(()=>{var bn={3948:(g,T)=>{"use strict";Object.defineProperty(T,"__esModule",{value:!0});var N=[];N[0]=function(){return function(){}},N[1]=function(d,j){return typeof j>"u"?d:function(A){d(A,j)}};var W=function(){function d(){this.hasHandlers=!1,this._handlers=[],this._contexts=[],this._createDispatcher()}return d.prototype.addHandler=function(j,s){return this.isHandlerAttached(j,s)||(this._handlers.push(j),this._contexts.push(s),this._createDispatcher(),this._updateHasHandlers()),this},d.prototype.removeHandler=function(j,s){var A=this._getHandlerIndex(j,s);return typeof A<"u"&&(this._handlers.splice(A,1),this._contexts.splice(A,1),this._createDispatcher(),this._updateHasHandlers()),this},d.prototype.isHandlerAttached=function(j,s){return typeof this._getHandlerIndex(j,s)<"u"},d.prototype._updateHasHandlers=function(){this.hasHandlers=!!this._handlers.length},d.prototype._getHandlerIndex=function(j,s){var C,A=this._handlers.length;for(C=0;C<A&&(this._handlers[C]!==j||this._contexts[C]!==s);C++);return C<A?C:void 0},d.prototype._createDispatcher=function(){this.dispatch=function H(d){return N[d]||(N[d]=function L(d){for(var j="return function dispatcher"+d+"(payload) {\n",s=[],A=[],C=0;C<d;C++)s.push("cb"+C),A.push("ctx"+C),j+="    cb"+C+"(payload, ctx"+C+");\n";return j+="};",new(Function.bind.apply(Function,[void 0].concat(s.concat(A),[j])))}(d)),N[d]}(this._handlers.length).apply(this,this._handlers.concat(this._contexts))},d}();T.default=W},5e3:g=>{function T(H,L,W,d,j,s,A){try{var C=H[s](A),Z=C.value}catch(ye){return void W(ye)}C.done?L(Z):Promise.resolve(Z).then(d,j)}g.exports=function N(H){return function(){var L=this,W=arguments;return new Promise(function(d,j){var s=H.apply(L,W);function A(Z){T(s,d,j,A,C,"next",Z)}function C(Z){T(s,d,j,A,C,"throw",Z)}A(void 0)})}},g.exports.__esModule=!0,g.exports.default=g.exports},5259:function(){!function(g){"use strict";if(!g.setImmediate){var d,N=1,H={},L=!1,W=g.document,q=Object.getPrototypeOf&&Object.getPrototypeOf(g);q=q&&q.setTimeout?q:g,"[object process]"==={}.toString.call(g.process)?function Z(){d=function(P){process.nextTick(function(){C(P)})}}():function ye(){if(g.postMessage&&!g.importScripts){var P=!0,k=g.onmessage;return g.onmessage=function(){P=!1},g.postMessage("","*"),g.onmessage=k,P}}()?function Me(){var P="setImmediate$"+Math.random()+"$",k=function(M){M.source===g&&"string"==typeof M.data&&0===M.data.indexOf(P)&&C(+M.data.slice(P.length))};g.addEventListener?g.addEventListener("message",k,!1):g.attachEvent("onmessage",k),d=function(M){g.postMessage(P+M,"*")}}():g.MessageChannel?function Se(){var P=new MessageChannel;P.port1.onmessage=function(k){C(k.data)},d=function(k){P.port2.postMessage(k)}}():W&&"onreadystatechange"in W.createElement("script")?function oe(){var P=W.documentElement;d=function(k){var M=W.createElement("script");M.onreadystatechange=function(){C(k),M.onreadystatechange=null,P.removeChild(M),M=null},P.appendChild(M)}}():function fe(){d=function(P){setTimeout(C,0,P)}}(),q.setImmediate=function j(P){"function"!=typeof P&&(P=new Function(""+P));for(var k=new Array(arguments.length-1),M=0;M<k.length;M++)k[M]=arguments[M+1];return H[N]={callback:P,args:k},d(N),N++},q.clearImmediate=s}function s(P){delete H[P]}function C(P){if(L)setTimeout(C,0,P);else{var k=H[P];if(k){L=!0;try{!function A(P){var k=P.callback,M=P.args;switch(M.length){case 0:k();break;case 1:k(M[0]);break;case 2:k(M[0],M[1]);break;case 3:k(M[0],M[1],M[2]);break;default:k.apply(void 0,M)}}(k)}finally{s(P),L=!1}}}}}(typeof self>"u"?typeof global>"u"?this:global:self)},6702:(g,T,N)=>{var W,H=N(5e3).default,L=(W=typeof document<"u"?document.currentScript?.src:void 0,H(function*(d={}){var s=d,A="object"==typeof window,C=typeof WorkerGlobalScope<"u",Se=("object"==typeof process&&process.versions?.node&&process,"./this.program"),oe=(e,r)=>{throw r};C&&(W=self.location.href);var P,k,fe="";if(A||C){try{fe=new URL(".",W).href}catch{}C&&(k=e=>{var r=new XMLHttpRequest;return r.open("GET",e,!1),r.responseType="arraybuffer",r.send(null),new Uint8Array(r.response)}),P=function(){var e=H(function*(r){var o=yield fetch(r,{credentials:"same-origin"});if(o.ok)return o.arrayBuffer();throw new Error(o.status+" : "+o.url)});return function(o){return e.apply(this,arguments)}}()}var re,ve,M=console.log.bind(console),ae=console.error.bind(console),ge=!1;function we(e,r){e||pe(r)}var Oe,Pe,De,ne,_e,U,Y,ce,Ue,Be=!1;function Ee(){var e=De.buffer;ne=new Int8Array(e),new Int16Array(e),s.HEAPU8=_e=new Uint8Array(e),new Uint16Array(e),U=new Int32Array(e),s.HEAPU32=Y=new Uint32Array(e),new Float32Array(e),ce=new Float64Array(e),Ue=new BigInt64Array(e),new BigUint64Array(e)}var Te,y=0,h=null;function pe(e){s.onAbort?.(e),ae(e="Aborted("+e+")"),ge=!0,e+=". Build with -sASSERTIONS for more info.";var r=new WebAssembly.RuntimeError(e);throw Pe?.(r),r}function ke(){return(ke=H(function*(e){if(!re)try{var r=yield P(e);return new Uint8Array(r)}catch{}return function Ne(e){if(e==Te&&re)return new Uint8Array(re);if(k)return k(e);throw"both async and sync fetching of the wasm failed"}(e)})).apply(this,arguments)}function E(){return E=H(function*(e,r){try{var o=yield function Ye(e){return ke.apply(this,arguments)}(e);return yield WebAssembly.instantiate(o,r)}catch(S){ae(`failed to asynchronously prepare wasm: ${S}`),pe(S)}}),E.apply(this,arguments)}function se(){return se=H(function*(e,r,o){if(!e&&"function"==typeof WebAssembly.instantiateStreaming)try{var u=fetch(r,{credentials:"same-origin"});return yield WebAssembly.instantiateStreaming(u,o)}catch(G){ae(`wasm streaming compile failed: ${G}`),ae("falling back to ArrayBuffer instantiation")}return function Je(e,r){return E.apply(this,arguments)}(r,o)}),se.apply(this,arguments)}function be(){return be=H(function*(){function e(G,F){return De=(xe=G.exports).memory,Ee(),s.wasmTable=de=xe.__indirect_function_table,function ei(e){s._main=St=e.main,s._webidl_free=e.webidl_free,s._webidl_malloc=e.webidl_malloc,s._emscripten_bind_VoidPtr___destroy___0=gt=e.emscripten_bind_VoidPtr___destroy___0,s._emscripten_bind_Uarm_Uarm_0=vt=e.emscripten_bind_Uarm_Uarm_0,s._emscripten_bind_Uarm_SetRamSize_1=Pt=e.emscripten_bind_Uarm_SetRamSize_1,s._emscripten_bind_Uarm_SetNand_2=Dt=e.emscripten_bind_Uarm_SetNand_2,s._emscripten_bind_Uarm_SetMemory_2=Ut=e.emscripten_bind_Uarm_SetMemory_2,s._emscripten_bind_Uarm_SetSavestate_2=xt=e.emscripten_bind_Uarm_SetSavestate_2,s._emscripten_bind_Uarm_SetSd_3=Gt=e.emscripten_bind_Uarm_SetSd_3,s._emscripten_bind_Uarm_SetDefaultMips_1=Ct=e.emscripten_bind_Uarm_SetDefaultMips_1,s._emscripten_bind_Uarm_Launch_2=Mt=e.emscripten_bind_Uarm_Launch_2,s._emscripten_bind_Uarm_Cycle_1=wt=e.emscripten_bind_Uarm_Cycle_1,s._emscripten_bind_Uarm_GetFrame_0=Ft=e.emscripten_bind_Uarm_GetFrame_0,s._emscripten_bind_Uarm_ResetFrame_0=It=e.emscripten_bind_Uarm_ResetFrame_0,s._emscripten_bind_Uarm_GetTimesliceSizeUsec_0=Tt=e.emscripten_bind_Uarm_GetTimesliceSizeUsec_0,s._emscripten_bind_Uarm_PenDown_2=Nt=e.emscripten_bind_Uarm_PenDown_2,s._emscripten_bind_Uarm_PenUp_0=kt=e.emscripten_bind_Uarm_PenUp_0,s._emscripten_bind_Uarm_CurrentIps_0=jt=e.emscripten_bind_Uarm_CurrentIps_0,s._emscripten_bind_Uarm_CurrentIpsMax_0=zt=e.emscripten_bind_Uarm_CurrentIpsMax_0,s._emscripten_bind_Uarm_SetMaxLoad_1=Rt=e.emscripten_bind_Uarm_SetMaxLoad_1,s._emscripten_bind_Uarm_SetCyclesPerSecondLimit_1=At=e.emscripten_bind_Uarm_SetCyclesPerSecondLimit_1,s._emscripten_bind_Uarm_GetTimestampUsec_0=Ot=e.emscripten_bind_Uarm_GetTimestampUsec_0,s._emscripten_bind_Uarm_KeyDown_1=Bt=e.emscripten_bind_Uarm_KeyDown_1,s._emscripten_bind_Uarm_KeyUp_1=Et=e.emscripten_bind_Uarm_KeyUp_1,s._emscripten_bind_Uarm_PendingSamples_0=Ht=e.emscripten_bind_Uarm_PendingSamples_0,s._emscripten_bind_Uarm_PopQueuedSamples_0=Lt=e.emscripten_bind_Uarm_PopQueuedSamples_0,s._emscripten_bind_Uarm_GetSampleQueueSize_0=Vt=e.emscripten_bind_Uarm_GetSampleQueueSize_0,s._emscripten_bind_Uarm_SetPcmOutputEnabled_1=Kt=e.emscripten_bind_Uarm_SetPcmOutputEnabled_1,s._emscripten_bind_Uarm_SetPcmSuspended_1=Wt=e.emscripten_bind_Uarm_SetPcmSuspended_1,s._emscripten_bind_Uarm_GetRomDataSize_0=$t=e.emscripten_bind_Uarm_GetRomDataSize_0,s._emscripten_bind_Uarm_GetRomData_0=Qt=e.emscripten_bind_Uarm_GetRomData_0,s._emscripten_bind_Uarm_GetNandDataSize_0=Yt=e.emscripten_bind_Uarm_GetNandDataSize_0,s._emscripten_bind_Uarm_GetNandData_0=Jt=e.emscripten_bind_Uarm_GetNandData_0,s._emscripten_bind_Uarm_GetNandDirtyPages_0=Xt=e.emscripten_bind_Uarm_GetNandDirtyPages_0,s._emscripten_bind_Uarm_IsNandDirty_0=Zt=e.emscripten_bind_Uarm_IsNandDirty_0,s._emscripten_bind_Uarm_SetNandDirty_1=qt=e.emscripten_bind_Uarm_SetNandDirty_1,s._emscripten_bind_Uarm_GetSdCardDataSize_0=er=e.emscripten_bind_Uarm_GetSdCardDataSize_0,s._emscripten_bind_Uarm_GetSdCardData_0=tr=e.emscripten_bind_Uarm_GetSdCardData_0,s._emscripten_bind_Uarm_GetSdCardDirtyPages_0=rr=e.emscripten_bind_Uarm_GetSdCardDirtyPages_0,s._emscripten_bind_Uarm_IsSdCardDirty_0=nr=e.emscripten_bind_Uarm_IsSdCardDirty_0,s._emscripten_bind_Uarm_SetSdCardDirty_1=ir=e.emscripten_bind_Uarm_SetSdCardDirty_1,s._emscripten_bind_Uarm_GetMemoryDataSize_0=ar=e.emscripten_bind_Uarm_GetMemoryDataSize_0,s._emscripten_bind_Uarm_GetMemoryData_0=sr=e.emscripten_bind_Uarm_GetMemoryData_0,s._emscripten_bind_Uarm_GetMemoryDirtyPages_0=or=e.emscripten_bind_Uarm_GetMemoryDirtyPages_0,s._emscripten_bind_Uarm_GetDeviceType_0=_r=e.emscripten_bind_Uarm_GetDeviceType_0,s._emscripten_bind_Uarm_SdCardInsert_3=cr=e.emscripten_bind_Uarm_SdCardInsert_3,s._emscripten_bind_Uarm_SdCardEject_0=pr=e.emscripten_bind_Uarm_SdCardEject_0,s._emscripten_bind_Uarm_SdCardInitialized_0=ur=e.emscripten_bind_Uarm_SdCardInitialized_0,s._emscripten_bind_Uarm_GetSdCardId_0=dr=e.emscripten_bind_Uarm_GetSdCardId_0,s._emscripten_bind_Uarm_Reset_0=fr=e.emscripten_bind_Uarm_Reset_0,s._emscripten_bind_Uarm_Save_0=lr=e.emscripten_bind_Uarm_Save_0,s._emscripten_bind_Uarm_GetSavestateSize_0=mr=e.emscripten_bind_Uarm_GetSavestateSize_0,s._emscripten_bind_Uarm_GetSavestateData_0=hr=e.emscripten_bind_Uarm_GetSavestateData_0,s._emscripten_bind_Uarm_IsSdInserted_0=br=e.emscripten_bind_Uarm_IsSdInserted_0,s._emscripten_bind_Uarm_GetRamSize_0=yr=e.emscripten_bind_Uarm_GetRamSize_0,s._emscripten_bind_Uarm_JamKey_2=Sr=e.emscripten_bind_Uarm_JamKey_2,s._emscripten_bind_Uarm_InstallDatabase_2=gr=e.emscripten_bind_Uarm_InstallDatabase_2,s._emscripten_bind_Uarm_NewDbBackup_1=vr=e.emscripten_bind_Uarm_NewDbBackup_1,s._emscripten_bind_Uarm___destroy___0=Pr=e.emscripten_bind_Uarm___destroy___0,s._emscripten_bind_DbBackup_Init_0=Dr=e.emscripten_bind_DbBackup_Init_0,s._emscripten_bind_DbBackup_GetState_0=Ur=e.emscripten_bind_DbBackup_GetState_0,s._emscripten_bind_DbBackup_Continue_0=xr=e.emscripten_bind_DbBackup_Continue_0,s._emscripten_bind_DbBackup_HasLastProcessedDb_0=Gr=e.emscripten_bind_DbBackup_HasLastProcessedDb_0,s._emscripten_bind_DbBackup_GetLastProcessedDb_0=Cr=e.emscripten_bind_DbBackup_GetLastProcessedDb_0,s._emscripten_bind_DbBackup_GetArchiveData_0=Mr=e.emscripten_bind_DbBackup_GetArchiveData_0,s._emscripten_bind_DbBackup_GetArchiveSize_0=wr=e.emscripten_bind_DbBackup_GetArchiveSize_0,s._emscripten_bind_DbBackup___destroy___0=Fr=e.emscripten_bind_DbBackup___destroy___0,s._emscripten_bind_Bridge_Bridge_0=Ir=e.emscripten_bind_Bridge_Bridge_0,s._emscripten_bind_Bridge_Malloc_1=Tr=e.emscripten_bind_Bridge_Malloc_1,s._emscripten_bind_Bridge_Free_1=Nr=e.emscripten_bind_Bridge_Free_1,s._emscripten_bind_Bridge___destroy___0=kr=e.emscripten_bind_Bridge___destroy___0,s._emscripten_bind_SessionFile5_SessionFile5_0=jr=e.emscripten_bind_SessionFile5_SessionFile5_0,s._emscripten_bind_SessionFile5_IsSessionFile_2=zr=e.emscripten_bind_SessionFile5_IsSessionFile_2,s._emscripten_bind_SessionFile5_GetDeviceId_0=Rr=e.emscripten_bind_SessionFile5_GetDeviceId_0,s._emscripten_bind_SessionFile5_SetDeviceId_1=Ar=e.emscripten_bind_SessionFile5_SetDeviceId_1,s._emscripten_bind_SessionFile5_GetMetadata_0=Or=e.emscripten_bind_SessionFile5_GetMetadata_0,s._emscripten_bind_SessionFile5_GetMetadataSize_0=Br=e.emscripten_bind_SessionFile5_GetMetadataSize_0,s._emscripten_bind_SessionFile5_SetMetadata_2=Er=e.emscripten_bind_SessionFile5_SetMetadata_2,s._emscripten_bind_SessionFile5_GetNor_0=Hr=e.emscripten_bind_SessionFile5_GetNor_0,s._emscripten_bind_SessionFile5_GetNorSize_0=Lr=e.emscripten_bind_SessionFile5_GetNorSize_0,s._emscripten_bind_SessionFile5_SetNor_2=Vr=e.emscripten_bind_SessionFile5_SetNor_2,s._emscripten_bind_SessionFile5_GetNand_0=Kr=e.emscripten_bind_SessionFile5_GetNand_0,s._emscripten_bind_SessionFile5_GetNandSize_0=Wr=e.emscripten_bind_SessionFile5_GetNandSize_0,s._emscripten_bind_SessionFile5_SetNand_2=$r=e.emscripten_bind_SessionFile5_SetNand_2,s._emscripten_bind_SessionFile5_GetMemory_0=Qr=e.emscripten_bind_SessionFile5_GetMemory_0,s._emscripten_bind_SessionFile5_GetMemorySize_0=Yr=e.emscripten_bind_SessionFile5_GetMemorySize_0,s._emscripten_bind_SessionFile5_SetMemory_2=Jr=e.emscripten_bind_SessionFile5_SetMemory_2,s._emscripten_bind_SessionFile5_GetSavestate_0=Xr=e.emscripten_bind_SessionFile5_GetSavestate_0,s._emscripten_bind_SessionFile5_GetSavestateSize_0=Zr=e.emscripten_bind_SessionFile5_GetSavestateSize_0,s._emscripten_bind_SessionFile5_SetSavestate_2=qr=e.emscripten_bind_SessionFile5_SetSavestate_2,s._emscripten_bind_SessionFile5_GetRamSize_0=en=e.emscripten_bind_SessionFile5_GetRamSize_0,s._emscripten_bind_SessionFile5_SetRamSize_1=tn=e.emscripten_bind_SessionFile5_SetRamSize_1,s._emscripten_bind_SessionFile5_Serialize_0=rn=e.emscripten_bind_SessionFile5_Serialize_0,s._emscripten_bind_SessionFile5_GetSerializedSession_0=nn=e.emscripten_bind_SessionFile5_GetSerializedSession_0,s._emscripten_bind_SessionFile5_GetSerializedSessionSize_0=an=e.emscripten_bind_SessionFile5_GetSerializedSessionSize_0,s._emscripten_bind_SessionFile5_GetVersion_0=sn=e.emscripten_bind_SessionFile5_GetVersion_0,s._emscripten_bind_SessionFile5_Deserialize_2=on=e.emscripten_bind_SessionFile5_Deserialize_2,s._emscripten_bind_SessionFile5___destroy___0=_n=e.emscripten_bind_SessionFile5___destroy___0,cn=e._emscripten_timeout}(xe),function $e(){if(y--,s.monitorRunDependencies?.(y),0==y&&h){var r=h;h=null,r()}}(),xe}!function ot(){y++,s.monitorRunDependencies?.(y)}();var o=function He(){return{env:dn,wasi_snapshot_preview1:dn}}();if(s.instantiateWasm)return new Promise((G,F)=>{s.instantiateWasm(o,(w,K)=>{G(e(w))})});Te??=function Qe(){return function q(e){return s.locateFile?s.locateFile(e,fe):fe+e}("uarm_web.wasm")}();var u=yield function V(e,r,o){return se.apply(this,arguments)}(re,Te,o);return function r(G){return e(G.instance)}(u)}),be.apply(this,arguments)}class i{name="ExitStatus";constructor(r){this.message=`Program terminated with exit(${r})`,this.status=r}}var de,t=e=>{for(;e.length>0;)e.shift()(s)},n=[],a=e=>n.push(e),_=[],c=e=>_.push(e),m=!0,O=typeof TextDecoder<"u"?new TextDecoder:void 0,ue=(e,r=0,o=NaN)=>{for(var u=r+o,S=r;e[S]&&!(S>=u);)++S;if(S-r>16&&e.buffer&&O)return O.decode(e.subarray(r,S));for(var G="";r<S;){var F=e[r++];if(128&F){var w=63&e[r++];if(192!=(224&F)){var K=63&e[r++];if((F=224==(240&F)?(15&F)<<12|w<<6|K:(7&F)<<18|w<<12|K<<6|63&e[r++])<65536)G+=String.fromCharCode(F);else{var Ce=F-65536;G+=String.fromCharCode(55296|Ce>>10,56320|1023&Ce)}}else G+=String.fromCharCode((31&F)<<6|w)}else G+=String.fromCharCode(F)}return G},I=(e,r)=>e?ue(_e,e,r):"",ee=e=>e<-9007199254740992||e>9007199254740992?NaN:Number(e),_t=0,Pn=[0,31,60,91,121,152,182,213,244,274,305,335],Dn=[0,31,59,90,120,151,181,212,243,273,304,334],ct=e=>((e=>e%4==0&&(e%100!=0||e%400==0))(e.getFullYear())?Pn:Dn)[e.getMonth()]+e.getDate()-1,je={},Ze=e=>{if(e instanceof i||"unwind"==e)return ve;oe(0,e)},pt=()=>m||_t>0,ut=e=>{ve=e,pt()||(s.onExit?.(e),ge=!0),oe(0,new i(e))},dt=(e,r)=>{ve=e,ut(e)},Gn=dt,ft=()=>performance.now(),lt=(e,r,o,u)=>{if(!(u>0))return 0;for(var S=o,G=o+u-1,F=0;F<e.length;++F){var w=e.codePointAt(F);if(w<=127){if(o>=G)break;r[o++]=w}else if(w<=2047){if(o+1>=G)break;r[o++]=192|w>>6,r[o++]=128|63&w}else if(w<=65535){if(o+2>=G)break;r[o++]=224|w>>12,r[o++]=128|w>>6&63,r[o++]=128|63&w}else{if(o+3>=G)break;r[o++]=240|w>>18,r[o++]=128|w>>12&63,r[o++]=128|w>>6&63,r[o++]=128|63&w,F++}}return r[o]=0,o-S},ze=(e,r,o)=>lt(e,_e,r,o),mt=()=>Date.now(),qe=[],ht=(e,r)=>Math.ceil(e/r)*r,An=e=>{var o=(e-De.buffer.byteLength+65535)/65536|0;try{return De.grow(o),Ee(),1}catch{}},et={},Re=()=>{if(!Re.strings){var r={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.language||"C").replace("-","_")+".UTF-8",_:Se||"./this.program"};for(var o in et)void 0===et[o]?delete r[o]:r[o]=et[o];var u=[];for(var o in r)u.push(`${o}=${r[o]}`);Re.strings=u}return Re.strings},bt=e=>{for(var r=0,o=0;o<e.length;++o){var u=e.charCodeAt(o);u<=127?r++:u<=2047?r+=2:u>=55296&&u<=57343?(r+=4,++o):r+=3}return r},tt=[null,[],[]],rt=(e,r)=>{var o=tt[e];0===r||10===r?((1===e?M:ae)(ue(o)),o.length=0):o.push(r)},yt=[];s.noExitRuntime&&(m=s.noExitRuntime),s.print&&(M=s.print),s.printErr&&(ae=s.printErr),s.wasmBinary&&(re=s.wasmBinary),s.thisProgram&&(Se=s.thisProgram),s.callMain=fn,s.wasmTable=de;var St,gt,vt,Pt,Dt,Ut,xt,Gt,Ct,Mt,wt,Ft,It,Tt,Nt,kt,jt,zt,Rt,At,Ot,Bt,Et,Ht,Lt,Vt,Kt,Wt,$t,Qt,Yt,Jt,Xt,Zt,qt,er,tr,rr,nr,ir,ar,sr,or,_r,cr,pr,ur,dr,fr,lr,mr,hr,br,yr,Sr,gr,vr,Pr,Dr,Ur,xr,Gr,Cr,Mr,wr,Fr,Ir,Tr,Nr,kr,jr,zr,Rr,Ar,Or,Br,Er,Hr,Lr,Vr,Kr,Wr,$r,Qr,Yr,Jr,Xr,Zr,qr,en,tn,rn,nn,an,sn,on,_n,cn,Qn={72158:e=>{de.grow(65536);for(let r=0;r<=65535;r++)de.set(de.length-65535-1+r,de.get(Y[(e>>>2)+r]));return de.length-65535-1}},dn={__assert_fail:(e,r,o,u)=>pe(`Assertion failed: ${I(e)}, at: `+[r?I(r):"unknown filename",o,u?I(u):"unknown function"]),__emscripten_abort:function Yn(){throw new Error("emulator terminated")},__syscall_ftruncate64:function yn(e,r){r=ee(r)},_abort_js:()=>pe(""),_emscripten_runtime_keepalive_clear:()=>{m=!1,_t=0},_localtime_js:function Un(e,r){e=ee(e);var o=new Date(1e3*e);U[r>>2]=o.getSeconds(),U[r+4>>2]=o.getMinutes(),U[r+8>>2]=o.getHours(),U[r+12>>2]=o.getDate(),U[r+16>>2]=o.getMonth(),U[r+20>>2]=o.getFullYear()-1900,U[r+24>>2]=o.getDay();var u=0|ct(o);U[r+28>>2]=u,U[r+36>>2]=-60*o.getTimezoneOffset();var S=new Date(o.getFullYear(),0,1),G=new Date(o.getFullYear(),6,1).getTimezoneOffset(),F=S.getTimezoneOffset(),w=0|(G!=F&&o.getTimezoneOffset()==Math.min(F,G));U[r+32>>2]=w},_mktime_js:function(e){var r=(()=>{var o=new Date(U[e+20>>2]+1900,U[e+16>>2],U[e+12>>2],U[e+8>>2],U[e+4>>2],U[e>>2],0),u=U[e+32>>2],S=o.getTimezoneOffset(),G=new Date(o.getFullYear(),0,1),F=new Date(o.getFullYear(),6,1).getTimezoneOffset(),w=G.getTimezoneOffset(),K=Math.min(w,F);if(u<0)U[e+32>>2]=+(F!=w&&K==S);else if(u>0!=(K==S)){var Ce=Math.max(w,F),Le=u>0?K:Ce;o.setTime(o.getTime()+6e4*(Le-S))}U[e+24>>2]=o.getDay();var Ve=0|ct(o);U[e+28>>2]=Ve,U[e>>2]=o.getSeconds(),U[e+4>>2]=o.getMinutes(),U[e+8>>2]=o.getHours(),U[e+12>>2]=o.getDate(),U[e+16>>2]=o.getMonth(),U[e+20>>2]=o.getYear();var Ae=o.getTime();return isNaN(Ae)?-1:Ae/1e3})();return BigInt(r)},_setitimer_js:(e,r)=>{if(je[e]&&(clearTimeout(je[e].id),delete je[e]),!r)return 0;var o=setTimeout(()=>{delete je[e],(e=>{if(!ge)try{e(),(()=>{if(!pt())try{Gn(ve)}catch(e){Ze(e)}})()}catch(r){Ze(r)}})(()=>cn(e,ft()))},r);return je[e]={id:o,timeout_ms:r},0},_tzset_js:(e,r,o,u)=>{var S=(new Date).getFullYear(),G=new Date(S,0,1),F=new Date(S,6,1),w=G.getTimezoneOffset(),K=F.getTimezoneOffset(),Ce=Math.max(w,K);Y[e>>2]=60*Ce,U[r>>2]=+(w!=K);var Le=mn=>{var oi=mn>=0?"-":"+",hn=Math.abs(mn);return`UTC${oi}${String(Math.floor(hn/60)).padStart(2,"0")}${String(hn%60).padStart(2,"0")}`},Ve=Le(w),Ae=Le(K);K<w?(ze(Ve,o,17),ze(Ae,u,17)):(ze(Ve,u,17),ze(Ae,o,17))},clock_time_get:function Nn(e,r,o){if(r=ee(r),!(e=>e>=0&&e<=3)(e))return 28;var u;u=0===e?mt():ft();var S=Math.round(1e3*u*1e3);return Ue[o>>3]=BigInt(S),0},emscripten_asm_const_int:(e,r,o)=>((e,r,o)=>{var u=((e,r)=>{qe.length=0;for(var o;o=_e[e++];){var u=105!=o;r+=(u&=112!=o)&&r%8?4:0,qe.push(112==o?Y[r>>2]:106==o?Ue[r>>3]:105==o?U[r>>2]:ce[r>>3]),r+=u?8:4}return qe})(r,o);return Qn[e](...u)})(e,r,o),emscripten_date_now:mt,emscripten_resize_heap:e=>{var r=_e.length,o=2147483648;if((e>>>=0)>o)return!1;for(var u=1;u<=4;u*=2){var S=r*(1+.2/u);S=Math.min(S,e+100663296);var G=Math.min(o,ht(Math.max(e,S),65536));if(An(G))return!0}return!1},environ_get:(e,r)=>{var o=0,u=0;for(var S of Re()){var G=r+o;Y[e+u>>2]=G,o+=ze(S,G,1/0)+1,u+=4}return 0},environ_sizes_get:(e,r)=>{var o=Re();Y[e>>2]=o.length;var u=0;for(var S of o)u+=bt(S)+1;return Y[r>>2]=u,0},fd_close:e=>52,fd_read:(e,r,o,u)=>52,fd_seek:function Kn(e,r,o,u){return r=ee(r),70},fd_write:(e,r,o,u)=>{for(var S=0,G=0;G<o;G++){var F=Y[r>>2],w=Y[r+4>>2];r+=8;for(var K=0;K<w;K++)rt(e,_e[F+K]);S+=w}return Y[u>>2]=S,0},proc_exit:ut},xe=yield function Xe(){return be.apply(this,arguments)}();function fn(){var e=St;try{var u=e(0,0);return dt(u),u}catch(S){return Ze(S)}}function Q(){}function Ge(e){return(e||Q).__cache__}function x(e,r){var o=Ge(r),u=o[e];return u||((u=Object.create((r||Q).prototype)).ptr=e,o[e]=u)}(function ti(){if(s.preInit)for("function"==typeof s.preInit&&(s.preInit=[s.preInit]);s.preInit.length>0;)s.preInit.shift()()})(),function nt(){function e(){s.calledRun=!0,ge||(function We(){Be=!0,t(yt),xe.__wasm_call_ctors()}(),Oe?.(s),s.onRuntimeInitialized?.(),s.noInitialRun||fn(),function Ie(){if(s.postRun)for("function"==typeof s.postRun&&(s.postRun=[s.postRun]);s.postRun.length;)a(s.postRun.shift());t(n)}())}y>0?h=nt:(function Fe(){if(s.preRun)for("function"==typeof s.preRun&&(s.preRun=[s.preRun]);s.preRun.length;)c(s.preRun.shift());t(_)}(),y>0?h=nt:s.setStatus?(s.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>s.setStatus(""),1),e()},1)):e())}(),(Q.prototype=Object.create(Q.prototype)).constructor=Q,Q.prototype.__class__=Q,Q.__cache__={},s.WrapperObject=Q,s.getCache=Ge,s.wrapPointer=x,s.castObject=function ri(e,r){return x(e.ptr,r)},s.NULL=x(0),s.destroy=function ni(e){if(!e.__destroy__)throw"Error: Cannot destroy object. (Did you create it yourself?)";e.__destroy__(),delete Ge(e.__class__)[e.ptr]},s.compare=function ii(e,r){return e.ptr===r.ptr},s.getPointer=function ai(e){return e.ptr},s.getClass=function si(e){return e.__class__};var v={buffer:0,size:0,pos:0,temps:[],needed:0,prepare(){if(v.needed){for(var e=0;e<v.temps.length;e++)s._webidl_free(v.temps[e]);v.temps.length=0,s._webidl_free(v.buffer),v.buffer=0,v.size+=v.needed,v.needed=0}v.buffer||(v.size+=128,v.buffer=s._webidl_malloc(v.size),we(v.buffer)),v.pos=0},alloc(e,r){we(v.buffer);var S,u=e.length*r.BYTES_PER_ELEMENT;return u=ht(u,8),v.pos+u>=v.size?(we(u>0),v.needed+=u,S=s._webidl_malloc(u),v.temps.push(S)):(S=v.buffer+v.pos,v.pos+=u),S},copy(e,r,o){o/=r.BYTES_PER_ELEMENT;for(var u=0;u<e.length;u++)r[o+u]=e[u]}};function ln(e){if("string"==typeof e){var r=(e=>{var u=bt(e)+1,S=new Array(u);lt(e,S,0,S.length);return S})(e),o=v.alloc(r,ne);return v.copy(r,ne,o),o}return e}function R(){throw"cannot construct a VoidPtr, no constructor in IDL"}function p(){this.ptr=vt(),Ge(p)[this.ptr]=this}function B(){throw"cannot construct a DbBackup, no constructor in IDL"}function J(){this.ptr=Ir(),Ge(J)[this.ptr]=this}function l(){this.ptr=jr(),Ge(l)[this.ptr]=this}return(R.prototype=Object.create(Q.prototype)).constructor=R,R.prototype.__class__=R,R.__cache__={},s.VoidPtr=R,R.prototype.__destroy__=R.prototype.__destroy__=function(){gt(this.ptr)},(p.prototype=Object.create(Q.prototype)).constructor=p,p.prototype.__class__=p,p.__cache__={},s.Uarm=p,p.prototype.SetRamSize=p.prototype.SetRamSize=function(e){return e&&"object"==typeof e&&(e=e.ptr),x(Pt(this.ptr,e),p)},p.prototype.SetNand=p.prototype.SetNand=function(e,r){return e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),x(Dt(this.ptr,e,r),p)},p.prototype.SetMemory=p.prototype.SetMemory=function(e,r){return e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),x(Ut(this.ptr,e,r),p)},p.prototype.SetSavestate=p.prototype.SetSavestate=function(e,r){return e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),x(xt(this.ptr,e,r),p)},p.prototype.SetSd=p.prototype.SetSd=function(e,r,o){var u=this.ptr;return v.prepare(),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),o=o&&"object"==typeof o?o.ptr:ln(o),x(Gt(u,e,r,o),p)},p.prototype.SetDefaultMips=p.prototype.SetDefaultMips=function(e){return e&&"object"==typeof e&&(e=e.ptr),x(Ct(this.ptr,e),p)},p.prototype.Launch=p.prototype.Launch=function(e,r){return e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),!!Mt(this.ptr,e,r)},p.prototype.Cycle=p.prototype.Cycle=function(e){return e&&"object"==typeof e&&(e=e.ptr),wt(this.ptr,e)},p.prototype.GetFrame=p.prototype.GetFrame=function(){return x(Ft(this.ptr),R)},p.prototype.ResetFrame=p.prototype.ResetFrame=function(){It(this.ptr)},p.prototype.GetTimesliceSizeUsec=p.prototype.GetTimesliceSizeUsec=function(){return Tt(this.ptr)},p.prototype.PenDown=p.prototype.PenDown=function(e,r){e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),Nt(this.ptr,e,r)},p.prototype.PenUp=p.prototype.PenUp=function(){kt(this.ptr)},p.prototype.CurrentIps=p.prototype.CurrentIps=function(){return jt(this.ptr)},p.prototype.CurrentIpsMax=p.prototype.CurrentIpsMax=function(){return zt(this.ptr)},p.prototype.SetMaxLoad=p.prototype.SetMaxLoad=function(e){e&&"object"==typeof e&&(e=e.ptr),Rt(this.ptr,e)},p.prototype.SetCyclesPerSecondLimit=p.prototype.SetCyclesPerSecondLimit=function(e){e&&"object"==typeof e&&(e=e.ptr),At(this.ptr,e)},p.prototype.GetTimestampUsec=p.prototype.GetTimestampUsec=function(){return Ot(this.ptr)},p.prototype.KeyDown=p.prototype.KeyDown=function(e){e&&"object"==typeof e&&(e=e.ptr),Bt(this.ptr,e)},p.prototype.KeyUp=p.prototype.KeyUp=function(e){e&&"object"==typeof e&&(e=e.ptr),Et(this.ptr,e)},p.prototype.PendingSamples=p.prototype.PendingSamples=function(){return Ht(this.ptr)},p.prototype.PopQueuedSamples=p.prototype.PopQueuedSamples=function(){return x(Lt(this.ptr),R)},p.prototype.GetSampleQueueSize=p.prototype.GetSampleQueueSize=function(){return Vt(this.ptr)},p.prototype.SetPcmOutputEnabled=p.prototype.SetPcmOutputEnabled=function(e){e&&"object"==typeof e&&(e=e.ptr),Kt(this.ptr,e)},p.prototype.SetPcmSuspended=p.prototype.SetPcmSuspended=function(e){e&&"object"==typeof e&&(e=e.ptr),Wt(this.ptr,e)},p.prototype.GetRomDataSize=p.prototype.GetRomDataSize=function(){return $t(this.ptr)},p.prototype.GetRomData=p.prototype.GetRomData=function(){return x(Qt(this.ptr),R)},p.prototype.GetNandDataSize=p.prototype.GetNandDataSize=function(){return Yt(this.ptr)},p.prototype.GetNandData=p.prototype.GetNandData=function(){return x(Jt(this.ptr),R)},p.prototype.GetNandDirtyPages=p.prototype.GetNandDirtyPages=function(){return x(Xt(this.ptr),R)},p.prototype.IsNandDirty=p.prototype.IsNandDirty=function(){return!!Zt(this.ptr)},p.prototype.SetNandDirty=p.prototype.SetNandDirty=function(e){e&&"object"==typeof e&&(e=e.ptr),qt(this.ptr,e)},p.prototype.GetSdCardDataSize=p.prototype.GetSdCardDataSize=function(){return er(this.ptr)},p.prototype.GetSdCardData=p.prototype.GetSdCardData=function(){return x(tr(this.ptr),R)},p.prototype.GetSdCardDirtyPages=p.prototype.GetSdCardDirtyPages=function(){return x(rr(this.ptr),R)},p.prototype.IsSdCardDirty=p.prototype.IsSdCardDirty=function(){return!!nr(this.ptr)},p.prototype.SetSdCardDirty=p.prototype.SetSdCardDirty=function(e){e&&"object"==typeof e&&(e=e.ptr),ir(this.ptr,e)},p.prototype.GetMemoryDataSize=p.prototype.GetMemoryDataSize=function(){return ar(this.ptr)},p.prototype.GetMemoryData=p.prototype.GetMemoryData=function(){return x(sr(this.ptr),R)},p.prototype.GetMemoryDirtyPages=p.prototype.GetMemoryDirtyPages=function(){return x(or(this.ptr),R)},p.prototype.GetDeviceType=p.prototype.GetDeviceType=function(){return _r(this.ptr)},p.prototype.SdCardInsert=p.prototype.SdCardInsert=function(e,r,o){var u=this.ptr;return v.prepare(),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),o=o&&"object"==typeof o?o.ptr:ln(o),!!cr(u,e,r,o)},p.prototype.SdCardEject=p.prototype.SdCardEject=function(){pr(this.ptr)},p.prototype.SdCardInitialized=p.prototype.SdCardInitialized=function(){return!!ur(this.ptr)},p.prototype.GetSdCardId=p.prototype.GetSdCardId=function(){return I(dr(this.ptr))},p.prototype.Reset=p.prototype.Reset=function(){fr(this.ptr)},p.prototype.Save=p.prototype.Save=function(){lr(this.ptr)},p.prototype.GetSavestateSize=p.prototype.GetSavestateSize=function(){return mr(this.ptr)},p.prototype.GetSavestateData=p.prototype.GetSavestateData=function(){return x(hr(this.ptr),R)},p.prototype.IsSdInserted=p.prototype.IsSdInserted=function(){return!!br(this.ptr)},p.prototype.GetRamSize=p.prototype.GetRamSize=function(){return yr(this.ptr)},p.prototype.JamKey=p.prototype.JamKey=function(e,r){e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),Sr(this.ptr,e,r)},p.prototype.InstallDatabase=p.prototype.InstallDatabase=function(e,r){return e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),gr(this.ptr,e,r)},p.prototype.NewDbBackup=p.prototype.NewDbBackup=function(e){return e&&"object"==typeof e&&(e=e.ptr),x(vr(this.ptr,e),B)},p.prototype.__destroy__=p.prototype.__destroy__=function(){Pr(this.ptr)},(B.prototype=Object.create(Q.prototype)).constructor=B,B.prototype.__class__=B,B.__cache__={},s.DbBackup=B,B.prototype.Init=B.prototype.Init=function(){return!!Dr(this.ptr)},B.prototype.GetState=B.prototype.GetState=function(){return Ur(this.ptr)},B.prototype.Continue=B.prototype.Continue=function(){return!!xr(this.ptr)},B.prototype.HasLastProcessedDb=B.prototype.HasLastProcessedDb=function(){return!!Gr(this.ptr)},B.prototype.GetLastProcessedDb=B.prototype.GetLastProcessedDb=function(){return I(Cr(this.ptr))},B.prototype.GetArchiveData=B.prototype.GetArchiveData=function(){return x(Mr(this.ptr),R)},B.prototype.GetArchiveSize=B.prototype.GetArchiveSize=function(){return wr(this.ptr)},B.prototype.__destroy__=B.prototype.__destroy__=function(){Fr(this.ptr)},(J.prototype=Object.create(Q.prototype)).constructor=J,J.prototype.__class__=J,J.__cache__={},s.Bridge=J,J.prototype.Malloc=J.prototype.Malloc=function(e){return e&&"object"==typeof e&&(e=e.ptr),x(Tr(this.ptr,e),R)},J.prototype.Free=J.prototype.Free=function(e){e&&"object"==typeof e&&(e=e.ptr),Nr(this.ptr,e)},J.prototype.__destroy__=J.prototype.__destroy__=function(){kr(this.ptr)},(l.prototype=Object.create(Q.prototype)).constructor=l,l.prototype.__class__=l,l.__cache__={},s.SessionFile5=l,l.prototype.IsSessionFile=l.prototype.IsSessionFile=function(e,r){return e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),!!zr(this.ptr,e,r)},l.prototype.GetDeviceId=l.prototype.GetDeviceId=function(){return Rr(this.ptr)},l.prototype.SetDeviceId=l.prototype.SetDeviceId=function(e){return e&&"object"==typeof e&&(e=e.ptr),x(Ar(this.ptr,e),l)},l.prototype.GetMetadata=l.prototype.GetMetadata=function(){return x(Or(this.ptr),R)},l.prototype.GetMetadataSize=l.prototype.GetMetadataSize=function(){return Br(this.ptr)},l.prototype.SetMetadata=l.prototype.SetMetadata=function(e,r){return e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),x(Er(this.ptr,e,r),l)},l.prototype.GetNor=l.prototype.GetNor=function(){return x(Hr(this.ptr),R)},l.prototype.GetNorSize=l.prototype.GetNorSize=function(){return Lr(this.ptr)},l.prototype.SetNor=l.prototype.SetNor=function(e,r){return e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),x(Vr(this.ptr,e,r),l)},l.prototype.GetNand=l.prototype.GetNand=function(){return x(Kr(this.ptr),R)},l.prototype.GetNandSize=l.prototype.GetNandSize=function(){return Wr(this.ptr)},l.prototype.SetNand=l.prototype.SetNand=function(e,r){return e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),x($r(this.ptr,e,r),l)},l.prototype.GetMemory=l.prototype.GetMemory=function(){return x(Qr(this.ptr),R)},l.prototype.GetMemorySize=l.prototype.GetMemorySize=function(){return Yr(this.ptr)},l.prototype.SetMemory=l.prototype.SetMemory=function(e,r){return e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),x(Jr(this.ptr,e,r),l)},l.prototype.GetSavestate=l.prototype.GetSavestate=function(){return x(Xr(this.ptr),R)},l.prototype.GetSavestateSize=l.prototype.GetSavestateSize=function(){return Zr(this.ptr)},l.prototype.SetSavestate=l.prototype.SetSavestate=function(e,r){return e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),x(qr(this.ptr,e,r),l)},l.prototype.GetRamSize=l.prototype.GetRamSize=function(){return en(this.ptr)},l.prototype.SetRamSize=l.prototype.SetRamSize=function(e){return e&&"object"==typeof e&&(e=e.ptr),x(tn(this.ptr,e),l)},l.prototype.Serialize=l.prototype.Serialize=function(){return!!rn(this.ptr)},l.prototype.GetSerializedSession=l.prototype.GetSerializedSession=function(){return x(nn(this.ptr),R)},l.prototype.GetSerializedSessionSize=l.prototype.GetSerializedSessionSize=function(){return an(this.ptr)},l.prototype.GetVersion=l.prototype.GetVersion=function(){return sn(this.ptr)},l.prototype.Deserialize=l.prototype.Deserialize=function(e,r){return e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),!!on(this.ptr,e,r)},l.prototype.__destroy__=l.prototype.__destroy__=function(){_n(this.ptr)},Be?s:new Promise((e,r)=>{Oe=e,Pe=r})}));g.exports=L,g.exports.default=L},6784:(g,T,N)=>{"use strict";var L=N(3948);T.J=L.default}},it={};function te(g){var T=it[g];if(void 0!==T)return T.exports;var N=it[g]={exports:{}};return bn[g].call(N.exports,N,N.exports,te),N.exports}te.n=g=>{var T=g&&g.__esModule?()=>g.default:()=>g;return te.d(T,{a:T}),T},te.d=(g,T)=>{for(var N in T)te.o(T,N)&&!te.o(g,N)&&Object.defineProperty(g,N,{enumerable:!0,get:T[N]})},te.o=(g,T)=>Object.prototype.hasOwnProperty.call(g,T),(()=>{"use strict";function g(i,t,n,a,_,c,f){try{var m=i[c](f),D=m.value}catch(b){return void n(b)}m.done?t(D):Promise.resolve(D).then(a,_)}function T(i){return function(){var t=this,n=arguments;return new Promise(function(a,_){var c=i.apply(t,n);function f(D){g(c,a,_,f,m,"next",D)}function m(D){g(c,a,_,f,m,"throw",D)}f(void 0)})}}function d(i,t,n,a){var f,_=arguments.length,c=_<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(i,t,n,a);else for(var m=i.length-1;m>=0;m--)(f=i[m])&&(c=(_<3?f(c):_>3?f(t,n,c):f(t,n))||c);return _>3&&c&&Object.defineProperty(t,n,c),c}"function"==typeof SuppressedError&&SuppressedError;var he=function(i){return i.palmPilot="PalmPilot",i.pilot="Pilot",i.iii="PalmIII",i.palmVx="PalmVx",i.palmV="PalmV",i.palmVII="PalmVII",i.palmVIIEZ="PalmVIIEZ",i.palmVIIx="PalmVIIx",i.iiic="PalmIIIc",i.iiix="PalmIIIx",i.iiixe="PalmIIIxe",i.iiie="PalmIIIe",i.m500="PalmM500",i.m505="PalmM505",i.m515="PalmM515",i.m520="PalmM520",i.m100="PalmM100",i.m105="PalmM105",i.m125="PalmM125",i.m130="PalmM130",i.i705="Palmi705",i.i710="PalmI710",i.handera330="HandEra330",i.handera330c="HandEra330c",i.pegS300="PEG-S300",i.pegS320="PEG-S320",i.pegS500c="PEG-S500C",i.pegT400="PEG-T400",i.pegN600c="PEG-N600C/N610C",i.pegT600c="PEG-T600",i.pegN700c="PEG-N700C/N710C",i.pegT650c="YSX1230",i.pegNR70="NR70",i.acerS11="Acer-S11",i.lp168="Legend-P168",i.te2="Tungsten-E2",i.frankene2="Franken-E2",i}(he||{}),Be=te(6702),Ee=te.n(Be),Fe=te(6784);let We=0;function Ie(i){switch(i){case 0:return 1;case 1:return 2;case 2:return 3;case 3:return 4;case 4:return 5;case 5:return 6;case 6:return 10;default:return 0}}function y(){return(i,t,n)=>{const a=n.value;return n.value=function(_,c){return this.guard(()=>a.call(this,_,c))},n}}class h{constructor(t){this.module=t,this.fatalErrorEvent=new Fe.J,this.amIdead=!1,this.uarm=new t.Uarm,this.bridge=new t.Bridge}static create(t){return T(function*(){const n=We++;return new h(yield Ee()({print:a=>console.log(`${n}: ${a}`),printErr:a=>console.warn(`${n}: ${a}`),instantiateWasm:(a,_)=>{WebAssembly.instantiate(t,a).then(c=>_(c))}}))})()}setRamSize(t){this.uarm.SetRamSize(t)}setMemory(t){this.uarm.SetMemory(t.length,this.copyIn(t))}setNand(t){this.uarm.SetNand(t.length,this.copyIn(t))}setSd(t,n){this.uarm.SetSd(t.length,this.copyIn(t),n)}setSavestate(t){this.uarm.SetSavestate(t.length,this.copyIn(t))}launch(t){return this.uarm.Launch(t.length,this.copyIn(t))}buttonUp(t){const n=Ie(t);n>=0&&this.uarm.KeyUp(n)}buttonDown(t){const n=Ie(t);n>=0&&this.uarm.KeyDown(n)}penDown(t,n){this.uarm.PenDown(t,n)}penUp(){this.uarm.PenUp()}getTimestampUsec(){return this.uarm.GetTimestampUsec()}cycle(t){return this.uarm.Cycle(t)}getTimesliceSizeUsec(){return this.uarm.GetTimesliceSizeUsec()}getDevice(){const t=this.uarm.GetDeviceType();switch(t){case 0:return he.te2;case 1:return he.frankene2;default:throw new Error(`invalid device ID ${t}`)}}getFrame(t){const n=this.module.getPointer(this.uarm.GetFrame())>>>2;return 0===n?void 0:this.module.HEAPU32.subarray(n,n+320*t)}resetFrame(){this.uarm.ResetFrame()}setTargetMips(t){this.uarm.SetCyclesPerSecondLimit(1e6*t)}setMaxHostLoad(t){this.uarm.SetMaxLoad(100*t)}getMemorySize(){return this.uarm.GetMemoryDataSize()}getMemoryData(){const t=this.module.getPointer(this.uarm.GetMemoryData());return this.module.HEAPU8.subarray(t,t+this.uarm.GetMemoryDataSize())}getMemoryDirtyPages(){const t=this.module.getPointer(this.uarm.GetMemoryDirtyPages()),n=this.uarm.GetMemoryDataSize()>>>10,a=t>>>2;let _=n>>>5;return 32*_<n&&_++,this.module.HEAPU32.subarray(a,a+_)}getSdCardSize(){return this.uarm.GetSdCardDataSize()}getSdCardData(){const t=this.module.getPointer(this.uarm.GetSdCardData());if(0!==t)return this.module.HEAPU8.subarray(t,t+this.uarm.GetSdCardDataSize())}getSdCardDirtyPages(){const t=this.module.getPointer(this.uarm.GetSdCardDirtyPages());if(0===t)return;const n=this.uarm.GetSdCardDataSize()>>>13,a=t>>>2;let _=n>>>5;return 32*_<n&&_++,this.module.HEAPU32.subarray(a,a+_)}isSdCardDirty(){return this.uarm.IsSdCardDirty()}setSdCardDirty(t){this.uarm.SetSdCardDirty(t)}getNandSize(){return this.uarm.GetNandDataSize()}getNandData(){const t=this.module.getPointer(this.uarm.GetNandData());return this.module.HEAPU8.subarray(t,t+this.uarm.GetNandDataSize())}getNandDirtyPages(){const t=this.module.getPointer(this.uarm.GetNandDirtyPages()),n=this.uarm.GetNandDataSize()/4224|0,a=t>>>2;let _=n>>>5;return 32*_<n&&_++,this.module.HEAPU32.subarray(a,a+_)}isNandDirty(){return this.uarm.IsNandDirty()}setNandDirty(t){this.uarm.SetNandDirty(t)}saveState(){this.uarm.Save();const t=this.module.getPointer(this.uarm.GetSavestateData());return this.module.HEAPU8.subarray(t,t+this.uarm.GetSavestateSize())}getCurrentIps(){return this.uarm.CurrentIps()}getCurrentIpsMax(){return Number(this.uarm.CurrentIpsMax())}getSdCardKey(){return this.uarm.SdCardInitialized()?this.uarm.GetSdCardId():void 0}sdCardInsert(t,n){const a=this.copyIn(new Uint8Array(t.buffer,t.byteOffset,t.byteLength));return!!this.uarm.SdCardInsert(a,4*t.length,n)||(this.bridge.Free(a),!1)}sdCardEject(){this.uarm.SdCardEject()}sdCardInserted(){return this.uarm.IsSdInserted()}clearSampleQueue(){this.uarm.PopQueuedSamples()}getQueuedSamples(){const t=this.uarm.PendingSamples();if(0===t)return;const n=this.module.getPointer(this.uarm.PopQueuedSamples())>>>2;return this.module.HEAPU32.subarray(n,n+t)}getSampleQueueSize(){return this.uarm.GetSampleQueueSize()}disablePcm(t){this.uarm.SetPcmOutputEnabled(!t)}suspendPcm(t){this.uarm.SetPcmSuspended(t)}reset(){this.uarm.Reset()}jamButton(t,n){this.uarm.JamKey(Ie(t),n)}installDb(t){const n=this.copyIn(t),a=this.uarm.InstallDatabase(t.length,n);return this.bridge.Free(n),function st(i){switch(i){case 0:case 1:return 1;case-2:return-4;case-4:return-3;case-5:return-6;case-7:case-6:return-7;case-3:return-2;case-8:return-1}}(a)}createDbBackup(t){const n=this.uarm.NewDbBackup(t?1:0);if(n.Init())return{getState:()=>this.guard(()=>n.GetState()),continue:()=>this.guard(()=>n.Continue()),getLastProcessedDb:()=>this.guard(()=>n.HasLastProcessedDb()?n.GetLastProcessedDb():void 0),getArchive:()=>this.guard(()=>{const a=this.module.getPointer(n.GetArchiveData());if(0!==a)return this.module.HEAPU8.subarray(a,a+n.GetArchiveSize())}),destroy:()=>this.guard(()=>this.module.destroy(n))};this.module.destroy(n)}getRomData(){const t=this.module.getPointer(this.uarm.GetRomData());return new Uint8Array(this.module.HEAPU8.subarray(t,t+this.uarm.GetRomDataSize()))}dead(){return this.amIdead}guard(t){if(this.amIdead)throw new Error("uarm instance is dead");try{return t()}catch(n){throw this.amIdead=!0,this.uarm=void 0,this.fatalErrorEvent.dispatch(n instanceof Error?n:new Error("unknown error")),n}}copyIn(t){const n=this.bridge.Malloc(t.length),a=this.module.getPointer(n);return this.module.HEAPU8.subarray(a,a+t.length).set(t),n}}d([y()],h.prototype,"setRamSize",null),d([y()],h.prototype,"setMemory",null),d([y()],h.prototype,"setNand",null),d([y()],h.prototype,"setSd",null),d([y()],h.prototype,"setSavestate",null),d([y()],h.prototype,"launch",null),d([y()],h.prototype,"buttonUp",null),d([y()],h.prototype,"buttonDown",null),d([y()],h.prototype,"penDown",null),d([y()],h.prototype,"penUp",null),d([y()],h.prototype,"getTimestampUsec",null),d([y()],h.prototype,"cycle",null),d([y()],h.prototype,"getTimesliceSizeUsec",null),d([y()],h.prototype,"getDevice",null),d([y()],h.prototype,"getFrame",null),d([y()],h.prototype,"resetFrame",null),d([y()],h.prototype,"setTargetMips",null),d([y()],h.prototype,"setMaxHostLoad",null),d([y()],h.prototype,"getMemorySize",null),d([y()],h.prototype,"getMemoryData",null),d([y()],h.prototype,"getMemoryDirtyPages",null),d([y()],h.prototype,"getSdCardSize",null),d([y()],h.prototype,"getSdCardData",null),d([y()],h.prototype,"getSdCardDirtyPages",null),d([y()],h.prototype,"isSdCardDirty",null),d([y()],h.prototype,"setSdCardDirty",null),d([y()],h.prototype,"getNandSize",null),d([y()],h.prototype,"getNandData",null),d([y()],h.prototype,"getNandDirtyPages",null),d([y()],h.prototype,"isNandDirty",null),d([y()],h.prototype,"setNandDirty",null),d([y()],h.prototype,"saveState",null),d([y()],h.prototype,"getCurrentIps",null),d([y()],h.prototype,"getCurrentIpsMax",null),d([y()],h.prototype,"getSdCardKey",null),d([y()],h.prototype,"sdCardInsert",null),d([y()],h.prototype,"sdCardEject",null),d([y()],h.prototype,"sdCardInserted",null),d([y()],h.prototype,"clearSampleQueue",null),d([y()],h.prototype,"getQueuedSamples",null),d([y()],h.prototype,"getSampleQueueSize",null),d([y()],h.prototype,"disablePcm",null),d([y()],h.prototype,"suspendPcm",null),d([y()],h.prototype,"reset",null),d([y()],h.prototype,"jamButton",null),d([y()],h.prototype,"installDb",null),d([y()],h.prototype,"createDbBackup",null),d([y()],h.prototype,"getRomData",null),te(5259);const $e=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);function pe(i){let t=-1;for(let n=0;n<i.length;n++)t=$e[255&(t^i[n])]^t>>>8;return~t}class Ne{constructor(t,n,a,_,c){this.pageSize=t,this.pageCount=n,this.name=a,this.crcCheck=_,this.adapter=c,this.scheduledPageCount=0,this.dirtyPagesSize4=n>>>5,32*this.dirtyPagesSize4<n&&this.dirtyPagesSize4++,this.scheduledPages=new Uint32Array(n),this.pagePool=new Uint8Array(256*t)}takeSnapshot(){if(this.scheduledPageCount>0&&console.warn(`${this.name} pending, skipping snapshot...`),!this.adapter.isDirty())return;const t=this.adapter.getData(),n=this.adapter.getDirtyPages();if(!t||!n)return;let a=0,_=0;for(let c=0;c<n.length;c++){let f=n[c];if(0!==f){for(let m=0;m<4;m++){const D=255&f;if(f>>>=8,0!==D)for(let b=1;b<256;b<<=1){if(!(D&b)){_++;continue}this.scheduledPages[a]=_;const z=a*this.pageSize,O=_*this.pageSize;z>=this.pagePool.length&&this.growPagePool(),this.pagePool.subarray(z,z+this.pageSize).set(t.subarray(O,O+this.pageSize)),a++,_++}else _+=8}n[c]=0}else _+=32}return this.scheduledPageCount=a,this.scheduledPageCount>0?(this.adapter.setDirty(!1),{scheduledPageCount:this.scheduledPageCount,scheduledPages:this.scheduledPages.buffer,pagePool:this.pagePool.buffer,crc:this.crcCheck?pe(t):void 0}):void 0}getTransferables(){return this.scheduledPageCount>0?[this.scheduledPages.buffer,this.pagePool.buffer]:[]}returnSnapshot(t,n){if(!n)return;const a=this.scheduledPageCount;if(this.scheduledPages=new Uint32Array(n.scheduledPages),this.pagePool=new Uint8Array(n.pagePool),this.scheduledPageCount=0,t)return;const _=this.adapter.getDirtyPages();if(_)for(let c=0;c<a;c++){const f=this.scheduledPages[c];_[f>>>5]|=1<<(31&f)}this.adapter.setDirty(!0)}enableCrc(t){this.crcCheck=t}growPagePool(){const t=new Uint8Array(Math.min(Math.ceil(1.5*this.pagePool.length/this.pageSize)*this.pageSize,this.pageCount*this.pageSize));console.log(`growing ${this.name} page pool to ${t.length} bytes`),t.set(this.pagePool),this.pagePool=t}}class ke{constructor(t,n,a){this.uarm=t,this.settings=n,this.pcmPort=a,this.timesliceTask=()=>{const _=this.uarm.getTimestampUsec(),c=Number(_),f=this.uarm.cycle(_),m=(this.uarm.getTimesliceSizeUsec()-Number(this.uarm.getTimestampUsec())+c)/1e3;this.timeoutHandle=this.immediateHandle=void 0,m<5?this.immediateHandle=setImmediate(this.timesliceTask):this.timeoutHandle=setTimeout(this.timesliceTask,m);const D=performance.now();if(this.settings.automaticSnapshotInterval>0&&D-this.lastSnapshotAt>this.settings.automaticSnapshotInterval&&!this.snapshotPending){const b=this.takeSnapshot();b&&this.snapshotEvent.dispatch(b),this.lastSnapshotAt=D}this.processSamples(f),!this.backgrounded&&this.timesliceEvent.dispatch({sizeSeconds:f,frame:this.getFrame(),currentIps:this.uarm.getCurrentIps(),currentIpsMax:this.uarm.getCurrentIpsMax()})},this.onPcmPortMessage=_=>{if(!this.pcmStreaming||this.settings.disableAudio)return;const c=_.data;switch(c.type){case"resumePcm":this.suspendPcm(!1);break;case"suspendPcm":this.uarm.suspendPcm(!0);break;case"returnBuffer":this.sampleBufferPool.push(c.buffer)}},this.timesliceEvent=new Fe.J,this.snapshotEvent=new Fe.J,this.running=!1,this.backgrounded=!1,this.uarmInitialized=!1,this.framePool=[],this.deviceId=he.te2,this.snapshotPending=!1,this.lastSnapshotAt=0,this.pcmStreaming=!1,this.pcmSuspended=!1,this.pcmSuspendedForMsec=0,this.sampleBufferPool=[],this.returnSnapshotCallbacks=[],t.fatalErrorEvent.addHandler(()=>this.stop()),this.sampleQueueSize=t.getSampleQueueSize(),this.pcmPort.addEventListener("message",this.onPcmPortMessage),this.pcmPort.start()}openSession(t,n,a,_,c){const f=a?a.length>=33554432?33554432:16777216:void 0;if(void 0!==f&&this.uarm.setRamSize(f),n&&this.uarm.setNand(n),a&&this.uarm.setMemory(a),_&&this.uarm.setSavestate(_),c){const[m,D]=c;this.uarm.setSd(m,D)}return!!this.uarm.launch(t)&&(this.deviceId=this.uarm.getDevice(),this.pageTrackerMemory=new Ne(1024,this.uarm.getMemorySize()>>>10,"memory",this.settings.memoryCrc,{getData:()=>this.uarm.getMemoryData(),getDirtyPages:()=>this.uarm.getMemoryDirtyPages(),isDirty:()=>!0,setDirty:()=>{}}),this.pageTrackerNand=new Ne(4224,this.uarm.getNandSize()/4224|0,"nand",!1,{getData:()=>this.uarm.getNandData(),getDirtyPages:()=>this.uarm.getNandDirtyPages(),isDirty:()=>this.uarm.isNandDirty(),setDirty:m=>this.uarm.setNandDirty(m)}),this.updatePageTrackerSd(),this.uarmInitialized=!0,this.updateSettings(this.settings),!0)}updateSettings(t){this.settings=t,this.uarmInitialized&&(this.uarm.setMaxHostLoad(t.maxHostLoad),this.uarm.disablePcm(t.disableAudio),this.uarm.setTargetMips(t.targetMips),this.pageTrackerMemory?.enableCrc(t.memoryCrc))}buttonUp(t){this.uarm.buttonUp(t)}buttonDown(t){this.uarm.buttonDown(t)}penDown(t,n){this.uarm.penDown(t,n)}penUp(){this.uarm.penUp()}start(){this.running=!0,this.updateRunState()}stop(){this.running=!1,this.updateRunState()}setBackgrounded(t){this.backgrounded=t,this.updateRunState()}returnFrame(t){this.framePool.push(t)}returnSnapshot(t,n){if(this.snapshotPending)try{this.returnSnapshotUnguarded(t,n),this.returnSnapshotCallbacks.length>0&&(this.returnSnapshotCallbacks.forEach(a=>a()),this.returnSnapshotCallbacks=[])}finally{this.snapshotPending=!1}}takeSnapshot(){if(!this.snapshotPending)try{return this.takeSnapshotUnguarded()}finally{this.snapshotPending=!0}}refreshSnapshot(t){if(!this.snapshotPending)throw new Error("refresh snapshot called, but no pending snapshot!");return this.returnSnapshotUnguarded(t,!1),this.takeSnapshotUnguarded(t.timestamp,t.time)}waitForPendingSnapshot(){var t=this;return T(function*(){if(t.snapshotPending)return new Promise(n=>t.returnSnapshotCallbacks.push(n))})()}getMemorySize(){return this.uarm.getMemorySize()}getNandSize(){return this.uarm.getNandSize()}sdCardInsert(t,n){const a=this.uarm.sdCardInsert(t,n);return this.updatePageTrackerSd(),a}sdCardEject(){this.uarm.sdCardEject(),this.updatePageTrackerSd()}sdCardInserted(){return this.uarm.sdCardInserted()}getSdCardKey(){return this.uarm.getSdCardKey()}reset(t){switch(t){case 0:break;case 1:this.uarm.jamButton(4,2e3);break;case 2:this.uarm.jamButton(6,2e3)}this.uarm.reset()}installDb(t){return this.uarm.installDb(t)}backup(t){const n=this.uarm.createDbBackup(t);if(n)try{const a=[];for(;1===n.getState();)if(!n.continue()){const c=n.getLastProcessedDb();void 0!==c&&a.push(c)}const _=n.getArchive();return _?{archive:_.slice(),failedDatabases:a}:void 0}finally{n.destroy()}}getSdCardData(){const t=this.uarm.getSdCardData();return t?new Uint32Array(t.buffer,t.byteOffset,t.byteLength).slice():void 0}getFullState(){return{rom:this.uarm.getRomData().slice(),memory:this.uarm.getMemoryData().slice(),nand:this.uarm.getNandData().slice(),savestate:this.uarm.saveState().slice()}}enablePcmStreaming(){this.pcmStreaming||(this.pcmStreaming=!0,this.dispatchPcmPortMessage({type:"flush"}),this.suspendPcm(!1))}disablePcmStreaming(){this.pcmStreaming&&(this.pcmStreaming=!1,this.suspendPcm(!1))}takeSnapshotUnguarded(t,n=0){const a=Date.now(),_=this.uarm.saveState();if(this.savestate?this.savestate.set(_):this.savestate=_.slice(),!this.pageTrackerMemory||!this.pageTrackerNand)throw new Error("unreachable");const c=this.pageTrackerMemory.takeSnapshot(),f=this.pageTrackerNand.takeSnapshot(),m=this.pageTrackerSd?.takeSnapshot(),D=Date.now(),b=this.uarm.getSdCardKey();return[{memory:c,nand:f,sd:m&&void 0!==b?{snapshot:m,key:b,size:this.uarm.getSdCardSize()}:void 0,savestate:this.savestate.buffer,time:D-a+n,timestamp:t??D},[...this.pageTrackerMemory.getTransferables(),...this.pageTrackerNand.getTransferables(),...this.pageTrackerSd?.getTransferables()??[],this.savestate.buffer]]}returnSnapshotUnguarded(t,n){this.pageTrackerMemory?.returnSnapshot(n,t.memory),this.pageTrackerNand?.returnSnapshot(n,t.nand),this.pageTrackerSd&&t.sd&&this.pageTrackerSd.returnSnapshot(n,t.sd.snapshot),this.savestate=new Uint8Array(t.savestate)}updateRunState(){if(this.uarm.dead())return;const t=this.running&&(!this.backgrounded||this.settings.runInBackground);t&&void 0===this.timeoutHandle&&void 0===this.immediateHandle&&(this.immediateHandle=setImmediate(this.timesliceTask),this.dispatchPcmPortMessage({type:"flush"}),this.suspendPcm(!1)),t||(void 0!==this.timeoutHandle&&clearTimeout(this.timeoutHandle),void 0!==this.immediateHandle&&clearImmediate(this.immediateHandle),this.timeoutHandle=this.immediateHandle=void 0)}updatePageTrackerSd(){this.pageTrackerSd=void 0,0!==this.uarm.getSdCardSize()&&(this.pageTrackerSd=new Ne(8192,this.uarm.getSdCardSize()>>>13,"sdcard",!1,{getData:()=>this.uarm.getSdCardData(),getDirtyPages:()=>this.uarm.getSdCardDirtyPages(),isDirty:()=>this.uarm.isSdCardDirty(),setDirty:t=>this.uarm.setSdCardDirty(t)}))}processSamples(t){if(!this.pcmStreaming||this.settings.disableAudio)return void this.uarm.clearSampleQueue();this.pcmSuspended&&(this.pcmSuspendedForMsec+=1e3*t,this.pcmSuspendedForMsec>500&&this.suspendPcm(!1));const n=this.uarm.getQueuedSamples();if(!n)return;const a=this.getSampleBuffer();a.set(n),this.dispatchPcmPortMessage({type:"sampleData",buffer:a.buffer,count:n.length},[a.buffer])}getSampleBuffer(){return this.sampleBufferPool.length>0?new Uint32Array(this.sampleBufferPool.pop()):new Uint32Array(this.sampleQueueSize)}getFrame(){const t=this.uarm.getFrame(this.deviceId===he.frankene2?480:320);if(!t)return;let n;if(0===this.framePool.length)n=t.slice().buffer;else{const a=new Uint32Array(this.framePool.pop());a.set(t),n=a.buffer}return this.uarm.resetFrame(),n}suspendPcm(t){this.uarm.suspendPcm(t),this.pcmSuspended=t,t&&(this.pcmSuspendedForMsec=0)}dispatchPcmPortMessage(t,n){this.pcmPort.postMessage(t,n)}}let E;function V(){if(!E)throw new Error("worker not initialized");return E}function se(i,t){postMessage(i,t)}const He=new class Je{constructor(t){this.dispatchMessage=t,this.registeredMethods=new Map,this.registeredMethods=new Map}dispatch(t){var n=this;return T(function*(){const{id:a,method:_,args:c}=t,f=n.registeredMethods.get(_);if(f)try{let m;const D=yield f(c,b=>{m=[...m??[],...b]});n.dispatchMessage({type:"rpcSuccess",method:_,id:a,result:D},m)}catch(m){console.error(m),n.dispatchMessage({type:"rpcError",method:_,id:a,error:`${m}`})}else n.dispatchMessage({type:"rpcError",id:a,method:_,error:`method not registered: ${_}`})})()}register(t,n){return this.registeredMethods.set(t,n),this}}(se);function be(){return(be=T(function*(i){const t=i.data;switch(t.type){case"rpcCall":He.dispatch(t);break;case"updateSettings":E?.updateSettings(t.settings);break;case"buttonDown":E?.buttonDown(t.button);break;case"buttonUp":E?.buttonUp(t.button);break;case"penDown":E?.penDown(t.x,t.y);break;case"penUp":E?.penUp();break;case"returnFrame":E?.returnFrame(t.frame);break;case"returnSnapshot":E?.returnSnapshot(t.snapshot,t.success);break;case"setBackgrounded":E?.setBackgrounded(t.backgrounded);break;case"reset":E?.reset(t.resetType);break;case"setPcmStreaming":t.pcmStreaming?E?.enablePcmStreaming():E?.disablePcmStreaming()}})).apply(this,arguments)}He.register("initialize",function(){var i=T(function*({module:t,settings:n,pcmPort:a}){if(E)throw new Error("worker already initialized");const _=yield h.create(t);_.fatalErrorEvent.addHandler(c=>se({type:"fatalError",error:c.message})),E=new ke(_,n,a),E.timesliceEvent.addHandler(c=>se({type:"timeslice",...c},c.frame?[c.frame]:void 0)),E.snapshotEvent.addHandler(c=>{const[f,m]=c;se({type:"snapshot",snapshot:f},m)})});return function(t){return i.apply(this,arguments)}}()).register("openSession",({rom:i,memory:t,nand:n,state:a,card:_})=>V().openSession(i,n,t,a,_)).register("start",()=>V().start()).register("stop",()=>V().stop()).register("takeSnapshot",(i,t)=>{const n=V().takeSnapshot();if(!n)throw new Error("unable to take snapshot");const[a,_]=n;return t(_),a}).register("refreshSnapshot",(i,t)=>{const[n,a]=V().refreshSnapshot(i);return t(a),n}).register("waitForPendingSnapshot",()=>V().waitForPendingSnapshot()).register("getMemorySize",()=>({memory:V().getMemorySize(),nand:V().getNandSize()})).register("sdCardInsert",({data:i,key:t})=>V().sdCardInsert(i,t)).register("sdCardEject",()=>V().sdCardEject()).register("getSdCardState",()=>{if(!V().sdCardInserted())return{inserted:!1};const i=V().getSdCardKey();if(void 0===i)throw new Error("unreachable");return{inserted:!0,key:i}}).register("installDb",i=>V().installDb(i)).register("backup",({includeRom:i},t)=>{const n=V().backup(i);return n&&t([n.archive.buffer]),n}).register("getSdCardData",(i,t)=>{const n=V().getSdCardData();return n&&t([n.buffer]),n}).register("getFullState",(i,t)=>{const n=V().getFullState();return t([n.rom.buffer,n.memory.buffer,n.nand.buffer,n.savestate.buffer]),n}),addEventListener("message",function Xe(i){return be.apply(this,arguments)}),se({type:"ready"})})()})();
//# sourceMappingURL=9689.b0ae611c01202659.js.map