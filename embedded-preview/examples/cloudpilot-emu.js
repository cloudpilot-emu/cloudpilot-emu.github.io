!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.cloudpilot=t():e.cloudpilot=t()}(self,(()=>(()=>{var e={492:e=>{var t,r=(t="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(e){var r,n,i=void 0!==(e=e||{})?e:{};i.ready=new Promise((function(e,t){r=e,n=t}));var o,s,a,u=Object.assign({},i),c=[],p="./this.program",l=(e,t)=>{throw t},d="object"==typeof window,h="function"==typeof importScripts,m=("object"==typeof process&&"object"==typeof process.versions&&process.versions.node,"");(d||h)&&(h?m=self.location.href:"undefined"!=typeof document&&document.currentScript&&(m=document.currentScript.src),t&&(m=t),m=0!==m.indexOf("blob:")?m.substr(0,m.replace(/[?#].*/,"").lastIndexOf("/")+1):"",o=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},h&&(a=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),s=(e,t,r)=>{var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{200==n.status||0==n.status&&n.response?t(n.response):r()},n.onerror=r,n.send(null)});var _,f=i.print||console.log.bind(console),y=i.printErr||console.warn.bind(console);Object.assign(i,u),u=null,i.arguments&&(c=i.arguments),i.thisProgram&&(p=i.thisProgram),i.quit&&(l=i.quit),i.wasmBinary&&(_=i.wasmBinary);var v,g=i.noExitRuntime||!0;"object"!=typeof WebAssembly&&V("no native wasm support detected");var b,w=!1;function S(e,t){e||V(t)}var C,E,D,I,k,M,G="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function x(e,t,r){for(var n=t+r,i=t;e[i]&&!(i>=n);)++i;if(i-t>16&&e.buffer&&G)return G.decode(e.subarray(t,i));for(var o="";t<i;){var s=e[t++];if(128&s){var a=63&e[t++];if(192!=(224&s)){var u=63&e[t++];if((s=224==(240&s)?(15&s)<<12|a<<6|u:(7&s)<<18|a<<12|u<<6|63&e[t++])<65536)o+=String.fromCharCode(s);else{var c=s-65536;o+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else o+=String.fromCharCode((31&s)<<6|a)}else o+=String.fromCharCode(s)}return o}function P(e,t){return e?x(D,e,t):""}function R(e,t,r,n){if(!(n>0))return 0;for(var i=r,o=r+n-1,s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a>=55296&&a<=57343&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++s)),a<=127){if(r>=o)break;t[r++]=a}else if(a<=2047){if(r+1>=o)break;t[r++]=192|a>>6,t[r++]=128|63&a}else if(a<=65535){if(r+2>=o)break;t[r++]=224|a>>12,t[r++]=128|a>>6&63,t[r++]=128|63&a}else{if(r+3>=o)break;t[r++]=240|a>>18,t[r++]=128|a>>12&63,t[r++]=128|a>>6&63,t[r++]=128|63&a}}return t[r]=0,r-i}function z(e){for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n<=127?t++:n<=2047?t+=2:n>=55296&&n<=57343?(t+=4,++r):t+=3}return t}function F(e){C=e,i.HEAP8=E=new Int8Array(e),i.HEAP16=new Int16Array(e),i.HEAP32=I=new Int32Array(e),i.HEAPU8=D=new Uint8Array(e),i.HEAPU16=new Uint16Array(e),i.HEAPU32=k=new Uint32Array(e),i.HEAPF32=new Float32Array(e),i.HEAPF64=M=new Float64Array(e)}i.INITIAL_MEMORY;var N,A=[],H=[],T=[],B=[],L=0,j=null,U=null;function O(e){L++,i.monitorRunDependencies&&i.monitorRunDependencies(L)}function W(e){if(L--,i.monitorRunDependencies&&i.monitorRunDependencies(L),0==L&&(null!==j&&(clearInterval(j),j=null),U)){var t=U;U=null,t()}}function V(e){i.onAbort&&i.onAbort(e),y(e="Aborted("+e+")"),w=!0,b=1,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw n(t),t}var q,K,Y,Q,Z="data:application/octet-stream;base64,";function X(e){return e.startsWith(Z)}function $(e){try{if(e==q&&_)return new Uint8Array(_);if(a)return a(e);throw"both async and sync fetching of the wasm failed"}catch(e){V(e)}}X(q="cloudpilot_web.wasm")||(K=q,q=i.locateFile?i.locateFile(K,m):m+K);var J={418020:e=>{N.grow(65536);for(let t=0;t<=65535;t++)N.set(N.length-65535-1+t,N.get(k[(e>>>2)+t]));return N.length-65535-1}};function ee(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function te(e){for(;e.length>0;)e.shift()(i)}function re(e,t){return t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN}var ne={isAbs:e=>"/"===e.charAt(0),splitPath:e=>/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1),normalizeArray:(e,t)=>{for(var r=0,n=e.length-1;n>=0;n--){var i=e[n];"."===i?e.splice(n,1):".."===i?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r;r--)e.unshift("..");return e},normalize:e=>{var t=ne.isAbs(e),r="/"===e.substr(-1);return(e=ne.normalizeArray(e.split("/").filter((e=>!!e)),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e},dirname:e=>{var t=ne.splitPath(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},basename:e=>{if("/"===e)return"/";var t=(e=(e=ne.normalize(e)).replace(/\/$/,"")).lastIndexOf("/");return-1===t?e:e.substr(t+1)},join:function(){var e=Array.prototype.slice.call(arguments);return ne.normalize(e.join("/"))},join2:(e,t)=>ne.normalize(e+"/"+t)},ie={resolve:function(){for(var e="",t=!1,r=arguments.length-1;r>=-1&&!t;r--){var n=r>=0?arguments[r]:ce.cwd();if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");if(!n)return"";e=n+"/"+e,t=ne.isAbs(n)}return(t?"/":"")+(e=ne.normalizeArray(e.split("/").filter((e=>!!e)),!t).join("/"))||"."},relative:(e,t)=>{function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=ie.resolve(e).substr(1),t=ie.resolve(t).substr(1);for(var n=r(e.split("/")),i=r(t.split("/")),o=Math.min(n.length,i.length),s=o,a=0;a<o;a++)if(n[a]!==i[a]){s=a;break}var u=[];for(a=s;a<n.length;a++)u.push("..");return(u=u.concat(i.slice(s))).join("/")}};function oe(e,t,r){var n=r>0?r:z(e)+1,i=new Array(n),o=R(e,i,0,i.length);return t&&(i.length=o),i}var se={ttys:[],init:function(){},shutdown:function(){},register:function(e,t){se.ttys[e]={input:[],output:[],ops:t},ce.registerDevice(e,se.stream_ops)},stream_ops:{open:function(e){var t=se.ttys[e.node.rdev];if(!t)throw new ce.ErrnoError(43);e.tty=t,e.seekable=!1},close:function(e){e.tty.ops.fsync(e.tty)},fsync:function(e){e.tty.ops.fsync(e.tty)},read:function(e,t,r,n,i){if(!e.tty||!e.tty.ops.get_char)throw new ce.ErrnoError(60);for(var o=0,s=0;s<n;s++){var a;try{a=e.tty.ops.get_char(e.tty)}catch(e){throw new ce.ErrnoError(29)}if(void 0===a&&0===o)throw new ce.ErrnoError(6);if(null==a)break;o++,t[r+s]=a}return o&&(e.node.timestamp=Date.now()),o},write:function(e,t,r,n,i){if(!e.tty||!e.tty.ops.put_char)throw new ce.ErrnoError(60);try{for(var o=0;o<n;o++)e.tty.ops.put_char(e.tty,t[r+o])}catch(e){throw new ce.ErrnoError(29)}return n&&(e.node.timestamp=Date.now()),o}},default_tty_ops:{get_char:function(e){if(!e.input.length){var t=null;if("undefined"!=typeof window&&"function"==typeof window.prompt?null!==(t=window.prompt("Input: "))&&(t+="\n"):"function"==typeof readline&&null!==(t=readline())&&(t+="\n"),!t)return null;e.input=oe(t,!0)}return e.input.shift()},put_char:function(e,t){null===t||10===t?(f(x(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},fsync:function(e){e.output&&e.output.length>0&&(f(x(e.output,0)),e.output=[])}},default_tty1_ops:{put_char:function(e,t){null===t||10===t?(y(x(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},fsync:function(e){e.output&&e.output.length>0&&(y(x(e.output,0)),e.output=[])}}};function ae(e){V()}var ue={ops_table:null,mount:function(e){return ue.createNode(null,"/",16895,0)},createNode:function(e,t,r,n){if(ce.isBlkdev(r)||ce.isFIFO(r))throw new ce.ErrnoError(63);ue.ops_table||(ue.ops_table={dir:{node:{getattr:ue.node_ops.getattr,setattr:ue.node_ops.setattr,lookup:ue.node_ops.lookup,mknod:ue.node_ops.mknod,rename:ue.node_ops.rename,unlink:ue.node_ops.unlink,rmdir:ue.node_ops.rmdir,readdir:ue.node_ops.readdir,symlink:ue.node_ops.symlink},stream:{llseek:ue.stream_ops.llseek}},file:{node:{getattr:ue.node_ops.getattr,setattr:ue.node_ops.setattr},stream:{llseek:ue.stream_ops.llseek,read:ue.stream_ops.read,write:ue.stream_ops.write,allocate:ue.stream_ops.allocate,mmap:ue.stream_ops.mmap,msync:ue.stream_ops.msync}},link:{node:{getattr:ue.node_ops.getattr,setattr:ue.node_ops.setattr,readlink:ue.node_ops.readlink},stream:{}},chrdev:{node:{getattr:ue.node_ops.getattr,setattr:ue.node_ops.setattr},stream:ce.chrdev_stream_ops}});var i=ce.createNode(e,t,r,n);return ce.isDir(i.mode)?(i.node_ops=ue.ops_table.dir.node,i.stream_ops=ue.ops_table.dir.stream,i.contents={}):ce.isFile(i.mode)?(i.node_ops=ue.ops_table.file.node,i.stream_ops=ue.ops_table.file.stream,i.usedBytes=0,i.contents=null):ce.isLink(i.mode)?(i.node_ops=ue.ops_table.link.node,i.stream_ops=ue.ops_table.link.stream):ce.isChrdev(i.mode)&&(i.node_ops=ue.ops_table.chrdev.node,i.stream_ops=ue.ops_table.chrdev.stream),i.timestamp=Date.now(),e&&(e.contents[t]=i,e.timestamp=i.timestamp),i},getFileDataAsTypedArray:function(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0)},expandFileStorage:function(e,t){var r=e.contents?e.contents.length:0;if(!(r>=t)){t=Math.max(t,r*(r<1048576?2:1.125)>>>0),0!=r&&(t=Math.max(t,256));var n=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(n.subarray(0,e.usedBytes),0)}},resizeFileStorage:function(e,t){if(e.usedBytes!=t)if(0==t)e.contents=null,e.usedBytes=0;else{var r=e.contents;e.contents=new Uint8Array(t),r&&e.contents.set(r.subarray(0,Math.min(t,e.usedBytes))),e.usedBytes=t}},node_ops:{getattr:function(e){var t={};return t.dev=ce.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,ce.isDir(e.mode)?t.size=4096:ce.isFile(e.mode)?t.size=e.usedBytes:ce.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr:function(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp),void 0!==t.size&&ue.resizeFileStorage(e,t.size)},lookup:function(e,t){throw ce.genericErrors[44]},mknod:function(e,t,r,n){return ue.createNode(e,t,r,n)},rename:function(e,t,r){if(ce.isDir(e.mode)){var n;try{n=ce.lookupNode(t,r)}catch(e){}if(n)for(var i in n.contents)throw new ce.ErrnoError(55)}delete e.parent.contents[e.name],e.parent.timestamp=Date.now(),e.name=r,t.contents[r]=e,t.timestamp=e.parent.timestamp,e.parent=t},unlink:function(e,t){delete e.contents[t],e.timestamp=Date.now()},rmdir:function(e,t){var r=ce.lookupNode(e,t);for(var n in r.contents)throw new ce.ErrnoError(55);delete e.contents[t],e.timestamp=Date.now()},readdir:function(e){var t=[".",".."];for(var r in e.contents)e.contents.hasOwnProperty(r)&&t.push(r);return t},symlink:function(e,t,r){var n=ue.createNode(e,t,41471,0);return n.link=r,n},readlink:function(e){if(!ce.isLink(e.mode))throw new ce.ErrnoError(28);return e.link}},stream_ops:{read:function(e,t,r,n,i){var o=e.node.contents;if(i>=e.node.usedBytes)return 0;var s=Math.min(e.node.usedBytes-i,n);if(s>8&&o.subarray)t.set(o.subarray(i,i+s),r);else for(var a=0;a<s;a++)t[r+a]=o[i+a];return s},write:function(e,t,r,n,i,o){if(t.buffer===E.buffer&&(o=!1),!n)return 0;var s=e.node;if(s.timestamp=Date.now(),t.subarray&&(!s.contents||s.contents.subarray)){if(o)return s.contents=t.subarray(r,r+n),s.usedBytes=n,n;if(0===s.usedBytes&&0===i)return s.contents=t.slice(r,r+n),s.usedBytes=n,n;if(i+n<=s.usedBytes)return s.contents.set(t.subarray(r,r+n),i),n}if(ue.expandFileStorage(s,i+n),s.contents.subarray&&t.subarray)s.contents.set(t.subarray(r,r+n),i);else for(var a=0;a<n;a++)s.contents[i+a]=t[r+a];return s.usedBytes=Math.max(s.usedBytes,i+n),n},llseek:function(e,t,r){var n=t;if(1===r?n+=e.position:2===r&&ce.isFile(e.node.mode)&&(n+=e.node.usedBytes),n<0)throw new ce.ErrnoError(28);return n},allocate:function(e,t,r){ue.expandFileStorage(e.node,t+r),e.node.usedBytes=Math.max(e.node.usedBytes,t+r)},mmap:function(e,t,r,n,i){if(!ce.isFile(e.node.mode))throw new ce.ErrnoError(43);var o,s,a=e.node.contents;if(2&i||a.buffer!==C){if((r>0||r+t<a.length)&&(a=a.subarray?a.subarray(r,r+t):Array.prototype.slice.call(a,r,r+t)),s=!0,!(o=ae()))throw new ce.ErrnoError(48);E.set(a,o)}else s=!1,o=a.byteOffset;return{ptr:o,allocated:s}},msync:function(e,t,r,n,i){return ue.stream_ops.write(e,t,0,n,r,!1),0}}},ce={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath:(e,t={})=>{if(!(e=ie.resolve(e)))return{path:"",node:null};if((t=Object.assign({follow_mount:!0,recurse_count:0},t)).recurse_count>8)throw new ce.ErrnoError(32);for(var r=e.split("/").filter((e=>!!e)),n=ce.root,i="/",o=0;o<r.length;o++){var s=o===r.length-1;if(s&&t.parent)break;if(n=ce.lookupNode(n,r[o]),i=ne.join2(i,r[o]),ce.isMountpoint(n)&&(!s||s&&t.follow_mount)&&(n=n.mounted.root),!s||t.follow)for(var a=0;ce.isLink(n.mode);){var u=ce.readlink(i);if(i=ie.resolve(ne.dirname(i),u),n=ce.lookupPath(i,{recurse_count:t.recurse_count+1}).node,a++>40)throw new ce.ErrnoError(32)}}return{path:i,node:n}},getPath:e=>{for(var t;;){if(ce.isRoot(e)){var r=e.mount.mountpoint;return t?"/"!==r[r.length-1]?r+"/"+t:r+t:r}t=t?e.name+"/"+t:e.name,e=e.parent}},hashName:(e,t)=>{for(var r=0,n=0;n<t.length;n++)r=(r<<5)-r+t.charCodeAt(n)|0;return(e+r>>>0)%ce.nameTable.length},hashAddNode:e=>{var t=ce.hashName(e.parent.id,e.name);e.name_next=ce.nameTable[t],ce.nameTable[t]=e},hashRemoveNode:e=>{var t=ce.hashName(e.parent.id,e.name);if(ce.nameTable[t]===e)ce.nameTable[t]=e.name_next;else for(var r=ce.nameTable[t];r;){if(r.name_next===e){r.name_next=e.name_next;break}r=r.name_next}},lookupNode:(e,t)=>{var r=ce.mayLookup(e);if(r)throw new ce.ErrnoError(r,e);for(var n=ce.hashName(e.id,t),i=ce.nameTable[n];i;i=i.name_next){var o=i.name;if(i.parent.id===e.id&&o===t)return i}return ce.lookup(e,t)},createNode:(e,t,r,n)=>{var i=new ce.FSNode(e,t,r,n);return ce.hashAddNode(i),i},destroyNode:e=>{ce.hashRemoveNode(e)},isRoot:e=>e===e.parent,isMountpoint:e=>!!e.mounted,isFile:e=>32768==(61440&e),isDir:e=>16384==(61440&e),isLink:e=>40960==(61440&e),isChrdev:e=>8192==(61440&e),isBlkdev:e=>24576==(61440&e),isFIFO:e=>4096==(61440&e),isSocket:e=>49152==(49152&e),flagModes:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},modeStringToFlags:e=>{var t=ce.flagModes[e];if(void 0===t)throw new Error("Unknown file open mode: "+e);return t},flagsToPermissionString:e=>{var t=["r","w","rw"][3&e];return 512&e&&(t+="w"),t},nodePermissions:(e,t)=>ce.ignorePermissions||(!t.includes("r")||292&e.mode)&&(!t.includes("w")||146&e.mode)&&(!t.includes("x")||73&e.mode)?0:2,mayLookup:e=>ce.nodePermissions(e,"x")||(e.node_ops.lookup?0:2),mayCreate:(e,t)=>{try{return ce.lookupNode(e,t),20}catch(e){}return ce.nodePermissions(e,"wx")},mayDelete:(e,t,r)=>{var n;try{n=ce.lookupNode(e,t)}catch(e){return e.errno}var i=ce.nodePermissions(e,"wx");if(i)return i;if(r){if(!ce.isDir(n.mode))return 54;if(ce.isRoot(n)||ce.getPath(n)===ce.cwd())return 10}else if(ce.isDir(n.mode))return 31;return 0},mayOpen:(e,t)=>e?ce.isLink(e.mode)?32:ce.isDir(e.mode)&&("r"!==ce.flagsToPermissionString(t)||512&t)?31:ce.nodePermissions(e,ce.flagsToPermissionString(t)):44,MAX_OPEN_FDS:4096,nextfd:(e=0,t=ce.MAX_OPEN_FDS)=>{for(var r=e;r<=t;r++)if(!ce.streams[r])return r;throw new ce.ErrnoError(33)},getStream:e=>ce.streams[e],createStream:(e,t,r)=>{ce.FSStream||(ce.FSStream=function(){this.shared={}},ce.FSStream.prototype={},Object.defineProperties(ce.FSStream.prototype,{object:{get:function(){return this.node},set:function(e){this.node=e}},isRead:{get:function(){return 1!=(2097155&this.flags)}},isWrite:{get:function(){return 0!=(2097155&this.flags)}},isAppend:{get:function(){return 1024&this.flags}},flags:{get:function(){return this.shared.flags},set:function(e){this.shared.flags=e}},position:{get:function(){return this.shared.position},set:function(e){this.shared.position=e}}})),e=Object.assign(new ce.FSStream,e);var n=ce.nextfd(t,r);return e.fd=n,ce.streams[n]=e,e},closeStream:e=>{ce.streams[e]=null},chrdev_stream_ops:{open:e=>{var t=ce.getDevice(e.node.rdev);e.stream_ops=t.stream_ops,e.stream_ops.open&&e.stream_ops.open(e)},llseek:()=>{throw new ce.ErrnoError(70)}},major:e=>e>>8,minor:e=>255&e,makedev:(e,t)=>e<<8|t,registerDevice:(e,t)=>{ce.devices[e]={stream_ops:t}},getDevice:e=>ce.devices[e],getMounts:e=>{for(var t=[],r=[e];r.length;){var n=r.pop();t.push(n),r.push.apply(r,n.mounts)}return t},syncfs:(e,t)=>{"function"==typeof e&&(t=e,e=!1),ce.syncFSRequests++,ce.syncFSRequests>1&&y("warning: "+ce.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var r=ce.getMounts(ce.root.mount),n=0;function i(e){return ce.syncFSRequests--,t(e)}function o(e){if(e)return o.errored?void 0:(o.errored=!0,i(e));++n>=r.length&&i(null)}r.forEach((t=>{if(!t.type.syncfs)return o(null);t.type.syncfs(t,e,o)}))},mount:(e,t,r)=>{var n,i="/"===r,o=!r;if(i&&ce.root)throw new ce.ErrnoError(10);if(!i&&!o){var s=ce.lookupPath(r,{follow_mount:!1});if(r=s.path,n=s.node,ce.isMountpoint(n))throw new ce.ErrnoError(10);if(!ce.isDir(n.mode))throw new ce.ErrnoError(54)}var a={type:e,opts:t,mountpoint:r,mounts:[]},u=e.mount(a);return u.mount=a,a.root=u,i?ce.root=u:n&&(n.mounted=a,n.mount&&n.mount.mounts.push(a)),u},unmount:e=>{var t=ce.lookupPath(e,{follow_mount:!1});if(!ce.isMountpoint(t.node))throw new ce.ErrnoError(28);var r=t.node,n=r.mounted,i=ce.getMounts(n);Object.keys(ce.nameTable).forEach((e=>{for(var t=ce.nameTable[e];t;){var r=t.name_next;i.includes(t.mount)&&ce.destroyNode(t),t=r}})),r.mounted=null;var o=r.mount.mounts.indexOf(n);r.mount.mounts.splice(o,1)},lookup:(e,t)=>e.node_ops.lookup(e,t),mknod:(e,t,r)=>{var n=ce.lookupPath(e,{parent:!0}).node,i=ne.basename(e);if(!i||"."===i||".."===i)throw new ce.ErrnoError(28);var o=ce.mayCreate(n,i);if(o)throw new ce.ErrnoError(o);if(!n.node_ops.mknod)throw new ce.ErrnoError(63);return n.node_ops.mknod(n,i,t,r)},create:(e,t)=>(t=void 0!==t?t:438,t&=4095,t|=32768,ce.mknod(e,t,0)),mkdir:(e,t)=>(t=void 0!==t?t:511,t&=1023,t|=16384,ce.mknod(e,t,0)),mkdirTree:(e,t)=>{for(var r=e.split("/"),n="",i=0;i<r.length;++i)if(r[i]){n+="/"+r[i];try{ce.mkdir(n,t)}catch(e){if(20!=e.errno)throw e}}},mkdev:(e,t,r)=>(void 0===r&&(r=t,t=438),t|=8192,ce.mknod(e,t,r)),symlink:(e,t)=>{if(!ie.resolve(e))throw new ce.ErrnoError(44);var r=ce.lookupPath(t,{parent:!0}).node;if(!r)throw new ce.ErrnoError(44);var n=ne.basename(t),i=ce.mayCreate(r,n);if(i)throw new ce.ErrnoError(i);if(!r.node_ops.symlink)throw new ce.ErrnoError(63);return r.node_ops.symlink(r,n,e)},rename:(e,t)=>{var r,n,i=ne.dirname(e),o=ne.dirname(t),s=ne.basename(e),a=ne.basename(t);if(r=ce.lookupPath(e,{parent:!0}).node,n=ce.lookupPath(t,{parent:!0}).node,!r||!n)throw new ce.ErrnoError(44);if(r.mount!==n.mount)throw new ce.ErrnoError(75);var u,c=ce.lookupNode(r,s),p=ie.relative(e,o);if("."!==p.charAt(0))throw new ce.ErrnoError(28);if("."!==(p=ie.relative(t,i)).charAt(0))throw new ce.ErrnoError(55);try{u=ce.lookupNode(n,a)}catch(e){}if(c!==u){var l=ce.isDir(c.mode),d=ce.mayDelete(r,s,l);if(d)throw new ce.ErrnoError(d);if(d=u?ce.mayDelete(n,a,l):ce.mayCreate(n,a))throw new ce.ErrnoError(d);if(!r.node_ops.rename)throw new ce.ErrnoError(63);if(ce.isMountpoint(c)||u&&ce.isMountpoint(u))throw new ce.ErrnoError(10);if(n!==r&&(d=ce.nodePermissions(r,"w")))throw new ce.ErrnoError(d);ce.hashRemoveNode(c);try{r.node_ops.rename(c,n,a)}catch(e){throw e}finally{ce.hashAddNode(c)}}},rmdir:e=>{var t=ce.lookupPath(e,{parent:!0}).node,r=ne.basename(e),n=ce.lookupNode(t,r),i=ce.mayDelete(t,r,!0);if(i)throw new ce.ErrnoError(i);if(!t.node_ops.rmdir)throw new ce.ErrnoError(63);if(ce.isMountpoint(n))throw new ce.ErrnoError(10);t.node_ops.rmdir(t,r),ce.destroyNode(n)},readdir:e=>{var t=ce.lookupPath(e,{follow:!0}).node;if(!t.node_ops.readdir)throw new ce.ErrnoError(54);return t.node_ops.readdir(t)},unlink:e=>{var t=ce.lookupPath(e,{parent:!0}).node;if(!t)throw new ce.ErrnoError(44);var r=ne.basename(e),n=ce.lookupNode(t,r),i=ce.mayDelete(t,r,!1);if(i)throw new ce.ErrnoError(i);if(!t.node_ops.unlink)throw new ce.ErrnoError(63);if(ce.isMountpoint(n))throw new ce.ErrnoError(10);t.node_ops.unlink(t,r),ce.destroyNode(n)},readlink:e=>{var t=ce.lookupPath(e).node;if(!t)throw new ce.ErrnoError(44);if(!t.node_ops.readlink)throw new ce.ErrnoError(28);return ie.resolve(ce.getPath(t.parent),t.node_ops.readlink(t))},stat:(e,t)=>{var r=ce.lookupPath(e,{follow:!t}).node;if(!r)throw new ce.ErrnoError(44);if(!r.node_ops.getattr)throw new ce.ErrnoError(63);return r.node_ops.getattr(r)},lstat:e=>ce.stat(e,!0),chmod:(e,t,r)=>{var n;if(!(n="string"==typeof e?ce.lookupPath(e,{follow:!r}).node:e).node_ops.setattr)throw new ce.ErrnoError(63);n.node_ops.setattr(n,{mode:4095&t|-4096&n.mode,timestamp:Date.now()})},lchmod:(e,t)=>{ce.chmod(e,t,!0)},fchmod:(e,t)=>{var r=ce.getStream(e);if(!r)throw new ce.ErrnoError(8);ce.chmod(r.node,t)},chown:(e,t,r,n)=>{var i;if(!(i="string"==typeof e?ce.lookupPath(e,{follow:!n}).node:e).node_ops.setattr)throw new ce.ErrnoError(63);i.node_ops.setattr(i,{timestamp:Date.now()})},lchown:(e,t,r)=>{ce.chown(e,t,r,!0)},fchown:(e,t,r)=>{var n=ce.getStream(e);if(!n)throw new ce.ErrnoError(8);ce.chown(n.node,t,r)},truncate:(e,t)=>{if(t<0)throw new ce.ErrnoError(28);var r;if(!(r="string"==typeof e?ce.lookupPath(e,{follow:!0}).node:e).node_ops.setattr)throw new ce.ErrnoError(63);if(ce.isDir(r.mode))throw new ce.ErrnoError(31);if(!ce.isFile(r.mode))throw new ce.ErrnoError(28);var n=ce.nodePermissions(r,"w");if(n)throw new ce.ErrnoError(n);r.node_ops.setattr(r,{size:t,timestamp:Date.now()})},ftruncate:(e,t)=>{var r=ce.getStream(e);if(!r)throw new ce.ErrnoError(8);if(0==(2097155&r.flags))throw new ce.ErrnoError(28);ce.truncate(r.node,t)},utime:(e,t,r)=>{var n=ce.lookupPath(e,{follow:!0}).node;n.node_ops.setattr(n,{timestamp:Math.max(t,r)})},open:(e,t,r)=>{if(""===e)throw new ce.ErrnoError(44);var n;if(r=void 0===r?438:r,r=64&(t="string"==typeof t?ce.modeStringToFlags(t):t)?4095&r|32768:0,"object"==typeof e)n=e;else{e=ne.normalize(e);try{n=ce.lookupPath(e,{follow:!(131072&t)}).node}catch(e){}}var o=!1;if(64&t)if(n){if(128&t)throw new ce.ErrnoError(20)}else n=ce.mknod(e,r,0),o=!0;if(!n)throw new ce.ErrnoError(44);if(ce.isChrdev(n.mode)&&(t&=-513),65536&t&&!ce.isDir(n.mode))throw new ce.ErrnoError(54);if(!o){var s=ce.mayOpen(n,t);if(s)throw new ce.ErrnoError(s)}512&t&&!o&&ce.truncate(n,0),t&=-131713;var a=ce.createStream({node:n,path:ce.getPath(n),flags:t,seekable:!0,position:0,stream_ops:n.stream_ops,ungotten:[],error:!1});return a.stream_ops.open&&a.stream_ops.open(a),!i.logReadFiles||1&t||(ce.readFiles||(ce.readFiles={}),e in ce.readFiles||(ce.readFiles[e]=1)),a},close:e=>{if(ce.isClosed(e))throw new ce.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(e){throw e}finally{ce.closeStream(e.fd)}e.fd=null},isClosed:e=>null===e.fd,llseek:(e,t,r)=>{if(ce.isClosed(e))throw new ce.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new ce.ErrnoError(70);if(0!=r&&1!=r&&2!=r)throw new ce.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,r),e.ungotten=[],e.position},read:(e,t,r,n,i)=>{if(n<0||i<0)throw new ce.ErrnoError(28);if(ce.isClosed(e))throw new ce.ErrnoError(8);if(1==(2097155&e.flags))throw new ce.ErrnoError(8);if(ce.isDir(e.node.mode))throw new ce.ErrnoError(31);if(!e.stream_ops.read)throw new ce.ErrnoError(28);var o=void 0!==i;if(o){if(!e.seekable)throw new ce.ErrnoError(70)}else i=e.position;var s=e.stream_ops.read(e,t,r,n,i);return o||(e.position+=s),s},write:(e,t,r,n,i,o)=>{if(n<0||i<0)throw new ce.ErrnoError(28);if(ce.isClosed(e))throw new ce.ErrnoError(8);if(0==(2097155&e.flags))throw new ce.ErrnoError(8);if(ce.isDir(e.node.mode))throw new ce.ErrnoError(31);if(!e.stream_ops.write)throw new ce.ErrnoError(28);e.seekable&&1024&e.flags&&ce.llseek(e,0,2);var s=void 0!==i;if(s){if(!e.seekable)throw new ce.ErrnoError(70)}else i=e.position;var a=e.stream_ops.write(e,t,r,n,i,o);return s||(e.position+=a),a},allocate:(e,t,r)=>{if(ce.isClosed(e))throw new ce.ErrnoError(8);if(t<0||r<=0)throw new ce.ErrnoError(28);if(0==(2097155&e.flags))throw new ce.ErrnoError(8);if(!ce.isFile(e.node.mode)&&!ce.isDir(e.node.mode))throw new ce.ErrnoError(43);if(!e.stream_ops.allocate)throw new ce.ErrnoError(138);e.stream_ops.allocate(e,t,r)},mmap:(e,t,r,n,i)=>{if(0!=(2&n)&&0==(2&i)&&2!=(2097155&e.flags))throw new ce.ErrnoError(2);if(1==(2097155&e.flags))throw new ce.ErrnoError(2);if(!e.stream_ops.mmap)throw new ce.ErrnoError(43);return e.stream_ops.mmap(e,t,r,n,i)},msync:(e,t,r,n,i)=>e.stream_ops.msync?e.stream_ops.msync(e,t,r,n,i):0,munmap:e=>0,ioctl:(e,t,r)=>{if(!e.stream_ops.ioctl)throw new ce.ErrnoError(59);return e.stream_ops.ioctl(e,t,r)},readFile:(e,t={})=>{if(t.flags=t.flags||0,t.encoding=t.encoding||"binary","utf8"!==t.encoding&&"binary"!==t.encoding)throw new Error('Invalid encoding type "'+t.encoding+'"');var r,n=ce.open(e,t.flags),i=ce.stat(e).size,o=new Uint8Array(i);return ce.read(n,o,0,i,0),"utf8"===t.encoding?r=x(o,0):"binary"===t.encoding&&(r=o),ce.close(n),r},writeFile:(e,t,r={})=>{r.flags=r.flags||577;var n=ce.open(e,r.flags,r.mode);if("string"==typeof t){var i=new Uint8Array(z(t)+1),o=R(t,i,0,i.length);ce.write(n,i,0,o,void 0,r.canOwn)}else{if(!ArrayBuffer.isView(t))throw new Error("Unsupported data type");ce.write(n,t,0,t.byteLength,void 0,r.canOwn)}ce.close(n)},cwd:()=>ce.currentPath,chdir:e=>{var t=ce.lookupPath(e,{follow:!0});if(null===t.node)throw new ce.ErrnoError(44);if(!ce.isDir(t.node.mode))throw new ce.ErrnoError(54);var r=ce.nodePermissions(t.node,"x");if(r)throw new ce.ErrnoError(r);ce.currentPath=t.path},createDefaultDirectories:()=>{ce.mkdir("/tmp"),ce.mkdir("/home"),ce.mkdir("/home/web_user")},createDefaultDevices:()=>{ce.mkdir("/dev"),ce.registerDevice(ce.makedev(1,3),{read:()=>0,write:(e,t,r,n,i)=>n}),ce.mkdev("/dev/null",ce.makedev(1,3)),se.register(ce.makedev(5,0),se.default_tty_ops),se.register(ce.makedev(6,0),se.default_tty1_ops),ce.mkdev("/dev/tty",ce.makedev(5,0)),ce.mkdev("/dev/tty1",ce.makedev(6,0));var e=function(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var e=new Uint8Array(1);return()=>(crypto.getRandomValues(e),e[0])}return()=>V("randomDevice")}();ce.createDevice("/dev","random",e),ce.createDevice("/dev","urandom",e),ce.mkdir("/dev/shm"),ce.mkdir("/dev/shm/tmp")},createSpecialDirectories:()=>{ce.mkdir("/proc");var e=ce.mkdir("/proc/self");ce.mkdir("/proc/self/fd"),ce.mount({mount:()=>{var t=ce.createNode(e,"fd",16895,73);return t.node_ops={lookup:(e,t)=>{var r=+t,n=ce.getStream(r);if(!n)throw new ce.ErrnoError(8);var i={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>n.path}};return i.parent=i,i}},t}},{},"/proc/self/fd")},createStandardStreams:()=>{i.stdin?ce.createDevice("/dev","stdin",i.stdin):ce.symlink("/dev/tty","/dev/stdin"),i.stdout?ce.createDevice("/dev","stdout",null,i.stdout):ce.symlink("/dev/tty","/dev/stdout"),i.stderr?ce.createDevice("/dev","stderr",null,i.stderr):ce.symlink("/dev/tty1","/dev/stderr"),ce.open("/dev/stdin",0),ce.open("/dev/stdout",1),ce.open("/dev/stderr",1)},ensureErrnoError:()=>{ce.ErrnoError||(ce.ErrnoError=function(e,t){this.node=t,this.setErrno=function(e){this.errno=e},this.setErrno(e),this.message="FS error"},ce.ErrnoError.prototype=new Error,ce.ErrnoError.prototype.constructor=ce.ErrnoError,[44].forEach((e=>{ce.genericErrors[e]=new ce.ErrnoError(e),ce.genericErrors[e].stack="<generic error, no stack>"})))},staticInit:()=>{ce.ensureErrnoError(),ce.nameTable=new Array(4096),ce.mount(ue,{},"/"),ce.createDefaultDirectories(),ce.createDefaultDevices(),ce.createSpecialDirectories(),ce.filesystems={MEMFS:ue}},init:(e,t,r)=>{ce.init.initialized=!0,ce.ensureErrnoError(),i.stdin=e||i.stdin,i.stdout=t||i.stdout,i.stderr=r||i.stderr,ce.createStandardStreams()},quit:()=>{ce.init.initialized=!1;for(var e=0;e<ce.streams.length;e++){var t=ce.streams[e];t&&ce.close(t)}},getMode:(e,t)=>{var r=0;return e&&(r|=365),t&&(r|=146),r},findObject:(e,t)=>{var r=ce.analyzePath(e,t);return r.exists?r.object:null},analyzePath:(e,t)=>{try{e=(n=ce.lookupPath(e,{follow:!t})).path}catch(e){}var r={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var n=ce.lookupPath(e,{parent:!0});r.parentExists=!0,r.parentPath=n.path,r.parentObject=n.node,r.name=ne.basename(e),n=ce.lookupPath(e,{follow:!t}),r.exists=!0,r.path=n.path,r.object=n.node,r.name=n.node.name,r.isRoot="/"===n.path}catch(e){r.error=e.errno}return r},createPath:(e,t,r,n)=>{e="string"==typeof e?e:ce.getPath(e);for(var i=t.split("/").reverse();i.length;){var o=i.pop();if(o){var s=ne.join2(e,o);try{ce.mkdir(s)}catch(e){}e=s}}return s},createFile:(e,t,r,n,i)=>{var o=ne.join2("string"==typeof e?e:ce.getPath(e),t),s=ce.getMode(n,i);return ce.create(o,s)},createDataFile:(e,t,r,n,i,o)=>{var s=t;e&&(e="string"==typeof e?e:ce.getPath(e),s=t?ne.join2(e,t):e);var a=ce.getMode(n,i),u=ce.create(s,a);if(r){if("string"==typeof r){for(var c=new Array(r.length),p=0,l=r.length;p<l;++p)c[p]=r.charCodeAt(p);r=c}ce.chmod(u,146|a);var d=ce.open(u,577);ce.write(d,r,0,r.length,0,o),ce.close(d),ce.chmod(u,a)}return u},createDevice:(e,t,r,n)=>{var i=ne.join2("string"==typeof e?e:ce.getPath(e),t),o=ce.getMode(!!r,!!n);ce.createDevice.major||(ce.createDevice.major=64);var s=ce.makedev(ce.createDevice.major++,0);return ce.registerDevice(s,{open:e=>{e.seekable=!1},close:e=>{n&&n.buffer&&n.buffer.length&&n(10)},read:(e,t,n,i,o)=>{for(var s=0,a=0;a<i;a++){var u;try{u=r()}catch(e){throw new ce.ErrnoError(29)}if(void 0===u&&0===s)throw new ce.ErrnoError(6);if(null==u)break;s++,t[n+a]=u}return s&&(e.node.timestamp=Date.now()),s},write:(e,t,r,i,o)=>{for(var s=0;s<i;s++)try{n(t[r+s])}catch(e){throw new ce.ErrnoError(29)}return i&&(e.node.timestamp=Date.now()),s}}),ce.mkdev(i,o,s)},forceLoadFile:e=>{if(e.isDevice||e.isFolder||e.link||e.contents)return!0;if("undefined"!=typeof XMLHttpRequest)throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(!o)throw new Error("Cannot load without read() or XMLHttpRequest.");try{e.contents=oe(o(e.url),!0),e.usedBytes=e.contents.length}catch(e){throw new ce.ErrnoError(29)}},createLazyFile:(e,t,r,n,i)=>{function o(){this.lengthKnown=!1,this.chunks=[]}if(o.prototype.get=function(e){if(!(e>this.length-1||e<0)){var t=e%this.chunkSize,r=e/this.chunkSize|0;return this.getter(r)[t]}},o.prototype.setDataGetter=function(e){this.getter=e},o.prototype.cacheLength=function(){var e=new XMLHttpRequest;if(e.open("HEAD",r,!1),e.send(null),!(e.status>=200&&e.status<300||304===e.status))throw new Error("Couldn't load "+r+". Status: "+e.status);var t,n=Number(e.getResponseHeader("Content-length")),i=(t=e.getResponseHeader("Accept-Ranges"))&&"bytes"===t,o=(t=e.getResponseHeader("Content-Encoding"))&&"gzip"===t,s=1048576;i||(s=n);var a=this;a.setDataGetter((e=>{var t=e*s,i=(e+1)*s-1;if(i=Math.min(i,n-1),void 0===a.chunks[e]&&(a.chunks[e]=((e,t)=>{if(e>t)throw new Error("invalid range ("+e+", "+t+") or no bytes requested!");if(t>n-1)throw new Error("only "+n+" bytes available! programmer error!");var i=new XMLHttpRequest;if(i.open("GET",r,!1),n!==s&&i.setRequestHeader("Range","bytes="+e+"-"+t),i.responseType="arraybuffer",i.overrideMimeType&&i.overrideMimeType("text/plain; charset=x-user-defined"),i.send(null),!(i.status>=200&&i.status<300||304===i.status))throw new Error("Couldn't load "+r+". Status: "+i.status);return void 0!==i.response?new Uint8Array(i.response||[]):oe(i.responseText||"",!0)})(t,i)),void 0===a.chunks[e])throw new Error("doXHR failed!");return a.chunks[e]})),!o&&n||(s=n=1,n=this.getter(0).length,s=n,f("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=n,this._chunkSize=s,this.lengthKnown=!0},"undefined"!=typeof XMLHttpRequest){if(!h)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var s=new o;Object.defineProperties(s,{length:{get:function(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});var a={isDevice:!1,contents:s}}else a={isDevice:!1,url:r};var u=ce.createFile(e,t,a,n,i);a.contents?u.contents=a.contents:a.url&&(u.contents=null,u.url=a.url),Object.defineProperties(u,{usedBytes:{get:function(){return this.contents.length}}});var c={};function p(e,t,r,n,i){var o=e.node.contents;if(i>=o.length)return 0;var s=Math.min(o.length-i,n);if(o.slice)for(var a=0;a<s;a++)t[r+a]=o[i+a];else for(a=0;a<s;a++)t[r+a]=o.get(i+a);return s}return Object.keys(u.stream_ops).forEach((e=>{var t=u.stream_ops[e];c[e]=function(){return ce.forceLoadFile(u),t.apply(null,arguments)}})),c.read=(e,t,r,n,i)=>(ce.forceLoadFile(u),p(e,t,r,n,i)),c.mmap=(e,t,r,n,i)=>{ce.forceLoadFile(u);var o=ae();if(!o)throw new ce.ErrnoError(48);return p(e,E,o,t,r),{ptr:o,allocated:!0}},u.stream_ops=c,u},createPreloadedFile:(e,t,r,n,i,o,a,u,c,p)=>{var l=t?ie.resolve(ne.join2(e,t)):e;function d(r){function s(r){p&&p(),u||ce.createDataFile(e,t,r,n,i,c),o&&o(),W()}Browser.handledByPreloadPlugin(r,l,s,(()=>{a&&a(),W()}))||s(r)}O(),"string"==typeof r?function(e,t,r,n){var i="al "+e;s(e,(t=>{S(t,'Loading data file "'+e+'" failed (no arrayBuffer).'),d(new Uint8Array(t)),i&&W()}),(t=>{if(!r)throw'Loading data file "'+e+'" failed.';r()})),i&&O()}(r,0,a):d(r)},indexedDB:()=>window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,DB_NAME:()=>"EM_FS_"+window.location.pathname,DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:(e,t,r)=>{t=t||(()=>{}),r=r||(()=>{});var n=ce.indexedDB();try{var i=n.open(ce.DB_NAME(),ce.DB_VERSION)}catch(e){return r(e)}i.onupgradeneeded=()=>{f("creating db"),i.result.createObjectStore(ce.DB_STORE_NAME)},i.onsuccess=()=>{var n=i.result.transaction([ce.DB_STORE_NAME],"readwrite"),o=n.objectStore(ce.DB_STORE_NAME),s=0,a=0,u=e.length;function c(){0==a?t():r()}e.forEach((e=>{var t=o.put(ce.analyzePath(e).object.contents,e);t.onsuccess=()=>{++s+a==u&&c()},t.onerror=()=>{a++,s+a==u&&c()}})),n.onerror=r},i.onerror=r},loadFilesFromDB:(e,t,r)=>{t=t||(()=>{}),r=r||(()=>{});var n=ce.indexedDB();try{var i=n.open(ce.DB_NAME(),ce.DB_VERSION)}catch(e){return r(e)}i.onupgradeneeded=r,i.onsuccess=()=>{var n=i.result;try{var o=n.transaction([ce.DB_STORE_NAME],"readonly")}catch(e){return void r(e)}var s=o.objectStore(ce.DB_STORE_NAME),a=0,u=0,c=e.length;function p(){0==u?t():r()}e.forEach((e=>{var t=s.get(e);t.onsuccess=()=>{ce.analyzePath(e).exists&&ce.unlink(e),ce.createDataFile(ne.dirname(e),ne.basename(e),t.result,!0,!0,!0),++a+u==c&&p()},t.onerror=()=>{u++,a+u==c&&p()}})),o.onerror=r},i.onerror=r}},pe={DEFAULT_POLLMASK:5,calculateAt:function(e,t,r){if(ne.isAbs(t))return t;var n;if(n=-100===e?ce.cwd():pe.getStreamFromFD(e).path,0==t.length){if(!r)throw new ce.ErrnoError(44);return n}return ne.join2(n,t)},doStat:function(e,t,r){try{var n=e(t)}catch(e){if(e&&e.node&&ne.normalize(t)!==ne.normalize(ce.getPath(e.node)))return-54;throw e}return I[r>>2]=n.dev,I[r+8>>2]=n.ino,I[r+12>>2]=n.mode,k[r+16>>2]=n.nlink,I[r+20>>2]=n.uid,I[r+24>>2]=n.gid,I[r+28>>2]=n.rdev,Q=[n.size>>>0,(Y=n.size,+Math.abs(Y)>=1?Y>0?(0|Math.min(+Math.floor(Y/4294967296),4294967295))>>>0:~~+Math.ceil((Y-+(~~Y>>>0))/4294967296)>>>0:0)],I[r+40>>2]=Q[0],I[r+44>>2]=Q[1],I[r+48>>2]=4096,I[r+52>>2]=n.blocks,Q=[Math.floor(n.atime.getTime()/1e3)>>>0,(Y=Math.floor(n.atime.getTime()/1e3),+Math.abs(Y)>=1?Y>0?(0|Math.min(+Math.floor(Y/4294967296),4294967295))>>>0:~~+Math.ceil((Y-+(~~Y>>>0))/4294967296)>>>0:0)],I[r+56>>2]=Q[0],I[r+60>>2]=Q[1],k[r+64>>2]=0,Q=[Math.floor(n.mtime.getTime()/1e3)>>>0,(Y=Math.floor(n.mtime.getTime()/1e3),+Math.abs(Y)>=1?Y>0?(0|Math.min(+Math.floor(Y/4294967296),4294967295))>>>0:~~+Math.ceil((Y-+(~~Y>>>0))/4294967296)>>>0:0)],I[r+72>>2]=Q[0],I[r+76>>2]=Q[1],k[r+80>>2]=0,Q=[Math.floor(n.ctime.getTime()/1e3)>>>0,(Y=Math.floor(n.ctime.getTime()/1e3),+Math.abs(Y)>=1?Y>0?(0|Math.min(+Math.floor(Y/4294967296),4294967295))>>>0:~~+Math.ceil((Y-+(~~Y>>>0))/4294967296)>>>0:0)],I[r+88>>2]=Q[0],I[r+92>>2]=Q[1],k[r+96>>2]=0,Q=[n.ino>>>0,(Y=n.ino,+Math.abs(Y)>=1?Y>0?(0|Math.min(+Math.floor(Y/4294967296),4294967295))>>>0:~~+Math.ceil((Y-+(~~Y>>>0))/4294967296)>>>0:0)],I[r+104>>2]=Q[0],I[r+108>>2]=Q[1],0},doMsync:function(e,t,r,n,i){if(!ce.isFile(t.node.mode))throw new ce.ErrnoError(43);if(2&n)return 0;var o=D.slice(e,e+r);ce.msync(t,o,i,r,n)},varargs:void 0,get:function(){return pe.varargs+=4,I[pe.varargs-4>>2]},getStr:function(e){return P(e)},getStreamFromFD:function(e){var t=ce.getStream(e);if(!t)throw new ce.ErrnoError(8);return t}};function le(e){return e%4==0&&(e%100!=0||e%400==0)}var de=[0,31,60,91,121,152,182,213,244,274,305,335],he=[0,31,59,90,120,151,181,212,243,273,304,334];function me(e){return(le(e.getFullYear())?de:he)[e.getMonth()]+e.getDate()-1}function _e(e){var t=z(e)+1,r=xe(t);return r&&R(e,E,r,t),r}var fe=[];function ye(e){try{return v.grow(e-C.byteLength+65535>>>16),F(v.buffer),1}catch(e){}}var ve={};function ge(){if(!ge.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:p||"./this.program"};for(var t in ve)void 0===ve[t]?delete e[t]:e[t]=ve[t];var r=[];for(var t in e)r.push(t+"="+e[t]);ge.strings=r}return ge.strings}var be=[31,29,31,30,31,30,31,31,30,31,30,31],we=[31,28,31,30,31,30,31,31,30,31,30,31];function Se(e,t){e<128?t.push(e):t.push(e%128|128,e>>7)}var Ce=[],Ee=void 0,De=[];function Ie(e,t){N.set(e,t),Ce[e]=N.get(e)}var ke=function(e,t,r,n){e||(e=this),this.parent=e,this.mount=e.mount,this.mounted=null,this.id=ce.nextInode++,this.name=t,this.mode=r,this.node_ops={},this.stream_ops={},this.rdev=n};Object.defineProperties(ke.prototype,{read:{get:function(){return 365==(365&this.mode)},set:function(e){e?this.mode|=365:this.mode&=-366}},write:{get:function(){return 146==(146&this.mode)},set:function(e){e?this.mode|=146:this.mode&=-147}},isFolder:{get:function(){return ce.isDir(this.mode)}},isDevice:{get:function(){return ce.isChrdev(this.mode)}}}),ce.FSNode=ke,ce.staticInit();var Me,Ge={b:function(e,t,r,n){V("Assertion failed: "+P(e)+", at: "+[t?P(t):"unknown filename",r,n?P(n):"unknown function"])},i:function(e){const t=new Error(P(e));throw t.isAssert=!0,t},k:function(e,t,r){try{var n=re(t,r);return isNaN(n)?-61:(ce.ftruncate(e,n),0)}catch(e){if(void 0===ce||!(e instanceof ce.ErrnoError))throw e;return-e.errno}},e:function(){return true},f:function(e,t){var r,n=new Date(1e3*(k[(r=e)>>2]+4294967296*I[r+4>>2]));I[t>>2]=n.getSeconds(),I[t+4>>2]=n.getMinutes(),I[t+8>>2]=n.getHours(),I[t+12>>2]=n.getDate(),I[t+16>>2]=n.getMonth(),I[t+20>>2]=n.getFullYear()-1900,I[t+24>>2]=n.getDay();var i=0|me(n);I[t+28>>2]=i,I[t+36>>2]=-60*n.getTimezoneOffset();var o=new Date(n.getFullYear(),0,1),s=new Date(n.getFullYear(),6,1).getTimezoneOffset(),a=o.getTimezoneOffset(),u=0|(s!=a&&n.getTimezoneOffset()==Math.min(a,s));I[t+32>>2]=u},g:function(e){var t=new Date(I[e+20>>2]+1900,I[e+16>>2],I[e+12>>2],I[e+8>>2],I[e+4>>2],I[e>>2],0),r=I[e+32>>2],n=t.getTimezoneOffset(),i=new Date(t.getFullYear(),0,1),o=new Date(t.getFullYear(),6,1).getTimezoneOffset(),s=i.getTimezoneOffset(),a=Math.min(s,o);if(r<0)I[e+32>>2]=Number(o!=s&&a==n);else if(r>0!=(a==n)){var u=Math.max(s,o),c=r>0?a:u;t.setTime(t.getTime()+6e4*(c-n))}I[e+24>>2]=t.getDay();var p=0|me(t);return I[e+28>>2]=p,I[e>>2]=t.getSeconds(),I[e+4>>2]=t.getMinutes(),I[e+8>>2]=t.getHours(),I[e+12>>2]=t.getDate(),I[e+16>>2]=t.getMonth(),I[e+20>>2]=t.getYear(),t.getTime()/1e3|0},h:function(e,t,r){var n=(new Date).getFullYear(),i=new Date(n,0,1),o=new Date(n,6,1),s=i.getTimezoneOffset(),a=o.getTimezoneOffset(),u=Math.max(s,a);function c(e){var t=e.toTimeString().match(/\(([A-Za-z ]+)\)$/);return t?t[1]:"GMT"}k[e>>2]=60*u,I[t>>2]=Number(s!=a);var p=c(i),l=c(o),d=_e(p),h=_e(l);a<s?(k[r>>2]=d,k[r+4>>2]=h):(k[r>>2]=h,k[r+4>>2]=d)},a:function(){V("")},s:function(e,t,r){var n=function(e,t){var r;for(fe.length=0,t>>=2;r=D[e++];)t+=105!=r&t,fe.push(105==r?I[t]:M[t++>>1]),++t;return fe}(t,r);return J[e].apply(null,n)},c:function(){return Date.now()},p:function(e,t,r){D.copyWithin(e,t,t+r)},o:function(e){var t,r=D.length,n=2147483648;if((e>>>=0)>n)return!1;for(var i=1;i<=4;i*=2){var o=r*(1+.2/i);if(o=Math.min(o,e+100663296),ye(Math.min(n,(t=Math.max(e,o))+(65536-t%65536)%65536)))return!0}return!1},m:function(e,t){var r=0;return ge().forEach((function(n,i){var o=t+r;k[e+4*i>>2]=o,function(e,t,r){for(var n=0;n<e.length;++n)E[t++>>0]=e.charCodeAt(n);E[t>>0]=0}(n,o),r+=n.length+1})),0},n:function(e,t){var r=ge();k[e>>2]=r.length;var n=0;return r.forEach((function(e){n+=e.length+1})),k[t>>2]=n,0},q:function(e){try{var t=pe.getStreamFromFD(e);return ce.close(t),0}catch(e){if(void 0===ce||!(e instanceof ce.ErrnoError))throw e;return e.errno}},d:function(e,t,r,n){try{var i=function(e,t,r,n){for(var i=0,o=0;o<r;o++){var s=k[t>>2],a=k[t+4>>2];t+=8;var u=ce.read(e,E,s,a,undefined);if(u<0)return-1;if(i+=u,u<a)break}return i}(pe.getStreamFromFD(e),t,r);return k[n>>2]=i,0}catch(e){if(void 0===ce||!(e instanceof ce.ErrnoError))throw e;return e.errno}},j:function(e,t,r,n,i){try{var o=re(t,r);if(isNaN(o))return 61;var s=pe.getStreamFromFD(e);return ce.llseek(s,o,n),Q=[s.position>>>0,(Y=s.position,+Math.abs(Y)>=1?Y>0?(0|Math.min(+Math.floor(Y/4294967296),4294967295))>>>0:~~+Math.ceil((Y-+(~~Y>>>0))/4294967296)>>>0:0)],I[i>>2]=Q[0],I[i+4>>2]=Q[1],s.getdents&&0===o&&0===n&&(s.getdents=null),0}catch(e){if(void 0===ce||!(e instanceof ce.ErrnoError))throw e;return e.errno}},r:function(e,t,r,n){try{var i=function(e,t,r,n){for(var i=0,o=0;o<r;o++){var s=k[t>>2],a=k[t+4>>2];t+=8;var u=ce.write(e,E,s,a,undefined);if(u<0)return-1;i+=u}return i}(pe.getStreamFromFD(e),t,r);return k[n>>2]=i,0}catch(e){if(void 0===ce||!(e instanceof ce.ErrnoError))throw e;return e.errno}},l:function(e,t,r,n,i){return function(e,t,r,n){var i=I[n+40>>2],o={tm_sec:I[n>>2],tm_min:I[n+4>>2],tm_hour:I[n+8>>2],tm_mday:I[n+12>>2],tm_mon:I[n+16>>2],tm_year:I[n+20>>2],tm_wday:I[n+24>>2],tm_yday:I[n+28>>2],tm_isdst:I[n+32>>2],tm_gmtoff:I[n+36>>2],tm_zone:i?P(i):""},s=P(r),a={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var u in a)s=s.replace(new RegExp(u,"g"),a[u]);var c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],p=["January","February","March","April","May","June","July","August","September","October","November","December"];function l(e,t,r){for(var n="number"==typeof e?e.toString():e||"";n.length<t;)n=r[0]+n;return n}function d(e,t){return l(e,t,"0")}function h(e,t){function r(e){return e<0?-1:e>0?1:0}var n;return 0===(n=r(e.getFullYear()-t.getFullYear()))&&0===(n=r(e.getMonth()-t.getMonth()))&&(n=r(e.getDate()-t.getDate())),n}function m(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function _(e){var t=function(e,t){for(var r=new Date(e.getTime());t>0;){var n=le(r.getFullYear()),i=r.getMonth(),o=(n?be:we)[i];if(!(t>o-r.getDate()))return r.setDate(r.getDate()+t),r;t-=o-r.getDate()+1,r.setDate(1),i<11?r.setMonth(i+1):(r.setMonth(0),r.setFullYear(r.getFullYear()+1))}return r}(new Date(e.tm_year+1900,0,1),e.tm_yday),r=new Date(t.getFullYear(),0,4),n=new Date(t.getFullYear()+1,0,4),i=m(r),o=m(n);return h(i,t)<=0?h(o,t)<=0?t.getFullYear()+1:t.getFullYear():t.getFullYear()-1}var f={"%a":function(e){return c[e.tm_wday].substring(0,3)},"%A":function(e){return c[e.tm_wday]},"%b":function(e){return p[e.tm_mon].substring(0,3)},"%B":function(e){return p[e.tm_mon]},"%C":function(e){return d((e.tm_year+1900)/100|0,2)},"%d":function(e){return d(e.tm_mday,2)},"%e":function(e){return l(e.tm_mday,2," ")},"%g":function(e){return _(e).toString().substring(2)},"%G":function(e){return _(e)},"%H":function(e){return d(e.tm_hour,2)},"%I":function(e){var t=e.tm_hour;return 0==t?t=12:t>12&&(t-=12),d(t,2)},"%j":function(e){return d(e.tm_mday+function(e,t){for(var r=0,n=0;n<=t;r+=e[n++]);return r}(le(e.tm_year+1900)?be:we,e.tm_mon-1),3)},"%m":function(e){return d(e.tm_mon+1,2)},"%M":function(e){return d(e.tm_min,2)},"%n":function(){return"\n"},"%p":function(e){return e.tm_hour>=0&&e.tm_hour<12?"AM":"PM"},"%S":function(e){return d(e.tm_sec,2)},"%t":function(){return"\t"},"%u":function(e){return e.tm_wday||7},"%U":function(e){var t=e.tm_yday+7-e.tm_wday;return d(Math.floor(t/7),2)},"%V":function(e){var t=Math.floor((e.tm_yday+7-(e.tm_wday+6)%7)/7);if((e.tm_wday+371-e.tm_yday-2)%7<=2&&t++,t){if(53==t){var r=(e.tm_wday+371-e.tm_yday)%7;4==r||3==r&&le(e.tm_year)||(t=1)}}else{t=52;var n=(e.tm_wday+7-e.tm_yday-1)%7;(4==n||5==n&&le(e.tm_year%400-1))&&t++}return d(t,2)},"%w":function(e){return e.tm_wday},"%W":function(e){var t=e.tm_yday+7-(e.tm_wday+6)%7;return d(Math.floor(t/7),2)},"%y":function(e){return(e.tm_year+1900).toString().substring(2)},"%Y":function(e){return e.tm_year+1900},"%z":function(e){var t=e.tm_gmtoff,r=t>=0;return t=(t=Math.abs(t)/60)/60*100+t%60,(r?"+":"-")+String("0000"+t).slice(-4)},"%Z":function(e){return e.tm_zone},"%%":function(){return"%"}};for(var u in s=s.replace(/%%/g,"\0\0"),f)s.includes(u)&&(s=s.replace(new RegExp(u,"g"),f[u](o)));var y=oe(s=s.replace(/\0\0/g,"%"),!1);return y.length>t?0:(function(e,t){E.set(e,t)}(y,e),y.length-1)}(e,t,r,n)}},xe=(function(){var e={a:Ge};function t(e,t){var r,n=e.exports;i.asm=n,F((v=i.asm.t).buffer),N=i.asm.uc,r=i.asm.u,H.unshift(r),W()}function r(e){t(e.instance)}function o(t){return(_||!d&&!h||"function"!=typeof fetch?Promise.resolve().then((function(){return $(q)})):fetch(q,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+q+"'";return e.arrayBuffer()})).catch((function(){return $(q)}))).then((function(t){return WebAssembly.instantiate(t,e)})).then((function(e){return e})).then(t,(function(e){y("failed to asynchronously prepare wasm: "+e),V(e)}))}if(O(),i.instantiateWasm)try{return i.instantiateWasm(e,t)}catch(e){y("Module.instantiateWasm callback failed with error: "+e),n(e)}(_||"function"!=typeof WebAssembly.instantiateStreaming||X(q)||"function"!=typeof fetch?o(r):fetch(q,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(r,(function(e){return y("wasm streaming compile failed: "+e),y("falling back to ArrayBuffer instantiation"),o(r)}))}))).catch(n)}(),i.___wasm_call_ctors=function(){return(i.___wasm_call_ctors=i.asm.u).apply(null,arguments)},i._malloc=function(){return(xe=i._malloc=i.asm.v).apply(null,arguments)}),Pe=(i._free=function(){return(i._free=i.asm.w).apply(null,arguments)},i._main=function(){return(i._main=i.asm.x).apply(null,arguments)},i._emscripten_bind_VoidPtr___destroy___0=function(){return(Pe=i._emscripten_bind_VoidPtr___destroy___0=i.asm.y).apply(null,arguments)}),Re=i._emscripten_bind_Cloudpilot_Cloudpilot_0=function(){return(Re=i._emscripten_bind_Cloudpilot_Cloudpilot_0=i.asm.z).apply(null,arguments)},ze=i._emscripten_bind_Cloudpilot_Malloc_1=function(){return(ze=i._emscripten_bind_Cloudpilot_Malloc_1=i.asm.A).apply(null,arguments)},Fe=i._emscripten_bind_Cloudpilot_Free_1=function(){return(Fe=i._emscripten_bind_Cloudpilot_Free_1=i.asm.B).apply(null,arguments)},Ne=i._emscripten_bind_Cloudpilot_Nullptr_0=function(){return(Ne=i._emscripten_bind_Cloudpilot_Nullptr_0=i.asm.C).apply(null,arguments)},Ae=i._emscripten_bind_Cloudpilot_InitializeSession_3=function(){return(Ae=i._emscripten_bind_Cloudpilot_InitializeSession_3=i.asm.D).apply(null,arguments)},He=i._emscripten_bind_Cloudpilot_GetCyclesPerSecond_0=function(){return(He=i._emscripten_bind_Cloudpilot_GetCyclesPerSecond_0=i.asm.E).apply(null,arguments)},Te=i._emscripten_bind_Cloudpilot_RunEmulation_1=function(){return(Te=i._emscripten_bind_Cloudpilot_RunEmulation_1=i.asm.F).apply(null,arguments)},Be=i._emscripten_bind_Cloudpilot_SetClockFactor_1=function(){return(Be=i._emscripten_bind_Cloudpilot_SetClockFactor_1=i.asm.G).apply(null,arguments)},Le=i._emscripten_bind_Cloudpilot_CopyFrame_0=function(){return(Le=i._emscripten_bind_Cloudpilot_CopyFrame_0=i.asm.H).apply(null,arguments)},je=i._emscripten_bind_Cloudpilot_IsScreenDirty_0=function(){return(je=i._emscripten_bind_Cloudpilot_IsScreenDirty_0=i.asm.I).apply(null,arguments)},Ue=i._emscripten_bind_Cloudpilot_MarkScreenClean_0=function(){return(Ue=i._emscripten_bind_Cloudpilot_MarkScreenClean_0=i.asm.J).apply(null,arguments)},Oe=i._emscripten_bind_Cloudpilot_MinMemoryForDevice_1=function(){return(Oe=i._emscripten_bind_Cloudpilot_MinMemoryForDevice_1=i.asm.K).apply(null,arguments)},We=i._emscripten_bind_Cloudpilot_FramebufferSizeForDevice_1=function(){return(We=i._emscripten_bind_Cloudpilot_FramebufferSizeForDevice_1=i.asm.L).apply(null,arguments)},Ve=i._emscripten_bind_Cloudpilot_TotalMemoryForDevice_1=function(){return(Ve=i._emscripten_bind_Cloudpilot_TotalMemoryForDevice_1=i.asm.M).apply(null,arguments)},qe=i._emscripten_bind_Cloudpilot_QueuePenMove_2=function(){return(qe=i._emscripten_bind_Cloudpilot_QueuePenMove_2=i.asm.N).apply(null,arguments)},Ke=i._emscripten_bind_Cloudpilot_QueuePenUp_0=function(){return(Ke=i._emscripten_bind_Cloudpilot_QueuePenUp_0=i.asm.O).apply(null,arguments)},Ye=i._emscripten_bind_Cloudpilot_QueueButtonDown_1=function(){return(Ye=i._emscripten_bind_Cloudpilot_QueueButtonDown_1=i.asm.P).apply(null,arguments)},Qe=i._emscripten_bind_Cloudpilot_QueueButtonUp_1=function(){return(Qe=i._emscripten_bind_Cloudpilot_QueueButtonUp_1=i.asm.Q).apply(null,arguments)},Ze=i._emscripten_bind_Cloudpilot_QueueKeyboardEvent_2=function(){return(Ze=i._emscripten_bind_Cloudpilot_QueueKeyboardEvent_2=i.asm.R).apply(null,arguments)},Xe=i._emscripten_bind_Cloudpilot_IsPowerOff_0=function(){return(Xe=i._emscripten_bind_Cloudpilot_IsPowerOff_0=i.asm.S).apply(null,arguments)},$e=i._emscripten_bind_Cloudpilot_IsUIInitialized_0=function(){return($e=i._emscripten_bind_Cloudpilot_IsUIInitialized_0=i.asm.T).apply(null,arguments)},Je=i._emscripten_bind_Cloudpilot_GetOSVersion_0=function(){return(Je=i._emscripten_bind_Cloudpilot_GetOSVersion_0=i.asm.U).apply(null,arguments)},et=i._emscripten_bind_Cloudpilot_IsSetupComplete_0=function(){return(et=i._emscripten_bind_Cloudpilot_IsSetupComplete_0=i.asm.V).apply(null,arguments)},tt=i._emscripten_bind_Cloudpilot_Reset_0=function(){return(tt=i._emscripten_bind_Cloudpilot_Reset_0=i.asm.W).apply(null,arguments)},rt=i._emscripten_bind_Cloudpilot_ResetNoExtensions_0=function(){return(rt=i._emscripten_bind_Cloudpilot_ResetNoExtensions_0=i.asm.X).apply(null,arguments)},nt=i._emscripten_bind_Cloudpilot_ResetHard_0=function(){return(nt=i._emscripten_bind_Cloudpilot_ResetHard_0=i.asm.Y).apply(null,arguments)},it=i._emscripten_bind_Cloudpilot_InstallDb_2=function(){return(it=i._emscripten_bind_Cloudpilot_InstallDb_2=i.asm.Z).apply(null,arguments)},ot=i._emscripten_bind_Cloudpilot_GetPalette2bitMapping_0=function(){return(ot=i._emscripten_bind_Cloudpilot_GetPalette2bitMapping_0=i.asm._).apply(null,arguments)},st=i._emscripten_bind_Cloudpilot_GetMemoryPtr_0=function(){return(st=i._emscripten_bind_Cloudpilot_GetMemoryPtr_0=i.asm.$).apply(null,arguments)},at=i._emscripten_bind_Cloudpilot_GetDirtyPagesPtr_0=function(){return(at=i._emscripten_bind_Cloudpilot_GetDirtyPagesPtr_0=i.asm.aa).apply(null,arguments)},ut=i._emscripten_bind_Cloudpilot_GetMemorySize_0=function(){return(ut=i._emscripten_bind_Cloudpilot_GetMemorySize_0=i.asm.ba).apply(null,arguments)},ct=i._emscripten_bind_Cloudpilot_ImportMemoryImage_2=function(){return(ct=i._emscripten_bind_Cloudpilot_ImportMemoryImage_2=i.asm.ca).apply(null,arguments)},pt=i._emscripten_bind_Cloudpilot_GetRomPtr_0=function(){return(pt=i._emscripten_bind_Cloudpilot_GetRomPtr_0=i.asm.da).apply(null,arguments)},lt=i._emscripten_bind_Cloudpilot_GetRomSize_0=function(){return(lt=i._emscripten_bind_Cloudpilot_GetRomSize_0=i.asm.ea).apply(null,arguments)},dt=i._emscripten_bind_Cloudpilot_GetSavestatePtr_0=function(){return(dt=i._emscripten_bind_Cloudpilot_GetSavestatePtr_0=i.asm.fa).apply(null,arguments)},ht=i._emscripten_bind_Cloudpilot_GetSavestateSize_0=function(){return(ht=i._emscripten_bind_Cloudpilot_GetSavestateSize_0=i.asm.ga).apply(null,arguments)},mt=i._emscripten_bind_Cloudpilot_SaveState_0=function(){return(mt=i._emscripten_bind_Cloudpilot_SaveState_0=i.asm.ha).apply(null,arguments)},_t=i._emscripten_bind_Cloudpilot_LoadState_2=function(){return(_t=i._emscripten_bind_Cloudpilot_LoadState_2=i.asm.ia).apply(null,arguments)},ft=i._emscripten_bind_Cloudpilot_GetHotsyncName_0=function(){return(ft=i._emscripten_bind_Cloudpilot_GetHotsyncName_0=i.asm.ja).apply(null,arguments)},yt=i._emscripten_bind_Cloudpilot_SetHotsyncName_1=function(){return(yt=i._emscripten_bind_Cloudpilot_SetHotsyncName_1=i.asm.ka).apply(null,arguments)},vt=i._emscripten_bind_Cloudpilot_RegisterPwmHandler_1=function(){return(vt=i._emscripten_bind_Cloudpilot_RegisterPwmHandler_1=i.asm.la).apply(null,arguments)},gt=i._emscripten_bind_Cloudpilot_StartBackup_0=function(){return(gt=i._emscripten_bind_Cloudpilot_StartBackup_0=i.asm.ma).apply(null,arguments)},bt=i._emscripten_bind_Cloudpilot_SetClipboardIntegration_1=function(){return(bt=i._emscripten_bind_Cloudpilot_SetClipboardIntegration_1=i.asm.na).apply(null,arguments)},wt=i._emscripten_bind_Cloudpilot_GetClipboardIntegration_0=function(){return(wt=i._emscripten_bind_Cloudpilot_GetClipboardIntegration_0=i.asm.oa).apply(null,arguments)},St=i._emscripten_bind_Cloudpilot_IsSuspended_0=function(){return(St=i._emscripten_bind_Cloudpilot_IsSuspended_0=i.asm.pa).apply(null,arguments)},Ct=i._emscripten_bind_Cloudpilot_GetSuspendContext_0=function(){return(Ct=i._emscripten_bind_Cloudpilot_GetSuspendContext_0=i.asm.qa).apply(null,arguments)},Et=i._emscripten_bind_Cloudpilot_SetNetworkRedirection_1=function(){return(Et=i._emscripten_bind_Cloudpilot_SetNetworkRedirection_1=i.asm.ra).apply(null,arguments)},Dt=i._emscripten_bind_Cloudpilot_GetNetworkRedirection_0=function(){return(Dt=i._emscripten_bind_Cloudpilot_GetNetworkRedirection_0=i.asm.sa).apply(null,arguments)},It=i._emscripten_bind_Cloudpilot_RegisterProxyDisconnectHandler_1=function(){return(It=i._emscripten_bind_Cloudpilot_RegisterProxyDisconnectHandler_1=i.asm.ta).apply(null,arguments)},kt=i._emscripten_bind_Cloudpilot_SetHotsyncNameManagement_1=function(){return(kt=i._emscripten_bind_Cloudpilot_SetHotsyncNameManagement_1=i.asm.ua).apply(null,arguments)},Mt=i._emscripten_bind_Cloudpilot_LaunchAppByName_1=function(){return(Mt=i._emscripten_bind_Cloudpilot_LaunchAppByName_1=i.asm.va).apply(null,arguments)},Gt=i._emscripten_bind_Cloudpilot_LaunchAppByDbHeader_2=function(){return(Gt=i._emscripten_bind_Cloudpilot_LaunchAppByDbHeader_2=i.asm.wa).apply(null,arguments)},xt=i._emscripten_bind_Cloudpilot_DeviceSupportsCardSize_1=function(){return(xt=i._emscripten_bind_Cloudpilot_DeviceSupportsCardSize_1=i.asm.xa).apply(null,arguments)},Pt=i._emscripten_bind_Cloudpilot_ClearExternalStorage_0=function(){return(Pt=i._emscripten_bind_Cloudpilot_ClearExternalStorage_0=i.asm.ya).apply(null,arguments)},Rt=i._emscripten_bind_Cloudpilot_AllocateCard_2=function(){return(Rt=i._emscripten_bind_Cloudpilot_AllocateCard_2=i.asm.za).apply(null,arguments)},zt=i._emscripten_bind_Cloudpilot_AdoptCard_3=function(){return(zt=i._emscripten_bind_Cloudpilot_AdoptCard_3=i.asm.Aa).apply(null,arguments)},Ft=i._emscripten_bind_Cloudpilot_MountCard_1=function(){return(Ft=i._emscripten_bind_Cloudpilot_MountCard_1=i.asm.Ba).apply(null,arguments)},Nt=i._emscripten_bind_Cloudpilot_RemoveCard_1=function(){return(Nt=i._emscripten_bind_Cloudpilot_RemoveCard_1=i.asm.Ca).apply(null,arguments)},At=i._emscripten_bind_Cloudpilot_GetCardData_1=function(){return(At=i._emscripten_bind_Cloudpilot_GetCardData_1=i.asm.Da).apply(null,arguments)},Ht=i._emscripten_bind_Cloudpilot_GetCardDirtyPages_1=function(){return(Ht=i._emscripten_bind_Cloudpilot_GetCardDirtyPages_1=i.asm.Ea).apply(null,arguments)},Tt=i._emscripten_bind_Cloudpilot_GetCardSize_1=function(){return(Tt=i._emscripten_bind_Cloudpilot_GetCardSize_1=i.asm.Fa).apply(null,arguments)},Bt=i._emscripten_bind_Cloudpilot_RemountCards_0=function(){return(Bt=i._emscripten_bind_Cloudpilot_RemountCards_0=i.asm.Ga).apply(null,arguments)},Lt=i._emscripten_bind_Cloudpilot_GetSupportLevel_1=function(){return(Lt=i._emscripten_bind_Cloudpilot_GetSupportLevel_1=i.asm.Ha).apply(null,arguments)},jt=i._emscripten_bind_Cloudpilot_GetMountedKey_0=function(){return(jt=i._emscripten_bind_Cloudpilot_GetMountedKey_0=i.asm.Ia).apply(null,arguments)},Ut=i._emscripten_bind_Cloudpilot___destroy___0=function(){return(Ut=i._emscripten_bind_Cloudpilot___destroy___0=i.asm.Ja).apply(null,arguments)},Ot=i._emscripten_bind_RomInfo_RomInfo_2=function(){return(Ot=i._emscripten_bind_RomInfo_RomInfo_2=i.asm.Ka).apply(null,arguments)},Wt=i._emscripten_bind_RomInfo_IsValid_0=function(){return(Wt=i._emscripten_bind_RomInfo_IsValid_0=i.asm.La).apply(null,arguments)},Vt=i._emscripten_bind_RomInfo_CardVersion_0=function(){return(Vt=i._emscripten_bind_RomInfo_CardVersion_0=i.asm.Ma).apply(null,arguments)},qt=i._emscripten_bind_RomInfo_CardName_0=function(){return(qt=i._emscripten_bind_RomInfo_CardName_0=i.asm.Na).apply(null,arguments)},Kt=i._emscripten_bind_RomInfo_RomVersion_0=function(){return(Kt=i._emscripten_bind_RomInfo_RomVersion_0=i.asm.Oa).apply(null,arguments)},Yt=i._emscripten_bind_RomInfo_RomVersionString_0=function(){return(Yt=i._emscripten_bind_RomInfo_RomVersionString_0=i.asm.Pa).apply(null,arguments)},Qt=i._emscripten_bind_RomInfo_Supports_1=function(){return(Qt=i._emscripten_bind_RomInfo_Supports_1=i.asm.Qa).apply(null,arguments)},Zt=i._emscripten_bind_RomInfo___destroy___0=function(){return(Zt=i._emscripten_bind_RomInfo___destroy___0=i.asm.Ra).apply(null,arguments)},Xt=i._emscripten_bind_Frame_GetLineWidth_0=function(){return(Xt=i._emscripten_bind_Frame_GetLineWidth_0=i.asm.Sa).apply(null,arguments)},$t=i._emscripten_bind_Frame_GetBpp_0=function(){return($t=i._emscripten_bind_Frame_GetBpp_0=i.asm.Ta).apply(null,arguments)},Jt=i._emscripten_bind_Frame_GetLines_0=function(){return(Jt=i._emscripten_bind_Frame_GetLines_0=i.asm.Ua).apply(null,arguments)},er=i._emscripten_bind_Frame_GetMargin_0=function(){return(er=i._emscripten_bind_Frame_GetMargin_0=i.asm.Va).apply(null,arguments)},tr=i._emscripten_bind_Frame_GetBytesPerLine_0=function(){return(tr=i._emscripten_bind_Frame_GetBytesPerLine_0=i.asm.Wa).apply(null,arguments)},rr=i._emscripten_bind_Frame_GetFirstDirtyLine_0=function(){return(rr=i._emscripten_bind_Frame_GetFirstDirtyLine_0=i.asm.Xa).apply(null,arguments)},nr=i._emscripten_bind_Frame_GetLastDirtyLine_0=function(){return(nr=i._emscripten_bind_Frame_GetLastDirtyLine_0=i.asm.Ya).apply(null,arguments)},ir=i._emscripten_bind_Frame_GetHasChanges_0=function(){return(ir=i._emscripten_bind_Frame_GetHasChanges_0=i.asm.Za).apply(null,arguments)},or=i._emscripten_bind_Frame_GetBuffer_0=function(){return(or=i._emscripten_bind_Frame_GetBuffer_0=i.asm._a).apply(null,arguments)},sr=i._emscripten_bind_Frame_GetBufferSize_0=function(){return(sr=i._emscripten_bind_Frame_GetBufferSize_0=i.asm.$a).apply(null,arguments)},ar=i._emscripten_bind_Frame_GetScaleX_0=function(){return(ar=i._emscripten_bind_Frame_GetScaleX_0=i.asm.ab).apply(null,arguments)},ur=i._emscripten_bind_Frame_GetScaleY_0=function(){return(ur=i._emscripten_bind_Frame_GetScaleY_0=i.asm.bb).apply(null,arguments)},cr=i._emscripten_bind_Frame___destroy___0=function(){return(cr=i._emscripten_bind_Frame___destroy___0=i.asm.cb).apply(null,arguments)},pr=i._emscripten_bind_DbBackup_Init_1=function(){return(pr=i._emscripten_bind_DbBackup_Init_1=i.asm.db).apply(null,arguments)},lr=i._emscripten_bind_DbBackup_IsInProgress_0=function(){return(lr=i._emscripten_bind_DbBackup_IsInProgress_0=i.asm.eb).apply(null,arguments)},dr=i._emscripten_bind_DbBackup_IsDone_0=function(){return(dr=i._emscripten_bind_DbBackup_IsDone_0=i.asm.fb).apply(null,arguments)},hr=i._emscripten_bind_DbBackup_GetCurrentDatabase_0=function(){return(hr=i._emscripten_bind_DbBackup_GetCurrentDatabase_0=i.asm.gb).apply(null,arguments)},mr=i._emscripten_bind_DbBackup_Save_0=function(){return(mr=i._emscripten_bind_DbBackup_Save_0=i.asm.hb).apply(null,arguments)},_r=i._emscripten_bind_DbBackup_Skip_0=function(){return(_r=i._emscripten_bind_DbBackup_Skip_0=i.asm.ib).apply(null,arguments)},fr=i._emscripten_bind_DbBackup_GetArchivePtr_0=function(){return(fr=i._emscripten_bind_DbBackup_GetArchivePtr_0=i.asm.jb).apply(null,arguments)},yr=i._emscripten_bind_DbBackup_GetArchiveSize_0=function(){return(yr=i._emscripten_bind_DbBackup_GetArchiveSize_0=i.asm.kb).apply(null,arguments)},vr=i._emscripten_bind_DbBackup___destroy___0=function(){return(vr=i._emscripten_bind_DbBackup___destroy___0=i.asm.lb).apply(null,arguments)},gr=i._emscripten_bind_SuspendContextClipboardCopy_Cancel_0=function(){return(gr=i._emscripten_bind_SuspendContextClipboardCopy_Cancel_0=i.asm.mb).apply(null,arguments)},br=i._emscripten_bind_SuspendContextClipboardCopy_Resume_0=function(){return(br=i._emscripten_bind_SuspendContextClipboardCopy_Resume_0=i.asm.nb).apply(null,arguments)},wr=i._emscripten_bind_SuspendContextClipboardCopy_GetClipboardContent_0=function(){return(wr=i._emscripten_bind_SuspendContextClipboardCopy_GetClipboardContent_0=i.asm.ob).apply(null,arguments)},Sr=i._emscripten_bind_SuspendContextClipboardCopy___destroy___0=function(){return(Sr=i._emscripten_bind_SuspendContextClipboardCopy___destroy___0=i.asm.pb).apply(null,arguments)},Cr=i._emscripten_bind_SuspendContextClipboardPaste_Cancel_0=function(){return(Cr=i._emscripten_bind_SuspendContextClipboardPaste_Cancel_0=i.asm.qb).apply(null,arguments)},Er=i._emscripten_bind_SuspendContextClipboardPaste_Resume_1=function(){return(Er=i._emscripten_bind_SuspendContextClipboardPaste_Resume_1=i.asm.rb).apply(null,arguments)},Dr=i._emscripten_bind_SuspendContextClipboardPaste___destroy___0=function(){return(Dr=i._emscripten_bind_SuspendContextClipboardPaste___destroy___0=i.asm.sb).apply(null,arguments)},Ir=i._emscripten_bind_SuspendContextNetworkConnect_Cancel_0=function(){return(Ir=i._emscripten_bind_SuspendContextNetworkConnect_Cancel_0=i.asm.tb).apply(null,arguments)},kr=i._emscripten_bind_SuspendContextNetworkConnect_Resume_1=function(){return(kr=i._emscripten_bind_SuspendContextNetworkConnect_Resume_1=i.asm.ub).apply(null,arguments)},Mr=i._emscripten_bind_SuspendContextNetworkConnect___destroy___0=function(){return(Mr=i._emscripten_bind_SuspendContextNetworkConnect___destroy___0=i.asm.vb).apply(null,arguments)},Gr=i._emscripten_bind_SuspendContextNetworkRpc_Cancel_0=function(){return(Gr=i._emscripten_bind_SuspendContextNetworkRpc_Cancel_0=i.asm.wb).apply(null,arguments)},xr=i._emscripten_bind_SuspendContextNetworkRpc_GetRequestSize_0=function(){return(xr=i._emscripten_bind_SuspendContextNetworkRpc_GetRequestSize_0=i.asm.xb).apply(null,arguments)},Pr=i._emscripten_bind_SuspendContextNetworkRpc_GetRequestData_0=function(){return(Pr=i._emscripten_bind_SuspendContextNetworkRpc_GetRequestData_0=i.asm.yb).apply(null,arguments)},Rr=i._emscripten_bind_SuspendContextNetworkRpc_ReceiveResponse_2=function(){return(Rr=i._emscripten_bind_SuspendContextNetworkRpc_ReceiveResponse_2=i.asm.zb).apply(null,arguments)},zr=i._emscripten_bind_SuspendContextNetworkRpc___destroy___0=function(){return(zr=i._emscripten_bind_SuspendContextNetworkRpc___destroy___0=i.asm.Ab).apply(null,arguments)},Fr=i._emscripten_bind_SuspendContext_GetKind_0=function(){return(Fr=i._emscripten_bind_SuspendContext_GetKind_0=i.asm.Bb).apply(null,arguments)},Nr=i._emscripten_bind_SuspendContext_Cancel_0=function(){return(Nr=i._emscripten_bind_SuspendContext_Cancel_0=i.asm.Cb).apply(null,arguments)},Ar=i._emscripten_bind_SuspendContext_AsContextClipboardCopy_0=function(){return(Ar=i._emscripten_bind_SuspendContext_AsContextClipboardCopy_0=i.asm.Db).apply(null,arguments)},Hr=i._emscripten_bind_SuspendContext_AsContextClipboardPaste_0=function(){return(Hr=i._emscripten_bind_SuspendContext_AsContextClipboardPaste_0=i.asm.Eb).apply(null,arguments)},Tr=i._emscripten_bind_SuspendContext_AsContextNetworkConnect_0=function(){return(Tr=i._emscripten_bind_SuspendContext_AsContextNetworkConnect_0=i.asm.Fb).apply(null,arguments)},Br=i._emscripten_bind_SuspendContext_AsContextNetworkRpc_0=function(){return(Br=i._emscripten_bind_SuspendContext_AsContextNetworkRpc_0=i.asm.Gb).apply(null,arguments)},Lr=i._emscripten_bind_SuspendContext___destroy___0=function(){return(Lr=i._emscripten_bind_SuspendContext___destroy___0=i.asm.Hb).apply(null,arguments)},jr=i._emscripten_bind_ZipfileWalker_ZipfileWalker_2=function(){return(jr=i._emscripten_bind_ZipfileWalker_ZipfileWalker_2=i.asm.Ib).apply(null,arguments)},Ur=i._emscripten_bind_ZipfileWalker_GetState_0=function(){return(Ur=i._emscripten_bind_ZipfileWalker_GetState_0=i.asm.Jb).apply(null,arguments)},Or=i._emscripten_bind_ZipfileWalker_Next_0=function(){return(Or=i._emscripten_bind_ZipfileWalker_Next_0=i.asm.Kb).apply(null,arguments)},Wr=i._emscripten_bind_ZipfileWalker_GetCurrentEntrySize_0=function(){return(Wr=i._emscripten_bind_ZipfileWalker_GetCurrentEntrySize_0=i.asm.Lb).apply(null,arguments)},Vr=i._emscripten_bind_ZipfileWalker_GetCurrentEntryName_0=function(){return(Vr=i._emscripten_bind_ZipfileWalker_GetCurrentEntryName_0=i.asm.Mb).apply(null,arguments)},qr=i._emscripten_bind_ZipfileWalker_GetCurrentEntryContent_0=function(){return(qr=i._emscripten_bind_ZipfileWalker_GetCurrentEntryContent_0=i.asm.Nb).apply(null,arguments)},Kr=i._emscripten_bind_ZipfileWalker___destroy___0=function(){return(Kr=i._emscripten_bind_ZipfileWalker___destroy___0=i.asm.Ob).apply(null,arguments)},Yr=i._emscripten_bind_SessionImage_SessionImage_0=function(){return(Yr=i._emscripten_bind_SessionImage_SessionImage_0=i.asm.Pb).apply(null,arguments)},Qr=i._emscripten_bind_SessionImage_GetDeviceId_0=function(){return(Qr=i._emscripten_bind_SessionImage_GetDeviceId_0=i.asm.Qb).apply(null,arguments)},Zr=i._emscripten_bind_SessionImage_SetDeviceId_1=function(){return(Zr=i._emscripten_bind_SessionImage_SetDeviceId_1=i.asm.Rb).apply(null,arguments)},Xr=i._emscripten_bind_SessionImage_GetRomImage_0=function(){return(Xr=i._emscripten_bind_SessionImage_GetRomImage_0=i.asm.Sb).apply(null,arguments)},$r=i._emscripten_bind_SessionImage_GetRomImageSize_0=function(){return($r=i._emscripten_bind_SessionImage_GetRomImageSize_0=i.asm.Tb).apply(null,arguments)},Jr=i._emscripten_bind_SessionImage_SetRomImage_2=function(){return(Jr=i._emscripten_bind_SessionImage_SetRomImage_2=i.asm.Ub).apply(null,arguments)},en=i._emscripten_bind_SessionImage_GetMemoryImage_0=function(){return(en=i._emscripten_bind_SessionImage_GetMemoryImage_0=i.asm.Vb).apply(null,arguments)},tn=i._emscripten_bind_SessionImage_GetMemoryImageSize_0=function(){return(tn=i._emscripten_bind_SessionImage_GetMemoryImageSize_0=i.asm.Wb).apply(null,arguments)},rn=i._emscripten_bind_SessionImage_SetMemoryImage_2=function(){return(rn=i._emscripten_bind_SessionImage_SetMemoryImage_2=i.asm.Xb).apply(null,arguments)},nn=i._emscripten_bind_SessionImage_GetMetadata_0=function(){return(nn=i._emscripten_bind_SessionImage_GetMetadata_0=i.asm.Yb).apply(null,arguments)},on=i._emscripten_bind_SessionImage_GetMetadataSize_0=function(){return(on=i._emscripten_bind_SessionImage_GetMetadataSize_0=i.asm.Zb).apply(null,arguments)},sn=i._emscripten_bind_SessionImage_SetMetadata_2=function(){return(sn=i._emscripten_bind_SessionImage_SetMetadata_2=i.asm._b).apply(null,arguments)},an=i._emscripten_bind_SessionImage_GetSavestate_0=function(){return(an=i._emscripten_bind_SessionImage_GetSavestate_0=i.asm.$b).apply(null,arguments)},un=i._emscripten_bind_SessionImage_GetSavestateSize_0=function(){return(un=i._emscripten_bind_SessionImage_GetSavestateSize_0=i.asm.ac).apply(null,arguments)},cn=i._emscripten_bind_SessionImage_SetSavestate_2=function(){return(cn=i._emscripten_bind_SessionImage_SetSavestate_2=i.asm.bc).apply(null,arguments)},pn=i._emscripten_bind_SessionImage_GetVersion_0=function(){return(pn=i._emscripten_bind_SessionImage_GetVersion_0=i.asm.cc).apply(null,arguments)},ln=i._emscripten_bind_SessionImage_Serialize_0=function(){return(ln=i._emscripten_bind_SessionImage_Serialize_0=i.asm.dc).apply(null,arguments)},dn=i._emscripten_bind_SessionImage_GetSerializedImage_0=function(){return(dn=i._emscripten_bind_SessionImage_GetSerializedImage_0=i.asm.ec).apply(null,arguments)},hn=i._emscripten_bind_SessionImage_GetSerializedImageSize_0=function(){return(hn=i._emscripten_bind_SessionImage_GetSerializedImageSize_0=i.asm.fc).apply(null,arguments)},mn=i._emscripten_bind_SessionImage_Deserialize_2=function(){return(mn=i._emscripten_bind_SessionImage_Deserialize_2=i.asm.gc).apply(null,arguments)},_n=i._emscripten_bind_SessionImage___destroy___0=function(){return(_n=i._emscripten_bind_SessionImage___destroy___0=i.asm.hc).apply(null,arguments)},fn=i._emscripten_bind_SkinLoader_SkinLoader_1=function(){return(fn=i._emscripten_bind_SkinLoader_SkinLoader_1=i.asm.ic).apply(null,arguments)},yn=i._emscripten_bind_SkinLoader_GetData_0=function(){return(yn=i._emscripten_bind_SkinLoader_GetData_0=i.asm.jc).apply(null,arguments)},vn=i._emscripten_bind_SkinLoader_GetSize_0=function(){return(vn=i._emscripten_bind_SkinLoader_GetSize_0=i.asm.kc).apply(null,arguments)},gn=i._emscripten_bind_SkinLoader___destroy___0=function(){return(gn=i._emscripten_bind_SkinLoader___destroy___0=i.asm.lc).apply(null,arguments)},bn=i._emscripten_bind_GunzipContext_GunzipContext_3=function(){return(bn=i._emscripten_bind_GunzipContext_GunzipContext_3=i.asm.mc).apply(null,arguments)},wn=i._emscripten_bind_GunzipContext_GetState_0=function(){return(wn=i._emscripten_bind_GunzipContext_GetState_0=i.asm.nc).apply(null,arguments)},Sn=i._emscripten_bind_GunzipContext_Continue_0=function(){return(Sn=i._emscripten_bind_GunzipContext_Continue_0=i.asm.oc).apply(null,arguments)},Cn=i._emscripten_bind_GunzipContext_GetUncompressedData_0=function(){return(Cn=i._emscripten_bind_GunzipContext_GetUncompressedData_0=i.asm.pc).apply(null,arguments)},En=i._emscripten_bind_GunzipContext_ReleaseUncompressedData_0=function(){return(En=i._emscripten_bind_GunzipContext_ReleaseUncompressedData_0=i.asm.qc).apply(null,arguments)},Dn=i._emscripten_bind_GunzipContext_GetUncompressedSize_0=function(){return(Dn=i._emscripten_bind_GunzipContext_GetUncompressedSize_0=i.asm.rc).apply(null,arguments)},In=i._emscripten_bind_GunzipContext_GetError_0=function(){return(In=i._emscripten_bind_GunzipContext_GetError_0=i.asm.sc).apply(null,arguments)},kn=i._emscripten_bind_GunzipContext___destroy___0=function(){return(kn=i._emscripten_bind_GunzipContext___destroy___0=i.asm.tc).apply(null,arguments)};function Mn(e){var t,r,n=i._main;try{var o=n(0,0);return b=t=o,b=r=t,g||(i.onExit&&i.onExit(r),w=!0),l(r,new ee(r)),o}catch(e){return function(e){if(e instanceof ee||"unwind"==e)return b;l(1,e)}(e)}}function Gn(e){function t(){Me||(Me=!0,i.calledRun=!0,w||(i.noFSInit||ce.init.initialized||ce.init(),ce.ignorePermissions=!1,se.init(),te(H),te(T),r(i),i.onRuntimeInitialized&&i.onRuntimeInitialized(),xn&&Mn(),function(){if(i.postRun)for("function"==typeof i.postRun&&(i.postRun=[i.postRun]);i.postRun.length;)e=i.postRun.shift(),B.unshift(e);var e;te(B)}()))}e=e||c,L>0||(function(){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;)e=i.preRun.shift(),A.unshift(e);var e;te(A)}(),L>0||(i.setStatus?(i.setStatus("Running..."),setTimeout((function(){setTimeout((function(){i.setStatus("")}),1),t()}),1)):t()))}if(i.___original_main=function(){return(i.___original_main=i.asm.vc).apply(null,arguments)},i.___start_em_js=418211,i.___stop_em_js=418408,i.UTF8ToString=P,i.addFunction=function(e,t){if(Ee||(Ee=new WeakMap,function(e,t){if(Ee)for(var r=0;r<0+t;r++){var n=(o=void 0,(o=Ce[i=r])||(i>=Ce.length&&(Ce.length=i+1),Ce[i]=o=N.get(i)),o);n&&Ee.set(n,r)}var i,o}(0,N.length)),Ee.has(e))return Ee.get(e);var r=function(){if(De.length)return De.pop();try{N.grow(1)}catch(e){if(!(e instanceof RangeError))throw e;throw"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH."}return N.length-1}();try{Ie(r,e)}catch(n){if(!(n instanceof TypeError))throw n;Ie(r,function(e,t){if("function"==typeof WebAssembly.Function)return new WebAssembly.Function(function(e){for(var t={i:"i32",j:"i32",f:"f32",d:"f64",p:"i32"},r={parameters:[],results:"v"==e[0]?[]:[t[e[0]]]},n=1;n<e.length;++n)r.parameters.push(t[e[n]]),"j"===e[n]&&r.parameters.push("i32");return r}(t),e);var r=[1];!function(e,t){var r=e.slice(0,1),n=e.slice(1),i={i:127,p:127,j:126,f:125,d:124};t.push(96),Se(n.length,t);for(var o=0;o<n.length;++o)t.push(i[n[o]]);"v"==r?t.push(0):t.push(1,i[r])}(t,r);var n=[0,97,115,109,1,0,0,0,1];Se(r.length,n),n.push.apply(n,r),n.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);var i=new WebAssembly.Module(new Uint8Array(n));return new WebAssembly.Instance(i,{e:{f:e}}).exports.f}(e,t))}return Ee.set(e,r),r},U=function e(){Me||Gn(),Me||(U=e)},i.preInit)for("function"==typeof i.preInit&&(i.preInit=[i.preInit]);i.preInit.length>0;)i.preInit.pop()();var xn=!0;function Pn(){}function Rn(e){return(e||Pn).__cache__}function zn(e,t){var r=Rn(t),n=r[e];return n||((n=Object.create((t||Pn).prototype)).ptr=e,r[e]=n)}i.noInitialRun&&(xn=!1),Gn(),Pn.prototype=Object.create(Pn.prototype),Pn.prototype.constructor=Pn,Pn.prototype.__class__=Pn,Pn.__cache__={},i.WrapperObject=Pn,i.getCache=Rn,i.wrapPointer=zn,i.castObject=function(e,t){return zn(e.ptr,t)},i.NULL=zn(0),i.destroy=function(e){if(!e.__destroy__)throw"Error: Cannot destroy object. (Did you create it yourself?)";e.__destroy__(),delete Rn(e.__class__)[e.ptr]},i.compare=function(e,t){return e.ptr===t.ptr},i.getPointer=function(e){return e.ptr},i.getClass=function(e){return e.__class__};var Fn={buffer:0,size:0,pos:0,temps:[],needed:0,prepare:function(){if(Fn.needed){for(var e=0;e<Fn.temps.length;e++)i._free(Fn.temps[e]);Fn.temps.length=0,i._free(Fn.buffer),Fn.buffer=0,Fn.size+=Fn.needed,Fn.needed=0}Fn.buffer||(Fn.size+=128,Fn.buffer=i._malloc(Fn.size),S(Fn.buffer)),Fn.pos=0},alloc:function(e,t){S(Fn.buffer);var r,n=t.BYTES_PER_ELEMENT,o=e.length*n;return o=o+7&-8,Fn.pos+o>=Fn.size?(S(o>0),Fn.needed+=o,r=i._malloc(o),Fn.temps.push(r)):(r=Fn.buffer+Fn.pos,Fn.pos+=o),r},copy:function(e,t,r){switch(r>>>=0,t.BYTES_PER_ELEMENT){case 2:r>>>=1;break;case 4:r>>>=2;break;case 8:r>>>=3}for(var n=0;n<e.length;n++)t[r+n]=e[n]}};function Nn(e){if("string"==typeof e){var t=oe(e),r=Fn.alloc(t,E);return Fn.copy(t,E,r),r}return e}function An(){throw"cannot construct a VoidPtr, no constructor in IDL"}function Hn(){this.ptr=Re(),Rn(Hn)[this.ptr]=this}function Tn(e,t){e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),this.ptr=Ot(e,t),Rn(Tn)[this.ptr]=this}function Bn(){throw"cannot construct a Frame, no constructor in IDL"}function Ln(){throw"cannot construct a DbBackup, no constructor in IDL"}function jn(){throw"cannot construct a SuspendContextClipboardCopy, no constructor in IDL"}function Un(){throw"cannot construct a SuspendContextClipboardPaste, no constructor in IDL"}function On(){throw"cannot construct a SuspendContextNetworkConnect, no constructor in IDL"}function Wn(){throw"cannot construct a SuspendContextNetworkRpc, no constructor in IDL"}function Vn(){throw"cannot construct a SuspendContext, no constructor in IDL"}function qn(e,t){e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),this.ptr=jr(e,t),Rn(qn)[this.ptr]=this}function Kn(){this.ptr=Yr(),Rn(Kn)[this.ptr]=this}function Yn(e){Fn.prepare(),e=e&&"object"==typeof e?e.ptr:Nn(e),this.ptr=fn(e),Rn(Yn)[this.ptr]=this}function Qn(e,t,r){e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),this.ptr=bn(e,t,r),Rn(Qn)[this.ptr]=this}return An.prototype=Object.create(Pn.prototype),An.prototype.constructor=An,An.prototype.__class__=An,An.__cache__={},i.VoidPtr=An,An.prototype.__destroy__=An.prototype.__destroy__=function(){var e=this.ptr;Pe(e)},Hn.prototype=Object.create(Pn.prototype),Hn.prototype.constructor=Hn,Hn.prototype.__class__=Hn,Hn.__cache__={},i.Cloudpilot=Hn,Hn.prototype.Malloc=Hn.prototype.Malloc=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),zn(ze(t,e),An)},Hn.prototype.Free=Hn.prototype.Free=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),Fe(t,e)},Hn.prototype.Nullptr=Hn.prototype.Nullptr=function(){var e=this.ptr;return zn(Ne(e),An)},Hn.prototype.InitializeSession=Hn.prototype.InitializeSession=function(e,t,r){var n=this.ptr;return Fn.prepare(),e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r=r&&"object"==typeof r?r.ptr:Nn(r),!!Ae(n,e,t,r)},Hn.prototype.GetCyclesPerSecond=Hn.prototype.GetCyclesPerSecond=function(){var e=this.ptr;return He(e)},Hn.prototype.RunEmulation=Hn.prototype.RunEmulation=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),Te(t,e)},Hn.prototype.SetClockFactor=Hn.prototype.SetClockFactor=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),Be(t,e)},Hn.prototype.CopyFrame=Hn.prototype.CopyFrame=function(){var e=this.ptr;return zn(Le(e),Bn)},Hn.prototype.IsScreenDirty=Hn.prototype.IsScreenDirty=function(){var e=this.ptr;return!!je(e)},Hn.prototype.MarkScreenClean=Hn.prototype.MarkScreenClean=function(){var e=this.ptr;Ue(e)},Hn.prototype.MinMemoryForDevice=Hn.prototype.MinMemoryForDevice=function(e){var t=this.ptr;return Fn.prepare(),e=e&&"object"==typeof e?e.ptr:Nn(e),Oe(t,e)},Hn.prototype.FramebufferSizeForDevice=Hn.prototype.FramebufferSizeForDevice=function(e){var t=this.ptr;return Fn.prepare(),e=e&&"object"==typeof e?e.ptr:Nn(e),We(t,e)},Hn.prototype.TotalMemoryForDevice=Hn.prototype.TotalMemoryForDevice=function(e){var t=this.ptr;return Fn.prepare(),e=e&&"object"==typeof e?e.ptr:Nn(e),Ve(t,e)},Hn.prototype.QueuePenMove=Hn.prototype.QueuePenMove=function(e,t){var r=this.ptr;e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),qe(r,e,t)},Hn.prototype.QueuePenUp=Hn.prototype.QueuePenUp=function(){var e=this.ptr;Ke(e)},Hn.prototype.QueueButtonDown=Hn.prototype.QueueButtonDown=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),Ye(t,e)},Hn.prototype.QueueButtonUp=Hn.prototype.QueueButtonUp=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),Qe(t,e)},Hn.prototype.QueueKeyboardEvent=Hn.prototype.QueueKeyboardEvent=function(e,t){var r=this.ptr;e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),Ze(r,e,t)},Hn.prototype.IsPowerOff=Hn.prototype.IsPowerOff=function(){var e=this.ptr;return!!Xe(e)},Hn.prototype.IsUIInitialized=Hn.prototype.IsUIInitialized=function(){var e=this.ptr;return!!$e(e)},Hn.prototype.GetOSVersion=Hn.prototype.GetOSVersion=function(){var e=this.ptr;return Je(e)},Hn.prototype.IsSetupComplete=Hn.prototype.IsSetupComplete=function(){var e=this.ptr;return!!et(e)},Hn.prototype.Reset=Hn.prototype.Reset=function(){var e=this.ptr;tt(e)},Hn.prototype.ResetNoExtensions=Hn.prototype.ResetNoExtensions=function(){var e=this.ptr;rt(e)},Hn.prototype.ResetHard=Hn.prototype.ResetHard=function(){var e=this.ptr;nt(e)},Hn.prototype.InstallDb=Hn.prototype.InstallDb=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),it(r,e,t)},Hn.prototype.GetPalette2bitMapping=Hn.prototype.GetPalette2bitMapping=function(){var e=this.ptr;return ot(e)},Hn.prototype.GetMemoryPtr=Hn.prototype.GetMemoryPtr=function(){var e=this.ptr;return zn(st(e),An)},Hn.prototype.GetDirtyPagesPtr=Hn.prototype.GetDirtyPagesPtr=function(){var e=this.ptr;return zn(at(e),An)},Hn.prototype.GetMemorySize=Hn.prototype.GetMemorySize=function(){var e=this.ptr;return ut(e)},Hn.prototype.ImportMemoryImage=Hn.prototype.ImportMemoryImage=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),!!ct(r,e,t)},Hn.prototype.GetRomPtr=Hn.prototype.GetRomPtr=function(){var e=this.ptr;return zn(pt(e),An)},Hn.prototype.GetRomSize=Hn.prototype.GetRomSize=function(){var e=this.ptr;return lt(e)},Hn.prototype.GetSavestatePtr=Hn.prototype.GetSavestatePtr=function(){var e=this.ptr;return zn(dt(e),An)},Hn.prototype.GetSavestateSize=Hn.prototype.GetSavestateSize=function(){var e=this.ptr;return ht(e)},Hn.prototype.SaveState=Hn.prototype.SaveState=function(){var e=this.ptr;return!!mt(e)},Hn.prototype.LoadState=Hn.prototype.LoadState=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),!!_t(r,e,t)},Hn.prototype.GetHotsyncName=Hn.prototype.GetHotsyncName=function(){var e=this.ptr;return P(ft(e))},Hn.prototype.SetHotsyncName=Hn.prototype.SetHotsyncName=function(e){var t=this.ptr;Fn.prepare(),e=e&&"object"==typeof e?e.ptr:Nn(e),yt(t,e)},Hn.prototype.RegisterPwmHandler=Hn.prototype.RegisterPwmHandler=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),vt(t,e)},Hn.prototype.StartBackup=Hn.prototype.StartBackup=function(){var e=this.ptr;return zn(gt(e),Ln)},Hn.prototype.SetClipboardIntegration=Hn.prototype.SetClipboardIntegration=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),bt(t,e)},Hn.prototype.GetClipboardIntegration=Hn.prototype.GetClipboardIntegration=function(){var e=this.ptr;return!!wt(e)},Hn.prototype.IsSuspended=Hn.prototype.IsSuspended=function(){var e=this.ptr;return!!St(e)},Hn.prototype.GetSuspendContext=Hn.prototype.GetSuspendContext=function(){var e=this.ptr;return zn(Ct(e),Vn)},Hn.prototype.SetNetworkRedirection=Hn.prototype.SetNetworkRedirection=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),Et(t,e)},Hn.prototype.GetNetworkRedirection=Hn.prototype.GetNetworkRedirection=function(){var e=this.ptr;return!!Dt(e)},Hn.prototype.RegisterProxyDisconnectHandler=Hn.prototype.RegisterProxyDisconnectHandler=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),It(t,e)},Hn.prototype.SetHotsyncNameManagement=Hn.prototype.SetHotsyncNameManagement=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),kt(t,e)},Hn.prototype.LaunchAppByName=Hn.prototype.LaunchAppByName=function(e){var t=this.ptr;return Fn.prepare(),e=e&&"object"==typeof e?e.ptr:Nn(e),!!Mt(t,e)},Hn.prototype.LaunchAppByDbHeader=Hn.prototype.LaunchAppByDbHeader=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),!!Gt(r,e,t)},Hn.prototype.DeviceSupportsCardSize=Hn.prototype.DeviceSupportsCardSize=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),!!xt(t,e)},Hn.prototype.ClearExternalStorage=Hn.prototype.ClearExternalStorage=function(){var e=this.ptr;Pt(e)},Hn.prototype.AllocateCard=Hn.prototype.AllocateCard=function(e,t){var r=this.ptr;return Fn.prepare(),e=e&&"object"==typeof e?e.ptr:Nn(e),t&&"object"==typeof t&&(t=t.ptr),!!Rt(r,e,t)},Hn.prototype.AdoptCard=Hn.prototype.AdoptCard=function(e,t,r){var n=this.ptr;return Fn.prepare(),e=e&&"object"==typeof e?e.ptr:Nn(e),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!zt(n,e,t,r)},Hn.prototype.MountCard=Hn.prototype.MountCard=function(e){var t=this.ptr;return Fn.prepare(),e=e&&"object"==typeof e?e.ptr:Nn(e),!!Ft(t,e)},Hn.prototype.RemoveCard=Hn.prototype.RemoveCard=function(e){var t=this.ptr;return Fn.prepare(),e=e&&"object"==typeof e?e.ptr:Nn(e),!!Nt(t,e)},Hn.prototype.GetCardData=Hn.prototype.GetCardData=function(e){var t=this.ptr;return Fn.prepare(),e=e&&"object"==typeof e?e.ptr:Nn(e),zn(At(t,e),An)},Hn.prototype.GetCardDirtyPages=Hn.prototype.GetCardDirtyPages=function(e){var t=this.ptr;return Fn.prepare(),e=e&&"object"==typeof e?e.ptr:Nn(e),zn(Ht(t,e),An)},Hn.prototype.GetCardSize=Hn.prototype.GetCardSize=function(e){var t=this.ptr;return Fn.prepare(),e=e&&"object"==typeof e?e.ptr:Nn(e),Tt(t,e)},Hn.prototype.RemountCards=Hn.prototype.RemountCards=function(){var e=this.ptr;Bt(e)},Hn.prototype.GetSupportLevel=Hn.prototype.GetSupportLevel=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),Lt(t,e)},Hn.prototype.GetMountedKey=Hn.prototype.GetMountedKey=function(){var e=this.ptr;return P(jt(e))},Hn.prototype.__destroy__=Hn.prototype.__destroy__=function(){var e=this.ptr;Ut(e)},Tn.prototype=Object.create(Pn.prototype),Tn.prototype.constructor=Tn,Tn.prototype.__class__=Tn,Tn.__cache__={},i.RomInfo=Tn,Tn.prototype.IsValid=Tn.prototype.IsValid=function(){var e=this.ptr;return!!Wt(e)},Tn.prototype.CardVersion=Tn.prototype.CardVersion=function(){var e=this.ptr;return Vt(e)},Tn.prototype.CardName=Tn.prototype.CardName=function(){var e=this.ptr;return P(qt(e))},Tn.prototype.RomVersion=Tn.prototype.RomVersion=function(){var e=this.ptr;return Kt(e)},Tn.prototype.RomVersionString=Tn.prototype.RomVersionString=function(){var e=this.ptr;return P(Yt(e))},Tn.prototype.Supports=Tn.prototype.Supports=function(e){var t=this.ptr;return Fn.prepare(),e=e&&"object"==typeof e?e.ptr:Nn(e),!!Qt(t,e)},Tn.prototype.__destroy__=Tn.prototype.__destroy__=function(){var e=this.ptr;Zt(e)},Bn.prototype=Object.create(Pn.prototype),Bn.prototype.constructor=Bn,Bn.prototype.__class__=Bn,Bn.__cache__={},i.Frame=Bn,Bn.prototype.GetLineWidth=Bn.prototype.GetLineWidth=function(){var e=this.ptr;return Xt(e)},Bn.prototype.GetBpp=Bn.prototype.GetBpp=function(){var e=this.ptr;return $t(e)},Bn.prototype.GetLines=Bn.prototype.GetLines=function(){var e=this.ptr;return Jt(e)},Bn.prototype.GetMargin=Bn.prototype.GetMargin=function(){var e=this.ptr;return er(e)},Bn.prototype.GetBytesPerLine=Bn.prototype.GetBytesPerLine=function(){var e=this.ptr;return tr(e)},Bn.prototype.GetFirstDirtyLine=Bn.prototype.GetFirstDirtyLine=function(){var e=this.ptr;return rr(e)},Bn.prototype.GetLastDirtyLine=Bn.prototype.GetLastDirtyLine=function(){var e=this.ptr;return nr(e)},Bn.prototype.GetHasChanges=Bn.prototype.GetHasChanges=function(){var e=this.ptr;return!!ir(e)},Bn.prototype.GetBuffer=Bn.prototype.GetBuffer=function(){var e=this.ptr;return zn(or(e),An)},Bn.prototype.GetBufferSize=Bn.prototype.GetBufferSize=function(){var e=this.ptr;return sr(e)},Bn.prototype.GetScaleX=Bn.prototype.GetScaleX=function(){var e=this.ptr;return ar(e)},Bn.prototype.GetScaleY=Bn.prototype.GetScaleY=function(){var e=this.ptr;return ur(e)},Bn.prototype.__destroy__=Bn.prototype.__destroy__=function(){var e=this.ptr;cr(e)},Ln.prototype=Object.create(Pn.prototype),Ln.prototype.constructor=Ln,Ln.prototype.__class__=Ln,Ln.__cache__={},i.DbBackup=Ln,Ln.prototype.Init=Ln.prototype.Init=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),!!pr(t,e)},Ln.prototype.IsInProgress=Ln.prototype.IsInProgress=function(){var e=this.ptr;return!!lr(e)},Ln.prototype.IsDone=Ln.prototype.IsDone=function(){var e=this.ptr;return!!dr(e)},Ln.prototype.GetCurrentDatabase=Ln.prototype.GetCurrentDatabase=function(){var e=this.ptr;return P(hr(e))},Ln.prototype.Save=Ln.prototype.Save=function(){var e=this.ptr;return!!mr(e)},Ln.prototype.Skip=Ln.prototype.Skip=function(){var e=this.ptr;_r(e)},Ln.prototype.GetArchivePtr=Ln.prototype.GetArchivePtr=function(){var e=this.ptr;return zn(fr(e),An)},Ln.prototype.GetArchiveSize=Ln.prototype.GetArchiveSize=function(){var e=this.ptr;return yr(e)},Ln.prototype.__destroy__=Ln.prototype.__destroy__=function(){var e=this.ptr;vr(e)},jn.prototype=Object.create(Pn.prototype),jn.prototype.constructor=jn,jn.prototype.__class__=jn,jn.__cache__={},i.SuspendContextClipboardCopy=jn,jn.prototype.Cancel=jn.prototype.Cancel=function(){var e=this.ptr;gr(e)},jn.prototype.Resume=jn.prototype.Resume=function(){var e=this.ptr;br(e)},jn.prototype.GetClipboardContent=jn.prototype.GetClipboardContent=function(){var e=this.ptr;return P(wr(e))},jn.prototype.__destroy__=jn.prototype.__destroy__=function(){var e=this.ptr;Sr(e)},Un.prototype=Object.create(Pn.prototype),Un.prototype.constructor=Un,Un.prototype.__class__=Un,Un.__cache__={},i.SuspendContextClipboardPaste=Un,Un.prototype.Cancel=Un.prototype.Cancel=function(){var e=this.ptr;Cr(e)},Un.prototype.Resume=Un.prototype.Resume=function(e){var t=this.ptr;Fn.prepare(),e=e&&"object"==typeof e?e.ptr:Nn(e),Er(t,e)},Un.prototype.__destroy__=Un.prototype.__destroy__=function(){var e=this.ptr;Dr(e)},On.prototype=Object.create(Pn.prototype),On.prototype.constructor=On,On.prototype.__class__=On,On.__cache__={},i.SuspendContextNetworkConnect=On,On.prototype.Cancel=On.prototype.Cancel=function(){var e=this.ptr;Ir(e)},On.prototype.Resume=On.prototype.Resume=function(e){var t=this.ptr;Fn.prepare(),e=e&&"object"==typeof e?e.ptr:Nn(e),kr(t,e)},On.prototype.__destroy__=On.prototype.__destroy__=function(){var e=this.ptr;Mr(e)},Wn.prototype=Object.create(Pn.prototype),Wn.prototype.constructor=Wn,Wn.prototype.__class__=Wn,Wn.__cache__={},i.SuspendContextNetworkRpc=Wn,Wn.prototype.Cancel=Wn.prototype.Cancel=function(){var e=this.ptr;Gr(e)},Wn.prototype.GetRequestSize=Wn.prototype.GetRequestSize=function(){var e=this.ptr;return xr(e)},Wn.prototype.GetRequestData=Wn.prototype.GetRequestData=function(){var e=this.ptr;return zn(Pr(e),An)},Wn.prototype.ReceiveResponse=Wn.prototype.ReceiveResponse=function(e,t){var r=this.ptr;e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),Rr(r,e,t)},Wn.prototype.__destroy__=Wn.prototype.__destroy__=function(){var e=this.ptr;zr(e)},Vn.prototype=Object.create(Pn.prototype),Vn.prototype.constructor=Vn,Vn.prototype.__class__=Vn,Vn.__cache__={},i.SuspendContext=Vn,Vn.prototype.GetKind=Vn.prototype.GetKind=function(){var e=this.ptr;return Fr(e)},Vn.prototype.Cancel=Vn.prototype.Cancel=function(){var e=this.ptr;Nr(e)},Vn.prototype.AsContextClipboardCopy=Vn.prototype.AsContextClipboardCopy=function(){var e=this.ptr;return zn(Ar(e),jn)},Vn.prototype.AsContextClipboardPaste=Vn.prototype.AsContextClipboardPaste=function(){var e=this.ptr;return zn(Hr(e),Un)},Vn.prototype.AsContextNetworkConnect=Vn.prototype.AsContextNetworkConnect=function(){var e=this.ptr;return zn(Tr(e),On)},Vn.prototype.AsContextNetworkRpc=Vn.prototype.AsContextNetworkRpc=function(){var e=this.ptr;return zn(Br(e),Wn)},Vn.prototype.__destroy__=Vn.prototype.__destroy__=function(){var e=this.ptr;Lr(e)},qn.prototype=Object.create(Pn.prototype),qn.prototype.constructor=qn,qn.prototype.__class__=qn,qn.__cache__={},i.ZipfileWalker=qn,qn.prototype.GetState=qn.prototype.GetState=function(){var e=this.ptr;return Ur(e)},qn.prototype.Next=qn.prototype.Next=function(){var e=this.ptr;return Or(e)},qn.prototype.GetCurrentEntrySize=qn.prototype.GetCurrentEntrySize=function(){var e=this.ptr;return Wr(e)},qn.prototype.GetCurrentEntryName=qn.prototype.GetCurrentEntryName=function(){var e=this.ptr;return P(Vr(e))},qn.prototype.GetCurrentEntryContent=qn.prototype.GetCurrentEntryContent=function(){var e=this.ptr;return zn(qr(e),An)},qn.prototype.__destroy__=qn.prototype.__destroy__=function(){var e=this.ptr;Kr(e)},Kn.prototype=Object.create(Pn.prototype),Kn.prototype.constructor=Kn,Kn.prototype.__class__=Kn,Kn.__cache__={},i.SessionImage=Kn,Kn.prototype.GetDeviceId=Kn.prototype.GetDeviceId=function(){var e=this.ptr;return P(Qr(e))},Kn.prototype.SetDeviceId=Kn.prototype.SetDeviceId=function(e){var t=this.ptr;return Fn.prepare(),e=e&&"object"==typeof e?e.ptr:Nn(e),zn(Zr(t,e),Kn)},Kn.prototype.GetRomImage=Kn.prototype.GetRomImage=function(){var e=this.ptr;return zn(Xr(e),An)},Kn.prototype.GetRomImageSize=Kn.prototype.GetRomImageSize=function(){var e=this.ptr;return $r(e)},Kn.prototype.SetRomImage=Kn.prototype.SetRomImage=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),zn(Jr(r,e,t),Kn)},Kn.prototype.GetMemoryImage=Kn.prototype.GetMemoryImage=function(){var e=this.ptr;return zn(en(e),An)},Kn.prototype.GetMemoryImageSize=Kn.prototype.GetMemoryImageSize=function(){var e=this.ptr;return tn(e)},Kn.prototype.SetMemoryImage=Kn.prototype.SetMemoryImage=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),zn(rn(r,e,t),Kn)},Kn.prototype.GetMetadata=Kn.prototype.GetMetadata=function(){var e=this.ptr;return zn(nn(e),An)},Kn.prototype.GetMetadataSize=Kn.prototype.GetMetadataSize=function(){var e=this.ptr;return on(e)},Kn.prototype.SetMetadata=Kn.prototype.SetMetadata=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),zn(sn(r,e,t),Kn)},Kn.prototype.GetSavestate=Kn.prototype.GetSavestate=function(){var e=this.ptr;return zn(an(e),An)},Kn.prototype.GetSavestateSize=Kn.prototype.GetSavestateSize=function(){var e=this.ptr;return un(e)},Kn.prototype.SetSavestate=Kn.prototype.SetSavestate=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),zn(cn(r,e,t),Kn)},Kn.prototype.GetVersion=Kn.prototype.GetVersion=function(){var e=this.ptr;return pn(e)},Kn.prototype.Serialize=Kn.prototype.Serialize=function(){var e=this.ptr;return!!ln(e)},Kn.prototype.GetSerializedImage=Kn.prototype.GetSerializedImage=function(){var e=this.ptr;return zn(dn(e),An)},Kn.prototype.GetSerializedImageSize=Kn.prototype.GetSerializedImageSize=function(){var e=this.ptr;return hn(e)},Kn.prototype.Deserialize=Kn.prototype.Deserialize=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),!!mn(r,e,t)},Kn.prototype.__destroy__=Kn.prototype.__destroy__=function(){var e=this.ptr;_n(e)},Yn.prototype=Object.create(Pn.prototype),Yn.prototype.constructor=Yn,Yn.prototype.__class__=Yn,Yn.__cache__={},i.SkinLoader=Yn,Yn.prototype.GetData=Yn.prototype.GetData=function(){var e=this.ptr;return zn(yn(e),An)},Yn.prototype.GetSize=Yn.prototype.GetSize=function(){var e=this.ptr;return vn(e)},Yn.prototype.__destroy__=Yn.prototype.__destroy__=function(){var e=this.ptr;gn(e)},Qn.prototype=Object.create(Pn.prototype),Qn.prototype.constructor=Qn,Qn.prototype.__class__=Qn,Qn.__cache__={},i.GunzipContext=Qn,Qn.prototype.GetState=Qn.prototype.GetState=function(){var e=this.ptr;return wn(e)},Qn.prototype.Continue=Qn.prototype.Continue=function(){var e=this.ptr;return Sn(e)},Qn.prototype.GetUncompressedData=Qn.prototype.GetUncompressedData=function(){var e=this.ptr;return zn(Cn(e),An)},Qn.prototype.ReleaseUncompressedData=Qn.prototype.ReleaseUncompressedData=function(){var e=this.ptr;return zn(En(e),An)},Qn.prototype.GetUncompressedSize=Qn.prototype.GetUncompressedSize=function(){var e=this.ptr;return Dn(e)},Qn.prototype.GetError=Qn.prototype.GetError=function(){var e=this.ptr;return P(In(e))},Qn.prototype.__destroy__=Qn.prototype.__destroy__=function(){var e=this.ptr;kn(e)},e.ready});e.exports=r},650:function(e,t){!function(e){"use strict";var t,r=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,n=536870912,i=1073741824,o=new WeakMap,s=function(e,t){return function(o){var s=t.get(o),a=void 0===s?o.size:s<i?s+1:0;if(!o.has(a))return e(o,a);if(o.size<n){for(;o.has(a);)a=Math.floor(Math.random()*i);return e(o,a)}if(o.size>r)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;o.has(a);)a=Math.floor(Math.random()*r);return e(o,a)}}((t=o,function(e,r){return t.set(e,r),r}),o),a=function(e){return function(t){var r=e(t);return t.add(r),r}}(s);e.addUniqueNumber=a,e.generateUniqueNumber=s}(t)},37:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=[];r[0]=function(){return function(){}},r[1]=function(e,t){return void 0===t?e:function(r){e(r,t)}};var n=function(){function e(){this.hasHandlers=!1,this._handlers=[],this._contexts=[],this._createDispatcher()}return e.prototype.addHandler=function(e,t){return this.isHandlerAttached(e,t)||(this._handlers.push(e),this._contexts.push(t),this._createDispatcher(),this._updateHasHandlers()),this},e.prototype.removeHandler=function(e,t){var r=this._getHandlerIndex(e,t);return void 0!==r&&(this._handlers.splice(r,1),this._contexts.splice(r,1),this._createDispatcher(),this._updateHasHandlers()),this},e.prototype.isHandlerAttached=function(e,t){return void 0!==this._getHandlerIndex(e,t)},e.prototype._updateHasHandlers=function(){this.hasHandlers=!!this._handlers.length},e.prototype._getHandlerIndex=function(e,t){var r,n=this._handlers.length;for(r=0;r<n&&(this._handlers[r]!==e||this._contexts[r]!==t);r++);return r<n?r:void 0},e.prototype._createDispatcher=function(){var e;this.dispatch=(e=this._handlers.length,r[e]||(r[e]=function(e){for(var t="return function dispatcher"+e+"(payload) {\n",r=[],n=[],i=0;i<e;i++)r.push("cb"+i),n.push("ctx"+i),t+="    cb"+i+"(payload, ctx"+i+");\n";return t+="};",new(Function.bind.apply(Function,[void 0].concat(r.concat(n),[t])))}(e)),r[e]).apply(this,this._handlers.concat(this._contexts))},e}();t.default=n},819:(e,t,r)=>{"use strict";var n=r(37);t.j=n.default}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return(()=>{"use strict";function e(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s}function t(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))}var i,o,s;r.r(n),r.d(n,{Button:()=>ie,DeviceId:()=>i,DeviceOrientation:()=>o,VERSION:()=>oe,createEmulator:()=>se}),Object.create,Object.create,(s=i||(i={})).palmPilot="PalmPilot",s.pilot="Pilot",s.iii="PalmIII",s.palmVx="PalmVx",s.palmV="PalmV",s.palmVII="PalmVII",s.palmVIIEZ="PalmVIIEZ",s.palmVIIx="PalmVIIx",s.iiic="PalmIIIc",s.iiix="PalmIIIx",s.iiixe="PalmIIIxe",s.iiie="PalmIIIe",s.m500="PalmM500",s.m505="PalmM505",s.m515="PalmM515",s.m520="PalmM520",s.m100="PalmM100",s.m105="PalmM105",s.m125="PalmM125",s.m130="PalmM130",s.i705="Palmi705",s.i710="PalmI710",s.handera330="HandEra330",s.handera330c="HandEra330c",s.pegS300="PEG-S300",s.pegS320="PEG-S320",s.pegS500c="PEG-S500C",s.pegT400="PEG-T400",s.pegN600c="PEG-N600C/N610C",s.pegT600c="PEG-T600",s.pegN700c="PEG-N700C/N710C",s.pegT650c="YSX1230",s.pegNR70="NR70",s.acerS11="Acer-S11",function(e){e.portrait="portrait",e.landscape90="landscape90",e.landscape270="landscape270",e.portrait180="portrait180"}(o||(o={})),new Error("timeout while waiting for mutex to become available"),new Error("mutex already locked");const a=new Error("request for lock canceled");class u{constructor(e,t=a){this._value=e,this._cancelError=t,this._weightedQueues=[],this._weightedWaiters=[]}acquire(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise(((t,r)=>{this._weightedQueues[e-1]||(this._weightedQueues[e-1]=[]),this._weightedQueues[e-1].push({resolve:t,reject:r}),this._dispatch()}))}runExclusive(e,t=1){return r=this,n=void 0,o=function*(){const[r,n]=yield this.acquire(t);try{return yield e(r)}finally{n()}},new((i=void 0)||(i=Promise))((function(e,t){function s(e){try{u(o.next(e))}catch(e){t(e)}}function a(e){try{u(o.throw(e))}catch(e){t(e)}}function u(t){var r;t.done?e(t.value):(r=t.value,r instanceof i?r:new i((function(e){e(r)}))).then(s,a)}u((o=o.apply(r,n||[])).next())}));var r,n,i,o}waitForUnlock(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise((t=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),this._weightedWaiters[e-1].push(t),this._dispatch()}))}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatch()}release(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatch()}cancel(){this._weightedQueues.forEach((e=>e.forEach((e=>e.reject(this._cancelError))))),this._weightedQueues=[]}_dispatch(){var e;for(let t=this._value;t>0;t--){const r=null===(e=this._weightedQueues[t-1])||void 0===e?void 0:e.shift();if(!r)continue;const n=this._value,i=t;this._value-=t,t=this._value+1,r.resolve([n,this._newReleaser(i)])}this._drainUnlockWaiters()}_newReleaser(e){let t=!1;return()=>{t||(t=!0,this.release(e))}}_drainUnlockWaiters(){for(let e=this._value;e>0;e--)this._weightedWaiters[e-1]&&(this._weightedWaiters[e-1].forEach((e=>e())),this._weightedWaiters[e-1]=[])}}class c{constructor(e){this._semaphore=new u(1,e)}acquire(){return e=this,t=void 0,n=function*(){const[,e]=yield this._semaphore.acquire();return e},new((r=void 0)||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}));var e,t,r,n}runExclusive(e){return this._semaphore.runExclusive((()=>e()))}isLocked(){return this._semaphore.isLocked()}waitForUnlock(){return this._semaphore.waitForUnlock()}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}}const p="safari"in window,l=(navigator.userAgent.match(/(crios)|(fxios)/i),!!navigator.platform.match(/iPhone|iPad|iPod/)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1),d=(navigator.userAgent.match(/android/i),navigator.userAgent.toLowerCase().indexOf("firefox"),window.AudioContext||window.webkitAudioContext);function h(e,t=100){return new Promise(((r,n)=>{setTimeout((()=>n(new Error("timeout"))),t),e.then(r,n)}))}class m{constructor(e){this.emulationService=e,this.initialize=()=>this.mutex.runExclusive((()=>t(this,void 0,void 0,(function*(){if(!this.initialized){try{this.context=new d}catch(e){return console.error(e),void console.error("web audio not available")}try{this.context.destination.channelCount=1}catch(e){console.warn("audio driver: failed to set channel count")}try{yield this.start()}catch(e){return console.error(e),void console.error("failed to initialize audio context")}this.context.addEventListener("statechange",(()=>{var e;"interrupted"===(null===(e=this.context)||void 0===e?void 0:e.state)&&this.updateState()})),this.gainNode=this.context.createGain(),this.gainNode.channelCount=1,this.gainNode.channelInterpretation="speakers",this.gainNode.gain.value=this.gain(),this.gainNode.connect(this.context.destination),this.applyPwmUpdate(),this.initialized=!0}})))),this.updateState=(e=!1)=>this.mutex.runExclusive((()=>t(this,void 0,void 0,(function*(){if(!this.context)return;if(this.isRunning()===this.shouldRun())return;e||this.isRunning()||!this.shouldRun()||this.applyPwmUpdate();const t=this.context.state;if(this.shouldRun())try{this.updateGain(),yield h(this.context.resume()),console.log("resume audio context")}catch(e){console.error(`failed to resume audio from state ${t}`)}else try{yield h(this.context.suspend()),console.log("suspend audio context")}catch(e){console.error(`failed to suspend audio from state ${t}`)}console.log(`audio context state change ${t} -> ${this.context.state}`)})))),this.onPwmUpdate=e=>t(this,void 0,void 0,(function*(){this.pendingPwmUpdate=e,this.initialized&&(this.shouldRun()!==this.isRunning()&&this.updateState(!0),this.shouldRun()&&this.applyPwmUpdate())})),this.mutex=new c,this.initialized=!1,this.muted=!1,this.emulationService.pwmUpdateEvent.addHandler(this.onPwmUpdate),this.emulationService.emulationStateChangeEvent.addHandler((()=>this.updateState())),this.emulationService.powerOffChangeEvent.addHandler((()=>this.updateState())),l||document.addEventListener("visibilitychange",(()=>this.updateState()))}isInitialized(){return this.initialized}mute(e){this.muted=e,this.updateState()}isMuted(){return this.muted}shouldRun(){return this.emulationService.isRunning()&&!this.emulationService.isPowerOff()&&!this.muted&&this.gain()>0&&("hidden"!==document.visibilityState||l||this.runHidden())}updateGain(){this.gainNode&&(this.gainNode.gain.value=this.gain())}start(){return t(this,void 0,void 0,(function*(){this.context&&(yield h(this.context.resume()),this.updateState(),console.log("audio context initialized"))}))}isRunning(){var e;return"running"===(null===(e=this.context)||void 0===e?void 0:e.state)}applyPwmUpdate(){if(!this.context||!this.pendingPwmUpdate)return;const{frequency:e,dutyCycle:t}=this.pendingPwmUpdate,r=this.context.sampleRate;if(this.pendingPwmUpdate=void 0,e<=0||t<=0||e>=r)return void this.disconnectSource();const n=this.context.createBuffer(1,Math.round(r/e),r),i=n.getChannelData(0);for(let e=0;e<i.length;e++)i[e]=e/i.length<t?1:0;const o=this.context.createBufferSource();o.channelCount=1,o.channelInterpretation="speakers",o.loop=!0,o.buffer=n,this.disconnectSource(),o.connect(this.gainNode),o.start(),this.bufferSourceNode=o,this.pendingPwmUpdate=void 0}disconnectSource(){this.bufferSourceNode&&(this.bufferSourceNode.stop(),this.bufferSourceNode.disconnect(),this.bufferSourceNode=void 0)}gain(){return this.getVolume()/2}}class _ extends m{constructor(){super(...arguments),this.volume=.5}setVolume(e){this.volume=Math.max(Math.min(e,1),0),this.updateGain()}getVolume(){return this.volume}runHidden(){return!1}}function f(e,r){let n,i;const o=document.createElement("canvas");return(s,a)=>t(this,void 0,void 0,(function*(){if(n===s&&i===a)return o;o.width=s,o.height=a;const t=o.getContext("2d");if(!t)throw new Error("get a new browser");return t.drawImage(yield e,0,0,o.width,o.height),(p||l)&&(yield r).indexOf("data:image")>=0&&(yield new Promise((e=>setTimeout(e,0))),t.drawImage(yield e,0,0,o.width,o.height)),n=s,i=a,o}))}function y(e){return new Promise(((t,r)=>{const n=new Image;n.onload=()=>t(n),n.onerror=()=>r(),n.src=e}))}const v=e=>`data:image/svg+xml;base64,${btoa(e)}`;var g,b;function w(e){switch(e){case i.i710:case i.m520:return{screenSize:1,width:320,height:320,silkscreenHeight:120};case i.handera330:case i.handera330c:return{screenSize:2,width:240,height:320,silkscreenHeight:0};case i.pegS300:case i.pegS320:case i.pegS500c:return{screenSize:0,width:160,height:160,silkscreenHeight:76};case i.pegT600c:case i.pegT400:case i.pegT650c:return{screenSize:1,width:320,height:320,silkscreenHeight:140,silkscreenOvershoot:10};case i.pegN600c:case i.pegN700c:return{screenSize:1,width:320,height:320,silkscreenHeight:120};case i.pegNR70:return{screenSize:3,width:320,height:480,silkscreenHeight:0};case i.acerS11:return{screenSize:0,width:160,height:160,silkscreenHeight:60,siklscreenShift:8};default:return{screenSize:0,width:160,height:160,silkscreenHeight:60}}}function S(e){switch(e){case i.pilot:case i.palmPilot:case i.iii:case i.palmV:case i.palmVx:case i.iiix:case i.iiixe:case i.iiie:case i.m100:case i.m105:case i.m125:case i.m500:case i.palmVII:case i.palmVIIEZ:case i.palmVIIx:case i.i705:case i.handera330:case i.pegS300:case i.pegS320:case i.pegT400:case i.acerS11:return!1;default:return!0}}(b=g||(g={})).sdcard="sdcard",b.memorystick="memorystick",b.none="none";var C=r(819);const E=[135,135,105],D=[0,0,0],I=new Array(16).fill(0).map(((e,t)=>D.map(((e,r)=>Math.floor((t*e+(15-t)*E[r])/15))))).map((([e,t,r])=>4278190080|r<<16|t<<8|e)),k=I.map((e=>{var t;return"#"+(null===(t=(16777215&e).toString(16).padStart(6,"0").match(/(..?)/g))||void 0===t?void 0:t.reverse().join(""))})),M=i.m515,G=k[2],x=k[0],P="rgba(0,0,0,0.2)";function R(e){const t=w(e),r=(0===t.screenSize?3:2)*devicePixelRatio,n={frameDevice:1,frameCanvas:r},i=e=>({frameDevice:e,frameCanvas:e*r}),o=e=>({frameDevice:e,frameCanvas:n.frameCanvas+e*r}),s=t.silkscreenHeight>0?i(1):i(0),a=i(function(e){switch(e){case 3:case 1:return 60;case 2:return 45;default:return 30}}(t.screenSize));return{scale:r,borderWidth:n,height:i(2*n.frameDevice+t.height+s.frameDevice+t.silkscreenHeight+a.frameDevice),width:i(2*n.frameDevice+t.width),screenHeight:i(t.height),screenWidth:i(t.width),screenLeft:o(0),screenTop:o(0),screenBottom:o(t.height),separatorHeight:s,silkscreenHeight:i(t.silkscreenHeight),silkscreenTop:o(t.height+s.frameDevice),silkscreenBottom:o(t.height+s.frameDevice+t.silkscreenHeight),softSilkscreenHeight:i(t.silkscreenHeight>0?0:t.height-t.width),buttonHeight:a,buttonWidth:a,buttonTop:o(t.height+s.frameDevice+t.silkscreenHeight),buttonBottom:o(t.height+s.frameDevice+t.silkscreenHeight+a.frameDevice)}}class z{constructor(e){this.skinLoader=e,this.layout=R(M),this.onResize=new C.j}get width(){switch(this.getOrientation()){case o.portrait:case o.portrait180:case void 0:return this.layout.width.frameCanvas;default:return this.layout.height.frameCanvas}}get height(){switch(this.getOrientation()){case o.portrait:case o.portrait180:case void 0:return this.layout.height.frameCanvas;default:return this.layout.width.frameCanvas}}updateEmulationCanvas(e){this.drawEmulationCanvas(e),this.onAfterUpdateCanvas()}eventToPalmCoordinates(e,t=!1){if(!this.ctx)return;const r=this.ctx.canvas.getBoundingClientRect();let n,i,s,a;r.width/r.height>this.width/this.height?(a=r.height,s=this.width/this.height*r.height,i=r.top,n=r.left+(r.width-s)/2):(s=r.width,a=this.height/this.width*r.width,n=r.left,i=r.top+(r.height-a)/2);let u=(e.clientX-n)/s*this.width/this.layout.scale,c=(e.clientY-i)/a*this.height/this.layout.scale;switch(this.getOrientation()){case o.landscape90:{const e=c;c=this.layout.height.frameDevice-u,u=e;break}case o.landscape270:{const e=c;c=u,u=this.layout.width.frameDevice-e;break}case o.portrait180:u=this.layout.width.frameDevice-u,c=this.layout.height.frameDevice-c}u-=this.layout.borderWidth.frameDevice,c-=this.layout.borderWidth.frameDevice,c>=this.layout.screenHeight.frameDevice&&(c<=this.layout.screenHeight.frameDevice+this.layout.separatorHeight.frameDevice?c=this.layout.screenHeight.frameDevice:c-=this.layout.separatorHeight.frameDevice);const p=this.layout.screenHeight.frameDevice+this.layout.silkscreenHeight.frameDevice+this.layout.buttonHeight.frameDevice;if(t)u<0&&(u=0),u>=this.layout.screenWidth.frameDevice&&(u=this.layout.screenWidth.frameDevice-1),c<0&&(c=0),c>=p&&(c=p-1);else if(u<0||u>=this.layout.screenWidth.frameDevice||c<0||c>=p)return;return[u,c]}isSilkscreen(e){const[,t]=e;return!this.isButtons(e)&&t>=this.layout.screenHeight.frameDevice}isButtons([,e]){return e>=this.layout.screenHeight.frameDevice+this.layout.silkscreenHeight.frameDevice}determineButton([e,t]){return e>=this.layout.screenWidth.frameDevice-this.layout.buttonWidth.frameDevice?3:e>=this.layout.screenWidth.frameDevice-2*this.layout.buttonWidth.frameDevice?2:e>=2*this.layout.buttonWidth.frameDevice?t>=this.layout.screenHeight.frameDevice+this.layout.silkscreenHeight.frameDevice+this.layout.buttonHeight.frameDevice/2?5:4:e>=this.layout.buttonWidth.frameDevice?1:0}initWithCanvas(e){var r;return void 0===e&&(e=null===(r=this.ctx)||void 0===r?void 0:r.canvas),t(this,void 0,void 0,(function*(){if(!e)return;this.layout=R(this.getDeviceId()),this.onResize.dispatch(),e.width=this.width,e.height=this.height;const t=e.getContext("2d");if(!t)throw new Error("canvas not supported - get a new browser");this.ctx=t,this.setupTransformation(),this.fillCanvasRect(0,0,this.layout.width.frameCanvas,this.layout.height.frameCanvas,this.frameColor()),this.fillRect(0,0,this.layout.screenWidth.frameDevice,this.layout.screenHeight.frameDevice+this.layout.silkscreenHeight.frameDevice+this.layout.separatorHeight.frameDevice+this.layout.buttonHeight.frameDevice,this.backgroundColor()),this.drawEmulationCanvas(),yield Promise.all([this.drawSilkscreen(),this.drawButtons()])}))}drawButtons(e=[]){return t(this,void 0,void 0,(function*(){this.ctx&&(this.setupTransformation(),this.ctx.imageSmoothingEnabled=!0,this.ctx.imageSmoothingQuality="high",this.ctx.drawImage(yield this.buttonsImage()(this.layout.screenWidth.frameCanvas,this.layout.buttonHeight.frameCanvas),this.layout.screenLeft.frameCanvas,this.layout.buttonTop.frameCanvas,this.layout.screenWidth.frameCanvas,this.layout.buttonHeight.frameCanvas),e.includes(0)&&this.fillRect(0,this.layout.buttonTop.frameDevice,this.layout.buttonWidth.frameDevice,this.layout.buttonHeight.frameDevice,P),e.includes(1)&&this.fillRect(this.layout.buttonWidth.frameDevice,this.layout.buttonTop.frameDevice,this.layout.buttonWidth.frameDevice,this.layout.buttonHeight.frameDevice,P),e.includes(2)&&this.fillRect(this.layout.screenWidth.frameDevice-2*this.layout.buttonWidth.frameDevice,this.layout.buttonTop.frameDevice,this.layout.buttonWidth.frameDevice,this.layout.buttonHeight.frameDevice,P),e.includes(3)&&this.fillRect(this.layout.screenWidth.frameDevice-this.layout.buttonWidth.frameDevice,this.layout.buttonTop.frameDevice,this.layout.buttonWidth.frameDevice,this.layout.buttonHeight.frameDevice,P),e.includes(4)&&this.fillRect(2*this.layout.buttonWidth.frameDevice,this.layout.buttonTop.frameDevice,this.layout.screenWidth.frameDevice-4*this.layout.buttonWidth.frameDevice,this.layout.buttonHeight.frameDevice/2,P),e.includes(5)&&this.fillRect(2*this.layout.buttonWidth.frameDevice,this.layout.buttonTop.frameDevice+this.layout.buttonHeight.frameDevice/2,this.layout.screenWidth.frameDevice-4*this.layout.buttonWidth.frameDevice,this.layout.buttonHeight.frameDevice/2,P))}))}onAfterUpdateCanvas(){}setupTransformation(){var e;if(this.ctx)switch(null===(e=this.ctx)||void 0===e||e.resetTransform(),this.getOrientation()){case o.portrait:case void 0:break;case o.landscape90:this.ctx.translate(this.layout.height.frameCanvas,0),this.ctx.rotate(Math.PI/2);break;case o.landscape270:this.ctx.translate(0,this.layout.width.frameCanvas),this.ctx.rotate(3*Math.PI/2);break;case o.portrait180:this.ctx.translate(this.layout.width.frameCanvas,this.layout.height.frameCanvas),this.ctx.rotate(Math.PI)}}drawSilkscreen(){return t(this,void 0,void 0,(function*(){0!==this.layout.silkscreenHeight.frameCanvas&&this.ctx&&(this.setupTransformation(),this.fillRect(this.layout.screenLeft.frameDevice,this.layout.silkscreenTop.frameDevice,this.layout.screenWidth.frameDevice,this.layout.silkscreenHeight.frameDevice,G),this.ctx.imageSmoothingEnabled=!0,this.ctx.imageSmoothingQuality="high",this.ctx.drawImage(yield this.silkscreenImage()(this.layout.screenWidth.frameCanvas,this.layout.silkscreenHeight.frameCanvas),this.layout.borderWidth.frameCanvas,this.layout.silkscreenTop.frameCanvas,this.layout.screenWidth.frameCanvas,this.layout.silkscreenHeight.frameCanvas))}))}drawEmulationCanvas(e=this.lastEmulationCanvas){e&&this.ctx&&(this.lastEmulationCanvas=e,this.ctx.imageSmoothingEnabled=!1,this.ctx.drawImage(e,this.layout.screenLeft.frameCanvas,this.layout.screenTop.frameCanvas,this.layout.screenWidth.frameCanvas,this.layout.screenHeight.frameCanvas))}fillRect(e,t,r,n,i){this.ctx&&(this.ctx.beginPath(),this.ctx.rect(this.layout.borderWidth.frameCanvas+this.layout.scale*e,this.layout.borderWidth.frameCanvas+this.layout.scale*t,this.layout.scale*r,this.layout.scale*n),this.ctx.fillStyle=i,this.ctx.fill())}fillCanvasRect(e,t,r,n,i){this.ctx&&(this.ctx.beginPath(),this.ctx.rect(e,t,r,n),this.ctx.fillStyle=i,this.ctx.fill())}silkscreenImage(){return this.skinLoader.loadSkinElement(this.silkscreenSkinElement())}silkscreenSkinElement(){switch(this.getDeviceId()){case i.pegT600c:case i.pegT650c:return"silkscreen/clie-t600.svg";case i.pegN700c:case i.pegN600c:return"silkscreen/clie-n610.svg";case i.pegS320:case i.pegS300:return"silkscreen/clie-s300.svg";case i.pegS500c:return"silkscreen/clie-s500.svg";case i.pegT400:return"silkscreen/clie-t415.svg";case i.acerS11:return"silkscreen/acer-s10.svg";case i.palmPilot:case i.pilot:case i.iii:case i.palmVII:return"silkscreen/pilot.svg";case i.m500:return"silkscreen/m500.svg";case i.m505:case i.m515:case i.m520:return"silkscreen/m515.svg";case i.iiic:return"silkscreen/iiic.svg";case i.m100:case i.m105:case i.m125:return"silkscreen/m100.svg";case i.m130:return"silkscreen/m130.svg";case i.i710:return"silkscreen/tungstenw.svg";case i.i705:return"silkscreen/i705.svg";case i.iiic:case i.iiix:case i.iiixe:case i.palmVx:case i.palmV:case i.palmVIIEZ:case i.palmVIIx:default:return"silkscreen/v.svg"}}buttonsImage(){return this.skinLoader.loadSkinElement(this.buttonsSkinElement())}buttonsSkinElement(){switch(this.getDeviceId()){case i.acerS11:return"hard-buttons/acer-s10.svg";case i.pegNR70:return"hard-buttons/clie-nr70.svg";case i.pegN700c:return"hard-buttons/clie-n700.svg";case i.pegN600c:return"hard-buttons/clie-n610.svg";case i.pegS300:return"hard-buttons/clie-s300.svg";case i.pegS500c:return"hard-buttons/clie-s500.svg";case i.pegS320:return"hard-buttons/clie-s320.svg";case i.pegT400:case i.pegT600c:case i.pegT650c:return"hard-buttons/clie-t415.svg";case i.pilot:case i.palmPilot:return"hard-buttons/pilot.svg";case i.m500:return"hard-buttons/m500.svg";case i.m505:case i.m515:case i.m520:return"hard-buttons/m515.svg";case i.iiic:return"hard-buttons/iiic.svg";case i.m100:case i.m105:return"hard-buttons/m100.svg";case i.m125:return"hard-buttons/m125.svg";case i.m130:return"hard-buttons/m130.svg";case i.i710:return"hard-buttons/tungstenw.svg";case i.iii:case i.iiix:case i.iiixe:case i.palmVII:case i.palmVIIEZ:case i.palmVIIx:return"hard-buttons/iiix.svg";case i.iiie:return"hard-buttons/iiie.svg";case i.i705:return"hard-buttons/i705.svg";case i.handera330:return"hard-buttons/handera330.svg";case i.handera330c:return"hard-buttons/handera330c.svg";case i.palmVx:case i.palmV:default:return"hard-buttons/v.svg"}}backgroundColor(){return S(this.getDeviceId())?"white":x}frameColor(){return S(this.getDeviceId())?"white":"#ccc"}}const F='<svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><title>Game Controller</title><path d="M467.51 248.83c-18.4-83.18-45.69-136.24-89.43-149.17A91.5 91.5 0 00352 96c-26.89 0-48.11 16-96 16s-69.15-16-96-16a99.09 99.09 0 00-27.2 3.66C89 112.59 61.94 165.7 43.33 248.83c-19 84.91-15.56 152 21.58 164.88 26 9 49.25-9.61 71.27-37 25-31.2 55.79-40.8 119.82-40.8s93.62 9.6 118.66 40.8c22 27.41 46.11 45.79 71.42 37.16 41.02-14.01 40.44-79.13 21.43-165.04z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"/><circle cx="292" cy="224" r="20"/><path d="M336 288a20 20 0 1120-19.95A20 20 0 01336 288z"/><circle cx="336" cy="180" r="20"/><circle cx="380" cy="224" r="20"/><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M160 176v96M208 224h-96"/></svg>',N=f(y(v(F)),F);class A extends z{constructor(){super(...arguments),this.deviceId=i.m515,this.orientation=o.portrait,this.gameModeIndicatorEnabled=!0,this.gameModeActive=!1,this.lastActiveButtons=void 0}initialize(e,r=this.deviceId,n=this.orientation){var i;return t(this,void 0,void 0,(function*(){this.deviceId=r,this.orientation=n;const t=e||(null===(i=this.ctx)||void 0===i?void 0:i.canvas);t&&(t.width=this.width,t.height=this.height,t.style.objectFit="contain"),yield this.initWithCanvas(e)}))}updateOrientation(e){this.orientation=e,this.initialize()}toggleGameModeIndicator(e){this.gameModeActive=e,this.drawButtons(this.lastActiveButtons)}setGameModeIndicatorEnabled(e){this.gameModeIndicatorEnabled=e,this.drawButtons(this.lastActiveButtons)}isGameModeIndicatorEnabled(){return this.gameModeIndicatorEnabled}getCanvas(){var e;return null===(e=this.ctx)||void 0===e?void 0:e.canvas}drawButtons(e=[]){const r=Object.create(null,{drawButtons:{get:()=>super.drawButtons}});return t(this,void 0,void 0,(function*(){this.lastActiveButtons=e,yield r.drawButtons.call(this,e),this.gameModeActive&&this.gameModeIndicatorEnabled&&(yield this.drawGameModeIndicator())}))}getDeviceId(){return this.deviceId}getOrientation(){return this.orientation}drawGameModeIndicator(){return t(this,void 0,void 0,(function*(){if(!this.ctx)return;const e=Math.floor(.1*this.layout.screenWidth.frameCanvas),t=Math.floor(.8*e),r=Math.floor(.1*e),n=Math.floor(.11*e);this.fillCanvasRect(this.layout.screenLeft.frameCanvas-r+this.layout.screenWidth.frameCanvas-e,this.layout.buttonTop.frameCanvas+this.layout.buttonHeight.frameCanvas-e-r,e,e,"rgba(200, 200, 200, 0.7)"),this.ctx.drawImage(yield N(e,e),this.layout.screenLeft.frameCanvas+this.layout.screenWidth.frameCanvas-r-e+n,this.layout.buttonTop.frameCanvas+this.layout.buttonHeight.frameCanvas-e-r+n,t,t)}))}}var H=r(650);const T=((e,t)=>{let r=null;return()=>{if(null!==r)return r;const e=new Blob(['(()=>{"use strict";const e=new Map,t=new Map,r=(e,t)=>{let r,o;const i=performance.now();r=i,o=e-Math.max(0,i-t);return{expected:r+o,remainingDelay:o}},o=(e,t,r,i)=>{const s=performance.now();s>r?postMessage({id:null,method:"call",params:{timerId:t,timerType:i}}):e.set(t,setTimeout(o,r-s,e,t,r,i))};addEventListener("message",(i=>{let{data:s}=i;try{if("clear"===s.method){const{id:r,params:{timerId:o,timerType:i}}=s;if("interval"===i)(t=>{const r=e.get(t);if(void 0===r)throw new Error(\'There is no interval scheduled with the given id "\'.concat(t,\'".\'));clearTimeout(r),e.delete(t)})(o),postMessage({error:null,id:r});else{if("timeout"!==i)throw new Error(\'The given type "\'.concat(i,\'" is not supported\'));(e=>{const r=t.get(e);if(void 0===r)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(r),t.delete(e)})(o),postMessage({error:null,id:r})}}else{if("set"!==s.method)throw new Error(\'The given method "\'.concat(s.method,\'" is not supported\'));{const{params:{delay:i,now:n,timerId:a,timerType:d}}=s;if("interval"===d)((t,i,s)=>{const{expected:n,remainingDelay:a}=r(t,s);e.set(i,setTimeout(o,a,e,i,n,"interval"))})(i,a,n);else{if("timeout"!==d)throw new Error(\'The given type "\'.concat(d,\'" is not supported\'));((e,i,s)=>{const{expected:n,remainingDelay:a}=r(e,s);t.set(i,setTimeout(o,a,t,i,n,"timeout"))})(i,a,n)}}}}catch(e){postMessage({error:{message:e.message},id:s.id,result:null})}}))})();'],{type:"application/javascript; charset=utf-8"}),t=URL.createObjectURL(e);return r=(e=>{const t=new Map([[0,()=>{}]]),r=new Map([[0,()=>{}]]),n=new Map,i=new Worker(e);return i.addEventListener("message",(({data:e})=>{if(void 0!==(i=e).method&&"call"===i.method){const{params:{timerId:i,timerType:o}}=e;if("interval"===o){const e=t.get(i);if("number"==typeof e){const t=n.get(e);if(void 0===t||t.timerId!==i||t.timerType!==o)throw new Error("The timer is in an undefined state.")}else{if(void 0===e)throw new Error("The timer is in an undefined state.");e()}}else if("timeout"===o){const e=r.get(i);if("number"==typeof e){const t=n.get(e);if(void 0===t||t.timerId!==i||t.timerType!==o)throw new Error("The timer is in an undefined state.")}else{if(void 0===e)throw new Error("The timer is in an undefined state.");e(),r.delete(i)}}}else{if(!(e=>null===e.error&&"number"==typeof e.id)(e)){const{error:{message:t}}=e;throw new Error(t)}{const{id:i}=e,o=n.get(i);if(void 0===o)throw new Error("The timer is in an undefined state.");const{timerId:s,timerType:a}=o;n.delete(i),"interval"===a?t.delete(s):r.delete(s)}}var i})),{clearInterval:e=>{const r=(0,H.generateUniqueNumber)(n);n.set(r,{timerId:e,timerType:"interval"}),t.set(e,r),i.postMessage({id:r,method:"clear",params:{timerId:e,timerType:"interval"}})},clearTimeout:e=>{const t=(0,H.generateUniqueNumber)(n);n.set(t,{timerId:e,timerType:"timeout"}),r.set(e,t),i.postMessage({id:t,method:"clear",params:{timerId:e,timerType:"timeout"}})},setInterval:(e,r)=>{const n=(0,H.generateUniqueNumber)(t);return t.set(n,(()=>{e(),"function"==typeof t.get(n)&&i.postMessage({id:null,method:"set",params:{delay:r,now:performance.now(),timerId:n,timerType:"interval"}})})),i.postMessage({id:null,method:"set",params:{delay:r,now:performance.now(),timerId:n,timerType:"interval"}}),n},setTimeout:(e,t)=>{const n=(0,H.generateUniqueNumber)(r);return r.set(n,e),i.postMessage({id:null,method:"set",params:{delay:t,now:performance.now(),timerId:n,timerType:"timeout"}}),n}}})(t),setTimeout((()=>URL.revokeObjectURL(t))),r}})();var B;!function(e){e[e.animationFrame=0]="animationFrame",e[e.timeout=1]="timeout"}(B||(B={}));class L{constructor(e){this.callback=e}schedule(){void 0===this.handle&&(this.handle=requestAnimationFrame((e=>{this.handle=void 0,this.callback(e)})))}cancel(){void 0!==this.handle&&(cancelAnimationFrame(this.handle),this.handle=void 0)}isScheduled(){return void 0!==this.handle}getKind(){return B.animationFrame}}class j{constructor(e,t=60){this.callback=e,this.fps=t}schedule(){if(void 0!==this.handle)return;const e=performance.now(),t=1e3*Math.ceil(e/1e3*this.fps)/this.fps;var r,n;this.handle=(r=()=>{this.handle=void 0,this.callback(performance.now())},n=Math.max(t-e,0),T().setTimeout(r,n))}cancel(){var e;void 0!==this.handle&&(e=this.handle,T().clearTimeout(e),this.handle=void 0)}isScheduled(){return void 0!==this.handle}getKind(){return B.timeout}}class U{constructor(e,t){this.queue=new Array(e).fill(0),this.reset(t)}reset(e=0){this.next=1,this.size=1,this.queue[0]=e}push(e){return this.queue[this.next]=e,this.next=(this.next+1)%this.queue.length,this.size<this.queue.length&&this.size++,this}calculateAverage(){let e=0;for(let t=0;t<this.size;t++)e+=this.queue[t];return e/this.size}}class O{constructor(e){this.start=0,this.size=0,this.buffer=new Array(e)}push(e){return this.size<this.buffer.length?this.buffer[(this.start+this.size++)%this.buffer.length]=e:(this.start=(this.start+1)%this.buffer.length,this.buffer[(this.start+this.size-1)%this.buffer.length]=e),this}pop(){if(0===this.size)return;const e=this.buffer[this.start];return this.start=(this.start+1)%this.buffer.length,this.size--,e}peekLast(){if(0!==this.size)return this.buffer[(this.start+this.size-1)%this.buffer.length]}replaceLast(e){return this.size>0&&(this.buffer[(this.start+this.size-1)%this.buffer.length]=e),this}count(){return this.size}flush(){return this.start=0,this.size=0,this}}class W{constructor(){this.onPwmUpdate=e=>{this.pendingPwmUpdates.count()>0&&this.pendingPwmUpdates.peekLast().frequency<0?this.pendingPwmUpdates.replaceLast(e):this.pendingPwmUpdates.push(e)},this.advanceEmulation=e=>{if(this.isDirty=!1,!this.cloudpilotInstance||this.hasFatalError()||e<this.clockEmulator)return;const t=this.cloudpilotInstance.isSuspended();let r=!1;this.cloudpilotInstance.setClockFactor(this.emulationSpeed*this.getConfiguredSpeed()),e-this.clockEmulator>1e3/30&&(this.clockEmulator=e-1e3/30);const n=(e-this.clockEmulator)/1e3*this.cloudpilotInstance.cyclesPerSecond(),i=performance.now();let o=0;for(;o<n;)if(o+=this.cloudpilotInstance.runEmulation(Math.ceil(n-o)),this.cloudpilotInstance.isSuspended()){r=!0;break}const s=o/this.cloudpilotInstance.cyclesPerSecond()*1e3,a=performance.now()-i;if(this.clockEmulator+=Math.max(s,a),this.speedAverage.push(s/(a>0?a:s/1e3)*this.emulationSpeed),this.updateEmulationSpeed(this.speedAverage.calculateAverage()),r&&!t)return void this.handleSuspend();const u=this.cloudpilotInstance.isPowerOff(),c=this.cloudpilotInstance.isUiInitialized();if(u!==this.powerOff||c!==this.uiInitialized){const e=this.powerOff;this.powerOff=u,this.uiInitialized=c,e!==this.powerOff&&this.powerOffChangeEvent.dispatch(this.powerOff),this.isDirty=!0}c&&!u&&this.manageHotsyncName()&&this.checkAndUpdateHotsyncName(),this.onAfterAdvanceEmulation(e,o)},this.newFrameEvent=new C.j,this.pwmUpdateEvent=new C.j,this.emulationStateChangeEvent=new C.j,this.powerOffChangeEvent=new C.j,this.deviceId=i.m515,this.clockEmulator=0,this.scheduler=new L((e=>this.onSchedule(e))),this.canvas=document.createElement("canvas"),this.canvasTmp=document.createElement("canvas"),this.lastPenUpdate=0,this.penDown=!1,this.running=!1,this.powerOff=!1,this.uiInitialized=!1,this.pendingPwmUpdates=new O(10),this.lastPwmUpdateEvent=0,this.emulationSpeed=1,this.speedAverage=new U(20),this.timePerFrameAverage=new U(60),this.timestampLastFrame=0,this.frameCounter=0,this.isDirty=!1}handlePointerMove(e,t,r){if(!this.handleInput())return;const n=performance.now();if(this.penDown=!0,!(n-this.lastPenUpdate<25)&&this.cloudpilotInstance){if(r){const r=w(this.deviceId);e=this.transformSilkscreenX(e,r),t=this.transformSilkscreenY(t,r)}this.cloudpilotInstance.queuePenMove(Math.floor(e),Math.floor(t)),this.lastPenUpdate=n}}handlePointerUp(){this.handleInput()&&(this.cloudpilotInstance&&this.penDown&&this.cloudpilotInstance.queuePenUp(),this.lastPenUpdate=0,this.penDown=!1)}handleButtonDown(e){this.handleInput()&&this.cloudpilotInstance&&this.cloudpilotInstance.queueButtonDown(e)}handleButtonUp(e){this.handleInput()&&this.cloudpilotInstance&&this.cloudpilotInstance.queueButtonUp(e)}handleKeyDown(e,t=!1){this.handleInput()&&this.cloudpilotInstance&&this.cloudpilotInstance.queueKeyboardEvent(e,t)}reset(){this.cloudpilotInstance&&this.cloudpilotInstance.reset()}resetNoExtensions(){this.cloudpilotInstance&&this.cloudpilotInstance.resetNoExtensions()}resetHard(){this.cloudpilotInstance&&this.cloudpilotInstance.resetHard()}isRunning(){return this.running}isPowerOff(){return this.powerOff}isUiInitialized(){return this.uiInitialized}getCanvas(){return this.canvas}getStatistics(){return{hostSpeed:this.speedAverage.calculateAverage(),emulationSpeed:this.emulationSpeed,averageFps:this.calculateFPS()}}getEmulationSpeed(){return this.emulationSpeed}isSuspended(){return!!this.cloudpilotInstance&&this.cloudpilotInstance.isSuspended()}onAfterAdvanceEmulation(e,t){}handleSuspend(){}callScheduler(){this.scheduler.schedule()}handleInput(){return!0}openSession(e,t,r,n,i){let o=!1;return!!e.initializeSession(t,r)&&(n&&(n.length%4!=0?console.warn("memory size is not a multiple of 4; ignoring image"):(o=e.loadMemory(new Uint32Array(n.buffer,n.byteOffset,n.length>>>2)),o||console.warn("failed to load memory"))),o&&i&&e.loadState(i),e.remountCards(),this.cloudpilotInstance&&this.cloudpilotInstance.pwmUpdateEvent.removeHandler(this.onPwmUpdate),e.pwmUpdateEvent.addHandler(this.onPwmUpdate),this.cloudpilotInstance=e,this.deviceId=r,this.resetCanvas(),this.pendingPwmUpdates.flush(),this.lastPwmUpdateEvent=0,this.deviceHotsyncName=void 0,this.emulationSpeed=1,this.frameCounter=0,this.speedAverage.reset(1),this.powerOff=e.isPowerOff(),this.uiInitialized=e.isUiInitialized(),this.frameCounter=0,!0)}resetCanvas(){const e=w(this.deviceId);this.canvas.width=this.canvasTmp.width=e.width,this.canvas.height=this.canvasTmp.height=e.height;const t=this.canvas.getContext("2d");if(!t)throw new Error("get a new browser");this.context=t;const r=this.canvasTmp.getContext("2d");if(!r)throw new Error("get a new browser");this.contextTmp=r,this.clearCanvas(),this.imageData=void 0}doResume(){this.cloudpilotInstance&&(this.clockEmulator=performance.now(),this.schedule(),this.setRunning(!0),this.resetFPS())}doPause(){this.stopLoop()}doStop(){this.stopLoop()}stopLoop(){this.running&&(this.scheduler.cancel(),void 0!==this.advanceEmulationHandle&&(window.clearTimeout(this.advanceEmulationHandle),this.advanceEmulationHandle=void 0),this.setRunning(!1))}resetFPS(){this.timePerFrameAverage.reset(),this.timestampLastFrame=performance.now()}calculateFPS(){const e=this.timePerFrameAverage.calculateAverage();return e&&1e3/e}transformSilkscreenX(e,t){if(void 0===t.silkscreenOvershoot)return e;const r=t.width/(t.width+2*t.silkscreenOvershoot);return(e-t.width/2)/r+t.width/2}transformSilkscreenY(e,t){return void 0===t.siklscreenShift?e:e+t.siklscreenShift}setRunning(e){e!==this.running&&(this.running=e,this.emulationStateChangeEvent.dispatch(e))}updateEmulationSpeed(e){if(e>=1&&this.emulationSpeed>=1)return;const t=Math.min(Math.max(Math.floor(10*e)/10,.1),1);t<=this.emulationSpeed?this.emulationSpeed=t:this.emulationSpeed=e-t>=.05?t:this.emulationSpeed}performScreenUpdate(){var e;(null===(e=this.cloudpilotInstance)||void 0===e?void 0:e.isScreenDirty())&&(this.updateScreen(),this.cloudpilotInstance.markScreenClean(),this.frameCounter++)}onSchedule(e){this.hasFatalError()||(this.skipEmulationUpdate()||(this.performScreenUpdate(),this.pendingPwmUpdates.count()>0&&e-this.lastPwmUpdateEvent>10&&(this.pwmUpdateEvent.dispatch(this.pendingPwmUpdates.pop()),this.lastPwmUpdateEvent=e),void 0===this.advanceEmulationHandle&&(this.advanceEmulationHandle=window.setTimeout((()=>{this.advanceEmulationHandle=void 0,this.advanceEmulation(e)}),0)),this.timePerFrameAverage.push(Math.max(0,e-this.timestampLastFrame)),this.timestampLastFrame=e),this.schedule())}schedule(){this.scheduler.cancel(),this.getConfiguredSchdedulerKind()!==this.scheduler.getKind()&&(this.scheduler=this.getConfiguredSchdedulerKind()===B.animationFrame?new L((e=>this.onSchedule(e))):new j((e=>this.onSchedule(e)))),this.callScheduler()}checkAndUpdateHotsyncName(){if(!this.cloudpilotInstance)return;void 0===this.deviceHotsyncName&&(this.deviceHotsyncName=this.cloudpilotInstance.getHotsyncName());const e=this.getConfiguredHotsyncName();void 0===e?this.updateConfiguredHotsyncName(this.deviceHotsyncName):e!==this.deviceHotsyncName&&e.length<=40&&this.cloudpilotInstance.isSetupComplete()&&(this.cloudpilotInstance.setHotsyncName(e),this.deviceHotsyncName=e)}clearCanvas(){const e=this.deviceId,t=w(e);this.context.beginPath(),this.context.rect(0,0,t.width,t.height),this.context.fillStyle=S(e)?"white":k[0],this.context.fill()}updateScreen(){if(!this.cloudpilotInstance)return;const e=this.cloudpilotInstance.getFrame();if(this.cloudpilotInstance.isPowerOff())return this.clearCanvas(),void this.newFrameEvent.dispatch(this.canvas);if(!e.hasChanges)return;if(e.lines*e.scaleY===this.canvas.height&&e.lineWidth*e.scaleX===this.canvas.width){this.imageData&&this.imageData.width===e.lineWidth&&this.imageData.height===e.lines||(this.imageData=new ImageData(e.lineWidth,e.lines));const t=new Uint32Array(this.imageData.data.buffer);switch(e.bpp){case 1:{const r=I[15],n=I[0];let i=0;for(let o=e.firstDirtyLine;o<=e.lastDirtyLine;o++){const s=o*e.bytesPerLine;for(let o=e.margin;o<e.lineWidth+e.margin;o++)t[i++]=e.buffer[s+(o>>>3)]&128>>>(7&o)?r:n}break}case 2:{const r=this.cloudpilotInstance.getPalette2bitMapping(),n=[I[15&r],I[r>>>4&15],I[r>>>8&15],I[r>>>12&15]];let i=0;for(let r=e.firstDirtyLine;r<=e.lastDirtyLine;r++){const o=r*e.bytesPerLine;for(let r=e.margin;r<e.lineWidth+e.margin;r++)t[i++]=n[e.buffer[o+(r>>>2)]>>6-2*(3&r)&3]}break}case 4:{let r=0;for(let n=e.firstDirtyLine;n<=e.lastDirtyLine;n++){const i=n*e.bytesPerLine;for(let n=e.margin;n<e.lineWidth+e.margin;n++)t[r++]=I[e.buffer[i+(n>>>1)]>>>4-4*(1&n)&15]}break}case 24:{const r=new Uint32Array(e.buffer.buffer,e.buffer.byteOffset,e.buffer.byteLength>>>2);if(0===e.margin)t.subarray(0,e.lineWidth*(e.lastDirtyLine-e.firstDirtyLine+1)).set(r.subarray(e.firstDirtyLine*e.lineWidth,e.lineWidth*(e.lastDirtyLine+1)));else{let n=0;for(let i=e.firstDirtyLine;i<=e.lastDirtyLine;i++){let o=i*(e.bytesPerLine>>>2)+e.margin;for(let i=0;i<e.lineWidth;i++)t[n++]=r[o++]}}}}}if(!this.imageData)return;const t=1!==e.scaleX||1!==e.scaleY;(t?this.contextTmp:this.context).putImageData(this.imageData,0,e.firstDirtyLine,0,0,e.lineWidth,e.lastDirtyLine-e.firstDirtyLine+1),t&&(this.context.imageSmoothingEnabled=!1,this.context.drawImage(this.canvasTmp,0,e.firstDirtyLine,e.lineWidth,e.lastDirtyLine-e.firstDirtyLine+1,0,e.firstDirtyLine*e.scaleY,e.lineWidth*e.scaleX,(e.lastDirtyLine-e.firstDirtyLine+1)*e.scaleY)),this.newFrameEvent.dispatch(this.canvas)}}class V extends W{constructor(){super(...arguments),this.timesliceEvent=new C.j}pause(){this.doPause()}resume(){this.doResume()}initWithRom(e,t,r,n){return this.isRunning()&&(this.doStop(),this.session=void 0),e.clearExternalStorage(),!!this.openSession(e,t,r)&&(this.session=n,!0)}initWithSessionImage(e,t,r){return this.isRunning()&&(this.doStop(),this.session=void 0),e.clearExternalStorage(),!!this.openSession(e,t.rom,t.deviceId,t.memory,t.savestate)&&(this.session=r,!0)}getSession(){return this.session}forceUpdateHotsyncName(){this.cloudpilotInstance&&this.cloudpilotInstance.isUiInitialized()&&!this.cloudpilotInstance.isPowerOff()&&this.checkAndUpdateHotsyncName()}getConfiguredSpeed(){var e,t;return null!==(t=null===(e=this.session)||void 0===e?void 0:e.speed)&&void 0!==t?t:1}manageHotsyncName(){return!0}getConfiguredHotsyncName(){var e;return null===(e=this.session)||void 0===e?void 0:e.hotsyncName}updateConfiguredHotsyncName(e){this.session&&(this.session.hotsyncName=e)}getConfiguredSchdedulerKind(){var e;return(null===(e=this.session)||void 0===e?void 0:e.runInBackground)?B.timeout:B.animationFrame}hasFatalError(){var e;return!!(null===(e=this.cloudpilotInstance)||void 0===e?void 0:e.hasFatalError())}skipEmulationUpdate(){return!1}onAfterAdvanceEmulation(e,t){this.timesliceEvent.dispatch()}handleInput(){return this.isRunning()}}class q{constructor(e,t){this.emulationService=e,this.canvasDisplayService=t,this.handleMouseDown=e=>{if(0!==e.button)return;const t=this.canvasDisplayService.eventToPalmCoordinates(e);if(!t)return;const r=this.determineArea(t);if(2===r){const e=this.canvasDisplayService.determineButton(t);this.interactionMouse={area:r,buttonPrimary:e},this.handleButtonDown(e)}else this.interactionMouse={area:r},this.emulationService.handlePointerMove(...t,1===r)},this.handleMouseMove=e=>{var t,r;if(!(1&e.buttons&&this.interactionMouse&&2!==(null===(t=this.interactionMouse)||void 0===t?void 0:t.area)))return;const n=this.canvasDisplayService.eventToPalmCoordinates(e,!0);n&&this.emulationService.handlePointerMove(...n,1===(null===(r=this.interactionMouse)||void 0===r?void 0:r.area))},this.handeMouseUp=e=>{if(0!==e.button)return;const t=this.interactionMouse;switch(this.interactionMouse=void 0,null==t?void 0:t.area){case 2:this.handleButtonUp(t.buttonPrimary);break;case 0:case 1:this.emulationService.handlePointerUp()}},this.handleTouchStart=e=>{let t=!1;for(let r=0;r<e.changedTouches.length;r++){const n=e.changedTouches.item(r);if(!n)continue;const i=this.canvasDisplayService.eventToPalmCoordinates(n);if(!i)continue;t=!0;const o=this.determineArea(i);if(2===o){const e=this.canvasDisplayService.determineButton(i);this.interactionsTouch.set(n.identifier,{area:o,buttonPrimary:e}),this.handleButtonDown(e)}else this.interactionsTouch.set(n.identifier,{area:o}),this.emulationService.handlePointerMove(...i,1===o)}t&&!1!==e.cancelable&&e.preventDefault()},this.handleTouchMove=e=>{let t=!1;for(let r=0;r<e.changedTouches.length;r++){const n=e.changedTouches.item(r);if(!n)continue;const i=this.interactionsTouch.get(n.identifier);if(!i)continue;t=!0;const o=i.area;switch(o){case 2:{const e=this.canvasDisplayService.eventToPalmCoordinates(n);if(!e||2!==this.determineArea(e)){this.handleButtonUp(i.buttonSecondary),i.buttonSecondary=void 0;break}const t=this.canvasDisplayService.determineButton(e);t===i.buttonPrimary?(this.handleButtonUp(i.buttonSecondary),i.buttonSecondary=void 0):t!==i.buttonSecondary&&(this.handleButtonUp(i.buttonSecondary),i.buttonSecondary=t,this.handleButtonDown(t));break}case 0:case 1:{const e=this.canvasDisplayService.eventToPalmCoordinates(n,!0);if(!e)continue;this.emulationService.handlePointerMove(...e,1===o);break}default:continue}}t&&!1!==e.cancelable&&e.preventDefault()},this.handleTouchEnd=e=>{let t=!1;for(let r=0;r<e.changedTouches.length;r++){const n=e.changedTouches.item(r);if(!n)continue;const i=this.interactionsTouch.get(n.identifier);switch(i&&(t=!0),this.interactionsTouch.delete(n.identifier),null==i?void 0:i.area){case 2:this.handleButtonUp(i.buttonPrimary),this.handleButtonUp(i.buttonSecondary);break;case 0:case 1:this.emulationService.handlePointerUp()}}t&&!1!==e.cancelable&&e.preventDefault()},this.handleKeyDown=e=>{if(this.emulationService.isSuspended()||!this.enableKeyboardEvents())return;if(this.isToggleGameMode(e))return e.preventDefault(),this.gameMode=!this.gameMode,void this.onToggleGameMode();const t=this.buttonFromEvent(e);if(void 0!==t)return this.handleButtonDown(t),void e.preventDefault();const r=this.keyCodeFromEvent(e);void 0!==r&&(this.emulationService.handleKeyDown(r),e.preventDefault())},this.handleKeyUp=e=>{if(this.emulationService.isSuspended()||!this.enableKeyboardEvents())return;const t=this.buttonFromEvent(e);if(void 0!==t)return this.handleButtonUp(t),void e.preventDefault();if("Control"===e.key){for(const e of this.activeButtons)this.emulationService.handleButtonUp(e);this.activeButtons.clear(),this.canvasDisplayService.drawButtons([])}},this.keyEventTarget=window,this.interactionsTouch=new Map,this.activeButtons=new Set,this.gameMode=!1,this.enableGamemodeHotkey=!0}bind(e,t=window){this.pointerEventTarget&&this.release(),this.pointerEventTarget=e,this.keyEventTarget=t||window,this.addEventListener(e,"mousedown",this.handleMouseDown),this.addEventListener(window,"mouseup",this.handeMouseUp),this.addEventListener(window,"mousemove",this.handleMouseMove),this.addEventListener(e,"touchstart",this.handleTouchStart),this.addEventListener(e,"touchmove",this.handleTouchMove),this.addEventListener(e,"touchend",this.handleTouchEnd),this.addEventListener(e,"touchcancel",this.handleTouchEnd),this.addEventListener(this.keyEventTarget,"keydown",this.handleKeyDown),this.addEventListener(this.keyEventTarget,"keyup",this.handleKeyUp)}release(){if(this.pointerEventTarget){this.removeEventListener(this.pointerEventTarget,"mousedown",this.handleMouseDown),this.removeEventListener(window,"mouseup",this.handeMouseUp),this.removeEventListener(window,"mousemove",this.handleMouseMove),this.removeEventListener(this.pointerEventTarget,"touchstart",this.handleTouchStart),this.removeEventListener(this.pointerEventTarget,"touchmove",this.handleTouchMove),this.removeEventListener(this.pointerEventTarget,"touchend",this.handleTouchEnd),this.removeEventListener(this.pointerEventTarget,"touchcancel",this.handleTouchEnd),this.removeEventListener(this.keyEventTarget,"keydown",this.handleKeyDown),this.removeEventListener(this.keyEventTarget,"keyup",this.handleKeyUp);for(const e of this.activeButtons)this.handleButtonUp(e);this.activeButtons.clear(),this.interactionsTouch.clear(),this.interactionMouse=void 0,this.pointerEventTarget=void 0}}isGameMode(){return this.gameMode}setGameMode(e){this.gameMode=e,this.onToggleGameMode()}setGameModeHotkeyEnabled(e){this.enableGamemodeHotkey=e}isGameModeHotkeyEnabled(){return this.enableGamemodeHotkey}enableKeyboardEvents(){return!0}onToggleGameMode(){}addEventListener(e,t,r,n){e.addEventListener(t,r,n)}removeEventListener(e,t,r,n){e.removeEventListener(t,r,n)}determineArea(e){return this.canvasDisplayService.isButtons(e)?2:this.canvasDisplayService.isSilkscreen(e)?1:0}handleButtonDown(e){this.activeButtons.has(e)||(this.activeButtons.add(e),this.emulationService.handleButtonDown(e),this.canvasDisplayService.drawButtons(Array.from(this.activeButtons.values())))}handleButtonUp(e){void 0!==e&&this.activeButtons.has(e)&&(this.activeButtons.delete(e),this.emulationService.handleButtonUp(e),this.canvasDisplayService.drawButtons(Array.from(this.activeButtons.values())))}isToggleGameMode(e){return this.isGameModeHotkeyEnabled()&&("Shift"===e.key&&e.ctrlKey||"Control"===e.key&&e.shiftKey)}isGameModeActive(e){return!this.gameMode&&e.ctrlKey||this.gameMode&&!e.ctrlKey}buttonFromEvent(e){switch(e.key){case"PageUp":return 4;case"PageDown":return 5}if(this.isGameModeActive(e))switch(e.key){case"w":case"i":case"ArrowUp":return 4;case"s":case"k":case"ArrowDown":return 5;case"a":case"j":case"y":case"z":case"ArrowLeft":return 0;case"q":case"u":case"x":return 1;case"e":case"o":case"c":return 2;case"d":case"l":case"v":case"ArrowRight":return 3}}keyCodeFromEvent(e){if(!this.isGameModeActive(e)){if(1===e.key.length&&e.key.charCodeAt(0)<=255)return e.key.charCodeAt(0);switch(e.key){case"ArrowLeft":return 28;case"ArrowRight":return 29;case"ArrowUp":return 30;case"ArrowDown":return 31;case"Backspace":return 8;case"Tab":return 9;case"Enter":return 10;default:return}}}}class K extends q{constructor(e,t){super(e,t),this.gameModeChangeEvent=new C.j,this.canvasDisplayService=t}onToggleGameMode(){this.canvasDisplayService.toggleGameModeIndicator(this.isGameMode()),this.gameModeChangeEvent.dispatch(this.isGameMode())}}class Y{constructor(e){this.cloudpilot=e,this.images=new Map}loadSkinElement(e){if(this.images.has(e))return this.images.get(e);const t=this.cloudpilot.then((t=>t.loadSkin(e))).then((t=>t?Promise.all([t,y(v(t))]):Promise.reject(new Error(`failed to load skin ${e}`)))),r=f(t.then((([,e])=>e)),t.then((([e])=>e)));return this.images.set(e,r),r}}class Q{constructor(e){this.query=e,this.changeEvent=new C.j,this.last=e()}update(){const e=this.query();e!==this.last&&(this.changeEvent.dispatch(e),this.last=e)}}const Z={hotsyncName:void 0,orientation:o.portrait,runInBackground:!1,speed:1,deviceId:i.m515},X="MEMORY_CARD";class ${constructor(e){this.cloudpilot=e,this.onTimeslice=()=>{this.powerOffWatcher.update(),this.uiInitializedWatcher.update(),this.hotsyncNameWatcher.update()},this.audioInitializedEvent=new C.j,this.session=Object.assign({},Z),this.emulationService=new V,this.canvasDisplayService=new A(new Y(Promise.resolve(e))),this.eventHandlingService=new K(this.emulationService,this.canvasDisplayService),this.audioService=new _(this.emulationService),this.emulationService.newFrameEvent.addHandler((e=>this.canvasDisplayService.updateEmulationCanvas(e))),this.timesliceEvent.addHandler(this.onTimeslice),this.powerOffWatcher=new Q((()=>this.isPowerOff())),this.uiInitializedWatcher=new Q((()=>this.isUiInitialized())),this.hotsyncNameWatcher=new Q((()=>this.getHotsyncName()||""))}getStatistics(){return this.emulationService.getStatistics()}loadRom(e,t){if(void 0===t){const r=this.cloudpilot.getRomInfo(e);if(!r||0===r.supportedDevices.length)throw new Error("unsupported device");t=r.supportedDevices[0]}if(this.session=Object.assign(Object.assign({},Z),{deviceId:t}),this.emulationService.initWithRom(this.cloudpilot,e,t,this.session))return this.canvasDisplayService.initialize(void 0,t,this.session.orientation),this;throw new Error("failed to initialize session")}loadSession(e){var t,r,n,i,s;const a=this.cloudpilot.deserializeSessionImage(e);if(!a)throw new Error("bad session image");if(this.session={hotsyncName:null===(t=a.metadata)||void 0===t?void 0:t.hotsyncName,speed:null!==(n=null===(r=a.metadata)||void 0===r?void 0:r.speed)&&void 0!==n?n:1,orientation:null!==(s=null===(i=a.metadata)||void 0===i?void 0:i.deviceOrientation)&&void 0!==s?s:o.portrait,runInBackground:!1,deviceId:a.deviceId},this.emulationService.initWithSessionImage(this.cloudpilot,a,this.session))return this.canvasDisplayService.initialize(void 0,a.deviceId,this.session.orientation),this;throw new Error("failed to initialize session")}insertCompressedCardImage(e){if(!this.cloudpilot.decompressCard(X,e))throw new Error("failed to decompress and mount card image");if(!this.cloudpilot.mountCard(X))throw new Error("failed to mount card image");return this}insertCardImage(e){if(e.length%512!=0)throw new Error("card image size must be a multiple of 512");if(!this.cloudpilot.allocateCard(X,e.length))throw new Error("failed to allocate card image");const t=this.cloudpilot.getCardData(X);if(!t)throw new Error("failed to allocate card image");if(t.set(new Uint32Array(e.buffer,e.byteOffset,e.byteLength>>>2)),!this.cloudpilot.mountCard(X))throw new Error("failed to mount card image");return this}ejectCard(){if(!this.isCardMounted())return this;if(!this.cloudpilot.removeCard(X))throw new Error("failed to eject card");return this}isCardMounted(){return this.cloudpilot.getMountedKey()===X}setCanvas(e){return this.canvasDisplayService.initialize(e,this.session.deviceId,this.session.orientation),this}bindInput(e){const t=this.canvasDisplayService.getCanvas();if(!t)throw new Error("you must set up the canvas setCanvas before calling bindInput");return this.eventHandlingService.bind(t,e),this}releaseInput(){return this.eventHandlingService.release(),this}installDatabase(e){if(this.cloudpilot.installDb(e)<0)throw new Error("failed to install database");return this}installAndLaunchDatabase(e){return this.installDatabase(e).launchDatabase(e)}installFromZipfile(e){return this.installFromZipfileAndLaunch(e)}installFromZipfileAndLaunch(e,t){let r;if(this.cloudpilot.withZipfileWalkerSync(e,(e=>{for(;0===e.GetState();){const n=e.GetCurrentEntryContent(),i=e.GetCurrentEntryName();if(!n)throw new Error(`unable to read ${i} from zupfile`);this.installDatabase(n),i.toLowerCase()===(null==t?void 0:t.toLowerCase())&&(r=n.subarray(0,32).slice()),e.Next()}if(-1===e.GetState())throw new Error("error reading zipfile")})),void 0!==t&&!r)throw new Error(`database ${t} not found `);return r&&this.launchDatabase(r),this}launchByName(e){if(!this.cloudpilot.launchAppByName(e))throw new Error(`failed to launch ${e}`);return this}launchDatabase(e){if(!this.cloudpilot.launchAppByDbHeader(e))throw new Error("failed to launch database");return this}reset(){return this.emulationService.reset(),this}resetNoExtensions(){return this.emulationService.resetNoExtensions(),this}resetHard(){return this.emulationService.resetHard(),this}isRunning(){return this.emulationService.isRunning()}isPowerOff(){return this.emulationService.isPowerOff()}isUiInitialized(){return this.emulationService.isUiInitialized()}resume(){return this.emulationService.resume(),this}pause(){return this.emulationService.pause(),this}buttonDown(e){return this.emulationService.handleButtonDown(e),this}buttonUp(e){return this.emulationService.handleButtonUp(e),this}setSpeed(e){return this.session.speed=e,this}getSpeed(){return this.session.speed}setVolume(e){return this.audioService.setVolume(e),this}getVolume(){return this.audioService.getVolume()}initializeAudio(){return t(this,void 0,void 0,(function*(){return yield this.audioService.initialize(),this.audioService.isInitialized()}))}isAudioInitialized(){return this.audioService.isInitialized()}setOrientation(e){return this.session.orientation=e,this.canvasDisplayService.updateOrientation(this.session.orientation),this}getOrientation(){return this.session.orientation}setHotsyncName(e){return this.session.hotsyncName=e,this.emulationService.forceUpdateHotsyncName(),this}getHotsyncName(){return this.session.hotsyncName}setRunHidden(e){return this.session.runInBackground=e,this}getRunHidden(){return this.session.runInBackground}isGameMode(){return this.eventHandlingService.isGameMode()}setGameMode(e){return this.eventHandlingService.setGameMode(e),this}isGameModeHotkeyEnabled(){return this.eventHandlingService.isGameModeHotkeyEnabled()}setGameModeHotkeyEnabled(e){return this.eventHandlingService.setGameModeHotkeyEnabled(e),this}isGameModeIndicatorEnabled(){return this.canvasDisplayService.isGameModeIndicatorEnabled()}setGameModeIndicatorEnabled(e){return this.canvasDisplayService.setGameModeIndicatorEnabled(e),this}get powerOffChangeEvent(){return this.powerOffWatcher.changeEvent}get isUiInitializedChangeEvent(){return this.uiInitializedWatcher.changeEvent}get hotsyncNameChangeEvent(){return this.hotsyncNameWatcher.changeEvent}get gameModeChangeEvent(){return this.eventHandlingService.gameModeChangeEvent}get timesliceEvent(){return this.emulationService.timesliceEvent}}var J=r(492),ee=r.n(J);const te=[i.palmPilot,i.pilot,i.iii,i.palmVx,i.palmV,i.palmVII,i.palmVIIEZ,i.palmVIIx,i.iiixe,i.iiix,i.iiie,i.m500,i.m505,i.m515,i.m520,i.iiic,i.m100,i.m105,i.m125,i.m130,i.i705,i.i710,i.handera330,i.handera330c,i.pegS300,i.pegS320,i.pegS500c,i.pegT400,i.pegN600c,i.pegT600c,i.pegN700c,i.pegT650c,i.pegNR70,i.acerS11];function re(){return(e,t,r)=>{const n=r.value;return r.value=function(e,t){return this.guard((()=>n.call(this,e,t)))},r}}class ne{constructor(e){this.module=e,this.fatalErrorEvent=new C.j,this.pwmUpdateEvent=new C.j,this.proxyDisconnectEvent=new C.j,this.amIdead=!1,this.cloudpilot=new e.Cloudpilot,this.cloudpilot.RegisterPwmHandler(e.addFunction(((e,t)=>this.pwmUpdateEvent.dispatch({frequency:e,dutyCycle:t})),"vdd")),this.cloudpilot.RegisterProxyDisconnectHandler(e.addFunction((t=>this.proxyDisconnectEvent.dispatch(e.UTF8ToString(t))),"vi"))}static create(e){return t(this,void 0,void 0,(function*(){return new ne(yield ee()(Object.assign({print:e=>console.log(e),printErr:e=>console.error(e)},void 0!==e?{locateFile:()=>e}:{})))}))}destroy(){this.module.destroy(this.cloudpilot)}hasFatalError(){return this.amIdead}getRomInfo(e){const t=this.copyIn(e),r=new this.module.RomInfo(t,e.length);let n;return r.IsValid()&&(n={cardVersion:r.CardVersion(),cardName:r.CardName(),romVersion:r.RomVersion(),romVersionString:r.RomVersionString(),supportedDevices:te.filter(r.Supports.bind(r))}),this.cloudpilot.Free(t),this.module.destroy(r),n}initializeSession(e,t){const r=this.copyIn(e),n=this.cloudpilot.InitializeSession(r,e.length,t);return this.cloudpilot.Free(r),n}cyclesPerSecond(){return this.cloudpilot.GetCyclesPerSecond()}runEmulation(e){return this.cloudpilot.RunEmulation(e)}getFrame(){const e=this.cloudpilot.CopyFrame(),t=this.module.getPointer(e.GetBuffer());return{bpp:e.GetBpp(),bytesPerLine:e.GetBytesPerLine(),lines:e.GetLines(),lineWidth:e.GetLineWidth(),margin:e.GetMargin(),firstDirtyLine:e.GetFirstDirtyLine(),lastDirtyLine:e.GetLastDirtyLine(),hasChanges:e.GetHasChanges(),scaleX:e.GetScaleX(),scaleY:e.GetScaleY(),buffer:this.module.HEAPU8.subarray(t,t+e.GetBufferSize())}}isScreenDirty(){return this.cloudpilot.IsScreenDirty()}markScreenClean(){this.cloudpilot.MarkScreenClean()}minRamForDevice(e){return 1024*this.cloudpilot.MinMemoryForDevice(e)}framebufferSizeForDevice(e){return 1024*this.cloudpilot.FramebufferSizeForDevice(e)}totalMemorySizeForDevice(e){return 1024*this.cloudpilot.TotalMemoryForDevice(e)}queuePenMove(e,t){this.cloudpilot.QueuePenMove(e,t)}queuePenUp(){this.cloudpilot.QueuePenUp()}queueButtonDown(e){this.cloudpilot.QueueButtonDown(e)}queueButtonUp(e){this.cloudpilot.QueueButtonUp(e)}queueKeyboardEvent(e,t){this.cloudpilot.QueueKeyboardEvent(e,t)}isPowerOff(){return!!this.cloudpilot.IsPowerOff()}isUiInitialized(){return!!this.cloudpilot.IsUIInitialized()}isSetupComplete(){return!!this.cloudpilot.IsSetupComplete()}getOSVersion(){return this.cloudpilot.GetOSVersion()}reset(){this.cloudpilot.Reset()}resetNoExtensions(){this.cloudpilot.ResetNoExtensions()}resetHard(){this.cloudpilot.ResetHard()}installDb(e){const t=this.copyIn(e),r=this.cloudpilot.InstallDb(t,e.length);return this.cloudpilot.Free(t),r}getPalette2bitMapping(){return this.cloudpilot.GetPalette2bitMapping()}getMemory(){const e=this.module.getPointer(this.cloudpilot.GetMemoryPtr());return this.module.HEAPU8.subarray(e,e+this.cloudpilot.GetMemorySize())}getMemory32(){let e=this.module.getPointer(this.cloudpilot.GetMemoryPtr());if(3&e)throw new Error("unaligned pointer");return e>>>=2,this.module.HEAPU32.subarray(e,e+(this.cloudpilot.GetMemorySize()>>>2))}getDirtyPages(){const e=this.module.getPointer(this.cloudpilot.GetDirtyPagesPtr()),t=this.cloudpilot.GetMemorySize(),r=(t>>>13)+(t%8192==0?0:1);return this.module.HEAPU8.subarray(e,e+r)}loadMemory(e){const t=this.getMemory32();if((()=>{if(e.length!==t.length||e.length<256)return!1;for(let r=256;r>0;r--){if(e[e.length-r]!==t[t.length-r])return!1;if(4294967295===t[t.length-r])break}return!0})())return t.set(e),!0;{const t=this.copyIn32(e),r=this.cloudpilot.ImportMemoryImage(t,e.length<<2);return this.cloudpilot.Free(t),r}}getRomImage(){const e=this.module.getPointer(this.cloudpilot.GetRomPtr());return this.module.HEAPU8.subarray(e,e+this.cloudpilot.GetRomSize())}getSavestate(){const e=this.module.getPointer(this.cloudpilot.GetSavestatePtr());return this.module.HEAPU8.subarray(e,e+this.cloudpilot.GetSavestateSize())}saveState(){return!!this.cloudpilot.SaveState()}loadState(e){const t=this.copyIn(e),r=this.cloudpilot.LoadState(t,e.length);return this.cloudpilot.Free(t),r}getHotsyncName(){return this.cloudpilot.GetHotsyncName()}setClockFactor(e){this.cloudpilot.SetClockFactor(e)}setHotsyncName(e){this.cloudpilot.SetHotsyncName(e)}backup(e){return t(this,void 0,void 0,(function*(){const t=this.guard((()=>this.cloudpilot.StartBackup()));try{return yield e(this.wrap(t))}finally{this.module.destroy(t)}}))}getArchive(e){const t=e.GetArchiveSize();return this.copyOut(e.GetArchivePtr(),t)}setClipboardIntegration(e){this.cloudpilot.SetClipboardIntegration(e)}getClipboardIntegration(){return this.cloudpilot.GetClipboardIntegration()}isSuspended(){return this.cloudpilot.IsSuspended()}getSuspendKind(){return this.cloudpilot.GetSuspendContext().GetKind()}cancelSuspend(){this.cloudpilot.GetSuspendContext().Cancel()}getSuspendContextClipboardCopy(){return this.wrap(this.cloudpilot.GetSuspendContext().AsContextClipboardCopy())}getSuspendContextClipboardPaste(){return this.wrap(this.cloudpilot.GetSuspendContext().AsContextClipboardPaste())}setNetworkRedirection(e){this.cloudpilot.SetNetworkRedirection(e)}getNetworkRedirection(){return this.cloudpilot.GetNetworkRedirection()}getSuspendContextNetworkConnect(){return this.wrap(this.cloudpilot.GetSuspendContext().AsContextNetworkConnect())}getSuspendContextNetworkRpc(){return this.wrap(this.cloudpilot.GetSuspendContext().AsContextNetworkRpc())}copyBuffer(e){return this.copyIn(e)}freeBuffer(e){this.cloudpilot.Free(e)}setHotsyncNameManagement(e){this.cloudpilot.SetHotsyncNameManagement(e)}resolveBuffer(e,t){const r=this.module.getPointer(e);return this.module.HEAPU8.subarray(r,r+t)}withZipfileWalker(e,r){return t(this,void 0,void 0,(function*(){const t=this.guard((()=>{const t=this.copyIn(e),r=new this.module.ZipfileWalker(e.length,t);return this.cloudpilot.Free(t),r}));try{return yield r(this.wrap(Object.setPrototypeOf({GetCurrentEntryContent:()=>this.copyOut(t.GetCurrentEntryContent(),t.GetCurrentEntrySize())},t)))}finally{this.module.destroy(t)}}))}withZipfileWalkerSync(e,t){const r=this.guard((()=>{const t=this.copyIn(e),r=new this.module.ZipfileWalker(e.length,t);return this.cloudpilot.Free(t),r}));try{return t(this.wrap(Object.setPrototypeOf({GetCurrentEntryContent:()=>this.copyOut(r.GetCurrentEntryContent(),r.GetCurrentEntrySize())},r)))}finally{this.module.destroy(r)}}serializeSessionImage(e){var t,r;const n=new this.module.SessionImage,i=this.cloudpilot.Nullptr(),o=this.copyIn(e.rom),s=e.memory?this.copyIn(e.memory):i,a=void 0!==e.savestate?this.copyIn(e.savestate):i;let u=i,c=0;if(void 0!==e.metadata){const t=(new TextEncoder).encode(JSON.stringify(e.metadata));c=t.length,u=this.copyIn(t)}n.SetRomImage(o,e.rom.length),n.SetMemoryImage(s,(null===(t=e.memory)||void 0===t?void 0:t.length)||0),n.SetDeviceId(e.deviceId),n.SetSavestate(a,(null===(r=e.savestate)||void 0===r?void 0:r.length)||0),n.SetMetadata(u,c);const p=n.Serialize()?this.copyOut(n.GetSerializedImage(),n.GetSerializedImageSize()):void 0;return this.module.destroy(n),[o,s,a,u].forEach((e=>this.cloudpilot.Free(e))),p}deserializeSessionImage(e){const t=new this.module.SessionImage,r=this.copyIn(e),n=(()=>{if(!t.Deserialize(r,e.length))return;const n=this.copyOut(t.GetRomImage(),t.GetRomImageSize()),i=this.copyOut(t.GetMemoryImage(),t.GetMemoryImageSize()),o=this.copyOut(t.GetSavestate(),t.GetSavestateSize()),s=t.GetDeviceId();if(!te.includes(s))return void console.warn(`unsupported device ${s}`);let a;const u=this.copyOut(t.GetMetadata(),t.GetMetadataSize());if(u)try{a=JSON.parse((new TextDecoder).decode(u))}catch(e){console.warn("invalid metadata",e)}return{deviceId:s,rom:n,memory:i,savestate:o,metadata:a,version:t.GetVersion()}})();return this.module.destroy(t),this.cloudpilot.Free(r),n}launchAppByName(e){return this.cloudpilot.LaunchAppByName(e)}launchAppByDbHeader(e){if(e.length<32)return!1;const t=this.copyIn(e.subarray(0,32)),r=this.cloudpilot.LaunchAppByDbHeader(t,32);return this.cloudpilot.Free(t),r}deviceSupportsCardSize(e){return this.cloudpilot.DeviceSupportsCardSize(e)}clearExternalStorage(){this.cloudpilot.ClearExternalStorage()}allocateCard(e,t){return this.cloudpilot.AllocateCard(e,t>>>9)}decompressCard(e,t){const r=this.copyIn(t);let n;try{for(n=new this.module.GunzipContext(r,t.length,524288);0===n.GetState();)n.Continue();return-1===n.GetState()?(console.error(`gunzip failed: ${n.GetError()}`),!1):n.GetUncompressedSize()%512!=0?(console.error("failed to allocate card: invalid size of decompressed image"),!1):this.cloudpilot.AdoptCard(e,n.ReleaseUncompressedData(),n.GetUncompressedSize()>>>9)}finally{this.cloudpilot.Free(r),n&&this.module.destroy(n)}}getCardData(e){const t=this.module.getPointer(this.cloudpilot.GetCardData(e));if(0!==t)return this.module.HEAPU32.subarray(t>>>2,t+this.cloudpilot.GetCardSize(e)>>2)}getCardDirtyPages(e){const t=this.module.getPointer(this.cloudpilot.GetCardDirtyPages(e));if(0===t)return;const r=function(e){const t=(e>>>13)+(e%8192>0?1:0);return(t>>>3)+(t%8>0?1:0)}(this.cloudpilot.GetCardSize(e));return this.module.HEAPU8.subarray(t,t+r)}getMountedKey(){return this.cloudpilot.GetMountedKey()}mountCard(e){return this.cloudpilot.MountCard(e)}removeCard(e){return this.cloudpilot.RemoveCard(e)}remountCards(){this.cloudpilot.RemountCards()}getCardSupportLevel(e){return this.cloudpilot.GetSupportLevel(e)}loadSkin(e){const t=new this.module.SkinLoader(e);try{const e=this.module.getPointer(t.GetData());if(0===e)return;return(new TextDecoder).decode(this.module.HEAPU8.subarray(e,e+t.GetSize()))}finally{this.module.destroy(t)}}copyIn(e){const t=this.cloudpilot.Malloc(e.length),r=this.module.getPointer(t);return this.module.HEAPU8.subarray(r,r+e.length).set(e),t}copyIn32(e){const t=this.cloudpilot.Malloc(e.length<<2),r=this.module.getPointer(t);return this.module.HEAPU32.subarray(r>>>2,(r>>>2)+e.length).set(e),t}copyOut(e,t){const r=this.module.getPointer(e);return r>0&&t>0?this.module.HEAPU8.subarray(r,r+t).slice():void 0}wrap(e){return new Proxy(e,{get:(e,t)=>{const r=e[t];return"function"!=typeof r?r:(...t)=>this.guard((()=>r.apply(e,t)))}})}guard(e){if(this.amIdead)throw new Error("cloudpilot instance is dead");try{return e()}catch(e){throw this.amIdead=!0,this.cloudpilot=void 0,this.fatalErrorEvent.dispatch(e instanceof Error?e:new Error("unknown error")),e}}}var ie;e([re()],ne.prototype,"getRomInfo",null),e([re()],ne.prototype,"initializeSession",null),e([re()],ne.prototype,"cyclesPerSecond",null),e([re()],ne.prototype,"runEmulation",null),e([re()],ne.prototype,"getFrame",null),e([re()],ne.prototype,"isScreenDirty",null),e([re()],ne.prototype,"markScreenClean",null),e([re()],ne.prototype,"minRamForDevice",null),e([re()],ne.prototype,"framebufferSizeForDevice",null),e([re()],ne.prototype,"totalMemorySizeForDevice",null),e([re()],ne.prototype,"queuePenMove",null),e([re()],ne.prototype,"queuePenUp",null),e([re()],ne.prototype,"queueButtonDown",null),e([re()],ne.prototype,"queueButtonUp",null),e([re()],ne.prototype,"queueKeyboardEvent",null),e([re()],ne.prototype,"isPowerOff",null),e([re()],ne.prototype,"isUiInitialized",null),e([re()],ne.prototype,"isSetupComplete",null),e([re()],ne.prototype,"getOSVersion",null),e([re()],ne.prototype,"reset",null),e([re()],ne.prototype,"resetNoExtensions",null),e([re()],ne.prototype,"resetHard",null),e([re()],ne.prototype,"installDb",null),e([re()],ne.prototype,"getPalette2bitMapping",null),e([re()],ne.prototype,"getMemory",null),e([re()],ne.prototype,"getMemory32",null),e([re()],ne.prototype,"getDirtyPages",null),e([re()],ne.prototype,"loadMemory",null),e([re()],ne.prototype,"getRomImage",null),e([re()],ne.prototype,"getSavestate",null),e([re()],ne.prototype,"saveState",null),e([re()],ne.prototype,"loadState",null),e([re()],ne.prototype,"getHotsyncName",null),e([re()],ne.prototype,"setClockFactor",null),e([re()],ne.prototype,"setHotsyncName",null),e([re()],ne.prototype,"setClipboardIntegration",null),e([re()],ne.prototype,"getClipboardIntegration",null),e([re()],ne.prototype,"isSuspended",null),e([re()],ne.prototype,"getSuspendKind",null),e([re()],ne.prototype,"cancelSuspend",null),e([re()],ne.prototype,"getSuspendContextClipboardCopy",null),e([re()],ne.prototype,"getSuspendContextClipboardPaste",null),e([re()],ne.prototype,"setNetworkRedirection",null),e([re()],ne.prototype,"getNetworkRedirection",null),e([re()],ne.prototype,"getSuspendContextNetworkConnect",null),e([re()],ne.prototype,"getSuspendContextNetworkRpc",null),e([re()],ne.prototype,"copyBuffer",null),e([re()],ne.prototype,"freeBuffer",null),e([re()],ne.prototype,"setHotsyncNameManagement",null),e([re()],ne.prototype,"resolveBuffer",null),e([re()],ne.prototype,"serializeSessionImage",null),e([re()],ne.prototype,"deserializeSessionImage",null),e([re()],ne.prototype,"launchAppByName",null),e([re()],ne.prototype,"launchAppByDbHeader",null),e([re()],ne.prototype,"deviceSupportsCardSize",null),e([re()],ne.prototype,"clearExternalStorage",null),e([re()],ne.prototype,"allocateCard",null),e([re()],ne.prototype,"decompressCard",null),e([re()],ne.prototype,"getCardData",null),e([re()],ne.prototype,"getCardDirtyPages",null),e([re()],ne.prototype,"getMountedKey",null),e([re()],ne.prototype,"mountCard",null),e([re()],ne.prototype,"removeCard",null),e([re()],ne.prototype,"remountCards",null),e([re()],ne.prototype,"getCardSupportLevel",null),e([re()],ne.prototype,"loadSkin",null),function(e){e[e.cal=0]="cal",e[e.phone=1]="phone",e[e.todo=2]="todo",e[e.notes=3]="notes",e[e.up=4]="up",e[e.down=5]="down",e[e.power=6]="power",e[e.cradle=7]="cradle"}(ie||(ie={}));const oe="1.8.0-5cde9e6 (preview)";function se(e){return t(this,void 0,void 0,(function*(){return new $(yield ne.create(e))}))}})(),n})()));
//# sourceMappingURL=cloudpilot-emu.js.map