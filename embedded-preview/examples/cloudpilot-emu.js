!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.cloudpilot=t():e.cloudpilot=t()}(self,(()=>(()=>{var e={492:e=>{var t,i=(t="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(e={}){var i,r,n=e;n.ready=new Promise(((e,t)=>{i=e,r=t}));var o,s=Object.assign({},n),a="./this.program",p=(e,t)=>{throw t},c="object"==typeof window,u="function"==typeof importScripts,l=("object"==typeof process&&"object"==typeof process.versions&&process.versions.node,"");(c||u)&&(u?l=self.location.href:"undefined"!=typeof document&&document.currentScript&&(l=document.currentScript.src),t&&(l=t),l=0!==l.indexOf("blob:")?l.substr(0,l.replace(/[?#].*/,"").lastIndexOf("/")+1):"",u&&(o=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}));var d,h,_=n.print||console.log.bind(console),m=n.printErr||console.error.bind(console);Object.assign(n,s),s=null,n.arguments&&n.arguments,n.thisProgram&&(a=n.thisProgram),n.quit&&(p=n.quit),n.wasmBinary&&(d=n.wasmBinary),"object"!=typeof WebAssembly&&z("no native wasm support detected");var y,f,v,g,b,S,C=!1;function w(e,t){e||z(t)}function I(){var e=h.buffer;n.HEAP8=f=new Int8Array(e),n.HEAP16=new Int16Array(e),n.HEAPU8=v=new Uint8Array(e),n.HEAPU16=new Uint16Array(e),n.HEAP32=g=new Int32Array(e),n.HEAPU32=b=new Uint32Array(e),n.HEAPF32=new Float32Array(e),n.HEAPF64=S=new Float64Array(e)}function E(){if(!C){var e=qr();0==e&&(e+=4);var t=b[e>>2],i=b[e+4>>2];34821223==t&&2310721022==i||z(`Stack overflow! Stack cookie has been overwritten at ${W(e)}, expected hex dwords 0x89BACDFE and 0x2135467, but received ${W(i)} ${W(t)}`),1668509029!=b[0]&&z("Runtime error: The application has corrupted its heap memory area (address zero)!")}}var G=[],D=[],x=[],P=[],k=0,M=null,R=null;function z(e){n.onAbort&&n.onAbort(e),m(e="Aborted("+e+")"),C=!0,y=1,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw r(t),t}var T,H,B,A=e=>e.startsWith("data:application/octet-stream;base64,");function N(e){if(e==T&&d)return new Uint8Array(d);if(o)return o(e);throw"both async and sync fetching of the wasm failed"}function F(e,t,i){return function(e){return d||!c&&!u||"function"!=typeof fetch?Promise.resolve().then((()=>N(e))):fetch(e,{credentials:"same-origin"}).then((t=>{if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()})).catch((()=>N(e)))}(e).then((e=>WebAssembly.instantiate(e,t))).then((e=>e)).then(i,(e=>{m(`failed to asynchronously prepare wasm: ${e}`),z(e)}))}A(T="cloudpilot_web.wasm")||(H=T,T=n.locateFile?n.locateFile(H,l):l+H);var L={425368:e=>{ue.grow(65536);for(let t=0;t<=65535;t++)ue.set(ue.length-65535-1+t,ue.get(b[(e>>>2)+t]));return ue.length-65535-1}};function U(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}var j=e=>{for(;e.length>0;)e.shift()(n)},O=n.noExitRuntime||!0,W=e=>"0x"+(e>>>=0).toString(16).padStart(8,"0"),V="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0,q=(e,t,i)=>{for(var r=t+i,n=t;e[n]&&!(n>=r);)++n;if(n-t>16&&e.buffer&&V)return V.decode(e.subarray(t,n));for(var o="";t<n;){var s=e[t++];if(128&s){var a=63&e[t++];if(192!=(224&s)){var p=63&e[t++];if((s=224==(240&s)?(15&s)<<12|a<<6|p:(7&s)<<18|a<<12|p<<6|63&e[t++])<65536)o+=String.fromCharCode(s);else{var c=s-65536;o+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else o+=String.fromCharCode((31&s)<<6|a)}else o+=String.fromCharCode(s)}return o},K=(e,t)=>e?q(v,e,t):"",Y=(e,t)=>t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,Z=e=>e%4==0&&(e%100!=0||e%400==0),Q=[0,31,60,91,121,152,182,213,244,274,305,335],$=[0,31,59,90,120,151,181,212,243,273,304,334],X=e=>(Z(e.getFullYear())?Q:$)[e.getMonth()]+e.getDate()-1,J=e=>{for(var t=0,i=0;i<e.length;++i){var r=e.charCodeAt(i);r<=127?t++:r<=2047?t+=2:r>=55296&&r<=57343?(t+=4,++i):t+=3}return t},ee=(e,t,i,r)=>{if(!(r>0))return 0;for(var n=i,o=i+r-1,s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a>=55296&&a<=57343&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++s)),a<=127){if(i>=o)break;t[i++]=a}else if(a<=2047){if(i+1>=o)break;t[i++]=192|a>>6,t[i++]=128|63&a}else if(a<=65535){if(i+2>=o)break;t[i++]=224|a>>12,t[i++]=128|a>>6&63,t[i++]=128|63&a}else{if(i+3>=o)break;t[i++]=240|a>>18,t[i++]=128|a>>12&63,t[i++]=128|a>>6&63,t[i++]=128|63&a}}return t[i]=0,i-n},te=e=>{var t=J(e)+1,i=be(t);return i&&((e,t,i)=>{ee(e,v,t,i)})(e,i,t),i},ie=[],re=e=>{var t=(e-h.buffer.byteLength+65535)/65536;try{return h.grow(t),I(),1}catch(e){}},ne={},oe=()=>{if(!oe.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:a||"./this.program"};for(var t in ne)void 0===ne[t]?delete e[t]:e[t]=ne[t];var i=[];for(var t in e)i.push(`${t}=${e[t]}`);oe.strings=i}return oe.strings},se=[null,[],[]],ae=[31,29,31,30,31,30,31,31,30,31,30,31],pe=[31,28,31,30,31,30,31,31,30,31,30,31];function ce(e,t,i){var r=i>0?i:J(e)+1,n=new Array(r),o=ee(e,n,0,n.length);return t&&(n.length=o),n}var ue,le,de,he=(e,t)=>{var i;y=e,y=i=e,O||(n.onExit&&n.onExit(i),C=!0),p(i,new U(i))},_e=(e,t)=>{e<128?t.push(e):t.push(e%128|128,e>>7)},me=[],ye=[],fe=(e,t)=>{ue.set(e,t),me[e]=ue.get(e)},ve={b:(e,t,i,r)=>{z(`Assertion failed: ${K(e)}, at: `+[t?K(t):"unknown filename",i,r?K(r):"unknown function"])},i:function(e){const t=new Error(K(e));throw t.isAssert=!0,t},m:function(e,t,i){Y(t,i)},h:()=>1,j:function(e,t,i){var r=Y(e,t),n=new Date(1e3*r);g[i>>2]=n.getSeconds(),g[i+4>>2]=n.getMinutes(),g[i+8>>2]=n.getHours(),g[i+12>>2]=n.getDate(),g[i+16>>2]=n.getMonth(),g[i+20>>2]=n.getFullYear()-1900,g[i+24>>2]=n.getDay();var o=0|X(n);g[i+28>>2]=o,g[i+36>>2]=-60*n.getTimezoneOffset();var s=new Date(n.getFullYear(),0,1),a=new Date(n.getFullYear(),6,1).getTimezoneOffset(),p=s.getTimezoneOffset(),c=0|(a!=p&&n.getTimezoneOffset()==Math.min(p,a));g[i+32>>2]=c},k:function(e){var t=(()=>{var t=new Date(g[e+20>>2]+1900,g[e+16>>2],g[e+12>>2],g[e+8>>2],g[e+4>>2],g[e>>2],0),i=g[e+32>>2],r=t.getTimezoneOffset(),n=new Date(t.getFullYear(),0,1),o=new Date(t.getFullYear(),6,1).getTimezoneOffset(),s=n.getTimezoneOffset(),a=Math.min(s,o);if(i<0)g[e+32>>2]=Number(o!=s&&a==r);else if(i>0!=(a==r)){var p=Math.max(s,o),c=i>0?a:p;t.setTime(t.getTime()+6e4*(c-r))}g[e+24>>2]=t.getDay();var u=0|X(t);g[e+28>>2]=u,g[e>>2]=t.getSeconds(),g[e+4>>2]=t.getMinutes(),g[e+8>>2]=t.getHours(),g[e+12>>2]=t.getDate(),g[e+16>>2]=t.getMonth(),g[e+20>>2]=t.getYear();var l=t.getTime();return isNaN(l)?(61,g[Or()>>2]=61,-1):l/1e3})();return Wr((B=t,+Math.abs(B)>=1?B>0?+Math.floor(B/4294967296)>>>0:~~+Math.ceil((B-+(~~B>>>0))/4294967296)>>>0:0)),t>>>0},r:(e,t,i)=>{var r=(new Date).getFullYear(),n=new Date(r,0,1),o=new Date(r,6,1),s=n.getTimezoneOffset(),a=o.getTimezoneOffset(),p=Math.max(s,a);function c(e){var t=e.toTimeString().match(/\(([A-Za-z ]+)\)$/);return t?t[1]:"GMT"}b[e>>2]=60*p,g[t>>2]=Number(s!=a);var u=c(n),l=c(o),d=te(u),h=te(l);a<s?(b[i>>2]=d,b[i+4>>2]=h):(b[i>>2]=h,b[i+4>>2]=d)},a:()=>{z("")},s:(e,t,i)=>((e,t,i)=>{var r=((e,t)=>{var i;for(ie.length=0;i=v[e++];){var r=105!=i;t+=(r&=112!=i)&&t%8?4:0,ie.push(112==i?b[t>>2]:105==i?g[t>>2]:S[t>>3]),t+=r?8:4}return ie})(t,i);return L[e].apply(null,r)})(e,t,i),c:()=>Date.now(),d:(e,t,i)=>v.copyWithin(e,t,t+i),q:e=>{var t=v.length,i=2147483648;if((e>>>=0)>i)return!1;for(var r,n=1;n<=4;n*=2){var o=t*(1+.2/n);o=Math.min(o,e+100663296);var s=Math.min(i,(r=Math.max(e,o))+(65536-r%65536)%65536);if(re(s))return!0}return!1},o:(e,t)=>{var i=0;return oe().forEach(((r,n)=>{var o=t+i;b[e+4*n>>2]=o,((e,t)=>{for(var i=0;i<e.length;++i)f[t++>>0]=e.charCodeAt(i);f[t>>0]=0})(r,o),i+=r.length+1})),0},p:(e,t)=>{var i=oe();b[e>>2]=i.length;var r=0;return i.forEach((e=>r+=e.length+1)),b[t>>2]=r,0},e:e=>52,g:(e,t,i,r)=>52,l:function(e,t,i,r,n){return Y(t,i),70},f:(e,t,i,r)=>{for(var n,o,s,a=0,p=0;p<i;p++){var c=b[t>>2],u=b[t+4>>2];t+=8;for(var l=0;l<u;l++)n=e,o=v[c+l],s=void 0,s=se[n],0===o||10===o?((1===n?_:m)(q(s,0)),s.length=0):s.push(o);a+=u}return b[r>>2]=a,0},n:(e,t,i,r,n)=>((e,t,i,r)=>{var n=b[r+40>>2],o={tm_sec:g[r>>2],tm_min:g[r+4>>2],tm_hour:g[r+8>>2],tm_mday:g[r+12>>2],tm_mon:g[r+16>>2],tm_year:g[r+20>>2],tm_wday:g[r+24>>2],tm_yday:g[r+28>>2],tm_isdst:g[r+32>>2],tm_gmtoff:g[r+36>>2],tm_zone:n?K(n):""},s=K(i),a={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var p in a)s=s.replace(new RegExp(p,"g"),a[p]);var c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],u=["January","February","March","April","May","June","July","August","September","October","November","December"];function l(e,t,i){for(var r="number"==typeof e?e.toString():e||"";r.length<t;)r=i[0]+r;return r}function d(e,t){return l(e,t,"0")}function h(e,t){function i(e){return e<0?-1:e>0?1:0}var r;return 0===(r=i(e.getFullYear()-t.getFullYear()))&&0===(r=i(e.getMonth()-t.getMonth()))&&(r=i(e.getDate()-t.getDate())),r}function _(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function m(e){var t=((e,t)=>{for(var i=new Date(e.getTime());t>0;){var r=Z(i.getFullYear()),n=i.getMonth(),o=(r?ae:pe)[n];if(!(t>o-i.getDate()))return i.setDate(i.getDate()+t),i;t-=o-i.getDate()+1,i.setDate(1),n<11?i.setMonth(n+1):(i.setMonth(0),i.setFullYear(i.getFullYear()+1))}return i})(new Date(e.tm_year+1900,0,1),e.tm_yday),i=new Date(t.getFullYear(),0,4),r=new Date(t.getFullYear()+1,0,4),n=_(i),o=_(r);return h(n,t)<=0?h(o,t)<=0?t.getFullYear()+1:t.getFullYear():t.getFullYear()-1}var y={"%a":e=>c[e.tm_wday].substring(0,3),"%A":e=>c[e.tm_wday],"%b":e=>u[e.tm_mon].substring(0,3),"%B":e=>u[e.tm_mon],"%C":e=>d((e.tm_year+1900)/100|0,2),"%d":e=>d(e.tm_mday,2),"%e":e=>l(e.tm_mday,2," "),"%g":e=>m(e).toString().substring(2),"%G":e=>m(e),"%H":e=>d(e.tm_hour,2),"%I":e=>{var t=e.tm_hour;return 0==t?t=12:t>12&&(t-=12),d(t,2)},"%j":e=>d(e.tm_mday+((e,t)=>{for(var i=0,r=0;r<=t;i+=e[r++]);return i})(Z(e.tm_year+1900)?ae:pe,e.tm_mon-1),3),"%m":e=>d(e.tm_mon+1,2),"%M":e=>d(e.tm_min,2),"%n":()=>"\n","%p":e=>e.tm_hour>=0&&e.tm_hour<12?"AM":"PM","%S":e=>d(e.tm_sec,2),"%t":()=>"\t","%u":e=>e.tm_wday||7,"%U":e=>{var t=e.tm_yday+7-e.tm_wday;return d(Math.floor(t/7),2)},"%V":e=>{var t=Math.floor((e.tm_yday+7-(e.tm_wday+6)%7)/7);if((e.tm_wday+371-e.tm_yday-2)%7<=2&&t++,t){if(53==t){var i=(e.tm_wday+371-e.tm_yday)%7;4==i||3==i&&Z(e.tm_year)||(t=1)}}else{t=52;var r=(e.tm_wday+7-e.tm_yday-1)%7;(4==r||5==r&&Z(e.tm_year%400-1))&&t++}return d(t,2)},"%w":e=>e.tm_wday,"%W":e=>{var t=e.tm_yday+7-(e.tm_wday+6)%7;return d(Math.floor(t/7),2)},"%y":e=>(e.tm_year+1900).toString().substring(2),"%Y":e=>e.tm_year+1900,"%z":e=>{var t=e.tm_gmtoff,i=t>=0;return t=(t=Math.abs(t)/60)/60*100+t%60,(i?"+":"-")+String("0000"+t).slice(-4)},"%Z":e=>e.tm_zone,"%%":()=>"%"};for(var p in s=s.replace(/%%/g,"\0\0"),y)s.includes(p)&&(s=s.replace(new RegExp(p,"g"),y[p](o)));var v,S,C=ce(s=s.replace(/\0\0/g,"%"),!1);return C.length>t?0:(v=C,S=e,f.set(v,S),C.length-1)})(e,t,i,r)},ge=function(){var e,t,i,o,s={a:ve};function a(e,t){var i;return ge=e.exports,h=ge.t,I(),ue=ge.Wc,i=ge.u,D.unshift(i),function(e){if(k--,n.monitorRunDependencies&&n.monitorRunDependencies(k),0==k&&(null!==M&&(clearInterval(M),M=null),R)){var t=R;R=null,t()}}(),ge}if(k++,n.monitorRunDependencies&&n.monitorRunDependencies(k),n.instantiateWasm)try{return n.instantiateWasm(s,a)}catch(e){m(`Module.instantiateWasm callback failed with error: ${e}`),r(e)}return(e=d,t=T,i=s,o=function(e){a(e.instance)},e||"function"!=typeof WebAssembly.instantiateStreaming||A(t)||"function"!=typeof fetch?F(t,i,o):fetch(t,{credentials:"same-origin"}).then((e=>WebAssembly.instantiateStreaming(e,i).then(o,(function(e){return m(`wasm streaming compile failed: ${e}`),m("falling back to ArrayBuffer instantiation"),F(t,i,o)}))))).catch(r),{}}(),be=n._malloc=e=>(be=n._malloc=ge.v)(e),Se=(n._free=e=>(n._free=ge.w)(e),n._main=(e,t)=>(Se=n._main=ge.x)(e,t)),Ce=(n._webidl_free=e=>(n._webidl_free=ge.y)(e),n._webidl_malloc=e=>(n._webidl_malloc=ge.z)(e),n._emscripten_bind_VoidPtr___destroy___0=e=>(Ce=n._emscripten_bind_VoidPtr___destroy___0=ge.A)(e)),we=n._emscripten_bind_Cloudpilot_Cloudpilot_0=()=>(we=n._emscripten_bind_Cloudpilot_Cloudpilot_0=ge.B)(),Ie=n._emscripten_bind_Cloudpilot_Malloc_1=(e,t)=>(Ie=n._emscripten_bind_Cloudpilot_Malloc_1=ge.C)(e,t),Ee=n._emscripten_bind_Cloudpilot_Free_1=(e,t)=>(Ee=n._emscripten_bind_Cloudpilot_Free_1=ge.D)(e,t),Ge=n._emscripten_bind_Cloudpilot_Nullptr_0=e=>(Ge=n._emscripten_bind_Cloudpilot_Nullptr_0=ge.E)(e),De=n._emscripten_bind_Cloudpilot_InitializeSession_3=(e,t,i,r)=>(De=n._emscripten_bind_Cloudpilot_InitializeSession_3=ge.F)(e,t,i,r),xe=n._emscripten_bind_Cloudpilot_GetCyclesPerSecond_0=e=>(xe=n._emscripten_bind_Cloudpilot_GetCyclesPerSecond_0=ge.G)(e),Pe=n._emscripten_bind_Cloudpilot_RunEmulation_1=(e,t)=>(Pe=n._emscripten_bind_Cloudpilot_RunEmulation_1=ge.H)(e,t),ke=n._emscripten_bind_Cloudpilot_SetClockFactor_1=(e,t)=>(ke=n._emscripten_bind_Cloudpilot_SetClockFactor_1=ge.I)(e,t),Me=n._emscripten_bind_Cloudpilot_CopyFrame_0=e=>(Me=n._emscripten_bind_Cloudpilot_CopyFrame_0=ge.J)(e),Re=n._emscripten_bind_Cloudpilot_IsScreenDirty_0=e=>(Re=n._emscripten_bind_Cloudpilot_IsScreenDirty_0=ge.K)(e),ze=n._emscripten_bind_Cloudpilot_MarkScreenClean_0=e=>(ze=n._emscripten_bind_Cloudpilot_MarkScreenClean_0=ge.L)(e),Te=n._emscripten_bind_Cloudpilot_MinMemoryForDevice_1=(e,t)=>(Te=n._emscripten_bind_Cloudpilot_MinMemoryForDevice_1=ge.M)(e,t),He=n._emscripten_bind_Cloudpilot_FramebufferSizeForDevice_1=(e,t)=>(He=n._emscripten_bind_Cloudpilot_FramebufferSizeForDevice_1=ge.N)(e,t),Be=n._emscripten_bind_Cloudpilot_TotalMemoryForDevice_1=(e,t)=>(Be=n._emscripten_bind_Cloudpilot_TotalMemoryForDevice_1=ge.O)(e,t),Ae=n._emscripten_bind_Cloudpilot_QueuePenMove_2=(e,t,i)=>(Ae=n._emscripten_bind_Cloudpilot_QueuePenMove_2=ge.P)(e,t,i),Ne=n._emscripten_bind_Cloudpilot_QueuePenUp_0=e=>(Ne=n._emscripten_bind_Cloudpilot_QueuePenUp_0=ge.Q)(e),Fe=n._emscripten_bind_Cloudpilot_QueueButtonDown_1=(e,t)=>(Fe=n._emscripten_bind_Cloudpilot_QueueButtonDown_1=ge.R)(e,t),Le=n._emscripten_bind_Cloudpilot_QueueButtonUp_1=(e,t)=>(Le=n._emscripten_bind_Cloudpilot_QueueButtonUp_1=ge.S)(e,t),Ue=n._emscripten_bind_Cloudpilot_QueueKeyboardEvent_2=(e,t,i)=>(Ue=n._emscripten_bind_Cloudpilot_QueueKeyboardEvent_2=ge.T)(e,t,i),je=n._emscripten_bind_Cloudpilot_IsPowerOff_0=e=>(je=n._emscripten_bind_Cloudpilot_IsPowerOff_0=ge.U)(e),Oe=n._emscripten_bind_Cloudpilot_IsUIInitialized_0=e=>(Oe=n._emscripten_bind_Cloudpilot_IsUIInitialized_0=ge.V)(e),We=n._emscripten_bind_Cloudpilot_GetOSVersion_0=e=>(We=n._emscripten_bind_Cloudpilot_GetOSVersion_0=ge.W)(e),Ve=n._emscripten_bind_Cloudpilot_IsSetupComplete_0=e=>(Ve=n._emscripten_bind_Cloudpilot_IsSetupComplete_0=ge.X)(e),qe=n._emscripten_bind_Cloudpilot_Reset_0=e=>(qe=n._emscripten_bind_Cloudpilot_Reset_0=ge.Y)(e),Ke=n._emscripten_bind_Cloudpilot_ResetNoExtensions_0=e=>(Ke=n._emscripten_bind_Cloudpilot_ResetNoExtensions_0=ge.Z)(e),Ye=n._emscripten_bind_Cloudpilot_ResetHard_0=e=>(Ye=n._emscripten_bind_Cloudpilot_ResetHard_0=ge._)(e),Ze=n._emscripten_bind_Cloudpilot_InstallDb_2=(e,t,i)=>(Ze=n._emscripten_bind_Cloudpilot_InstallDb_2=ge.$)(e,t,i),Qe=n._emscripten_bind_Cloudpilot_GetPalette2bitMapping_0=e=>(Qe=n._emscripten_bind_Cloudpilot_GetPalette2bitMapping_0=ge.aa)(e),$e=n._emscripten_bind_Cloudpilot_GetMemoryPtr_0=e=>($e=n._emscripten_bind_Cloudpilot_GetMemoryPtr_0=ge.ba)(e),Xe=n._emscripten_bind_Cloudpilot_GetDirtyPagesPtr_0=e=>(Xe=n._emscripten_bind_Cloudpilot_GetDirtyPagesPtr_0=ge.ca)(e),Je=n._emscripten_bind_Cloudpilot_GetMemorySize_0=e=>(Je=n._emscripten_bind_Cloudpilot_GetMemorySize_0=ge.da)(e),et=n._emscripten_bind_Cloudpilot_ImportMemoryImage_2=(e,t,i)=>(et=n._emscripten_bind_Cloudpilot_ImportMemoryImage_2=ge.ea)(e,t,i),tt=n._emscripten_bind_Cloudpilot_GetRomPtr_0=e=>(tt=n._emscripten_bind_Cloudpilot_GetRomPtr_0=ge.fa)(e),it=n._emscripten_bind_Cloudpilot_GetRomSize_0=e=>(it=n._emscripten_bind_Cloudpilot_GetRomSize_0=ge.ga)(e),rt=n._emscripten_bind_Cloudpilot_GetSavestatePtr_0=e=>(rt=n._emscripten_bind_Cloudpilot_GetSavestatePtr_0=ge.ha)(e),nt=n._emscripten_bind_Cloudpilot_GetSavestateSize_0=e=>(nt=n._emscripten_bind_Cloudpilot_GetSavestateSize_0=ge.ia)(e),ot=n._emscripten_bind_Cloudpilot_SaveState_0=e=>(ot=n._emscripten_bind_Cloudpilot_SaveState_0=ge.ja)(e),st=n._emscripten_bind_Cloudpilot_LoadState_2=(e,t,i)=>(st=n._emscripten_bind_Cloudpilot_LoadState_2=ge.ka)(e,t,i),at=n._emscripten_bind_Cloudpilot_GetHotsyncName_0=e=>(at=n._emscripten_bind_Cloudpilot_GetHotsyncName_0=ge.la)(e),pt=n._emscripten_bind_Cloudpilot_SetHotsyncName_1=(e,t)=>(pt=n._emscripten_bind_Cloudpilot_SetHotsyncName_1=ge.ma)(e,t),ct=n._emscripten_bind_Cloudpilot_RegisterPwmHandler_1=(e,t)=>(ct=n._emscripten_bind_Cloudpilot_RegisterPwmHandler_1=ge.na)(e,t),ut=n._emscripten_bind_Cloudpilot_StartBackup_0=e=>(ut=n._emscripten_bind_Cloudpilot_StartBackup_0=ge.oa)(e),lt=n._emscripten_bind_Cloudpilot_SetClipboardIntegration_1=(e,t)=>(lt=n._emscripten_bind_Cloudpilot_SetClipboardIntegration_1=ge.pa)(e,t),dt=n._emscripten_bind_Cloudpilot_GetClipboardIntegration_0=e=>(dt=n._emscripten_bind_Cloudpilot_GetClipboardIntegration_0=ge.qa)(e),ht=n._emscripten_bind_Cloudpilot_IsSuspended_0=e=>(ht=n._emscripten_bind_Cloudpilot_IsSuspended_0=ge.ra)(e),_t=n._emscripten_bind_Cloudpilot_GetSuspendContext_0=e=>(_t=n._emscripten_bind_Cloudpilot_GetSuspendContext_0=ge.sa)(e),mt=n._emscripten_bind_Cloudpilot_SetNetworkRedirection_1=(e,t)=>(mt=n._emscripten_bind_Cloudpilot_SetNetworkRedirection_1=ge.ta)(e,t),yt=n._emscripten_bind_Cloudpilot_GetNetworkRedirection_0=e=>(yt=n._emscripten_bind_Cloudpilot_GetNetworkRedirection_0=ge.ua)(e),ft=n._emscripten_bind_Cloudpilot_RegisterProxyDisconnectHandler_1=(e,t)=>(ft=n._emscripten_bind_Cloudpilot_RegisterProxyDisconnectHandler_1=ge.va)(e,t),vt=n._emscripten_bind_Cloudpilot_SetHotsyncNameManagement_1=(e,t)=>(vt=n._emscripten_bind_Cloudpilot_SetHotsyncNameManagement_1=ge.wa)(e,t),gt=n._emscripten_bind_Cloudpilot_LaunchAppByName_1=(e,t)=>(gt=n._emscripten_bind_Cloudpilot_LaunchAppByName_1=ge.xa)(e,t),bt=n._emscripten_bind_Cloudpilot_LaunchAppByDbHeader_2=(e,t,i)=>(bt=n._emscripten_bind_Cloudpilot_LaunchAppByDbHeader_2=ge.ya)(e,t,i),St=n._emscripten_bind_Cloudpilot_DeviceSupportsCardSize_1=(e,t)=>(St=n._emscripten_bind_Cloudpilot_DeviceSupportsCardSize_1=ge.za)(e,t),Ct=n._emscripten_bind_Cloudpilot_ClearExternalStorage_0=e=>(Ct=n._emscripten_bind_Cloudpilot_ClearExternalStorage_0=ge.Aa)(e),wt=n._emscripten_bind_Cloudpilot_AllocateCard_2=(e,t,i)=>(wt=n._emscripten_bind_Cloudpilot_AllocateCard_2=ge.Ba)(e,t,i),It=n._emscripten_bind_Cloudpilot_AdoptCard_3=(e,t,i,r)=>(It=n._emscripten_bind_Cloudpilot_AdoptCard_3=ge.Ca)(e,t,i,r),Et=n._emscripten_bind_Cloudpilot_MountCard_1=(e,t)=>(Et=n._emscripten_bind_Cloudpilot_MountCard_1=ge.Da)(e,t),Gt=n._emscripten_bind_Cloudpilot_RemoveCard_1=(e,t)=>(Gt=n._emscripten_bind_Cloudpilot_RemoveCard_1=ge.Ea)(e,t),Dt=n._emscripten_bind_Cloudpilot_GetCardData_1=(e,t)=>(Dt=n._emscripten_bind_Cloudpilot_GetCardData_1=ge.Fa)(e,t),xt=n._emscripten_bind_Cloudpilot_GetCardDirtyPages_1=(e,t)=>(xt=n._emscripten_bind_Cloudpilot_GetCardDirtyPages_1=ge.Ga)(e,t),Pt=n._emscripten_bind_Cloudpilot_GetCardSize_1=(e,t)=>(Pt=n._emscripten_bind_Cloudpilot_GetCardSize_1=ge.Ha)(e,t),kt=n._emscripten_bind_Cloudpilot_RemountCards_0=e=>(kt=n._emscripten_bind_Cloudpilot_RemountCards_0=ge.Ia)(e),Mt=n._emscripten_bind_Cloudpilot_GetSupportLevel_1=(e,t)=>(Mt=n._emscripten_bind_Cloudpilot_GetSupportLevel_1=ge.Ja)(e,t),Rt=n._emscripten_bind_Cloudpilot_GetMountedKey_0=e=>(Rt=n._emscripten_bind_Cloudpilot_GetMountedKey_0=ge.Ka)(e),zt=n._emscripten_bind_Cloudpilot_GetTransportIR_0=e=>(zt=n._emscripten_bind_Cloudpilot_GetTransportIR_0=ge.La)(e),Tt=n._emscripten_bind_Cloudpilot_GetTransportSerial_0=e=>(Tt=n._emscripten_bind_Cloudpilot_GetTransportSerial_0=ge.Ma)(e),Ht=n._emscripten_bind_Cloudpilot___destroy___0=e=>(Ht=n._emscripten_bind_Cloudpilot___destroy___0=ge.Na)(e),Bt=n._emscripten_bind_RomInfo_RomInfo_2=(e,t)=>(Bt=n._emscripten_bind_RomInfo_RomInfo_2=ge.Oa)(e,t),At=n._emscripten_bind_RomInfo_IsValid_0=e=>(At=n._emscripten_bind_RomInfo_IsValid_0=ge.Pa)(e),Nt=n._emscripten_bind_RomInfo_CardVersion_0=e=>(Nt=n._emscripten_bind_RomInfo_CardVersion_0=ge.Qa)(e),Ft=n._emscripten_bind_RomInfo_CardName_0=e=>(Ft=n._emscripten_bind_RomInfo_CardName_0=ge.Ra)(e),Lt=n._emscripten_bind_RomInfo_RomVersion_0=e=>(Lt=n._emscripten_bind_RomInfo_RomVersion_0=ge.Sa)(e),Ut=n._emscripten_bind_RomInfo_RomVersionString_0=e=>(Ut=n._emscripten_bind_RomInfo_RomVersionString_0=ge.Ta)(e),jt=n._emscripten_bind_RomInfo_Supports_1=(e,t)=>(jt=n._emscripten_bind_RomInfo_Supports_1=ge.Ua)(e,t),Ot=n._emscripten_bind_RomInfo___destroy___0=e=>(Ot=n._emscripten_bind_RomInfo___destroy___0=ge.Va)(e),Wt=n._emscripten_bind_Frame_GetLineWidth_0=e=>(Wt=n._emscripten_bind_Frame_GetLineWidth_0=ge.Wa)(e),Vt=n._emscripten_bind_Frame_GetBpp_0=e=>(Vt=n._emscripten_bind_Frame_GetBpp_0=ge.Xa)(e),qt=n._emscripten_bind_Frame_GetLines_0=e=>(qt=n._emscripten_bind_Frame_GetLines_0=ge.Ya)(e),Kt=n._emscripten_bind_Frame_GetMargin_0=e=>(Kt=n._emscripten_bind_Frame_GetMargin_0=ge.Za)(e),Yt=n._emscripten_bind_Frame_GetBytesPerLine_0=e=>(Yt=n._emscripten_bind_Frame_GetBytesPerLine_0=ge._a)(e),Zt=n._emscripten_bind_Frame_GetFirstDirtyLine_0=e=>(Zt=n._emscripten_bind_Frame_GetFirstDirtyLine_0=ge.$a)(e),Qt=n._emscripten_bind_Frame_GetLastDirtyLine_0=e=>(Qt=n._emscripten_bind_Frame_GetLastDirtyLine_0=ge.ab)(e),$t=n._emscripten_bind_Frame_GetHasChanges_0=e=>($t=n._emscripten_bind_Frame_GetHasChanges_0=ge.bb)(e),Xt=n._emscripten_bind_Frame_GetBuffer_0=e=>(Xt=n._emscripten_bind_Frame_GetBuffer_0=ge.cb)(e),Jt=n._emscripten_bind_Frame_GetBufferSize_0=e=>(Jt=n._emscripten_bind_Frame_GetBufferSize_0=ge.db)(e),ei=n._emscripten_bind_Frame_GetScaleX_0=e=>(ei=n._emscripten_bind_Frame_GetScaleX_0=ge.eb)(e),ti=n._emscripten_bind_Frame_GetScaleY_0=e=>(ti=n._emscripten_bind_Frame_GetScaleY_0=ge.fb)(e),ii=n._emscripten_bind_Frame___destroy___0=e=>(ii=n._emscripten_bind_Frame___destroy___0=ge.gb)(e),ri=n._emscripten_bind_DbBackup_Init_1=(e,t)=>(ri=n._emscripten_bind_DbBackup_Init_1=ge.hb)(e,t),ni=n._emscripten_bind_DbBackup_IsInProgress_0=e=>(ni=n._emscripten_bind_DbBackup_IsInProgress_0=ge.ib)(e),oi=n._emscripten_bind_DbBackup_IsDone_0=e=>(oi=n._emscripten_bind_DbBackup_IsDone_0=ge.jb)(e),si=n._emscripten_bind_DbBackup_GetCurrentDatabase_0=e=>(si=n._emscripten_bind_DbBackup_GetCurrentDatabase_0=ge.kb)(e),ai=n._emscripten_bind_DbBackup_Save_0=e=>(ai=n._emscripten_bind_DbBackup_Save_0=ge.lb)(e),pi=n._emscripten_bind_DbBackup_Skip_0=e=>(pi=n._emscripten_bind_DbBackup_Skip_0=ge.mb)(e),ci=n._emscripten_bind_DbBackup_GetArchivePtr_0=e=>(ci=n._emscripten_bind_DbBackup_GetArchivePtr_0=ge.nb)(e),ui=n._emscripten_bind_DbBackup_GetArchiveSize_0=e=>(ui=n._emscripten_bind_DbBackup_GetArchiveSize_0=ge.ob)(e),li=n._emscripten_bind_DbBackup___destroy___0=e=>(li=n._emscripten_bind_DbBackup___destroy___0=ge.pb)(e),di=n._emscripten_bind_SuspendContextClipboardCopy_Cancel_0=e=>(di=n._emscripten_bind_SuspendContextClipboardCopy_Cancel_0=ge.qb)(e),hi=n._emscripten_bind_SuspendContextClipboardCopy_Resume_0=e=>(hi=n._emscripten_bind_SuspendContextClipboardCopy_Resume_0=ge.rb)(e),_i=n._emscripten_bind_SuspendContextClipboardCopy_GetClipboardContent_0=e=>(_i=n._emscripten_bind_SuspendContextClipboardCopy_GetClipboardContent_0=ge.sb)(e),mi=n._emscripten_bind_SuspendContextClipboardCopy___destroy___0=e=>(mi=n._emscripten_bind_SuspendContextClipboardCopy___destroy___0=ge.tb)(e),yi=n._emscripten_bind_SuspendContextClipboardPaste_Cancel_0=e=>(yi=n._emscripten_bind_SuspendContextClipboardPaste_Cancel_0=ge.ub)(e),fi=n._emscripten_bind_SuspendContextClipboardPaste_Resume_1=(e,t)=>(fi=n._emscripten_bind_SuspendContextClipboardPaste_Resume_1=ge.vb)(e,t),vi=n._emscripten_bind_SuspendContextClipboardPaste___destroy___0=e=>(vi=n._emscripten_bind_SuspendContextClipboardPaste___destroy___0=ge.wb)(e),gi=n._emscripten_bind_SuspendContextNetworkConnect_Cancel_0=e=>(gi=n._emscripten_bind_SuspendContextNetworkConnect_Cancel_0=ge.xb)(e),bi=n._emscripten_bind_SuspendContextNetworkConnect_Resume_1=(e,t)=>(bi=n._emscripten_bind_SuspendContextNetworkConnect_Resume_1=ge.yb)(e,t),Si=n._emscripten_bind_SuspendContextNetworkConnect___destroy___0=e=>(Si=n._emscripten_bind_SuspendContextNetworkConnect___destroy___0=ge.zb)(e),Ci=n._emscripten_bind_SuspendContextNetworkRpc_Cancel_0=e=>(Ci=n._emscripten_bind_SuspendContextNetworkRpc_Cancel_0=ge.Ab)(e),wi=n._emscripten_bind_SuspendContextNetworkRpc_GetRequestSize_0=e=>(wi=n._emscripten_bind_SuspendContextNetworkRpc_GetRequestSize_0=ge.Bb)(e),Ii=n._emscripten_bind_SuspendContextNetworkRpc_GetRequestData_0=e=>(Ii=n._emscripten_bind_SuspendContextNetworkRpc_GetRequestData_0=ge.Cb)(e),Ei=n._emscripten_bind_SuspendContextNetworkRpc_ReceiveResponse_2=(e,t,i)=>(Ei=n._emscripten_bind_SuspendContextNetworkRpc_ReceiveResponse_2=ge.Db)(e,t,i),Gi=n._emscripten_bind_SuspendContextNetworkRpc___destroy___0=e=>(Gi=n._emscripten_bind_SuspendContextNetworkRpc___destroy___0=ge.Eb)(e),Di=n._emscripten_bind_SuspendContextSerialSync_Cancel_0=e=>(Di=n._emscripten_bind_SuspendContextSerialSync_Cancel_0=ge.Fb)(e),xi=n._emscripten_bind_SuspendContextSerialSync_Resume_0=e=>(xi=n._emscripten_bind_SuspendContextSerialSync_Resume_0=ge.Gb)(e),Pi=n._emscripten_bind_SuspendContextSerialSync___destroy___0=e=>(Pi=n._emscripten_bind_SuspendContextSerialSync___destroy___0=ge.Hb)(e),ki=n._emscripten_bind_SuspendContext_GetKind_0=e=>(ki=n._emscripten_bind_SuspendContext_GetKind_0=ge.Ib)(e),Mi=n._emscripten_bind_SuspendContext_Cancel_0=e=>(Mi=n._emscripten_bind_SuspendContext_Cancel_0=ge.Jb)(e),Ri=n._emscripten_bind_SuspendContext_AsContextClipboardCopy_0=e=>(Ri=n._emscripten_bind_SuspendContext_AsContextClipboardCopy_0=ge.Kb)(e),zi=n._emscripten_bind_SuspendContext_AsContextClipboardPaste_0=e=>(zi=n._emscripten_bind_SuspendContext_AsContextClipboardPaste_0=ge.Lb)(e),Ti=n._emscripten_bind_SuspendContext_AsContextNetworkConnect_0=e=>(Ti=n._emscripten_bind_SuspendContext_AsContextNetworkConnect_0=ge.Mb)(e),Hi=n._emscripten_bind_SuspendContext_AsContextNetworkRpc_0=e=>(Hi=n._emscripten_bind_SuspendContext_AsContextNetworkRpc_0=ge.Nb)(e),Bi=n._emscripten_bind_SuspendContext_AsContextSerialSync_0=e=>(Bi=n._emscripten_bind_SuspendContext_AsContextSerialSync_0=ge.Ob)(e),Ai=n._emscripten_bind_SuspendContext___destroy___0=e=>(Ai=n._emscripten_bind_SuspendContext___destroy___0=ge.Pb)(e),Ni=n._emscripten_bind_SessionImage_SessionImage_0=()=>(Ni=n._emscripten_bind_SessionImage_SessionImage_0=ge.Qb)(),Fi=n._emscripten_bind_SessionImage_GetDeviceId_0=e=>(Fi=n._emscripten_bind_SessionImage_GetDeviceId_0=ge.Rb)(e),Li=n._emscripten_bind_SessionImage_SetDeviceId_1=(e,t)=>(Li=n._emscripten_bind_SessionImage_SetDeviceId_1=ge.Sb)(e,t),Ui=n._emscripten_bind_SessionImage_GetRomImage_0=e=>(Ui=n._emscripten_bind_SessionImage_GetRomImage_0=ge.Tb)(e),ji=n._emscripten_bind_SessionImage_GetRomImageSize_0=e=>(ji=n._emscripten_bind_SessionImage_GetRomImageSize_0=ge.Ub)(e),Oi=n._emscripten_bind_SessionImage_SetRomImage_2=(e,t,i)=>(Oi=n._emscripten_bind_SessionImage_SetRomImage_2=ge.Vb)(e,t,i),Wi=n._emscripten_bind_SessionImage_GetMemoryImage_0=e=>(Wi=n._emscripten_bind_SessionImage_GetMemoryImage_0=ge.Wb)(e),Vi=n._emscripten_bind_SessionImage_GetMemoryImageSize_0=e=>(Vi=n._emscripten_bind_SessionImage_GetMemoryImageSize_0=ge.Xb)(e),qi=n._emscripten_bind_SessionImage_SetMemoryImage_2=(e,t,i)=>(qi=n._emscripten_bind_SessionImage_SetMemoryImage_2=ge.Yb)(e,t,i),Ki=n._emscripten_bind_SessionImage_GetMetadata_0=e=>(Ki=n._emscripten_bind_SessionImage_GetMetadata_0=ge.Zb)(e),Yi=n._emscripten_bind_SessionImage_GetMetadataSize_0=e=>(Yi=n._emscripten_bind_SessionImage_GetMetadataSize_0=ge._b)(e),Zi=n._emscripten_bind_SessionImage_SetMetadata_2=(e,t,i)=>(Zi=n._emscripten_bind_SessionImage_SetMetadata_2=ge.$b)(e,t,i),Qi=n._emscripten_bind_SessionImage_GetSavestate_0=e=>(Qi=n._emscripten_bind_SessionImage_GetSavestate_0=ge.ac)(e),$i=n._emscripten_bind_SessionImage_GetSavestateSize_0=e=>($i=n._emscripten_bind_SessionImage_GetSavestateSize_0=ge.bc)(e),Xi=n._emscripten_bind_SessionImage_SetSavestate_2=(e,t,i)=>(Xi=n._emscripten_bind_SessionImage_SetSavestate_2=ge.cc)(e,t,i),Ji=n._emscripten_bind_SessionImage_GetVersion_0=e=>(Ji=n._emscripten_bind_SessionImage_GetVersion_0=ge.dc)(e),er=n._emscripten_bind_SessionImage_Serialize_0=e=>(er=n._emscripten_bind_SessionImage_Serialize_0=ge.ec)(e),tr=n._emscripten_bind_SessionImage_GetSerializedImage_0=e=>(tr=n._emscripten_bind_SessionImage_GetSerializedImage_0=ge.fc)(e),ir=n._emscripten_bind_SessionImage_GetSerializedImageSize_0=e=>(ir=n._emscripten_bind_SessionImage_GetSerializedImageSize_0=ge.gc)(e),rr=n._emscripten_bind_SessionImage_Deserialize_2=(e,t,i)=>(rr=n._emscripten_bind_SessionImage_Deserialize_2=ge.hc)(e,t,i),nr=n._emscripten_bind_SessionImage___destroy___0=e=>(nr=n._emscripten_bind_SessionImage___destroy___0=ge.ic)(e),or=n._emscripten_bind_SkinLoader_SkinLoader_1=e=>(or=n._emscripten_bind_SkinLoader_SkinLoader_1=ge.jc)(e),sr=n._emscripten_bind_SkinLoader_GetData_0=e=>(sr=n._emscripten_bind_SkinLoader_GetData_0=ge.kc)(e),ar=n._emscripten_bind_SkinLoader_GetSize_0=e=>(ar=n._emscripten_bind_SkinLoader_GetSize_0=ge.lc)(e),pr=n._emscripten_bind_SkinLoader___destroy___0=e=>(pr=n._emscripten_bind_SkinLoader___destroy___0=ge.mc)(e),cr=n._emscripten_bind_EmTransportSerialBuffer_RxBytesPending_0=e=>(cr=n._emscripten_bind_EmTransportSerialBuffer_RxBytesPending_0=ge.nc)(e),ur=n._emscripten_bind_EmTransportSerialBuffer_Receive_0=e=>(ur=n._emscripten_bind_EmTransportSerialBuffer_Receive_0=ge.oc)(e),lr=n._emscripten_bind_EmTransportSerialBuffer_Send_3=(e,t,i,r)=>(lr=n._emscripten_bind_EmTransportSerialBuffer_Send_3=ge.pc)(e,t,i,r),dr=n._emscripten_bind_EmTransportSerialBuffer_IsOpen_0=e=>(dr=n._emscripten_bind_EmTransportSerialBuffer_IsOpen_0=ge.qc)(e),hr=n._emscripten_bind_EmTransportSerialBuffer_Rts_0=e=>(hr=n._emscripten_bind_EmTransportSerialBuffer_Rts_0=ge.rc)(e),_r=n._emscripten_bind_EmTransportSerialBuffer_Dtr_0=e=>(_r=n._emscripten_bind_EmTransportSerialBuffer_Dtr_0=ge.sc)(e),mr=n._emscripten_bind_EmTransportSerialBuffer_IsBreak_0=e=>(mr=n._emscripten_bind_EmTransportSerialBuffer_IsBreak_0=ge.tc)(e),yr=n._emscripten_bind_EmTransportSerialBuffer_BufferSize_0=e=>(yr=n._emscripten_bind_EmTransportSerialBuffer_BufferSize_0=ge.uc)(e),fr=n._emscripten_bind_EmTransportSerialBuffer_GetBaud_0=e=>(fr=n._emscripten_bind_EmTransportSerialBuffer_GetBaud_0=ge.vc)(e),vr=n._emscripten_bind_EmTransportSerialBuffer_GetParity_0=e=>(vr=n._emscripten_bind_EmTransportSerialBuffer_GetParity_0=ge.wc)(e),gr=n._emscripten_bind_EmTransportSerialBuffer_GetStopBits_0=e=>(gr=n._emscripten_bind_EmTransportSerialBuffer_GetStopBits_0=ge.xc)(e),br=n._emscripten_bind_EmTransportSerialBuffer_GetDataBits_0=e=>(br=n._emscripten_bind_EmTransportSerialBuffer_GetDataBits_0=ge.yc)(e),Sr=n._emscripten_bind_EmTransportSerialBuffer_GetHwrHandshake_0=e=>(Sr=n._emscripten_bind_EmTransportSerialBuffer_GetHwrHandshake_0=ge.zc)(e),Cr=n._emscripten_bind_EmTransportSerialBuffer_GetModeSync_0=e=>(Cr=n._emscripten_bind_EmTransportSerialBuffer_GetModeSync_0=ge.Ac)(e),wr=n._emscripten_bind_EmTransportSerialBuffer_SetModeSync_1=(e,t)=>(wr=n._emscripten_bind_EmTransportSerialBuffer_SetModeSync_1=ge.Bc)(e,t),Ir=n._emscripten_bind_EmTransportSerialBuffer_IsFrameComplete_0=e=>(Ir=n._emscripten_bind_EmTransportSerialBuffer_IsFrameComplete_0=ge.Cc)(e),Er=n._emscripten_bind_EmTransportSerialBuffer_SetRequestTransferCallback_1=(e,t)=>(Er=n._emscripten_bind_EmTransportSerialBuffer_SetRequestTransferCallback_1=ge.Dc)(e,t),Gr=n._emscripten_bind_EmTransportSerialBuffer___destroy___0=e=>(Gr=n._emscripten_bind_EmTransportSerialBuffer___destroy___0=ge.Ec)(e),Dr=n._emscripten_bind_GunzipContext_GunzipContext_3=(e,t,i)=>(Dr=n._emscripten_bind_GunzipContext_GunzipContext_3=ge.Fc)(e,t,i),xr=n._emscripten_bind_GunzipContext_GetState_0=e=>(xr=n._emscripten_bind_GunzipContext_GetState_0=ge.Gc)(e),Pr=n._emscripten_bind_GunzipContext_Continue_0=e=>(Pr=n._emscripten_bind_GunzipContext_Continue_0=ge.Hc)(e),kr=n._emscripten_bind_GunzipContext_GetUncompressedData_0=e=>(kr=n._emscripten_bind_GunzipContext_GetUncompressedData_0=ge.Ic)(e),Mr=n._emscripten_bind_GunzipContext_ReleaseUncompressedData_0=e=>(Mr=n._emscripten_bind_GunzipContext_ReleaseUncompressedData_0=ge.Jc)(e),Rr=n._emscripten_bind_GunzipContext_GetUncompressedSize_0=e=>(Rr=n._emscripten_bind_GunzipContext_GetUncompressedSize_0=ge.Kc)(e),zr=n._emscripten_bind_GunzipContext_GetError_0=e=>(zr=n._emscripten_bind_GunzipContext_GetError_0=ge.Lc)(e),Tr=n._emscripten_bind_GunzipContext___destroy___0=e=>(Tr=n._emscripten_bind_GunzipContext___destroy___0=ge.Mc)(e),Hr=n._emscripten_bind_ZipfileWalker_ZipfileWalker_2=(e,t)=>(Hr=n._emscripten_bind_ZipfileWalker_ZipfileWalker_2=ge.Nc)(e,t),Br=n._emscripten_bind_ZipfileWalker_GetState_0=e=>(Br=n._emscripten_bind_ZipfileWalker_GetState_0=ge.Oc)(e),Ar=n._emscripten_bind_ZipfileWalker_Next_0=e=>(Ar=n._emscripten_bind_ZipfileWalker_Next_0=ge.Pc)(e),Nr=n._emscripten_bind_ZipfileWalker_GetTotalEntries_0=e=>(Nr=n._emscripten_bind_ZipfileWalker_GetTotalEntries_0=ge.Qc)(e),Fr=n._emscripten_bind_ZipfileWalker_GetCurrentEntrySize_0=e=>(Fr=n._emscripten_bind_ZipfileWalker_GetCurrentEntrySize_0=ge.Rc)(e),Lr=n._emscripten_bind_ZipfileWalker_GetCurrentEntryName_0=e=>(Lr=n._emscripten_bind_ZipfileWalker_GetCurrentEntryName_0=ge.Sc)(e),Ur=n._emscripten_bind_ZipfileWalker_GetCurrentEntryContent_0=e=>(Ur=n._emscripten_bind_ZipfileWalker_GetCurrentEntryContent_0=ge.Tc)(e),jr=n._emscripten_bind_ZipfileWalker___destroy___0=e=>(jr=n._emscripten_bind_ZipfileWalker___destroy___0=ge.Uc)(e),Or=()=>(Or=ge.Vc)(),Wr=e=>(Wr=ge.Xc)(e),Vr=()=>(Vr=ge.Yc)(),qr=()=>(qr=ge.Zc)(),Kr=()=>(Kr=ge._c)();function Yr(){function e(){de||(de=!0,n.calledRun=!0,C||(E(),j(D),E(),j(x),i(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),Zr&&function(){var e=Se;try{var t=e(0,0);return he(t),t}catch(e){return(e=>{if(e instanceof U||"unwind"==e)return y;E(),e instanceof WebAssembly.RuntimeError&&Kr()<=0&&m("Stack overflow detected.  You can try increasing -sSTACK_SIZE (currently set to 1048576)"),p(1,e)})(e)}}(),function(){if(E(),n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;)e=n.postRun.shift(),P.unshift(e);var e;j(P)}()))}var t;k>0||(Vr(),0==(t=qr())&&(t+=4),b[t>>2]=34821223,b[t+4>>2]=2310721022,b[0]=1668509029,function(){if(n.preRun)for("function"==typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)e=n.preRun.shift(),G.unshift(e);var e;j(G)}(),k>0||(n.setStatus?(n.setStatus("Running..."),setTimeout((function(){setTimeout((function(){n.setStatus("")}),1),e()}),1)):e(),E()))}if(n.___original_main=()=>(n.___original_main=ge.$c)(),n.___start_em_js=425559,n.___stop_em_js=425658,n.addFunction=(e,t)=>{var i=(e=>(le||(le=new WeakMap,((e,t)=>{if(le)for(var i=0;i<0+t;i++){var r=(o=void 0,(o=me[n=i])||(n>=me.length&&(me.length=n+1),me[n]=o=ue.get(n)),o);r&&le.set(r,i)}var n,o})(0,ue.length)),le.get(e)||0))(e);if(i)return i;var r=(()=>{if(ye.length)return ye.pop();try{ue.grow(1)}catch(e){if(!(e instanceof RangeError))throw e;throw"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH."}return ue.length-1})();try{fe(r,e)}catch(i){if(!(i instanceof TypeError))throw i;var n=((e,t)=>{if("function"==typeof WebAssembly.Function)return new WebAssembly.Function((e=>{for(var t={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},i={parameters:[],results:"v"==e[0]?[]:[t[e[0]]]},r=1;r<e.length;++r)i.parameters.push(t[e[r]]);return i})(t),e);var i=[1];((e,t)=>{var i=e.slice(0,1),r=e.slice(1),n={i:127,p:127,j:126,f:125,d:124,e:111};t.push(96),_e(r.length,t);for(var o=0;o<r.length;++o)t.push(n[r[o]]);"v"==i?t.push(0):t.push(1,n[i])})(t,i);var r=[0,97,115,109,1,0,0,0,1];_e(i.length,r),r.push.apply(r,i),r.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);var n=new WebAssembly.Module(new Uint8Array(r));return new WebAssembly.Instance(n,{e:{f:e}}).exports.f})(e,t);fe(r,n)}return le.set(e,r),r},n.UTF8ToString=K,R=function e(){de||Yr(),de||(R=e)},n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();var Zr=!0;function Qr(){}function $r(e){return(e||Qr).__cache__}function Xr(e,t){var i=$r(t),r=i[e];return r||((r=Object.create((t||Qr).prototype)).ptr=e,i[e]=r)}n.noInitialRun&&(Zr=!1),Yr(),Qr.prototype=Object.create(Qr.prototype),Qr.prototype.constructor=Qr,Qr.prototype.__class__=Qr,Qr.__cache__={},n.WrapperObject=Qr,n.getCache=$r,n.wrapPointer=Xr,n.castObject=function(e,t){return Xr(e.ptr,t)},n.NULL=Xr(0),n.destroy=function(e){if(!e.__destroy__)throw"Error: Cannot destroy object. (Did you create it yourself?)";e.__destroy__(),delete $r(e.__class__)[e.ptr]},n.compare=function(e,t){return e.ptr===t.ptr},n.getPointer=function(e){return e.ptr},n.getClass=function(e){return e.__class__};var Jr={buffer:0,size:0,pos:0,temps:[],needed:0,prepare(){if(Jr.needed){for(var e=0;e<Jr.temps.length;e++)n._webidl_free(Jr.temps[e]);Jr.temps.length=0,n._webidl_free(Jr.buffer),Jr.buffer=0,Jr.size+=Jr.needed,Jr.needed=0}Jr.buffer||(Jr.size+=128,Jr.buffer=n._webidl_malloc(Jr.size),w(Jr.buffer)),Jr.pos=0},alloc(e,t){w(Jr.buffer);var i,r=t.BYTES_PER_ELEMENT,o=e.length*r;return o=o+7&-8,Jr.pos+o>=Jr.size?(w(o>0),Jr.needed+=o,i=n._webidl_malloc(o),Jr.temps.push(i)):(i=Jr.buffer+Jr.pos,Jr.pos+=o),i},copy(e,t,i){switch(i>>>=0,t.BYTES_PER_ELEMENT){case 2:i>>>=1;break;case 4:i>>>=2;break;case 8:i>>>=3}for(var r=0;r<e.length;r++)t[i+r]=e[r]}};function en(e){if("string"==typeof e){var t=ce(e),i=Jr.alloc(t,f);return Jr.copy(t,f,i),i}return e}function tn(){throw"cannot construct a VoidPtr, no constructor in IDL"}function rn(){this.ptr=we(),$r(rn)[this.ptr]=this}function nn(e,t){e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),this.ptr=Bt(e,t),$r(nn)[this.ptr]=this}function on(){throw"cannot construct a Frame, no constructor in IDL"}function sn(){throw"cannot construct a DbBackup, no constructor in IDL"}function an(){throw"cannot construct a SuspendContextClipboardCopy, no constructor in IDL"}function pn(){throw"cannot construct a SuspendContextClipboardPaste, no constructor in IDL"}function cn(){throw"cannot construct a SuspendContextNetworkConnect, no constructor in IDL"}function un(){throw"cannot construct a SuspendContextNetworkRpc, no constructor in IDL"}function ln(){throw"cannot construct a SuspendContextSerialSync, no constructor in IDL"}function dn(){throw"cannot construct a SuspendContext, no constructor in IDL"}function hn(){this.ptr=Ni(),$r(hn)[this.ptr]=this}function _n(e){Jr.prepare(),e=e&&"object"==typeof e?e.ptr:en(e),this.ptr=or(e),$r(_n)[this.ptr]=this}function mn(){throw"cannot construct a EmTransportSerialBuffer, no constructor in IDL"}function yn(e,t,i){e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),i&&"object"==typeof i&&(i=i.ptr),this.ptr=Dr(e,t,i),$r(yn)[this.ptr]=this}function fn(e,t){e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),this.ptr=Hr(e,t),$r(fn)[this.ptr]=this}return tn.prototype=Object.create(Qr.prototype),tn.prototype.constructor=tn,tn.prototype.__class__=tn,tn.__cache__={},n.VoidPtr=tn,tn.prototype.__destroy__=tn.prototype.__destroy__=function(){var e=this.ptr;Ce(e)},rn.prototype=Object.create(Qr.prototype),rn.prototype.constructor=rn,rn.prototype.__class__=rn,rn.__cache__={},n.Cloudpilot=rn,rn.prototype.Malloc=rn.prototype.Malloc=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),Xr(Ie(t,e),tn)},rn.prototype.Free=rn.prototype.Free=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),Ee(t,e)},rn.prototype.Nullptr=rn.prototype.Nullptr=function(){var e=this.ptr;return Xr(Ge(e),tn)},rn.prototype.InitializeSession=rn.prototype.InitializeSession=function(e,t,i){var r=this.ptr;return Jr.prepare(),e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),i=i&&"object"==typeof i?i.ptr:en(i),!!De(r,e,t,i)},rn.prototype.GetCyclesPerSecond=rn.prototype.GetCyclesPerSecond=function(){var e=this.ptr;return xe(e)},rn.prototype.RunEmulation=rn.prototype.RunEmulation=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),Pe(t,e)},rn.prototype.SetClockFactor=rn.prototype.SetClockFactor=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),ke(t,e)},rn.prototype.CopyFrame=rn.prototype.CopyFrame=function(){var e=this.ptr;return Xr(Me(e),on)},rn.prototype.IsScreenDirty=rn.prototype.IsScreenDirty=function(){var e=this.ptr;return!!Re(e)},rn.prototype.MarkScreenClean=rn.prototype.MarkScreenClean=function(){var e=this.ptr;ze(e)},rn.prototype.MinMemoryForDevice=rn.prototype.MinMemoryForDevice=function(e){var t=this.ptr;return Jr.prepare(),e=e&&"object"==typeof e?e.ptr:en(e),Te(t,e)},rn.prototype.FramebufferSizeForDevice=rn.prototype.FramebufferSizeForDevice=function(e){var t=this.ptr;return Jr.prepare(),e=e&&"object"==typeof e?e.ptr:en(e),He(t,e)},rn.prototype.TotalMemoryForDevice=rn.prototype.TotalMemoryForDevice=function(e){var t=this.ptr;return Jr.prepare(),e=e&&"object"==typeof e?e.ptr:en(e),Be(t,e)},rn.prototype.QueuePenMove=rn.prototype.QueuePenMove=function(e,t){var i=this.ptr;e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),Ae(i,e,t)},rn.prototype.QueuePenUp=rn.prototype.QueuePenUp=function(){var e=this.ptr;Ne(e)},rn.prototype.QueueButtonDown=rn.prototype.QueueButtonDown=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),Fe(t,e)},rn.prototype.QueueButtonUp=rn.prototype.QueueButtonUp=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),Le(t,e)},rn.prototype.QueueKeyboardEvent=rn.prototype.QueueKeyboardEvent=function(e,t){var i=this.ptr;e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),Ue(i,e,t)},rn.prototype.IsPowerOff=rn.prototype.IsPowerOff=function(){var e=this.ptr;return!!je(e)},rn.prototype.IsUIInitialized=rn.prototype.IsUIInitialized=function(){var e=this.ptr;return!!Oe(e)},rn.prototype.GetOSVersion=rn.prototype.GetOSVersion=function(){var e=this.ptr;return We(e)},rn.prototype.IsSetupComplete=rn.prototype.IsSetupComplete=function(){var e=this.ptr;return!!Ve(e)},rn.prototype.Reset=rn.prototype.Reset=function(){var e=this.ptr;qe(e)},rn.prototype.ResetNoExtensions=rn.prototype.ResetNoExtensions=function(){var e=this.ptr;Ke(e)},rn.prototype.ResetHard=rn.prototype.ResetHard=function(){var e=this.ptr;Ye(e)},rn.prototype.InstallDb=rn.prototype.InstallDb=function(e,t){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),Ze(i,e,t)},rn.prototype.GetPalette2bitMapping=rn.prototype.GetPalette2bitMapping=function(){var e=this.ptr;return Qe(e)},rn.prototype.GetMemoryPtr=rn.prototype.GetMemoryPtr=function(){var e=this.ptr;return Xr($e(e),tn)},rn.prototype.GetDirtyPagesPtr=rn.prototype.GetDirtyPagesPtr=function(){var e=this.ptr;return Xr(Xe(e),tn)},rn.prototype.GetMemorySize=rn.prototype.GetMemorySize=function(){var e=this.ptr;return Je(e)},rn.prototype.ImportMemoryImage=rn.prototype.ImportMemoryImage=function(e,t){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),!!et(i,e,t)},rn.prototype.GetRomPtr=rn.prototype.GetRomPtr=function(){var e=this.ptr;return Xr(tt(e),tn)},rn.prototype.GetRomSize=rn.prototype.GetRomSize=function(){var e=this.ptr;return it(e)},rn.prototype.GetSavestatePtr=rn.prototype.GetSavestatePtr=function(){var e=this.ptr;return Xr(rt(e),tn)},rn.prototype.GetSavestateSize=rn.prototype.GetSavestateSize=function(){var e=this.ptr;return nt(e)},rn.prototype.SaveState=rn.prototype.SaveState=function(){var e=this.ptr;return!!ot(e)},rn.prototype.LoadState=rn.prototype.LoadState=function(e,t){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),!!st(i,e,t)},rn.prototype.GetHotsyncName=rn.prototype.GetHotsyncName=function(){var e=this.ptr;return K(at(e))},rn.prototype.SetHotsyncName=rn.prototype.SetHotsyncName=function(e){var t=this.ptr;Jr.prepare(),e=e&&"object"==typeof e?e.ptr:en(e),pt(t,e)},rn.prototype.RegisterPwmHandler=rn.prototype.RegisterPwmHandler=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),ct(t,e)},rn.prototype.StartBackup=rn.prototype.StartBackup=function(){var e=this.ptr;return Xr(ut(e),sn)},rn.prototype.SetClipboardIntegration=rn.prototype.SetClipboardIntegration=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),lt(t,e)},rn.prototype.GetClipboardIntegration=rn.prototype.GetClipboardIntegration=function(){var e=this.ptr;return!!dt(e)},rn.prototype.IsSuspended=rn.prototype.IsSuspended=function(){var e=this.ptr;return!!ht(e)},rn.prototype.GetSuspendContext=rn.prototype.GetSuspendContext=function(){var e=this.ptr;return Xr(_t(e),dn)},rn.prototype.SetNetworkRedirection=rn.prototype.SetNetworkRedirection=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),mt(t,e)},rn.prototype.GetNetworkRedirection=rn.prototype.GetNetworkRedirection=function(){var e=this.ptr;return!!yt(e)},rn.prototype.RegisterProxyDisconnectHandler=rn.prototype.RegisterProxyDisconnectHandler=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),ft(t,e)},rn.prototype.SetHotsyncNameManagement=rn.prototype.SetHotsyncNameManagement=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),vt(t,e)},rn.prototype.LaunchAppByName=rn.prototype.LaunchAppByName=function(e){var t=this.ptr;return Jr.prepare(),e=e&&"object"==typeof e?e.ptr:en(e),!!gt(t,e)},rn.prototype.LaunchAppByDbHeader=rn.prototype.LaunchAppByDbHeader=function(e,t){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),!!bt(i,e,t)},rn.prototype.DeviceSupportsCardSize=rn.prototype.DeviceSupportsCardSize=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),!!St(t,e)},rn.prototype.ClearExternalStorage=rn.prototype.ClearExternalStorage=function(){var e=this.ptr;Ct(e)},rn.prototype.AllocateCard=rn.prototype.AllocateCard=function(e,t){var i=this.ptr;return Jr.prepare(),e=e&&"object"==typeof e?e.ptr:en(e),t&&"object"==typeof t&&(t=t.ptr),!!wt(i,e,t)},rn.prototype.AdoptCard=rn.prototype.AdoptCard=function(e,t,i){var r=this.ptr;return Jr.prepare(),e=e&&"object"==typeof e?e.ptr:en(e),t&&"object"==typeof t&&(t=t.ptr),i&&"object"==typeof i&&(i=i.ptr),!!It(r,e,t,i)},rn.prototype.MountCard=rn.prototype.MountCard=function(e){var t=this.ptr;return Jr.prepare(),e=e&&"object"==typeof e?e.ptr:en(e),!!Et(t,e)},rn.prototype.RemoveCard=rn.prototype.RemoveCard=function(e){var t=this.ptr;return Jr.prepare(),e=e&&"object"==typeof e?e.ptr:en(e),!!Gt(t,e)},rn.prototype.GetCardData=rn.prototype.GetCardData=function(e){var t=this.ptr;return Jr.prepare(),e=e&&"object"==typeof e?e.ptr:en(e),Xr(Dt(t,e),tn)},rn.prototype.GetCardDirtyPages=rn.prototype.GetCardDirtyPages=function(e){var t=this.ptr;return Jr.prepare(),e=e&&"object"==typeof e?e.ptr:en(e),Xr(xt(t,e),tn)},rn.prototype.GetCardSize=rn.prototype.GetCardSize=function(e){var t=this.ptr;return Jr.prepare(),e=e&&"object"==typeof e?e.ptr:en(e),Pt(t,e)},rn.prototype.RemountCards=rn.prototype.RemountCards=function(){var e=this.ptr;kt(e)},rn.prototype.GetSupportLevel=rn.prototype.GetSupportLevel=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),Mt(t,e)},rn.prototype.GetMountedKey=rn.prototype.GetMountedKey=function(){var e=this.ptr;return K(Rt(e))},rn.prototype.GetTransportIR=rn.prototype.GetTransportIR=function(){var e=this.ptr;return Xr(zt(e),mn)},rn.prototype.GetTransportSerial=rn.prototype.GetTransportSerial=function(){var e=this.ptr;return Xr(Tt(e),mn)},rn.prototype.__destroy__=rn.prototype.__destroy__=function(){var e=this.ptr;Ht(e)},nn.prototype=Object.create(Qr.prototype),nn.prototype.constructor=nn,nn.prototype.__class__=nn,nn.__cache__={},n.RomInfo=nn,nn.prototype.IsValid=nn.prototype.IsValid=function(){var e=this.ptr;return!!At(e)},nn.prototype.CardVersion=nn.prototype.CardVersion=function(){var e=this.ptr;return Nt(e)},nn.prototype.CardName=nn.prototype.CardName=function(){var e=this.ptr;return K(Ft(e))},nn.prototype.RomVersion=nn.prototype.RomVersion=function(){var e=this.ptr;return Lt(e)},nn.prototype.RomVersionString=nn.prototype.RomVersionString=function(){var e=this.ptr;return K(Ut(e))},nn.prototype.Supports=nn.prototype.Supports=function(e){var t=this.ptr;return Jr.prepare(),e=e&&"object"==typeof e?e.ptr:en(e),!!jt(t,e)},nn.prototype.__destroy__=nn.prototype.__destroy__=function(){var e=this.ptr;Ot(e)},on.prototype=Object.create(Qr.prototype),on.prototype.constructor=on,on.prototype.__class__=on,on.__cache__={},n.Frame=on,on.prototype.GetLineWidth=on.prototype.GetLineWidth=function(){var e=this.ptr;return Wt(e)},on.prototype.GetBpp=on.prototype.GetBpp=function(){var e=this.ptr;return Vt(e)},on.prototype.GetLines=on.prototype.GetLines=function(){var e=this.ptr;return qt(e)},on.prototype.GetMargin=on.prototype.GetMargin=function(){var e=this.ptr;return Kt(e)},on.prototype.GetBytesPerLine=on.prototype.GetBytesPerLine=function(){var e=this.ptr;return Yt(e)},on.prototype.GetFirstDirtyLine=on.prototype.GetFirstDirtyLine=function(){var e=this.ptr;return Zt(e)},on.prototype.GetLastDirtyLine=on.prototype.GetLastDirtyLine=function(){var e=this.ptr;return Qt(e)},on.prototype.GetHasChanges=on.prototype.GetHasChanges=function(){var e=this.ptr;return!!$t(e)},on.prototype.GetBuffer=on.prototype.GetBuffer=function(){var e=this.ptr;return Xr(Xt(e),tn)},on.prototype.GetBufferSize=on.prototype.GetBufferSize=function(){var e=this.ptr;return Jt(e)},on.prototype.GetScaleX=on.prototype.GetScaleX=function(){var e=this.ptr;return ei(e)},on.prototype.GetScaleY=on.prototype.GetScaleY=function(){var e=this.ptr;return ti(e)},on.prototype.__destroy__=on.prototype.__destroy__=function(){var e=this.ptr;ii(e)},sn.prototype=Object.create(Qr.prototype),sn.prototype.constructor=sn,sn.prototype.__class__=sn,sn.__cache__={},n.DbBackup=sn,sn.prototype.Init=sn.prototype.Init=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),!!ri(t,e)},sn.prototype.IsInProgress=sn.prototype.IsInProgress=function(){var e=this.ptr;return!!ni(e)},sn.prototype.IsDone=sn.prototype.IsDone=function(){var e=this.ptr;return!!oi(e)},sn.prototype.GetCurrentDatabase=sn.prototype.GetCurrentDatabase=function(){var e=this.ptr;return K(si(e))},sn.prototype.Save=sn.prototype.Save=function(){var e=this.ptr;return!!ai(e)},sn.prototype.Skip=sn.prototype.Skip=function(){var e=this.ptr;pi(e)},sn.prototype.GetArchivePtr=sn.prototype.GetArchivePtr=function(){var e=this.ptr;return Xr(ci(e),tn)},sn.prototype.GetArchiveSize=sn.prototype.GetArchiveSize=function(){var e=this.ptr;return ui(e)},sn.prototype.__destroy__=sn.prototype.__destroy__=function(){var e=this.ptr;li(e)},an.prototype=Object.create(Qr.prototype),an.prototype.constructor=an,an.prototype.__class__=an,an.__cache__={},n.SuspendContextClipboardCopy=an,an.prototype.Cancel=an.prototype.Cancel=function(){var e=this.ptr;di(e)},an.prototype.Resume=an.prototype.Resume=function(){var e=this.ptr;hi(e)},an.prototype.GetClipboardContent=an.prototype.GetClipboardContent=function(){var e=this.ptr;return K(_i(e))},an.prototype.__destroy__=an.prototype.__destroy__=function(){var e=this.ptr;mi(e)},pn.prototype=Object.create(Qr.prototype),pn.prototype.constructor=pn,pn.prototype.__class__=pn,pn.__cache__={},n.SuspendContextClipboardPaste=pn,pn.prototype.Cancel=pn.prototype.Cancel=function(){var e=this.ptr;yi(e)},pn.prototype.Resume=pn.prototype.Resume=function(e){var t=this.ptr;Jr.prepare(),e=e&&"object"==typeof e?e.ptr:en(e),fi(t,e)},pn.prototype.__destroy__=pn.prototype.__destroy__=function(){var e=this.ptr;vi(e)},cn.prototype=Object.create(Qr.prototype),cn.prototype.constructor=cn,cn.prototype.__class__=cn,cn.__cache__={},n.SuspendContextNetworkConnect=cn,cn.prototype.Cancel=cn.prototype.Cancel=function(){var e=this.ptr;gi(e)},cn.prototype.Resume=cn.prototype.Resume=function(e){var t=this.ptr;Jr.prepare(),e=e&&"object"==typeof e?e.ptr:en(e),bi(t,e)},cn.prototype.__destroy__=cn.prototype.__destroy__=function(){var e=this.ptr;Si(e)},un.prototype=Object.create(Qr.prototype),un.prototype.constructor=un,un.prototype.__class__=un,un.__cache__={},n.SuspendContextNetworkRpc=un,un.prototype.Cancel=un.prototype.Cancel=function(){var e=this.ptr;Ci(e)},un.prototype.GetRequestSize=un.prototype.GetRequestSize=function(){var e=this.ptr;return wi(e)},un.prototype.GetRequestData=un.prototype.GetRequestData=function(){var e=this.ptr;return Xr(Ii(e),tn)},un.prototype.ReceiveResponse=un.prototype.ReceiveResponse=function(e,t){var i=this.ptr;e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),Ei(i,e,t)},un.prototype.__destroy__=un.prototype.__destroy__=function(){var e=this.ptr;Gi(e)},ln.prototype=Object.create(Qr.prototype),ln.prototype.constructor=ln,ln.prototype.__class__=ln,ln.__cache__={},n.SuspendContextSerialSync=ln,ln.prototype.Cancel=ln.prototype.Cancel=function(){var e=this.ptr;Di(e)},ln.prototype.Resume=ln.prototype.Resume=function(){var e=this.ptr;xi(e)},ln.prototype.__destroy__=ln.prototype.__destroy__=function(){var e=this.ptr;Pi(e)},dn.prototype=Object.create(Qr.prototype),dn.prototype.constructor=dn,dn.prototype.__class__=dn,dn.__cache__={},n.SuspendContext=dn,dn.prototype.GetKind=dn.prototype.GetKind=function(){var e=this.ptr;return ki(e)},dn.prototype.Cancel=dn.prototype.Cancel=function(){var e=this.ptr;Mi(e)},dn.prototype.AsContextClipboardCopy=dn.prototype.AsContextClipboardCopy=function(){var e=this.ptr;return Xr(Ri(e),an)},dn.prototype.AsContextClipboardPaste=dn.prototype.AsContextClipboardPaste=function(){var e=this.ptr;return Xr(zi(e),pn)},dn.prototype.AsContextNetworkConnect=dn.prototype.AsContextNetworkConnect=function(){var e=this.ptr;return Xr(Ti(e),cn)},dn.prototype.AsContextNetworkRpc=dn.prototype.AsContextNetworkRpc=function(){var e=this.ptr;return Xr(Hi(e),un)},dn.prototype.AsContextSerialSync=dn.prototype.AsContextSerialSync=function(){var e=this.ptr;return Xr(Bi(e),ln)},dn.prototype.__destroy__=dn.prototype.__destroy__=function(){var e=this.ptr;Ai(e)},hn.prototype=Object.create(Qr.prototype),hn.prototype.constructor=hn,hn.prototype.__class__=hn,hn.__cache__={},n.SessionImage=hn,hn.prototype.GetDeviceId=hn.prototype.GetDeviceId=function(){var e=this.ptr;return K(Fi(e))},hn.prototype.SetDeviceId=hn.prototype.SetDeviceId=function(e){var t=this.ptr;return Jr.prepare(),e=e&&"object"==typeof e?e.ptr:en(e),Xr(Li(t,e),hn)},hn.prototype.GetRomImage=hn.prototype.GetRomImage=function(){var e=this.ptr;return Xr(Ui(e),tn)},hn.prototype.GetRomImageSize=hn.prototype.GetRomImageSize=function(){var e=this.ptr;return ji(e)},hn.prototype.SetRomImage=hn.prototype.SetRomImage=function(e,t){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),Xr(Oi(i,e,t),hn)},hn.prototype.GetMemoryImage=hn.prototype.GetMemoryImage=function(){var e=this.ptr;return Xr(Wi(e),tn)},hn.prototype.GetMemoryImageSize=hn.prototype.GetMemoryImageSize=function(){var e=this.ptr;return Vi(e)},hn.prototype.SetMemoryImage=hn.prototype.SetMemoryImage=function(e,t){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),Xr(qi(i,e,t),hn)},hn.prototype.GetMetadata=hn.prototype.GetMetadata=function(){var e=this.ptr;return Xr(Ki(e),tn)},hn.prototype.GetMetadataSize=hn.prototype.GetMetadataSize=function(){var e=this.ptr;return Yi(e)},hn.prototype.SetMetadata=hn.prototype.SetMetadata=function(e,t){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),Xr(Zi(i,e,t),hn)},hn.prototype.GetSavestate=hn.prototype.GetSavestate=function(){var e=this.ptr;return Xr(Qi(e),tn)},hn.prototype.GetSavestateSize=hn.prototype.GetSavestateSize=function(){var e=this.ptr;return $i(e)},hn.prototype.SetSavestate=hn.prototype.SetSavestate=function(e,t){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),Xr(Xi(i,e,t),hn)},hn.prototype.GetVersion=hn.prototype.GetVersion=function(){var e=this.ptr;return Ji(e)},hn.prototype.Serialize=hn.prototype.Serialize=function(){var e=this.ptr;return!!er(e)},hn.prototype.GetSerializedImage=hn.prototype.GetSerializedImage=function(){var e=this.ptr;return Xr(tr(e),tn)},hn.prototype.GetSerializedImageSize=hn.prototype.GetSerializedImageSize=function(){var e=this.ptr;return ir(e)},hn.prototype.Deserialize=hn.prototype.Deserialize=function(e,t){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),!!rr(i,e,t)},hn.prototype.__destroy__=hn.prototype.__destroy__=function(){var e=this.ptr;nr(e)},_n.prototype=Object.create(Qr.prototype),_n.prototype.constructor=_n,_n.prototype.__class__=_n,_n.__cache__={},n.SkinLoader=_n,_n.prototype.GetData=_n.prototype.GetData=function(){var e=this.ptr;return Xr(sr(e),tn)},_n.prototype.GetSize=_n.prototype.GetSize=function(){var e=this.ptr;return ar(e)},_n.prototype.__destroy__=_n.prototype.__destroy__=function(){var e=this.ptr;pr(e)},mn.prototype=Object.create(Qr.prototype),mn.prototype.constructor=mn,mn.prototype.__class__=mn,mn.__cache__={},n.EmTransportSerialBuffer=mn,mn.prototype.RxBytesPending=mn.prototype.RxBytesPending=function(){var e=this.ptr;return cr(e)},mn.prototype.Receive=mn.prototype.Receive=function(){var e=this.ptr;return Xr(ur(e),tn)},mn.prototype.Send=mn.prototype.Send=function(e,t,i){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),i&&"object"==typeof i&&(i=i.ptr),lr(r,e,t,i)},mn.prototype.IsOpen=mn.prototype.IsOpen=function(){var e=this.ptr;return!!dr(e)},mn.prototype.Rts=mn.prototype.Rts=function(){var e=this.ptr;return hr(e)},mn.prototype.Dtr=mn.prototype.Dtr=function(){var e=this.ptr;return!!_r(e)},mn.prototype.IsBreak=mn.prototype.IsBreak=function(){var e=this.ptr;return!!mr(e)},mn.prototype.BufferSize=mn.prototype.BufferSize=function(){var e=this.ptr;return yr(e)},mn.prototype.GetBaud=mn.prototype.GetBaud=function(){var e=this.ptr;return fr(e)},mn.prototype.GetParity=mn.prototype.GetParity=function(){var e=this.ptr;return vr(e)},mn.prototype.GetStopBits=mn.prototype.GetStopBits=function(){var e=this.ptr;return gr(e)},mn.prototype.GetDataBits=mn.prototype.GetDataBits=function(){var e=this.ptr;return br(e)},mn.prototype.GetHwrHandshake=mn.prototype.GetHwrHandshake=function(){var e=this.ptr;return Sr(e)},mn.prototype.GetModeSync=mn.prototype.GetModeSync=function(){var e=this.ptr;return!!Cr(e)},mn.prototype.SetModeSync=mn.prototype.SetModeSync=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),wr(t,e)},mn.prototype.IsFrameComplete=mn.prototype.IsFrameComplete=function(){var e=this.ptr;return!!Ir(e)},mn.prototype.SetRequestTransferCallback=mn.prototype.SetRequestTransferCallback=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),Er(t,e)},mn.prototype.__destroy__=mn.prototype.__destroy__=function(){var e=this.ptr;Gr(e)},yn.prototype=Object.create(Qr.prototype),yn.prototype.constructor=yn,yn.prototype.__class__=yn,yn.__cache__={},n.GunzipContext=yn,yn.prototype.GetState=yn.prototype.GetState=function(){var e=this.ptr;return xr(e)},yn.prototype.Continue=yn.prototype.Continue=function(){var e=this.ptr;return Pr(e)},yn.prototype.GetUncompressedData=yn.prototype.GetUncompressedData=function(){var e=this.ptr;return Xr(kr(e),tn)},yn.prototype.ReleaseUncompressedData=yn.prototype.ReleaseUncompressedData=function(){var e=this.ptr;return Xr(Mr(e),tn)},yn.prototype.GetUncompressedSize=yn.prototype.GetUncompressedSize=function(){var e=this.ptr;return Rr(e)},yn.prototype.GetError=yn.prototype.GetError=function(){var e=this.ptr;return K(zr(e))},yn.prototype.__destroy__=yn.prototype.__destroy__=function(){var e=this.ptr;Tr(e)},fn.prototype=Object.create(Qr.prototype),fn.prototype.constructor=fn,fn.prototype.__class__=fn,fn.__cache__={},n.ZipfileWalker=fn,fn.prototype.GetState=fn.prototype.GetState=function(){var e=this.ptr;return Br(e)},fn.prototype.Next=fn.prototype.Next=function(){var e=this.ptr;return Ar(e)},fn.prototype.GetTotalEntries=fn.prototype.GetTotalEntries=function(){var e=this.ptr;return Nr(e)},fn.prototype.GetCurrentEntrySize=fn.prototype.GetCurrentEntrySize=function(){var e=this.ptr;return Fr(e)},fn.prototype.GetCurrentEntryName=fn.prototype.GetCurrentEntryName=function(){var e=this.ptr;return K(Lr(e))},fn.prototype.GetCurrentEntryContent=fn.prototype.GetCurrentEntryContent=function(){var e=this.ptr;return Xr(Ur(e),tn)},fn.prototype.__destroy__=fn.prototype.__destroy__=function(){var e=this.ptr;jr(e)},e.ready});e.exports=i},650:function(e,t){!function(e){"use strict";var t,i=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,r=536870912,n=1073741824,o=new WeakMap,s=function(e,t){return function(o){var s=t.get(o),a=void 0===s?o.size:s<n?s+1:0;if(!o.has(a))return e(o,a);if(o.size<r){for(;o.has(a);)a=Math.floor(Math.random()*n);return e(o,a)}if(o.size>i)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;o.has(a);)a=Math.floor(Math.random()*i);return e(o,a)}}((t=o,function(e,i){return t.set(e,i),i}),o),a=function(e){return function(t){var i=e(t);return t.add(i),i}}(s);e.addUniqueNumber=a,e.generateUniqueNumber=s}(t)},37:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=[];i[0]=function(){return function(){}},i[1]=function(e,t){return void 0===t?e:function(i){e(i,t)}};var r=function(){function e(){this.hasHandlers=!1,this._handlers=[],this._contexts=[],this._createDispatcher()}return e.prototype.addHandler=function(e,t){return this.isHandlerAttached(e,t)||(this._handlers.push(e),this._contexts.push(t),this._createDispatcher(),this._updateHasHandlers()),this},e.prototype.removeHandler=function(e,t){var i=this._getHandlerIndex(e,t);return void 0!==i&&(this._handlers.splice(i,1),this._contexts.splice(i,1),this._createDispatcher(),this._updateHasHandlers()),this},e.prototype.isHandlerAttached=function(e,t){return void 0!==this._getHandlerIndex(e,t)},e.prototype._updateHasHandlers=function(){this.hasHandlers=!!this._handlers.length},e.prototype._getHandlerIndex=function(e,t){var i,r=this._handlers.length;for(i=0;i<r&&(this._handlers[i]!==e||this._contexts[i]!==t);i++);return i<r?i:void 0},e.prototype._createDispatcher=function(){var e;this.dispatch=(e=this._handlers.length,i[e]||(i[e]=function(e){for(var t="return function dispatcher"+e+"(payload) {\n",i=[],r=[],n=0;n<e;n++)i.push("cb"+n),r.push("ctx"+n),t+="    cb"+n+"(payload, ctx"+n+");\n";return t+="};",new(Function.bind.apply(Function,[void 0].concat(i.concat(r),[t])))}(e)),i[e]).apply(this,this._handlers.concat(this._contexts))},e}();t.default=r},819:(e,t,i)=>{"use strict";var r=i(37);t.j=r.default}},t={};function i(r){var n=t[r];if(void 0!==n)return n.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,i),o.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return(()=>{"use strict";function e(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s}function t(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{p(r.next(e))}catch(e){o(e)}}function a(e){try{p(r.throw(e))}catch(e){o(e)}}function p(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}p((r=r.apply(e,t||[])).next())}))}var n,o,s;i.r(r),i.d(r,{Button:()=>se,DeviceId:()=>n,DeviceOrientation:()=>o,VERSION:()=>ae,createEmulator:()=>pe,createEmulatorFactory:()=>ce}),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError,(s=n||(n={})).palmPilot="PalmPilot",s.pilot="Pilot",s.iii="PalmIII",s.palmVx="PalmVx",s.palmV="PalmV",s.palmVII="PalmVII",s.palmVIIEZ="PalmVIIEZ",s.palmVIIx="PalmVIIx",s.iiic="PalmIIIc",s.iiix="PalmIIIx",s.iiixe="PalmIIIxe",s.iiie="PalmIIIe",s.m500="PalmM500",s.m505="PalmM505",s.m515="PalmM515",s.m520="PalmM520",s.m100="PalmM100",s.m105="PalmM105",s.m125="PalmM125",s.m130="PalmM130",s.i705="Palmi705",s.i710="PalmI710",s.handera330="HandEra330",s.handera330c="HandEra330c",s.pegS300="PEG-S300",s.pegS320="PEG-S320",s.pegS500c="PEG-S500C",s.pegT400="PEG-T400",s.pegN600c="PEG-N600C/N610C",s.pegT600c="PEG-T600",s.pegN700c="PEG-N700C/N710C",s.pegT650c="YSX1230",s.pegNR70="NR70",s.acerS11="Acer-S11",s.lp168="Legend-P168",function(e){e.portrait="portrait",e.landscape90="landscape90",e.landscape270="landscape270",e.portrait180="portrait180"}(o||(o={})),new Error("timeout while waiting for mutex to become available"),new Error("mutex already locked");const a=new Error("request for lock canceled");class p{constructor(e,t=a){this._value=e,this._cancelError=t,this._weightedQueues=[],this._weightedWaiters=[]}acquire(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise(((t,i)=>{this._weightedQueues[e-1]||(this._weightedQueues[e-1]=[]),this._weightedQueues[e-1].push({resolve:t,reject:i}),this._dispatch()}))}runExclusive(e,t=1){return i=this,r=void 0,o=function*(){const[i,r]=yield this.acquire(t);try{return yield e(i)}finally{r()}},new((n=void 0)||(n=Promise))((function(e,t){function s(e){try{p(o.next(e))}catch(e){t(e)}}function a(e){try{p(o.throw(e))}catch(e){t(e)}}function p(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(s,a)}p((o=o.apply(i,r||[])).next())}));var i,r,n,o}waitForUnlock(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise((t=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),this._weightedWaiters[e-1].push(t),this._dispatch()}))}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatch()}release(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatch()}cancel(){this._weightedQueues.forEach((e=>e.forEach((e=>e.reject(this._cancelError))))),this._weightedQueues=[]}_dispatch(){var e;for(let t=this._value;t>0;t--){const i=null===(e=this._weightedQueues[t-1])||void 0===e?void 0:e.shift();if(!i)continue;const r=this._value,n=t;this._value-=t,t=this._value+1,i.resolve([r,this._newReleaser(n)])}this._drainUnlockWaiters()}_newReleaser(e){let t=!1;return()=>{t||(t=!0,this.release(e))}}_drainUnlockWaiters(){for(let e=this._value;e>0;e--)this._weightedWaiters[e-1]&&(this._weightedWaiters[e-1].forEach((e=>e())),this._weightedWaiters[e-1]=[])}}class c{constructor(e){this._semaphore=new p(1,e)}acquire(){return e=this,t=void 0,r=function*(){const[,e]=yield this._semaphore.acquire();return e},new((i=void 0)||(i=Promise))((function(n,o){function s(e){try{p(r.next(e))}catch(e){o(e)}}function a(e){try{p(r.throw(e))}catch(e){o(e)}}function p(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}p((r=r.apply(e,t||[])).next())}));var e,t,i,r}runExclusive(e){return this._semaphore.runExclusive((()=>e()))}isLocked(){return this._semaphore.isLocked()}waitForUnlock(){return this._semaphore.waitForUnlock()}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}}const u="safari"in window,l=(navigator.userAgent.match(/(crios)|(fxios)/i),!!navigator.platform.match(/iPhone|iPad|iPod/)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1),d=(navigator.userAgent.match(/ 17_4 /),navigator.userAgent.match(/ pwashell$/i),navigator.userAgent.match(/android/i),navigator.userAgent.toLowerCase().indexOf("firefox"),window.AudioContext||window.webkitAudioContext);function h(e,t=200){return new Promise(((i,r)=>{setTimeout((()=>r(new Error("timeout"))),t),e.then(i,r)}))}class _{constructor(e){this.emulationService=e,this.initialize=()=>this.mutex.runExclusive((()=>t(this,void 0,void 0,(function*(){if(!this.initialized){try{this.context=new d}catch(e){return console.error(e),void console.error("web audio not available")}try{this.context.destination.channelCount=1}catch(e){console.warn("audio driver: failed to set channel count")}try{yield this.start()}catch(e){return console.error(e),void console.error("failed to initialize audio context")}this.context.addEventListener("statechange",(()=>{var e;"interrupted"===(null===(e=this.context)||void 0===e?void 0:e.state)&&this.updateState()})),this.gainNode=this.context.createGain(),this.gainNode.channelCount=1,this.gainNode.channelInterpretation="speakers",this.gainNode.gain.value=this.gain(),this.gainNode.connect(this.context.destination),this.applyPwmUpdate(),this.initialized=!0}})))),this.updateState=(e=!1)=>this.mutex.runExclusive((()=>t(this,void 0,void 0,(function*(){if(!this.context)return;if(this.isRunning()===this.shouldRun())return;e||this.isRunning()||!this.shouldRun()||this.applyPwmUpdate();const t=this.context.state;if(this.shouldRun())try{this.updateGain(),yield h(this.context.resume()),console.log("resume audio context")}catch(e){console.error(`failed to resume audio from state ${t}`)}else try{yield h(this.context.suspend()),console.log("suspend audio context")}catch(e){console.error(`failed to suspend audio from state ${t}`)}console.log(`audio context state change ${t} -> ${this.context.state}`)})))),this.onPwmUpdate=e=>t(this,void 0,void 0,(function*(){this.pendingPwmUpdate=e,this.initialized&&(this.shouldRun()!==this.isRunning()&&this.updateState(!0),this.shouldRun()&&this.applyPwmUpdate())})),this.mutex=new c,this.initialized=!1,this.muted=!1,this.emulationService.pwmUpdateEvent.addHandler(this.onPwmUpdate),this.emulationService.emulationStateChangeEvent.addHandler((()=>this.updateState())),this.emulationService.powerOffChangeEvent.addHandler((()=>this.updateState())),l||document.addEventListener("visibilitychange",(()=>this.updateState()))}isInitialized(){return this.initialized}mute(e){this.muted=e,this.updateState()}isMuted(){return this.muted}shouldRun(){return this.emulationService.isRunning()&&!this.emulationService.isPowerOff()&&!this.muted&&this.gain()>0&&("hidden"!==document.visibilityState||l||this.runHidden())}updateGain(){this.gainNode&&(this.gainNode.gain.value=this.gain())}start(){return t(this,void 0,void 0,(function*(){this.context&&(yield h(this.context.resume()),this.updateState(),console.log("audio context initialized"))}))}isRunning(){var e;return"running"===(null===(e=this.context)||void 0===e?void 0:e.state)}applyPwmUpdate(){if(!this.context||!this.pendingPwmUpdate)return;const{frequency:e,dutyCycle:t}=this.pendingPwmUpdate,i=this.context.sampleRate;if(this.pendingPwmUpdate=void 0,e<=0||t<=0||e>=i)return void this.disconnectSource();const r=this.context.createBuffer(1,Math.round(i/e),i),n=r.getChannelData(0);for(let e=0;e<n.length;e++)n[e]=e/n.length<t?1:0;const o=this.context.createBufferSource();o.channelCount=1,o.channelInterpretation="speakers",o.loop=!0,o.buffer=r,this.disconnectSource(),o.connect(this.gainNode),o.start(),this.bufferSourceNode=o,this.pendingPwmUpdate=void 0}disconnectSource(){this.bufferSourceNode&&(this.bufferSourceNode.stop(),this.bufferSourceNode.disconnect(),this.bufferSourceNode=void 0)}gain(){return this.getVolume()/2}}class m extends _{constructor(){super(...arguments),this.volume=.5}setVolume(e){this.volume=Math.max(Math.min(e,1),0),this.updateGain()}getVolume(){return this.volume}runHidden(){return!1}}function y(e,i){let r,n;const o=document.createElement("canvas");return(s,a)=>t(this,void 0,void 0,(function*(){if(r===s&&n===a)return o;o.width=s,o.height=a;const t=o.getContext("2d");if(!t)throw new Error("get a new browser");return t.drawImage(yield e,0,0,o.width,o.height),(u||l)&&(yield i).indexOf("data:image")>=0&&(yield new Promise((e=>setTimeout(e,0))),t.drawImage(yield e,0,0,o.width,o.height)),r=s,n=a,o}))}function f(e){return new Promise(((t,i)=>{const r=new Image;r.onload=()=>t(r),r.onerror=()=>i(),r.src=e}))}const v=e=>`data:image/svg+xml;base64,${btoa(e)}`;var g,b;function S(e){switch(e){case n.i710:case n.m520:return{screenSize:1,width:320,height:320,silkscreenHeight:120};case n.handera330:case n.handera330c:case n.lp168:return{screenSize:2,width:240,height:320,silkscreenHeight:0};case n.pegS300:case n.pegS320:case n.pegS500c:return{screenSize:0,width:160,height:160,silkscreenHeight:76};case n.pegT600c:case n.pegT400:case n.pegT650c:return{screenSize:1,width:320,height:320,silkscreenHeight:140,silkscreenOvershoot:10};case n.pegN600c:case n.pegN700c:return{screenSize:1,width:320,height:320,silkscreenHeight:120};case n.pegNR70:return{screenSize:3,width:320,height:480,silkscreenHeight:0};case n.acerS11:return{screenSize:0,width:160,height:160,silkscreenHeight:60,siklscreenShift:8};default:return{screenSize:0,width:160,height:160,silkscreenHeight:60}}}function C(e){switch(e){case n.pilot:case n.palmPilot:case n.iii:case n.palmV:case n.palmVx:case n.iiix:case n.iiixe:case n.iiie:case n.m100:case n.m105:case n.m125:case n.m500:case n.palmVII:case n.palmVIIEZ:case n.palmVIIx:case n.i705:case n.handera330:case n.pegS300:case n.pegS320:case n.pegT400:case n.acerS11:return!1;default:return!0}}(b=g||(g={})).sdcard="sdcard",b.memorystick="memorystick",b.none="none";var w=i(819);const I=[135,135,105],E=[0,0,0],G=new Array(16).fill(0).map(((e,t)=>E.map(((e,i)=>Math.floor((t*e+(15-t)*I[i])/15))))).map((([e,t,i])=>4278190080|i<<16|t<<8|e)),D=G.map((e=>{var t;return"#"+(null===(t=(16777215&e).toString(16).padStart(6,"0").match(/(..?)/g))||void 0===t?void 0:t.reverse().join(""))})),x=n.m515,P=D[2],k=D[0],M="rgba(0,0,0,0.2)";function R(e){const t=S(e),i=(0===t.screenSize?3:2)*devicePixelRatio,r={frameDevice:1,frameCanvas:i},n=e=>({frameDevice:e,frameCanvas:e*i}),o=e=>({frameDevice:e,frameCanvas:r.frameCanvas+e*i}),s=t.silkscreenHeight>0?n(1):n(0),a=n(function(e){switch(e){case 3:case 1:return 60;case 2:return 45;default:return 30}}(t.screenSize));return{scale:i,borderWidth:r,height:n(2*r.frameDevice+t.height+s.frameDevice+t.silkscreenHeight+a.frameDevice),width:n(2*r.frameDevice+t.width),screenHeight:n(t.height),screenWidth:n(t.width),screenLeft:o(0),screenTop:o(0),screenBottom:o(t.height),separatorHeight:s,silkscreenHeight:n(t.silkscreenHeight),silkscreenTop:o(t.height+s.frameDevice),silkscreenBottom:o(t.height+s.frameDevice+t.silkscreenHeight),softSilkscreenHeight:n(t.silkscreenHeight>0?0:t.height-t.width),buttonHeight:a,buttonWidth:a,buttonTop:o(t.height+s.frameDevice+t.silkscreenHeight),buttonBottom:o(t.height+s.frameDevice+t.silkscreenHeight+a.frameDevice)}}class z{constructor(e){this.skinLoader=e,this.layout=R(x),this.onResize=new w.j}get width(){switch(this.getOrientation()){case o.portrait:case o.portrait180:case void 0:return this.layout.width.frameCanvas;default:return this.layout.height.frameCanvas}}get height(){switch(this.getOrientation()){case o.portrait:case o.portrait180:case void 0:return this.layout.height.frameCanvas;default:return this.layout.width.frameCanvas}}updateEmulationCanvas(e){this.drawEmulationCanvas(e),this.onAfterUpdateCanvas()}eventToPalmCoordinates(e,t=!1){if(!this.ctx)return;const i=this.ctx.canvas.getBoundingClientRect();let r,n,s,a;i.width/i.height>this.width/this.height?(a=i.height,s=this.width/this.height*i.height,n=i.top,r=i.left+(i.width-s)/2):(s=i.width,a=this.height/this.width*i.width,r=i.left,n=i.top+(i.height-a)/2);let p=(e.clientX-r)/s*this.width/this.layout.scale,c=(e.clientY-n)/a*this.height/this.layout.scale;switch(this.getOrientation()){case o.landscape90:{const e=c;c=this.layout.height.frameDevice-p,p=e;break}case o.landscape270:{const e=c;c=p,p=this.layout.width.frameDevice-e;break}case o.portrait180:p=this.layout.width.frameDevice-p,c=this.layout.height.frameDevice-c}p-=this.layout.borderWidth.frameDevice,c-=this.layout.borderWidth.frameDevice,c>=this.layout.screenHeight.frameDevice&&(c<=this.layout.screenHeight.frameDevice+this.layout.separatorHeight.frameDevice?c=this.layout.screenHeight.frameDevice:c-=this.layout.separatorHeight.frameDevice);const u=this.layout.screenHeight.frameDevice+this.layout.silkscreenHeight.frameDevice+this.layout.buttonHeight.frameDevice;if(t)p<0&&(p=0),p>=this.layout.screenWidth.frameDevice&&(p=this.layout.screenWidth.frameDevice-1),c<0&&(c=0),c>=u&&(c=u-1);else if(p<0||p>=this.layout.screenWidth.frameDevice||c<0||c>=u)return;return[p,c]}isSilkscreen(e){const[,t]=e;return!this.isButtons(e)&&t>=this.layout.screenHeight.frameDevice}isButtons([,e]){return e>=this.layout.screenHeight.frameDevice+this.layout.silkscreenHeight.frameDevice}determineButton([e,t]){return e>=this.layout.screenWidth.frameDevice-this.layout.buttonWidth.frameDevice?3:e>=this.layout.screenWidth.frameDevice-2*this.layout.buttonWidth.frameDevice?2:e>=2*this.layout.buttonWidth.frameDevice?t>=this.layout.screenHeight.frameDevice+this.layout.silkscreenHeight.frameDevice+this.layout.buttonHeight.frameDevice/2?5:4:e>=this.layout.buttonWidth.frameDevice?1:0}initWithCanvas(e){var i;return void 0===e&&(e=null===(i=this.ctx)||void 0===i?void 0:i.canvas),t(this,void 0,void 0,(function*(){if(!e)return;this.layout=R(this.getDeviceId()),this.onResize.dispatch(),e.width=this.width,e.height=this.height;const t=e.getContext("2d");if(!t)throw new Error("canvas not supported - get a new browser");this.ctx=t,this.setupTransformation(),this.fillCanvasRect(0,0,this.layout.width.frameCanvas,this.layout.height.frameCanvas,this.frameColor()),this.fillRect(0,0,this.layout.screenWidth.frameDevice,this.layout.screenHeight.frameDevice+this.layout.silkscreenHeight.frameDevice+this.layout.separatorHeight.frameDevice+this.layout.buttonHeight.frameDevice,this.backgroundColor()),this.drawEmulationCanvas(),yield Promise.all([this.drawSilkscreen(),this.drawButtons()])}))}drawButtons(e=[]){return t(this,void 0,void 0,(function*(){this.ctx&&(this.setupTransformation(),this.ctx.imageSmoothingEnabled=!0,this.ctx.imageSmoothingQuality="high",this.ctx.drawImage(yield this.buttonsImage()(this.layout.screenWidth.frameCanvas,this.layout.buttonHeight.frameCanvas),this.layout.screenLeft.frameCanvas,this.layout.buttonTop.frameCanvas,this.layout.screenWidth.frameCanvas,this.layout.buttonHeight.frameCanvas),e.includes(0)&&this.fillRect(0,this.layout.buttonTop.frameDevice,this.layout.buttonWidth.frameDevice,this.layout.buttonHeight.frameDevice,M),e.includes(1)&&this.fillRect(this.layout.buttonWidth.frameDevice,this.layout.buttonTop.frameDevice,this.layout.buttonWidth.frameDevice,this.layout.buttonHeight.frameDevice,M),e.includes(2)&&this.fillRect(this.layout.screenWidth.frameDevice-2*this.layout.buttonWidth.frameDevice,this.layout.buttonTop.frameDevice,this.layout.buttonWidth.frameDevice,this.layout.buttonHeight.frameDevice,M),e.includes(3)&&this.fillRect(this.layout.screenWidth.frameDevice-this.layout.buttonWidth.frameDevice,this.layout.buttonTop.frameDevice,this.layout.buttonWidth.frameDevice,this.layout.buttonHeight.frameDevice,M),e.includes(4)&&this.fillRect(2*this.layout.buttonWidth.frameDevice,this.layout.buttonTop.frameDevice,this.layout.screenWidth.frameDevice-4*this.layout.buttonWidth.frameDevice,this.layout.buttonHeight.frameDevice/2,M),e.includes(5)&&this.fillRect(2*this.layout.buttonWidth.frameDevice,this.layout.buttonTop.frameDevice+this.layout.buttonHeight.frameDevice/2,this.layout.screenWidth.frameDevice-4*this.layout.buttonWidth.frameDevice,this.layout.buttonHeight.frameDevice/2,M))}))}onAfterUpdateCanvas(){}setupTransformation(){var e;if(this.ctx)switch(null===(e=this.ctx)||void 0===e||e.resetTransform(),this.getOrientation()){case o.portrait:case void 0:break;case o.landscape90:this.ctx.translate(this.layout.height.frameCanvas,0),this.ctx.rotate(Math.PI/2);break;case o.landscape270:this.ctx.translate(0,this.layout.width.frameCanvas),this.ctx.rotate(3*Math.PI/2);break;case o.portrait180:this.ctx.translate(this.layout.width.frameCanvas,this.layout.height.frameCanvas),this.ctx.rotate(Math.PI)}}drawSilkscreen(){return t(this,void 0,void 0,(function*(){0!==this.layout.silkscreenHeight.frameCanvas&&this.ctx&&(this.setupTransformation(),this.fillRect(this.layout.screenLeft.frameDevice,this.layout.silkscreenTop.frameDevice,this.layout.screenWidth.frameDevice,this.layout.silkscreenHeight.frameDevice,P),this.ctx.imageSmoothingEnabled=!0,this.ctx.imageSmoothingQuality="high",this.ctx.drawImage(yield this.silkscreenImage()(this.layout.screenWidth.frameCanvas,this.layout.silkscreenHeight.frameCanvas),this.layout.borderWidth.frameCanvas,this.layout.silkscreenTop.frameCanvas,this.layout.screenWidth.frameCanvas,this.layout.silkscreenHeight.frameCanvas))}))}drawEmulationCanvas(e=this.lastEmulationCanvas){e&&this.ctx&&(this.lastEmulationCanvas=e,this.ctx.imageSmoothingEnabled=!1,this.ctx.drawImage(e,this.layout.screenLeft.frameCanvas,this.layout.screenTop.frameCanvas,this.layout.screenWidth.frameCanvas,this.layout.screenHeight.frameCanvas))}fillRect(e,t,i,r,n){this.ctx&&(this.ctx.beginPath(),this.ctx.rect(this.layout.borderWidth.frameCanvas+this.layout.scale*e,this.layout.borderWidth.frameCanvas+this.layout.scale*t,this.layout.scale*i,this.layout.scale*r),this.ctx.fillStyle=n,this.ctx.fill())}fillCanvasRect(e,t,i,r,n){this.ctx&&(this.ctx.beginPath(),this.ctx.rect(e,t,i,r),this.ctx.fillStyle=n,this.ctx.fill())}silkscreenImage(){return this.skinLoader.loadSkinElement(this.silkscreenSkinElement())}silkscreenSkinElement(){switch(this.getDeviceId()){case n.pegT600c:case n.pegT650c:return"silkscreen/clie-t600.svg";case n.pegN700c:case n.pegN600c:return"silkscreen/clie-n610.svg";case n.pegS320:case n.pegS300:return"silkscreen/clie-s300.svg";case n.pegS500c:return"silkscreen/clie-s500.svg";case n.pegT400:return"silkscreen/clie-t415.svg";case n.acerS11:return"silkscreen/acer-s10.svg";case n.palmPilot:case n.pilot:case n.iii:case n.palmVII:return"silkscreen/pilot.svg";case n.m500:return"silkscreen/m500.svg";case n.m505:case n.m515:case n.m520:return"silkscreen/m515.svg";case n.iiic:return"silkscreen/iiic.svg";case n.m100:case n.m105:case n.m125:return"silkscreen/m100.svg";case n.m130:return"silkscreen/m130.svg";case n.i710:return"silkscreen/tungstenw.svg";case n.i705:return"silkscreen/i705.svg";case n.iiic:case n.iiix:case n.iiixe:case n.palmVx:case n.palmV:case n.palmVIIEZ:case n.palmVIIx:default:return"silkscreen/v.svg"}}buttonsImage(){return this.skinLoader.loadSkinElement(this.buttonsSkinElement())}buttonsSkinElement(){switch(this.getDeviceId()){case n.acerS11:return"hard-buttons/acer-s10.svg";case n.pegNR70:return"hard-buttons/clie-nr70.svg";case n.pegN700c:return"hard-buttons/clie-n700.svg";case n.pegN600c:return"hard-buttons/clie-n610.svg";case n.pegS300:return"hard-buttons/clie-s300.svg";case n.pegS500c:return"hard-buttons/clie-s500.svg";case n.pegS320:return"hard-buttons/clie-s320.svg";case n.pegT400:case n.pegT600c:case n.pegT650c:return"hard-buttons/clie-t415.svg";case n.pilot:case n.palmPilot:return"hard-buttons/pilot.svg";case n.m500:return"hard-buttons/m500.svg";case n.m505:case n.m515:case n.m520:return"hard-buttons/m515.svg";case n.iiic:return"hard-buttons/iiic.svg";case n.m100:case n.m105:return"hard-buttons/m100.svg";case n.m125:return"hard-buttons/m125.svg";case n.m130:return"hard-buttons/m130.svg";case n.i710:return"hard-buttons/tungstenw.svg";case n.iii:case n.iiix:case n.iiixe:case n.palmVII:case n.palmVIIEZ:case n.palmVIIx:return"hard-buttons/iiix.svg";case n.iiie:return"hard-buttons/iiie.svg";case n.i705:return"hard-buttons/i705.svg";case n.handera330:return"hard-buttons/handera330.svg";case n.handera330c:return"hard-buttons/handera330c.svg";case n.lp168:return"hard-buttons/lp168.svg";case n.palmVx:case n.palmV:default:return"hard-buttons/v.svg"}}backgroundColor(){return C(this.getDeviceId())?"white":k}frameColor(){return C(this.getDeviceId())?"white":"#ccc"}}const T='<svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><title>Game Controller</title><path d="M467.51 248.83c-18.4-83.18-45.69-136.24-89.43-149.17A91.5 91.5 0 00352 96c-26.89 0-48.11 16-96 16s-69.15-16-96-16a99.09 99.09 0 00-27.2 3.66C89 112.59 61.94 165.7 43.33 248.83c-19 84.91-15.56 152 21.58 164.88 26 9 49.25-9.61 71.27-37 25-31.2 55.79-40.8 119.82-40.8s93.62 9.6 118.66 40.8c22 27.41 46.11 45.79 71.42 37.16 41.02-14.01 40.44-79.13 21.43-165.04z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"/><circle cx="292" cy="224" r="20"/><path d="M336 288a20 20 0 1120-19.95A20 20 0 01336 288z"/><circle cx="336" cy="180" r="20"/><circle cx="380" cy="224" r="20"/><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M160 176v96M208 224h-96"/></svg>',H=y(f(v(T)),T);class B extends z{constructor(){super(...arguments),this.deviceId=n.m515,this.orientation=o.portrait,this.gameModeIndicatorEnabled=!0,this.gameModeActive=!1,this.lastActiveButtons=void 0}initialize(e,i=this.deviceId,r=this.orientation){var n;return t(this,void 0,void 0,(function*(){this.deviceId=i,this.orientation=r;const t=e||(null===(n=this.ctx)||void 0===n?void 0:n.canvas);t&&(t.width=this.width,t.height=this.height,t.style.objectFit="contain"),yield this.initWithCanvas(e)}))}updateOrientation(e){this.orientation=e,this.initialize()}toggleGameModeIndicator(e){this.gameModeActive=e,this.drawButtons(this.lastActiveButtons)}setGameModeIndicatorEnabled(e){this.gameModeIndicatorEnabled=e,this.drawButtons(this.lastActiveButtons)}isGameModeIndicatorEnabled(){return this.gameModeIndicatorEnabled}getCanvas(){var e;return null===(e=this.ctx)||void 0===e?void 0:e.canvas}drawButtons(e=[]){const i=Object.create(null,{drawButtons:{get:()=>super.drawButtons}});return t(this,void 0,void 0,(function*(){this.lastActiveButtons=e,yield i.drawButtons.call(this,e),this.gameModeActive&&this.gameModeIndicatorEnabled&&(yield this.drawGameModeIndicator())}))}getDeviceId(){return this.deviceId}getOrientation(){return this.orientation}drawGameModeIndicator(){return t(this,void 0,void 0,(function*(){if(!this.ctx)return;const e=Math.floor(.1*this.layout.screenWidth.frameCanvas),t=Math.floor(.8*e),i=Math.floor(.1*e),r=Math.floor(.11*e);this.fillCanvasRect(this.layout.screenLeft.frameCanvas-i+this.layout.screenWidth.frameCanvas-e,this.layout.buttonTop.frameCanvas+this.layout.buttonHeight.frameCanvas-e-i,e,e,"rgba(200, 200, 200, 0.7)"),this.ctx.drawImage(yield H(e,e),this.layout.screenLeft.frameCanvas+this.layout.screenWidth.frameCanvas-i-e+r,this.layout.buttonTop.frameCanvas+this.layout.buttonHeight.frameCanvas-e-i+r,t,t)}))}}var A=i(650);const N=((e,t)=>{let i=null;return()=>{if(null!==i)return i;const e=new Blob(['(()=>{"use strict";const e=new Map,t=new Map,r=(e,t)=>{let r,o;const i=performance.now();r=i,o=e-Math.max(0,i-t);return{expected:r+o,remainingDelay:o}},o=(e,t,r,i)=>{const s=performance.now();s>r?postMessage({id:null,method:"call",params:{timerId:t,timerType:i}}):e.set(t,setTimeout(o,r-s,e,t,r,i))};addEventListener("message",(i=>{let{data:s}=i;try{if("clear"===s.method){const{id:r,params:{timerId:o,timerType:i}}=s;if("interval"===i)(t=>{const r=e.get(t);if(void 0===r)throw new Error(\'There is no interval scheduled with the given id "\'.concat(t,\'".\'));clearTimeout(r),e.delete(t)})(o),postMessage({error:null,id:r});else{if("timeout"!==i)throw new Error(\'The given type "\'.concat(i,\'" is not supported\'));(e=>{const r=t.get(e);if(void 0===r)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(r),t.delete(e)})(o),postMessage({error:null,id:r})}}else{if("set"!==s.method)throw new Error(\'The given method "\'.concat(s.method,\'" is not supported\'));{const{params:{delay:i,now:n,timerId:a,timerType:d}}=s;if("interval"===d)((t,i,s)=>{const{expected:n,remainingDelay:a}=r(t,s);e.set(i,setTimeout(o,a,e,i,n,"interval"))})(i,a,n);else{if("timeout"!==d)throw new Error(\'The given type "\'.concat(d,\'" is not supported\'));((e,i,s)=>{const{expected:n,remainingDelay:a}=r(e,s);t.set(i,setTimeout(o,a,t,i,n,"timeout"))})(i,a,n)}}}}catch(e){postMessage({error:{message:e.message},id:s.id,result:null})}}))})();'],{type:"application/javascript; charset=utf-8"}),t=URL.createObjectURL(e);return i=(e=>{const t=new Map([[0,()=>{}]]),i=new Map([[0,()=>{}]]),r=new Map,n=new Worker(e);return n.addEventListener("message",(({data:e})=>{if(void 0!==(n=e).method&&"call"===n.method){const{params:{timerId:n,timerType:o}}=e;if("interval"===o){const e=t.get(n);if("number"==typeof e){const t=r.get(e);if(void 0===t||t.timerId!==n||t.timerType!==o)throw new Error("The timer is in an undefined state.")}else{if(void 0===e)throw new Error("The timer is in an undefined state.");e()}}else if("timeout"===o){const e=i.get(n);if("number"==typeof e){const t=r.get(e);if(void 0===t||t.timerId!==n||t.timerType!==o)throw new Error("The timer is in an undefined state.")}else{if(void 0===e)throw new Error("The timer is in an undefined state.");e(),i.delete(n)}}}else{if(!(e=>null===e.error&&"number"==typeof e.id)(e)){const{error:{message:t}}=e;throw new Error(t)}{const{id:n}=e,o=r.get(n);if(void 0===o)throw new Error("The timer is in an undefined state.");const{timerId:s,timerType:a}=o;r.delete(n),"interval"===a?t.delete(s):i.delete(s)}}var n})),{clearInterval:e=>{const i=(0,A.generateUniqueNumber)(r);r.set(i,{timerId:e,timerType:"interval"}),t.set(e,i),n.postMessage({id:i,method:"clear",params:{timerId:e,timerType:"interval"}})},clearTimeout:e=>{const t=(0,A.generateUniqueNumber)(r);r.set(t,{timerId:e,timerType:"timeout"}),i.set(e,t),n.postMessage({id:t,method:"clear",params:{timerId:e,timerType:"timeout"}})},setInterval:(e,i)=>{const r=(0,A.generateUniqueNumber)(t);return t.set(r,(()=>{e(),"function"==typeof t.get(r)&&n.postMessage({id:null,method:"set",params:{delay:i,now:performance.now(),timerId:r,timerType:"interval"}})})),n.postMessage({id:null,method:"set",params:{delay:i,now:performance.now(),timerId:r,timerType:"interval"}}),r},setTimeout:(e,t)=>{const r=(0,A.generateUniqueNumber)(i);return i.set(r,e),n.postMessage({id:null,method:"set",params:{delay:t,now:performance.now(),timerId:r,timerType:"timeout"}}),r}}})(t),setTimeout((()=>URL.revokeObjectURL(t))),i}})();var F;!function(e){e[e.animationFrame=0]="animationFrame",e[e.timeout=1]="timeout"}(F||(F={}));class L{constructor(e){this.callback=e}schedule(){void 0===this.handle&&(this.handle=requestAnimationFrame((e=>{this.handle=void 0,this.callback(e)})))}cancel(){void 0!==this.handle&&(cancelAnimationFrame(this.handle),this.handle=void 0)}isScheduled(){return void 0!==this.handle}getKind(){return F.animationFrame}}class U{constructor(e,t=60){this.callback=e,this.fps=t}schedule(){if(void 0!==this.handle)return;const e=performance.now(),t=1e3*Math.ceil(e/1e3*this.fps)/this.fps;var i,r;this.handle=(i=()=>{this.handle=void 0,this.callback(performance.now())},r=Math.max(t-e,0),N().setTimeout(i,r))}cancel(){var e;void 0!==this.handle&&(e=this.handle,N().clearTimeout(e),this.handle=void 0)}isScheduled(){return void 0!==this.handle}getKind(){return F.timeout}}class j{constructor(e,t){this.queue=new Array(e).fill(0),this.reset(t)}reset(e=0){this.next=1,this.size=1,this.queue[0]=e}push(e){return this.queue[this.next]=e,this.next=(this.next+1)%this.queue.length,this.size<this.queue.length&&this.size++,this}calculateAverage(){let e=0;for(let t=0;t<this.size;t++)e+=this.queue[t];return e/this.size}}class O{constructor(e){this.start=0,this.size=0,this.buffer=new Array(e)}push(e){return this.size<this.buffer.length?this.buffer[(this.start+this.size++)%this.buffer.length]=e:(this.start=(this.start+1)%this.buffer.length,this.buffer[(this.start+this.size-1)%this.buffer.length]=e),this}pop(){if(0===this.size)return;const e=this.buffer[this.start];return this.start=(this.start+1)%this.buffer.length,this.size--,e}peekLast(){if(0!==this.size)return this.buffer[(this.start+this.size-1)%this.buffer.length]}replaceLast(e){return this.size>0&&(this.buffer[(this.start+this.size-1)%this.buffer.length]=e),this}count(){return this.size}flush(){return this.start=0,this.size=0,this}}class W{constructor(){this.onFrameComplete=()=>{this.transport&&this.receiveEvent.dispatch({data:this.transport.Receive(),isFrameComplete:this.transport.IsFrameComplete()})},this.receiveEvent=new w.j,this.dispatchEvent=new w.j,this.isSync=!1}bind(e){this.transport!==e&&(this.transport&&this.transport.frameCompleteEvent.removeHandler(this.onFrameComplete),e.frameCompleteEvent.addHandler(this.onFrameComplete),e.SetModeSync(this.isSync),this.transport=e)}send(e,t){this.transport&&(this.transport.IsOpen()||!this.transport.GetModeSync()?(this.transport.Send(e,t),setTimeout((()=>this.dispatchEvent.dispatch()),0)):this.receiveEvent.dispatch({data:void 0,isFrameComplete:!0}))}setModeSync(e){var t;this.isSync=e,null===(t=this.transport)||void 0===t||t.SetModeSync(e)}getModeSync(){var e,t,i;return null!==(i=null===(t=null===(e=this.transport)||void 0===e?void 0:e.GetModeSync)||void 0===t?void 0:t.call(e))&&void 0!==i&&i}dispatch(){if(!this.transport)return;const e=this.transport.RxBytesPending();0!==e&&(this.transport.GetModeSync()&&e<1024||this.receiveEvent.dispatch({data:this.transport.Receive(),isFrameComplete:this.transport.IsFrameComplete()}))}}class V{constructor(){this.onPwmUpdate=e=>{this.pendingPwmUpdates.count()>0&&this.pendingPwmUpdates.peekLast().frequency<0?this.pendingPwmUpdates.replaceLast(e):this.pendingPwmUpdates.push(e)},this.advanceEmulation=e=>{if(this.isDirty=!1,!this.isRunning)return;if(!this.cloudpilotInstance||this.hasFatalError()||e<this.clockEmulator)return;this.cloudpilotInstance.isSuspended()&&5===this.cloudpilotInstance.getSuspendKind()&&e-this.serialSyncStartedAt>250&&(console.log("serial sync timeout, waking emulator"),this.cloudpilotInstance.getSuspendContextSerialSync().Cancel());const t=this.cloudpilotInstance.isSuspended();let i=!1;this.cloudpilotInstance.setClockFactor(this.emulationSpeed*this.getConfiguredSpeed()),e-this.clockEmulator>1e3/30&&(this.clockEmulator=e-1e3/30);const r=(e-this.clockEmulator)/1e3*this.cloudpilotInstance.cyclesPerSecond(),n=performance.now();let o=0;for(;o<r;)if(o+=this.cloudpilotInstance.runEmulation(Math.ceil(r-o)),this.cloudpilotInstance.isSuspended()){i=!0;break}const s=o/this.cloudpilotInstance.cyclesPerSecond()*1e3,a=performance.now()-n;this.clockEmulator+=Math.max(s,a),this.speedAverage.push(s/(a>0?a:s/1e3)*this.emulationSpeed),this.updateEmulationSpeed(this.speedAverage.calculateAverage()),i&&!t&&(5===this.cloudpilotInstance.getSuspendKind()?this.serialSyncStartedAt=performance.now():this.handleSuspend());const p=this.cloudpilotInstance.isPowerOff(),c=this.cloudpilotInstance.isUiInitialized();if(p!==this.powerOff||c!==this.uiInitialized){const e=this.powerOff;this.powerOff=p,this.uiInitialized=c,e!==this.powerOff&&this.powerOffChangeEvent.dispatch(this.powerOff),this.isDirty=!0}c&&!p&&this.manageHotsyncName()&&!i&&this.checkAndUpdateHotsyncName(),this.serialPortIR.dispatch(),this.serialPortSerial.dispatch(),this.onAfterAdvanceEmulation(e,o)},this.newFrameEvent=new w.j,this.pwmUpdateEvent=new w.j,this.emulationStateChangeEvent=new w.j,this.powerOffChangeEvent=new w.j,this.deviceId=n.m515,this.clockEmulator=0,this.scheduler=new L((e=>this.onSchedule(e))),this.canvas=document.createElement("canvas"),this.canvasTmp=document.createElement("canvas"),this.lastPenUpdate=0,this.penDown=!1,this.running=!1,this.powerOff=!1,this.uiInitialized=!1,this.pendingPwmUpdates=new O(10),this.lastPwmUpdateEvent=0,this.emulationSpeed=1,this.speedAverage=new j(20),this.timePerFrameAverage=new j(60),this.timestampLastFrame=0,this.frameCounter=0,this.isDirty=!1,this.serialPortIR=new W,this.serialPortSerial=new W,this.serialSyncStartedAt=0,this.serialPortIR.dispatchEvent.addHandler((()=>this.advanceEmulation(performance.now()))),this.serialPortSerial.dispatchEvent.addHandler((()=>this.advanceEmulation(performance.now())))}handlePointerMove(e,t,i){if(!this.handleInput())return;const r=performance.now();if(this.penDown=!0,!(r-this.lastPenUpdate<25)&&this.cloudpilotInstance){if(i){const i=S(this.deviceId);e=this.transformSilkscreenX(e,i),t=this.transformSilkscreenY(t,i)}this.cloudpilotInstance.queuePenMove(Math.floor(e),Math.floor(t)),this.lastPenUpdate=r}}handlePointerUp(){this.handleInput()&&(this.cloudpilotInstance&&this.penDown&&this.cloudpilotInstance.queuePenUp(),this.lastPenUpdate=0,this.penDown=!1)}handleButtonDown(e){this.handleInput()&&this.cloudpilotInstance&&this.cloudpilotInstance.queueButtonDown(e)}handleButtonUp(e){this.handleInput()&&this.cloudpilotInstance&&this.cloudpilotInstance.queueButtonUp(e)}handleKeyDown(e,t=!1){this.handleInput()&&this.cloudpilotInstance&&this.cloudpilotInstance.queueKeyboardEvent(e,t)}reset(){this.cloudpilotInstance&&this.cloudpilotInstance.reset()}resetNoExtensions(){this.cloudpilotInstance&&this.cloudpilotInstance.resetNoExtensions()}resetHard(){this.cloudpilotInstance&&this.cloudpilotInstance.resetHard()}isRunning(){return this.running}isPowerOff(){return this.powerOff}isUiInitialized(){return this.uiInitialized}getCanvas(){return this.canvas}getStatistics(){return{hostSpeed:this.speedAverage.calculateAverage(),emulationSpeed:this.emulationSpeed,averageFps:this.calculateFPS()}}getEmulationSpeed(){return this.emulationSpeed}isSuspended(){return!!this.cloudpilotInstance&&this.cloudpilotInstance.isSuspended()}getSerialPortSerial(){if(!this.serialPortSerial)throw new Error("emulator not initialized");return this.serialPortSerial}getSerialPortIR(){if(!this.serialPortIR)throw new Error("emulator not initialized");return this.serialPortIR}onAfterAdvanceEmulation(e,t){}handleSuspend(){}callScheduler(){this.scheduler.schedule()}handleInput(){return!0}openSession(e,t,i,r,n){let o=!1;return!!e.initializeSession(t,i)&&(r&&(r.length%4!=0?console.warn("memory size is not a multiple of 4; ignoring image"):(o=e.loadMemory(new Uint32Array(r.buffer,r.byteOffset,r.length>>>2)),o||console.warn("failed to load memory"))),o&&n&&e.loadState(n),e.remountCards(),this.cloudpilotInstance&&this.cloudpilotInstance.pwmUpdateEvent.removeHandler(this.onPwmUpdate),e.pwmUpdateEvent.addHandler(this.onPwmUpdate),this.cloudpilotInstance!==e&&(this.serialPortIR.bind(e.getTransportIR()),this.serialPortSerial.bind(e.getTransportSerial())),this.cloudpilotInstance=e,this.deviceId=i,this.resetCanvas(),this.pendingPwmUpdates.flush(),this.lastPwmUpdateEvent=0,this.deviceHotsyncName=void 0,this.emulationSpeed=1,this.frameCounter=0,this.speedAverage.reset(1),this.powerOff=e.isPowerOff(),this.uiInitialized=e.isUiInitialized(),this.frameCounter=0,!0)}resetCanvas(){const e=S(this.deviceId);this.canvas.width=this.canvasTmp.width=e.width,this.canvas.height=this.canvasTmp.height=e.height;const t=this.canvas.getContext("2d");if(!t)throw new Error("get a new browser");this.context=t;const i=this.canvasTmp.getContext("2d");if(!i)throw new Error("get a new browser");this.contextTmp=i,this.clearCanvas(),this.imageData=void 0}doResume(){this.cloudpilotInstance&&(this.clockEmulator=performance.now(),this.schedule(),this.setRunning(!0),this.resetFPS())}doPause(){this.stopLoop()}doStop(){this.stopLoop()}stopLoop(){this.running&&(this.scheduler.cancel(),void 0!==this.advanceEmulationHandle&&(window.clearTimeout(this.advanceEmulationHandle),this.advanceEmulationHandle=void 0),this.setRunning(!1))}resetFPS(){this.timePerFrameAverage.reset(),this.timestampLastFrame=performance.now()}calculateFPS(){const e=this.timePerFrameAverage.calculateAverage();return e&&1e3/e}transformSilkscreenX(e,t){if(void 0===t.silkscreenOvershoot)return e;const i=t.width/(t.width+2*t.silkscreenOvershoot);return(e-t.width/2)/i+t.width/2}transformSilkscreenY(e,t){return void 0===t.siklscreenShift?e:e+t.siklscreenShift}setRunning(e){e!==this.running&&(this.running=e,this.emulationStateChangeEvent.dispatch(e))}updateEmulationSpeed(e){if(e>=1&&this.emulationSpeed>=1)return;const t=Math.min(Math.max(Math.floor(10*e)/10,.1),1);t<=this.emulationSpeed?this.emulationSpeed=t:this.emulationSpeed=e-t>=.05?t:this.emulationSpeed}performScreenUpdate(){var e;(null===(e=this.cloudpilotInstance)||void 0===e?void 0:e.isScreenDirty())&&(this.updateScreen(),this.cloudpilotInstance.markScreenClean(),this.frameCounter++)}onSchedule(e){this.hasFatalError()||(this.skipEmulationUpdate()||(this.performScreenUpdate(),this.pendingPwmUpdates.count()>0&&e-this.lastPwmUpdateEvent>10&&(this.pwmUpdateEvent.dispatch(this.pendingPwmUpdates.pop()),this.lastPwmUpdateEvent=e),void 0===this.advanceEmulationHandle&&(this.advanceEmulationHandle=window.setTimeout((()=>{this.advanceEmulationHandle=void 0,this.advanceEmulation(e)}),0)),this.timePerFrameAverage.push(Math.max(0,e-this.timestampLastFrame)),this.timestampLastFrame=e),this.schedule())}schedule(){this.scheduler.cancel(),this.getConfiguredSchdedulerKind()!==this.scheduler.getKind()&&(this.scheduler=this.getConfiguredSchdedulerKind()===F.animationFrame?new L((e=>this.onSchedule(e))):new U((e=>this.onSchedule(e)))),this.callScheduler()}checkAndUpdateHotsyncName(){if(!this.cloudpilotInstance)return;void 0===this.deviceHotsyncName&&(this.deviceHotsyncName=this.cloudpilotInstance.getHotsyncName());const e=this.getConfiguredHotsyncName();void 0===e?this.updateConfiguredHotsyncName(this.deviceHotsyncName):e!==this.deviceHotsyncName&&e.length<=40&&this.cloudpilotInstance.isSetupComplete()&&(this.cloudpilotInstance.setHotsyncName(e),this.deviceHotsyncName=e)}clearCanvas(){const e=this.deviceId,t=S(e);this.context.beginPath(),this.context.rect(0,0,t.width,t.height),this.context.fillStyle=C(e)?"white":D[0],this.context.fill()}updateScreen(){if(!this.cloudpilotInstance)return;const e=this.cloudpilotInstance.getFrame();if(this.cloudpilotInstance.isPowerOff())return this.clearCanvas(),void this.newFrameEvent.dispatch(this.canvas);if(!e.hasChanges)return;if(e.lines*e.scaleY===this.canvas.height&&e.lineWidth*e.scaleX===this.canvas.width){this.imageData&&this.imageData.width===e.lineWidth&&this.imageData.height===e.lines||(this.imageData=new ImageData(e.lineWidth,e.lines));const t=new Uint32Array(this.imageData.data.buffer);switch(e.bpp){case 1:{const i=G[15],r=G[0];let n=0;for(let o=e.firstDirtyLine;o<=e.lastDirtyLine;o++){const s=o*e.bytesPerLine;for(let o=e.margin;o<e.lineWidth+e.margin;o++)t[n++]=e.buffer[s+(o>>>3)]&128>>>(7&o)?i:r}break}case 2:{const i=this.cloudpilotInstance.getPalette2bitMapping(),r=[G[15&i],G[i>>>4&15],G[i>>>8&15],G[i>>>12&15]];let n=0;for(let i=e.firstDirtyLine;i<=e.lastDirtyLine;i++){const o=i*e.bytesPerLine;for(let i=e.margin;i<e.lineWidth+e.margin;i++)t[n++]=r[e.buffer[o+(i>>>2)]>>6-2*(3&i)&3]}break}case 4:{let i=0;for(let r=e.firstDirtyLine;r<=e.lastDirtyLine;r++){const n=r*e.bytesPerLine;for(let r=e.margin;r<e.lineWidth+e.margin;r++)t[i++]=G[e.buffer[n+(r>>>1)]>>>4-4*(1&r)&15]}break}case 24:{const i=new Uint32Array(e.buffer.buffer,e.buffer.byteOffset,e.buffer.byteLength>>>2);if(0===e.margin)t.subarray(0,e.lineWidth*(e.lastDirtyLine-e.firstDirtyLine+1)).set(i.subarray(e.firstDirtyLine*e.lineWidth,e.lineWidth*(e.lastDirtyLine+1)));else{let r=0;for(let n=e.firstDirtyLine;n<=e.lastDirtyLine;n++){let o=n*(e.bytesPerLine>>>2)+e.margin;for(let n=0;n<e.lineWidth;n++)t[r++]=i[o++]}}}}}if(!this.imageData)return;const t=1!==e.scaleX||1!==e.scaleY;(t?this.contextTmp:this.context).putImageData(this.imageData,0,e.firstDirtyLine,0,0,e.lineWidth,e.lastDirtyLine-e.firstDirtyLine+1),t&&(this.context.imageSmoothingEnabled=!1,this.context.drawImage(this.canvasTmp,0,e.firstDirtyLine,e.lineWidth,e.lastDirtyLine-e.firstDirtyLine+1,0,e.firstDirtyLine*e.scaleY,e.lineWidth*e.scaleX,(e.lastDirtyLine-e.firstDirtyLine+1)*e.scaleY)),this.newFrameEvent.dispatch(this.canvas)}}class q extends V{constructor(){super(...arguments),this.timesliceEvent=new w.j}pause(){this.doPause()}resume(){this.doResume()}initWithRom(e,t,i,r){return this.isRunning()&&(this.doStop(),this.session=void 0),e.clearExternalStorage(),!!this.openSession(e,t,i)&&(this.session=r,!0)}initWithSessionImage(e,t,i){return this.isRunning()&&(this.doStop(),this.session=void 0),e.clearExternalStorage(),!!this.openSession(e,t.rom,t.deviceId,t.memory,t.savestate)&&(this.session=i,!0)}getSession(){return this.session}forceUpdateHotsyncName(){this.cloudpilotInstance&&this.cloudpilotInstance.isUiInitialized()&&!this.cloudpilotInstance.isPowerOff()&&this.checkAndUpdateHotsyncName()}getConfiguredSpeed(){var e,t;return null!==(t=null===(e=this.session)||void 0===e?void 0:e.speed)&&void 0!==t?t:1}manageHotsyncName(){return!0}getConfiguredHotsyncName(){var e;return null===(e=this.session)||void 0===e?void 0:e.hotsyncName}updateConfiguredHotsyncName(e){this.session&&(this.session.hotsyncName=e)}getConfiguredSchdedulerKind(){var e;return(null===(e=this.session)||void 0===e?void 0:e.runInBackground)?F.timeout:F.animationFrame}hasFatalError(){var e;return!!(null===(e=this.cloudpilotInstance)||void 0===e?void 0:e.hasFatalError())}skipEmulationUpdate(){return!1}onAfterAdvanceEmulation(e,t){this.timesliceEvent.dispatch()}handleInput(){return this.isRunning()}}class K{constructor(e,t){this.emulationService=e,this.canvasDisplayService=t,this.handleMouseDown=e=>{if(0!==e.button)return;const t=this.canvasDisplayService.eventToPalmCoordinates(e);if(!t)return;const i=this.determineArea(t);if(2===i){const e=this.canvasDisplayService.determineButton(t);this.interactionMouse={area:i,buttonPrimary:e},this.handleButtonDown(e)}else this.interactionMouse={area:i},this.emulationService.handlePointerMove(...t,1===i)},this.handleMouseMove=e=>{var t,i;if(!(1&e.buttons&&this.interactionMouse&&2!==(null===(t=this.interactionMouse)||void 0===t?void 0:t.area)))return;const r=this.canvasDisplayService.eventToPalmCoordinates(e,!0);r&&this.emulationService.handlePointerMove(...r,1===(null===(i=this.interactionMouse)||void 0===i?void 0:i.area))},this.handeMouseUp=e=>{if(0!==e.button)return;const t=this.interactionMouse;switch(this.interactionMouse=void 0,null==t?void 0:t.area){case 2:this.handleButtonUp(t.buttonPrimary);break;case 0:case 1:this.emulationService.handlePointerUp()}},this.handleTouchStart=e=>{let t=!1;for(let i=0;i<e.changedTouches.length;i++){const r=e.changedTouches.item(i);if(!r)continue;const n=this.canvasDisplayService.eventToPalmCoordinates(r);if(!n)continue;t=!0;const o=this.determineArea(n);if(2===o){const e=this.canvasDisplayService.determineButton(n);this.interactionsTouch.set(r.identifier,{area:o,buttonPrimary:e}),this.handleButtonDown(e)}else this.interactionsTouch.set(r.identifier,{area:o}),this.emulationService.handlePointerMove(...n,1===o)}t&&!1!==e.cancelable&&e.preventDefault()},this.handleTouchMove=e=>{let t=!1;for(let i=0;i<e.changedTouches.length;i++){const r=e.changedTouches.item(i);if(!r)continue;const n=this.interactionsTouch.get(r.identifier);if(!n)continue;t=!0;const o=n.area;switch(o){case 2:{const e=this.canvasDisplayService.eventToPalmCoordinates(r);if(!e||2!==this.determineArea(e)){this.handleButtonUp(n.buttonSecondary),n.buttonSecondary=void 0;break}const t=this.canvasDisplayService.determineButton(e);t===n.buttonPrimary?(this.handleButtonUp(n.buttonSecondary),n.buttonSecondary=void 0):t!==n.buttonSecondary&&(this.handleButtonUp(n.buttonSecondary),n.buttonSecondary=t,this.handleButtonDown(t));break}case 0:case 1:{const e=this.canvasDisplayService.eventToPalmCoordinates(r,!0);if(!e)continue;this.emulationService.handlePointerMove(...e,1===o);break}default:continue}}t&&!1!==e.cancelable&&e.preventDefault()},this.handleTouchEnd=e=>{let t=!1;for(let i=0;i<e.changedTouches.length;i++){const r=e.changedTouches.item(i);if(!r)continue;const n=this.interactionsTouch.get(r.identifier);switch(n&&(t=!0),this.interactionsTouch.delete(r.identifier),null==n?void 0:n.area){case 2:this.handleButtonUp(n.buttonPrimary),this.handleButtonUp(n.buttonSecondary);break;case 0:case 1:this.emulationService.handlePointerUp()}}t&&!1!==e.cancelable&&e.preventDefault()},this.handleKeyDown=e=>{if(this.emulationService.isSuspended()||!this.enableKeyboardEvents())return;if(this.isToggleGameMode(e))return e.preventDefault(),this.gameMode=!this.gameMode,void this.onToggleGameMode();const t=this.buttonFromEvent(e);if(void 0!==t)return this.handleButtonDown(t),void e.preventDefault();const i=this.keyCodeFromEvent(e);void 0!==i&&(this.emulationService.handleKeyDown(i),e.preventDefault())},this.handleKeyUp=e=>{if(this.emulationService.isSuspended()||!this.enableKeyboardEvents())return;const t=this.buttonFromEvent(e);if(void 0!==t)return this.handleButtonUp(t),void e.preventDefault();if("Control"===e.key){for(const e of this.activeButtons)this.emulationService.handleButtonUp(e);this.activeButtons.clear(),this.canvasDisplayService.drawButtons([])}},this.keyEventTarget=window,this.interactionsTouch=new Map,this.activeButtons=new Set,this.gameMode=!1,this.enableGamemodeHotkey=!0}bind(e,t=window){this.pointerEventTarget&&this.release(),this.pointerEventTarget=e,this.keyEventTarget=t||window,this.addEventListener(e,"mousedown",this.handleMouseDown),this.addEventListener(window,"mouseup",this.handeMouseUp),this.addEventListener(window,"mousemove",this.handleMouseMove),this.addEventListener(e,"touchstart",this.handleTouchStart),this.addEventListener(e,"touchmove",this.handleTouchMove),this.addEventListener(e,"touchend",this.handleTouchEnd),this.addEventListener(e,"touchcancel",this.handleTouchEnd),this.addEventListener(this.keyEventTarget,"keydown",this.handleKeyDown),this.addEventListener(this.keyEventTarget,"keyup",this.handleKeyUp)}release(){if(this.pointerEventTarget){this.removeEventListener(this.pointerEventTarget,"mousedown",this.handleMouseDown),this.removeEventListener(window,"mouseup",this.handeMouseUp),this.removeEventListener(window,"mousemove",this.handleMouseMove),this.removeEventListener(this.pointerEventTarget,"touchstart",this.handleTouchStart),this.removeEventListener(this.pointerEventTarget,"touchmove",this.handleTouchMove),this.removeEventListener(this.pointerEventTarget,"touchend",this.handleTouchEnd),this.removeEventListener(this.pointerEventTarget,"touchcancel",this.handleTouchEnd),this.removeEventListener(this.keyEventTarget,"keydown",this.handleKeyDown),this.removeEventListener(this.keyEventTarget,"keyup",this.handleKeyUp);for(const e of this.activeButtons)this.handleButtonUp(e);this.activeButtons.clear(),this.interactionsTouch.clear(),this.interactionMouse=void 0,this.pointerEventTarget=void 0}}isGameMode(){return this.gameMode}setGameMode(e){this.gameMode=e,this.onToggleGameMode()}setGameModeHotkeyEnabled(e){this.enableGamemodeHotkey=e}isGameModeHotkeyEnabled(){return this.enableGamemodeHotkey}enableKeyboardEvents(){return!0}onToggleGameMode(){}addEventListener(e,t,i,r){e.addEventListener(t,i,r)}removeEventListener(e,t,i,r){e.removeEventListener(t,i,r)}determineArea(e){return this.canvasDisplayService.isButtons(e)?2:this.canvasDisplayService.isSilkscreen(e)?1:0}handleButtonDown(e){this.activeButtons.has(e)||(this.activeButtons.add(e),this.emulationService.handleButtonDown(e),this.canvasDisplayService.drawButtons(Array.from(this.activeButtons.values())))}handleButtonUp(e){void 0!==e&&this.activeButtons.has(e)&&(this.activeButtons.delete(e),this.emulationService.handleButtonUp(e),this.canvasDisplayService.drawButtons(Array.from(this.activeButtons.values())))}isToggleGameMode(e){return this.isGameModeHotkeyEnabled()&&("Shift"===e.key&&e.ctrlKey||"Control"===e.key&&e.shiftKey)}isGameModeActive(e){return!this.gameMode&&e.ctrlKey||this.gameMode&&!e.ctrlKey}buttonFromEvent(e){switch(e.key){case"PageUp":return 4;case"PageDown":return 5}if(this.isGameModeActive(e))switch(e.key){case"w":case"i":case"ArrowUp":return 4;case"s":case"k":case"ArrowDown":return 5;case"a":case"j":case"y":case"z":case"ArrowLeft":return 0;case"q":case"u":case"x":return 1;case"e":case"o":case"c":return 2;case"d":case"l":case"v":case"ArrowRight":return 3}}keyCodeFromEvent(e){if(!this.isGameModeActive(e)){if(1===e.key.length&&e.key.charCodeAt(0)<=255)return e.key.charCodeAt(0);switch(e.key){case"ArrowLeft":return 28;case"ArrowRight":return 29;case"ArrowUp":return 30;case"ArrowDown":return 31;case"Backspace":return 8;case"Tab":return 9;case"Enter":return 10;default:return}}}}class Y extends K{constructor(e,t){super(e,t),this.gameModeChangeEvent=new w.j,this.canvasDisplayService=t}onToggleGameMode(){this.canvasDisplayService.toggleGameModeIndicator(this.isGameMode()),this.gameModeChangeEvent.dispatch(this.isGameMode())}}class Z{constructor(e){this.cloudpilot=e,this.images=new Map}loadSkinElement(e){if(this.images.has(e))return this.images.get(e);const t=this.cloudpilot.then((t=>t.loadSkin(e))).then((t=>t?Promise.all([t,f(v(t))]):Promise.reject(new Error(`failed to load skin ${e}`)))),i=y(t.then((([,e])=>e)),t.then((([e])=>e)));return this.images.set(e,i),i}}class Q{constructor(e){this.query=e,this.changeEvent=new w.j,this.last=e()}update(){const e=this.query();e!==this.last&&(this.changeEvent.dispatch(e),this.last=e)}}const $={hotsyncName:void 0,orientation:o.portrait,runInBackground:!1,speed:1,deviceId:n.m515},X="MEMORY_CARD";class J{constructor(e){this.cloudpilot=e,this.onTimeslice=()=>{this.powerOffWatcher.update(),this.uiInitializedWatcher.update(),this.hotsyncNameWatcher.update()},this.audioInitializedEvent=new w.j,this.session=Object.assign({},$),this.emulationService=new q,this.canvasDisplayService=new B(new Z(Promise.resolve(e))),this.eventHandlingService=new Y(this.emulationService,this.canvasDisplayService),this.audioService=new m(this.emulationService),this.emulationService.newFrameEvent.addHandler((e=>this.canvasDisplayService.updateEmulationCanvas(e))),this.timesliceEvent.addHandler(this.onTimeslice),this.powerOffWatcher=new Q((()=>this.isPowerOff())),this.uiInitializedWatcher=new Q((()=>this.isUiInitialized())),this.hotsyncNameWatcher=new Q((()=>this.getHotsyncName()||""))}getStatistics(){return this.emulationService.getStatistics()}loadRom(e,t){if(void 0===t){const i=this.cloudpilot.getRomInfo(e);if(!i||0===i.supportedDevices.length)throw new Error("unsupported device");t=i.supportedDevices[0]}if(this.session=Object.assign(Object.assign({},$),{deviceId:t}),this.emulationService.initWithRom(this.cloudpilot,e,t,this.session))return this.canvasDisplayService.initialize(void 0,t,this.session.orientation),this;throw new Error("failed to initialize session")}loadSession(e){var t,i,r,n,s;const a=this.cloudpilot.deserializeSessionImage(e);if(!a)throw new Error("bad session image");if(this.session={hotsyncName:null===(t=a.metadata)||void 0===t?void 0:t.hotsyncName,speed:null!==(r=null===(i=a.metadata)||void 0===i?void 0:i.speed)&&void 0!==r?r:1,orientation:null!==(s=null===(n=a.metadata)||void 0===n?void 0:n.deviceOrientation)&&void 0!==s?s:o.portrait,runInBackground:!1,deviceId:a.deviceId},this.emulationService.initWithSessionImage(this.cloudpilot,a,this.session))return this.canvasDisplayService.initialize(void 0,a.deviceId,this.session.orientation),this;throw new Error("failed to initialize session")}insertCompressedCardImage(e){if(!this.cloudpilot.decompressCard(X,e))throw new Error("failed to decompress and mount card image");if(!this.cloudpilot.mountCard(X))throw new Error("failed to mount card image");return this}insertCardImage(e){if(e.length%512!=0)throw new Error("card image size must be a multiple of 512");if(!this.cloudpilot.allocateCard(X,e.length))throw new Error("failed to allocate card image");const t=this.cloudpilot.getCardData(X);if(!t)throw new Error("failed to allocate card image");if(t.set(new Uint32Array(e.buffer,e.byteOffset,e.byteLength>>>2)),!this.cloudpilot.mountCard(X))throw new Error("failed to mount card image");return this}ejectCard(){if(!this.isCardMounted())return this;if(!this.cloudpilot.removeCard(X))throw new Error("failed to eject card");return this}isCardMounted(){return this.cloudpilot.getMountedKey()===X}setCanvas(e){return this.canvasDisplayService.initialize(e,this.session.deviceId,this.session.orientation),this}bindInput(e){const t=this.canvasDisplayService.getCanvas();if(!t)throw new Error("you must set up the canvas setCanvas before calling bindInput");return this.eventHandlingService.bind(t,e),this}releaseInput(){return this.eventHandlingService.release(),this}installDatabase(e){if(this.cloudpilot.installDb(e)<0)throw new Error("failed to install database");return this}installAndLaunchDatabase(e){return this.installDatabase(e).launchDatabase(e)}installFromZipfile(e){return this.installFromZipfileAndLaunch(e)}installFromZipfileAndLaunch(e,t){let i;if(this.cloudpilot.withZipfileWalkerSync(e,(e=>{for(;0===e.GetState();){const r=e.GetCurrentEntryContent(),n=e.GetCurrentEntryName();if(!r)throw new Error(`unable to read ${n} from zupfile`);this.installDatabase(r),n.toLowerCase()===(null==t?void 0:t.toLowerCase())&&(i=r.subarray(0,32).slice()),e.Next()}if(-1===e.GetState())throw new Error("error reading zipfile")})),void 0!==t&&!i)throw new Error(`database ${t} not found `);return i&&this.launchDatabase(i),this}launchByName(e){if(!this.cloudpilot.launchAppByName(e))throw new Error(`failed to launch ${e}`);return this}launchDatabase(e){if(!this.cloudpilot.launchAppByDbHeader(e))throw new Error("failed to launch database");return this}reset(){return this.emulationService.reset(),this}resetNoExtensions(){return this.emulationService.resetNoExtensions(),this}resetHard(){return this.emulationService.resetHard(),this}isRunning(){return this.emulationService.isRunning()}isPowerOff(){return this.emulationService.isPowerOff()}isUiInitialized(){return this.emulationService.isUiInitialized()}resume(){return this.emulationService.resume(),this}pause(){return this.emulationService.pause(),this}buttonDown(e){return this.emulationService.handleButtonDown(e),this}buttonUp(e){return this.emulationService.handleButtonUp(e),this}setSpeed(e){return this.session.speed=e,this}getSpeed(){return this.session.speed}setVolume(e){return this.audioService.setVolume(e),this}getVolume(){return this.audioService.getVolume()}initializeAudio(){return t(this,void 0,void 0,(function*(){return yield this.audioService.initialize(),this.audioService.isInitialized()}))}isAudioInitialized(){return this.audioService.isInitialized()}setOrientation(e){return this.session.orientation=e,this.canvasDisplayService.updateOrientation(this.session.orientation),this}getOrientation(){return this.session.orientation}setHotsyncName(e){return this.session.hotsyncName=e,this.emulationService.forceUpdateHotsyncName(),this}getHotsyncName(){return this.session.hotsyncName}setRunHidden(e){return this.session.runInBackground=e,this}getRunHidden(){return this.session.runInBackground}isGameMode(){return this.eventHandlingService.isGameMode()}setGameMode(e){return this.eventHandlingService.setGameMode(e),this}isGameModeHotkeyEnabled(){return this.eventHandlingService.isGameModeHotkeyEnabled()}setGameModeHotkeyEnabled(e){return this.eventHandlingService.setGameModeHotkeyEnabled(e),this}isGameModeIndicatorEnabled(){return this.canvasDisplayService.isGameModeIndicatorEnabled()}setGameModeIndicatorEnabled(e){return this.canvasDisplayService.setGameModeIndicatorEnabled(e),this}getSerialPortIR(){return this.emulationService.getSerialPortIR()}getSerialPortSerial(){return this.emulationService.getSerialPortSerial()}get powerOffChangeEvent(){return this.powerOffWatcher.changeEvent}get isUiInitializedChangeEvent(){return this.uiInitializedWatcher.changeEvent}get hotsyncNameChangeEvent(){return this.hotsyncNameWatcher.changeEvent}get gameModeChangeEvent(){return this.eventHandlingService.gameModeChangeEvent}get timesliceEvent(){return this.emulationService.timesliceEvent}}var ee=i(492),te=i.n(ee);let ie=0;const re=[n.palmPilot,n.pilot,n.iii,n.palmVx,n.palmV,n.palmVII,n.palmVIIEZ,n.palmVIIx,n.iiixe,n.iiix,n.iiie,n.m500,n.m505,n.m515,n.m520,n.iiic,n.m100,n.m105,n.m125,n.m130,n.i705,n.i710,n.handera330,n.handera330c,n.pegS300,n.pegS320,n.pegS500c,n.pegT400,n.pegN600c,n.pegT600c,n.pegN700c,n.pegT650c,n.pegNR70,n.acerS11,n.lp168];function ne(){return(e,t,i)=>{const r=i.value;return i.value=function(e,t){return this.guard((()=>r.call(this,e,t)))},i}}class oe{constructor(e){this.module=e,this.fatalErrorEvent=new w.j,this.pwmUpdateEvent=new w.j,this.proxyDisconnectEvent=new w.j,this.amIdead=!1,this.cloudpilot=new e.Cloudpilot,this.cloudpilot.RegisterPwmHandler(e.addFunction(((e,t)=>this.pwmUpdateEvent.dispatch({frequency:e,dutyCycle:t})),"vdd")),this.cloudpilot.RegisterProxyDisconnectHandler(e.addFunction((t=>this.proxyDisconnectEvent.dispatch(e.UTF8ToString(t))),"vi")),this.transportIR=this.wrapTransport(this.cloudpilot.GetTransportIR()),this.transportSerial=this.wrapTransport(this.cloudpilot.GetTransportSerial())}static create(e){return t(this,void 0,void 0,(function*(){const t=ie++;return new oe(yield te()(Object.assign(Object.assign({print:e=>console.log(`${t}: ${e}`),printErr:e=>console.error(`${t}: ${e}`)},"string"==typeof e?{locateFile:()=>e}:{}),"function"==typeof e?{instantiateWasm:e}:{})))}))}destroy(){this.module.destroy(this.cloudpilot)}hasFatalError(){return this.amIdead}getRomInfo(e){const t=this.copyIn(e),i=new this.module.RomInfo(t,e.length);let r;return i.IsValid()&&(r={cardVersion:i.CardVersion(),cardName:i.CardName(),romVersion:i.RomVersion(),romVersionString:i.RomVersionString(),supportedDevices:re.filter(i.Supports.bind(i))}),this.cloudpilot.Free(t),this.module.destroy(i),r}initializeSession(e,t){const i=this.copyIn(e),r=this.cloudpilot.InitializeSession(i,e.length,t);return this.cloudpilot.Free(i),r}cyclesPerSecond(){return this.cloudpilot.GetCyclesPerSecond()}runEmulation(e){return this.cloudpilot.RunEmulation(e)}getFrame(){const e=this.cloudpilot.CopyFrame(),t=this.module.getPointer(e.GetBuffer());return{bpp:e.GetBpp(),bytesPerLine:e.GetBytesPerLine(),lines:e.GetLines(),lineWidth:e.GetLineWidth(),margin:e.GetMargin(),firstDirtyLine:e.GetFirstDirtyLine(),lastDirtyLine:e.GetLastDirtyLine(),hasChanges:e.GetHasChanges(),scaleX:e.GetScaleX(),scaleY:e.GetScaleY(),buffer:this.module.HEAPU8.subarray(t,t+e.GetBufferSize())}}isScreenDirty(){return this.cloudpilot.IsScreenDirty()}markScreenClean(){this.cloudpilot.MarkScreenClean()}minRamForDevice(e){return 1024*this.cloudpilot.MinMemoryForDevice(e)}framebufferSizeForDevice(e){return 1024*this.cloudpilot.FramebufferSizeForDevice(e)}totalMemorySizeForDevice(e){return 1024*this.cloudpilot.TotalMemoryForDevice(e)}queuePenMove(e,t){this.cloudpilot.QueuePenMove(e,t)}queuePenUp(){this.cloudpilot.QueuePenUp()}queueButtonDown(e){this.cloudpilot.QueueButtonDown(e)}queueButtonUp(e){this.cloudpilot.QueueButtonUp(e)}queueKeyboardEvent(e,t){this.cloudpilot.QueueKeyboardEvent(e,t)}isPowerOff(){return!!this.cloudpilot.IsPowerOff()}isUiInitialized(){return!!this.cloudpilot.IsUIInitialized()}isSetupComplete(){return!!this.cloudpilot.IsSetupComplete()}getOSVersion(){return this.cloudpilot.GetOSVersion()}reset(){this.cloudpilot.Reset()}resetNoExtensions(){this.cloudpilot.ResetNoExtensions()}resetHard(){this.cloudpilot.ResetHard()}installDb(e){const t=this.copyIn(e),i=this.cloudpilot.InstallDb(t,e.length);return this.cloudpilot.Free(t),i}getPalette2bitMapping(){return this.cloudpilot.GetPalette2bitMapping()}getMemory(){const e=this.module.getPointer(this.cloudpilot.GetMemoryPtr());return this.module.HEAPU8.subarray(e,e+this.cloudpilot.GetMemorySize())}getMemory32(){let e=this.module.getPointer(this.cloudpilot.GetMemoryPtr());if(3&e)throw new Error("unaligned pointer");return e>>>=2,this.module.HEAPU32.subarray(e,e+(this.cloudpilot.GetMemorySize()>>>2))}getDirtyPages(){const e=this.module.getPointer(this.cloudpilot.GetDirtyPagesPtr()),t=this.cloudpilot.GetMemorySize(),i=(t>>>13)+(t%8192==0?0:1);return this.module.HEAPU8.subarray(e,e+i)}loadMemory(e){const t=this.getMemory32();if((()=>{if(e.length!==t.length||e.length<256)return!1;for(let i=256;i>0;i--){if(e[e.length-i]!==t[t.length-i])return!1;if(4294967295===t[t.length-i])break}return!0})())return t.set(e),!0;{const t=this.copyIn32(e),i=this.cloudpilot.ImportMemoryImage(t,e.length<<2);return this.cloudpilot.Free(t),i}}getRomImage(){const e=this.module.getPointer(this.cloudpilot.GetRomPtr());return this.module.HEAPU8.subarray(e,e+this.cloudpilot.GetRomSize())}getSavestate(){const e=this.module.getPointer(this.cloudpilot.GetSavestatePtr());return this.module.HEAPU8.subarray(e,e+this.cloudpilot.GetSavestateSize())}saveState(){return!!this.cloudpilot.SaveState()}loadState(e){const t=this.copyIn(e),i=this.cloudpilot.LoadState(t,e.length);return this.cloudpilot.Free(t),i}getHotsyncName(){return this.cloudpilot.GetHotsyncName()}setClockFactor(e){this.cloudpilot.SetClockFactor(e)}setHotsyncName(e){this.cloudpilot.SetHotsyncName(e)}backup(e){return t(this,void 0,void 0,(function*(){const t=this.guard((()=>this.cloudpilot.StartBackup()));try{return yield e(this.wrap(t))}finally{this.module.destroy(t)}}))}getArchive(e){const t=e.GetArchiveSize();return this.copyOut(e.GetArchivePtr(),t)}setClipboardIntegration(e){this.cloudpilot.SetClipboardIntegration(e)}getClipboardIntegration(){return this.cloudpilot.GetClipboardIntegration()}isSuspended(){return this.cloudpilot.IsSuspended()}getSuspendKind(){return this.cloudpilot.GetSuspendContext().GetKind()}cancelSuspend(){this.cloudpilot.GetSuspendContext().Cancel()}getSuspendContextClipboardCopy(){return this.wrap(this.cloudpilot.GetSuspendContext().AsContextClipboardCopy())}getSuspendContextClipboardPaste(){return this.wrap(this.cloudpilot.GetSuspendContext().AsContextClipboardPaste())}setNetworkRedirection(e){this.cloudpilot.SetNetworkRedirection(e)}getNetworkRedirection(){return this.cloudpilot.GetNetworkRedirection()}getSuspendContextNetworkConnect(){return this.wrap(this.cloudpilot.GetSuspendContext().AsContextNetworkConnect())}getSuspendContextNetworkRpc(){return this.wrap(this.cloudpilot.GetSuspendContext().AsContextNetworkRpc())}getSuspendContextSerialSync(){return this.wrap(this.cloudpilot.GetSuspendContext().AsContextSerialSync())}copyBuffer(e){return this.copyIn(e)}freeBuffer(e){this.cloudpilot.Free(e)}setHotsyncNameManagement(e){this.cloudpilot.SetHotsyncNameManagement(e)}resolveBuffer(e,t){const i=this.module.getPointer(e);return this.module.HEAPU8.subarray(i,i+t)}withZipfileWalker(e,i){return t(this,void 0,void 0,(function*(){const t=this.guard((()=>{const t=this.copyIn(e),i=new this.module.ZipfileWalker(e.length,t);return this.cloudpilot.Free(t),i}));try{return yield i(function(e,t){return Object.setPrototypeOf({GetCurrentEntryContent:()=>{const i=t.getPointer(e.GetCurrentEntryContent()),r=e.GetCurrentEntrySize();return i>0&&r>0?t.HEAPU8.subarray(i,i+r):void 0}},e)}(this.wrap(t),this.module))}finally{this.module.destroy(t)}}))}withZipfileWalkerSync(e,t){const i=this.guard((()=>{const t=this.copyIn(e),i=new this.module.ZipfileWalker(e.length,t);return this.cloudpilot.Free(t),i}));try{return t(this.wrap(Object.setPrototypeOf({GetCurrentEntryContent:()=>this.copyOut(i.GetCurrentEntryContent(),i.GetCurrentEntrySize())},i)))}finally{this.module.destroy(i)}}serializeSessionImage(e){var t,i;const r=new this.module.SessionImage,n=this.cloudpilot.Nullptr(),o=this.copyIn(e.rom),s=e.memory?this.copyIn(e.memory):n,a=void 0!==e.savestate?this.copyIn(e.savestate):n;let p=n,c=0;if(void 0!==e.metadata){const t=(new TextEncoder).encode(JSON.stringify(e.metadata));c=t.length,p=this.copyIn(t)}r.SetRomImage(o,e.rom.length),r.SetMemoryImage(s,(null===(t=e.memory)||void 0===t?void 0:t.length)||0),r.SetDeviceId(e.deviceId),r.SetSavestate(a,(null===(i=e.savestate)||void 0===i?void 0:i.length)||0),r.SetMetadata(p,c);const u=r.Serialize()?this.copyOut(r.GetSerializedImage(),r.GetSerializedImageSize()):void 0;return this.module.destroy(r),[o,s,a,p].forEach((e=>this.cloudpilot.Free(e))),u}deserializeSessionImage(e){if(!e)return;const t=new this.module.SessionImage,i=this.copyIn(e),r=(()=>{if(!t.Deserialize(i,e.length))return;const r=this.copyOut(t.GetRomImage(),t.GetRomImageSize()),n=this.copyOut(t.GetMemoryImage(),t.GetMemoryImageSize()),o=this.copyOut(t.GetSavestate(),t.GetSavestateSize()),s=t.GetDeviceId();if(!re.includes(s))return void console.warn(`unsupported device ${s}`);let a;const p=this.copyOut(t.GetMetadata(),t.GetMetadataSize());if(p)try{a=JSON.parse((new TextDecoder).decode(p))}catch(e){console.warn("invalid metadata",e)}return{deviceId:s,rom:r,memory:n,savestate:o,metadata:a,version:t.GetVersion()}})();return this.module.destroy(t),this.cloudpilot.Free(i),r}launchAppByName(e){return this.cloudpilot.LaunchAppByName(e)}launchAppByDbHeader(e){if(e.length<32)return!1;const t=this.copyIn(e.subarray(0,32)),i=this.cloudpilot.LaunchAppByDbHeader(t,32);return this.cloudpilot.Free(t),i}deviceSupportsCardSize(e){return this.cloudpilot.DeviceSupportsCardSize(e)}clearExternalStorage(){this.cloudpilot.ClearExternalStorage()}allocateCard(e,t){return this.cloudpilot.AllocateCard(e,t>>>9)}decompressCard(e,t){const i=this.copyIn(t);let r;try{for(r=new this.module.GunzipContext(i,t.length,524288);0===r.GetState();)r.Continue();return-1===r.GetState()?(console.error(`gunzip failed: ${r.GetError()}`),!1):r.GetUncompressedSize()%512!=0?(console.error("failed to allocate card: invalid size of decompressed image"),!1):this.cloudpilot.AdoptCard(e,r.ReleaseUncompressedData(),r.GetUncompressedSize()>>>9)}finally{this.cloudpilot.Free(i),r&&this.module.destroy(r)}}getCardData(e){const t=this.module.getPointer(this.cloudpilot.GetCardData(e));if(0!==t)return this.module.HEAPU32.subarray(t>>>2,t+this.cloudpilot.GetCardSize(e)>>2)}getCardDirtyPages(e){const t=this.module.getPointer(this.cloudpilot.GetCardDirtyPages(e));if(0===t)return;const i=function(e){const t=(e>>>13)+(e%8192>0?1:0);return(t>>>3)+(t%8>0?1:0)}(this.cloudpilot.GetCardSize(e));return this.module.HEAPU8.subarray(t,t+i)}getMountedKey(){return this.cloudpilot.GetMountedKey()}mountCard(e){return this.cloudpilot.MountCard(e)}removeCard(e){return this.cloudpilot.RemoveCard(e)}remountCards(){this.cloudpilot.RemountCards()}getCardSupportLevel(e){return this.cloudpilot.GetSupportLevel(e)}loadSkin(e){const t=new this.module.SkinLoader(e);try{const e=this.module.getPointer(t.GetData());if(0===e)return;return(new TextDecoder).decode(this.module.HEAPU8.subarray(e,e+t.GetSize()))}finally{this.module.destroy(t)}}getTransportIR(){return this.transportIR}getTransportSerial(){return this.transportSerial}guard(e){if(this.amIdead)throw new Error("cloudpilot instance is dead");try{return e()}catch(e){throw this.amIdead=!0,this.cloudpilot=void 0,this.fatalErrorEvent.dispatch(e instanceof Error?e:new Error("unknown error")),e}}copyIn(e){const t=this.cloudpilot.Malloc(e.length),i=this.module.getPointer(t);return this.module.HEAPU8.subarray(i,i+e.length).set(e),t}copyIn32(e){const t=this.cloudpilot.Malloc(e.length<<2),i=this.module.getPointer(t);return this.module.HEAPU32.subarray(i>>>2,(i>>>2)+e.length).set(e),t}copyOut(e,t){const i=this.module.getPointer(e);return i>0&&t>0?this.module.HEAPU8.subarray(i,i+t).slice():void 0}wrap(e){return new Proxy(e,{get:(e,t)=>{const i=e[t];return"function"!=typeof i?i:(...t)=>this.guard((()=>i.apply(e,t)))}})}wrapTransport(e){const t=new w.j;return e.SetRequestTransferCallback(this.module.addFunction((()=>t.dispatch()),"v")),this.wrap(Object.setPrototypeOf({Receive:()=>{const t=e.RxBytesPending();return this.copyOut(e.Receive(),t)},Send:(t,i)=>{var r;const n=t&&this.copyIn(t);e.Send(null!==(r=null==t?void 0:t.length)&&void 0!==r?r:0,null!=n?n:this.cloudpilot.Nullptr(),i),n&&this.cloudpilot.Free(n)},frameCompleteEvent:t},e))}}var se;e([ne()],oe.prototype,"getRomInfo",null),e([ne()],oe.prototype,"initializeSession",null),e([ne()],oe.prototype,"cyclesPerSecond",null),e([ne()],oe.prototype,"runEmulation",null),e([ne()],oe.prototype,"getFrame",null),e([ne()],oe.prototype,"isScreenDirty",null),e([ne()],oe.prototype,"markScreenClean",null),e([ne()],oe.prototype,"minRamForDevice",null),e([ne()],oe.prototype,"framebufferSizeForDevice",null),e([ne()],oe.prototype,"totalMemorySizeForDevice",null),e([ne()],oe.prototype,"queuePenMove",null),e([ne()],oe.prototype,"queuePenUp",null),e([ne()],oe.prototype,"queueButtonDown",null),e([ne()],oe.prototype,"queueButtonUp",null),e([ne()],oe.prototype,"queueKeyboardEvent",null),e([ne()],oe.prototype,"isPowerOff",null),e([ne()],oe.prototype,"isUiInitialized",null),e([ne()],oe.prototype,"isSetupComplete",null),e([ne()],oe.prototype,"getOSVersion",null),e([ne()],oe.prototype,"reset",null),e([ne()],oe.prototype,"resetNoExtensions",null),e([ne()],oe.prototype,"resetHard",null),e([ne()],oe.prototype,"installDb",null),e([ne()],oe.prototype,"getPalette2bitMapping",null),e([ne()],oe.prototype,"getMemory",null),e([ne()],oe.prototype,"getMemory32",null),e([ne()],oe.prototype,"getDirtyPages",null),e([ne()],oe.prototype,"loadMemory",null),e([ne()],oe.prototype,"getRomImage",null),e([ne()],oe.prototype,"getSavestate",null),e([ne()],oe.prototype,"saveState",null),e([ne()],oe.prototype,"loadState",null),e([ne()],oe.prototype,"getHotsyncName",null),e([ne()],oe.prototype,"setClockFactor",null),e([ne()],oe.prototype,"setHotsyncName",null),e([ne()],oe.prototype,"setClipboardIntegration",null),e([ne()],oe.prototype,"getClipboardIntegration",null),e([ne()],oe.prototype,"isSuspended",null),e([ne()],oe.prototype,"getSuspendKind",null),e([ne()],oe.prototype,"cancelSuspend",null),e([ne()],oe.prototype,"getSuspendContextClipboardCopy",null),e([ne()],oe.prototype,"getSuspendContextClipboardPaste",null),e([ne()],oe.prototype,"setNetworkRedirection",null),e([ne()],oe.prototype,"getNetworkRedirection",null),e([ne()],oe.prototype,"getSuspendContextNetworkConnect",null),e([ne()],oe.prototype,"getSuspendContextNetworkRpc",null),e([ne()],oe.prototype,"getSuspendContextSerialSync",null),e([ne()],oe.prototype,"copyBuffer",null),e([ne()],oe.prototype,"freeBuffer",null),e([ne()],oe.prototype,"setHotsyncNameManagement",null),e([ne()],oe.prototype,"resolveBuffer",null),e([ne()],oe.prototype,"serializeSessionImage",null),e([ne()],oe.prototype,"deserializeSessionImage",null),e([ne()],oe.prototype,"launchAppByName",null),e([ne()],oe.prototype,"launchAppByDbHeader",null),e([ne()],oe.prototype,"deviceSupportsCardSize",null),e([ne()],oe.prototype,"clearExternalStorage",null),e([ne()],oe.prototype,"allocateCard",null),e([ne()],oe.prototype,"decompressCard",null),e([ne()],oe.prototype,"getCardData",null),e([ne()],oe.prototype,"getCardDirtyPages",null),e([ne()],oe.prototype,"getMountedKey",null),e([ne()],oe.prototype,"mountCard",null),e([ne()],oe.prototype,"removeCard",null),e([ne()],oe.prototype,"remountCards",null),e([ne()],oe.prototype,"getCardSupportLevel",null),e([ne()],oe.prototype,"loadSkin",null),function(e){e[e.cal=0]="cal",e[e.phone=1]="phone",e[e.todo=2]="todo",e[e.notes=3]="notes",e[e.up=4]="up",e[e.down=5]="down",e[e.power=6]="power",e[e.cradle=7]="cradle"}(se||(se={}));const ae="1.9.10-5a5df6e (preview)";function pe(e){return t(this,void 0,void 0,(function*(){return new J(yield oe.create(e))}))}function ce(e){const i=function(e){const i=WebAssembly.compileStreaming?WebAssembly.compileStreaming(fetch(e)):fetch(e).then((e=>e.arrayBuffer())).then((e=>WebAssembly.compile(e)));return(e,r)=>t(this,void 0,void 0,(function*(){return r(yield WebAssembly.instantiate(yield i,e))}))}(null!=e?e:"cloudpilot_web.wasm");return()=>oe.create(i).then((e=>new J(e)))}})(),r})()));
//# sourceMappingURL=cloudpilot-emu.js.map