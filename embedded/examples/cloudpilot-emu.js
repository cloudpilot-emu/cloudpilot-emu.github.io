!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.cloudpilot=t():e.cloudpilot=t()}(self,(()=>(()=>{var e={492:e=>{var t,r=(t="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(e={}){var r,n,i=e;i.ready=new Promise(((e,t)=>{r=e,n=t}));var o,s,a,c=Object.assign({},i),p="./this.program",u=(e,t)=>{throw t},l="object"==typeof window,d="function"==typeof importScripts,h=("object"==typeof process&&"object"==typeof process.versions&&process.versions.node,"");(l||d)&&(d?h=self.location.href:"undefined"!=typeof document&&document.currentScript&&(h=document.currentScript.src),t&&(h=t),h=0!==h.indexOf("blob:")?h.substr(0,h.replace(/[?#].*/,"").lastIndexOf("/")+1):"",o=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},d&&(a=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),s=(e,t,r)=>{var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{200==n.status||0==n.status&&n.response?t(n.response):r()},n.onerror=r,n.send(null)});var m,_=i.print||console.log.bind(console),f=i.printErr||console.error.bind(console);Object.assign(i,c),c=null,i.arguments&&i.arguments,i.thisProgram&&(p=i.thisProgram),i.quit&&(u=i.quit),i.wasmBinary&&(m=i.wasmBinary);var y,v=i.noExitRuntime||!0;"object"!=typeof WebAssembly&&H("no native wasm support detected");var g,b,w,S,C,E,I=!1;function D(e,t){e||H(t)}function k(){var e=y.buffer;i.HEAP8=b=new Int8Array(e),i.HEAP16=new Int16Array(e),i.HEAPU8=w=new Uint8Array(e),i.HEAPU16=new Uint16Array(e),i.HEAP32=S=new Int32Array(e),i.HEAPU32=C=new Uint32Array(e),i.HEAPF32=new Float32Array(e),i.HEAPF64=E=new Float64Array(e)}var G=[],M=[],P=[],x=[],R=0,z=null,F=null;function A(e){R++,i.monitorRunDependencies&&i.monitorRunDependencies(R)}function N(e){if(R--,i.monitorRunDependencies&&i.monitorRunDependencies(R),0==R&&(null!==z&&(clearInterval(z),z=null),F)){var t=F;F=null,t()}}function H(e){i.onAbort&&i.onAbort(e),f(e="Aborted("+e+")"),I=!0,g=1,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw n(t),t}var T,L,B,U;function j(e){return e.startsWith("data:application/octet-stream;base64,")}function O(e){if(e==T&&m)return new Uint8Array(m);if(a)return a(e);throw"both async and sync fetching of the wasm failed"}function W(e,t,r){return function(e){return m||!l&&!d||"function"!=typeof fetch?Promise.resolve().then((()=>O(e))):fetch(e,{credentials:"same-origin"}).then((t=>{if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()})).catch((()=>O(e)))}(e).then((e=>WebAssembly.instantiate(e,t))).then((e=>e)).then(r,(e=>{f(`failed to asynchronously prepare wasm: ${e}`),H(e)}))}j(T="cloudpilot_web.wasm")||(L=T,T=i.locateFile?i.locateFile(L,h):h+L);var V={1472568:e=>{ie.grow(65536);for(let t=0;t<=65535;t++)ie.set(ie.length-65535-1+t,ie.get(C[(e>>>2)+t]));return ie.length-65535-1}};function q(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}var K=e=>{for(;e.length>0;)e.shift()(i)},Y="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0,Q=(e,t,r)=>{for(var n=t+r,i=t;e[i]&&!(i>=n);)++i;if(i-t>16&&e.buffer&&Y)return Y.decode(e.subarray(t,i));for(var o="";t<i;){var s=e[t++];if(128&s){var a=63&e[t++];if(192!=(224&s)){var c=63&e[t++];if((s=224==(240&s)?(15&s)<<12|a<<6|c:(7&s)<<18|a<<12|c<<6|63&e[t++])<65536)o+=String.fromCharCode(s);else{var p=s-65536;o+=String.fromCharCode(55296|p>>10,56320|1023&p)}}else o+=String.fromCharCode((31&s)<<6|a)}else o+=String.fromCharCode(s)}return o},$=(e,t)=>e?Q(w,e,t):"",Z={isAbs:e=>"/"===e.charAt(0),splitPath:e=>/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1),normalizeArray:(e,t)=>{for(var r=0,n=e.length-1;n>=0;n--){var i=e[n];"."===i?e.splice(n,1):".."===i?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r;r--)e.unshift("..");return e},normalize:e=>{var t=Z.isAbs(e),r="/"===e.substr(-1);return(e=Z.normalizeArray(e.split("/").filter((e=>!!e)),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e},dirname:e=>{var t=Z.splitPath(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},basename:e=>{if("/"===e)return"/";var t=(e=(e=Z.normalize(e)).replace(/\/$/,"")).lastIndexOf("/");return-1===t?e:e.substr(t+1)},join:function(){var e=Array.prototype.slice.call(arguments);return Z.normalize(e.join("/"))},join2:(e,t)=>Z.normalize(e+"/"+t)},X=e=>(X=(()=>{if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues)return e=>crypto.getRandomValues(e);H("initRandomDevice")})())(e),J={resolve:function(){for(var e="",t=!1,r=arguments.length-1;r>=-1&&!t;r--){var n=r>=0?arguments[r]:le.cwd();if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");if(!n)return"";e=n+"/"+e,t=Z.isAbs(n)}return(t?"/":"")+(e=Z.normalizeArray(e.split("/").filter((e=>!!e)),!t).join("/"))||"."},relative:(e,t)=>{function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=J.resolve(e).substr(1),t=J.resolve(t).substr(1);for(var n=r(e.split("/")),i=r(t.split("/")),o=Math.min(n.length,i.length),s=o,a=0;a<o;a++)if(n[a]!==i[a]){s=a;break}var c=[];for(a=s;a<n.length;a++)c.push("..");return(c=c.concat(i.slice(s))).join("/")}},ee=[],te=e=>{for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n<=127?t++:n<=2047?t+=2:n>=55296&&n<=57343?(t+=4,++r):t+=3}return t},re=(e,t,r,n)=>{if(!(n>0))return 0;for(var i=r,o=r+n-1,s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a>=55296&&a<=57343&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++s)),a<=127){if(r>=o)break;t[r++]=a}else if(a<=2047){if(r+1>=o)break;t[r++]=192|a>>6,t[r++]=128|63&a}else if(a<=65535){if(r+2>=o)break;t[r++]=224|a>>12,t[r++]=128|a>>6&63,t[r++]=128|63&a}else{if(r+3>=o)break;t[r++]=240|a>>18,t[r++]=128|a>>12&63,t[r++]=128|a>>6&63,t[r++]=128|63&a}}return t[r]=0,r-i};function ne(e,t,r){var n=r>0?r:te(e)+1,i=new Array(n),o=re(e,i,0,i.length);return t&&(i.length=o),i}var ie,oe,se={ttys:[],init(){},shutdown(){},register(e,t){se.ttys[e]={input:[],output:[],ops:t},le.registerDevice(e,se.stream_ops)},stream_ops:{open(e){var t=se.ttys[e.node.rdev];if(!t)throw new le.ErrnoError(43);e.tty=t,e.seekable=!1},close(e){e.tty.ops.fsync(e.tty)},fsync(e){e.tty.ops.fsync(e.tty)},read(e,t,r,n,i){if(!e.tty||!e.tty.ops.get_char)throw new le.ErrnoError(60);for(var o=0,s=0;s<n;s++){var a;try{a=e.tty.ops.get_char(e.tty)}catch(e){throw new le.ErrnoError(29)}if(void 0===a&&0===o)throw new le.ErrnoError(6);if(null==a)break;o++,t[r+s]=a}return o&&(e.node.timestamp=Date.now()),o},write(e,t,r,n,i){if(!e.tty||!e.tty.ops.put_char)throw new le.ErrnoError(60);try{for(var o=0;o<n;o++)e.tty.ops.put_char(e.tty,t[r+o])}catch(e){throw new le.ErrnoError(29)}return n&&(e.node.timestamp=Date.now()),o}},default_tty_ops:{get_char:e=>(()=>{if(!ee.length){var e=null;if("undefined"!=typeof window&&"function"==typeof window.prompt?null!==(e=window.prompt("Input: "))&&(e+="\n"):"function"==typeof readline&&null!==(e=readline())&&(e+="\n"),!e)return null;ee=ne(e,!0)}return ee.shift()})(),put_char(e,t){null===t||10===t?(_(Q(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},fsync(e){e.output&&e.output.length>0&&(_(Q(e.output,0)),e.output=[])},ioctl_tcgets:e=>({c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}),ioctl_tcsets:(e,t,r)=>0,ioctl_tiocgwinsz:e=>[24,80]},default_tty1_ops:{put_char(e,t){null===t||10===t?(f(Q(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},fsync(e){e.output&&e.output.length>0&&(f(Q(e.output,0)),e.output=[])}}},ae=e=>{H()},ce={ops_table:null,mount:e=>ce.createNode(null,"/",16895,0),createNode(e,t,r,n){if(le.isBlkdev(r)||le.isFIFO(r))throw new le.ErrnoError(63);ce.ops_table||(ce.ops_table={dir:{node:{getattr:ce.node_ops.getattr,setattr:ce.node_ops.setattr,lookup:ce.node_ops.lookup,mknod:ce.node_ops.mknod,rename:ce.node_ops.rename,unlink:ce.node_ops.unlink,rmdir:ce.node_ops.rmdir,readdir:ce.node_ops.readdir,symlink:ce.node_ops.symlink},stream:{llseek:ce.stream_ops.llseek}},file:{node:{getattr:ce.node_ops.getattr,setattr:ce.node_ops.setattr},stream:{llseek:ce.stream_ops.llseek,read:ce.stream_ops.read,write:ce.stream_ops.write,allocate:ce.stream_ops.allocate,mmap:ce.stream_ops.mmap,msync:ce.stream_ops.msync}},link:{node:{getattr:ce.node_ops.getattr,setattr:ce.node_ops.setattr,readlink:ce.node_ops.readlink},stream:{}},chrdev:{node:{getattr:ce.node_ops.getattr,setattr:ce.node_ops.setattr},stream:le.chrdev_stream_ops}});var i=le.createNode(e,t,r,n);return le.isDir(i.mode)?(i.node_ops=ce.ops_table.dir.node,i.stream_ops=ce.ops_table.dir.stream,i.contents={}):le.isFile(i.mode)?(i.node_ops=ce.ops_table.file.node,i.stream_ops=ce.ops_table.file.stream,i.usedBytes=0,i.contents=null):le.isLink(i.mode)?(i.node_ops=ce.ops_table.link.node,i.stream_ops=ce.ops_table.link.stream):le.isChrdev(i.mode)&&(i.node_ops=ce.ops_table.chrdev.node,i.stream_ops=ce.ops_table.chrdev.stream),i.timestamp=Date.now(),e&&(e.contents[t]=i,e.timestamp=i.timestamp),i},getFileDataAsTypedArray:e=>e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0),expandFileStorage(e,t){var r=e.contents?e.contents.length:0;if(!(r>=t)){t=Math.max(t,r*(r<1048576?2:1.125)>>>0),0!=r&&(t=Math.max(t,256));var n=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(n.subarray(0,e.usedBytes),0)}},resizeFileStorage(e,t){if(e.usedBytes!=t)if(0==t)e.contents=null,e.usedBytes=0;else{var r=e.contents;e.contents=new Uint8Array(t),r&&e.contents.set(r.subarray(0,Math.min(t,e.usedBytes))),e.usedBytes=t}},node_ops:{getattr(e){var t={};return t.dev=le.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,le.isDir(e.mode)?t.size=4096:le.isFile(e.mode)?t.size=e.usedBytes:le.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp),void 0!==t.size&&ce.resizeFileStorage(e,t.size)},lookup(e,t){throw le.genericErrors[44]},mknod:(e,t,r,n)=>ce.createNode(e,t,r,n),rename(e,t,r){if(le.isDir(e.mode)){var n;try{n=le.lookupNode(t,r)}catch(e){}if(n)for(var i in n.contents)throw new le.ErrnoError(55)}delete e.parent.contents[e.name],e.parent.timestamp=Date.now(),e.name=r,t.contents[r]=e,t.timestamp=e.parent.timestamp,e.parent=t},unlink(e,t){delete e.contents[t],e.timestamp=Date.now()},rmdir(e,t){var r=le.lookupNode(e,t);for(var n in r.contents)throw new le.ErrnoError(55);delete e.contents[t],e.timestamp=Date.now()},readdir(e){var t=[".",".."];for(var r in e.contents)e.contents.hasOwnProperty(r)&&t.push(r);return t},symlink(e,t,r){var n=ce.createNode(e,t,41471,0);return n.link=r,n},readlink(e){if(!le.isLink(e.mode))throw new le.ErrnoError(28);return e.link}},stream_ops:{read(e,t,r,n,i){var o=e.node.contents;if(i>=e.node.usedBytes)return 0;var s=Math.min(e.node.usedBytes-i,n);if(s>8&&o.subarray)t.set(o.subarray(i,i+s),r);else for(var a=0;a<s;a++)t[r+a]=o[i+a];return s},write(e,t,r,n,i,o){if(t.buffer===b.buffer&&(o=!1),!n)return 0;var s=e.node;if(s.timestamp=Date.now(),t.subarray&&(!s.contents||s.contents.subarray)){if(o)return s.contents=t.subarray(r,r+n),s.usedBytes=n,n;if(0===s.usedBytes&&0===i)return s.contents=t.slice(r,r+n),s.usedBytes=n,n;if(i+n<=s.usedBytes)return s.contents.set(t.subarray(r,r+n),i),n}if(ce.expandFileStorage(s,i+n),s.contents.subarray&&t.subarray)s.contents.set(t.subarray(r,r+n),i);else for(var a=0;a<n;a++)s.contents[i+a]=t[r+a];return s.usedBytes=Math.max(s.usedBytes,i+n),n},llseek(e,t,r){var n=t;if(1===r?n+=e.position:2===r&&le.isFile(e.node.mode)&&(n+=e.node.usedBytes),n<0)throw new le.ErrnoError(28);return n},allocate(e,t,r){ce.expandFileStorage(e.node,t+r),e.node.usedBytes=Math.max(e.node.usedBytes,t+r)},mmap(e,t,r,n,i){if(!le.isFile(e.node.mode))throw new le.ErrnoError(43);var o,s,a=e.node.contents;if(2&i||a.buffer!==b.buffer){if((r>0||r+t<a.length)&&(a=a.subarray?a.subarray(r,r+t):Array.prototype.slice.call(a,r,r+t)),s=!0,!(o=ae()))throw new le.ErrnoError(48);b.set(a,o)}else s=!1,o=a.byteOffset;return{ptr:o,allocated:s}},msync:(e,t,r,n,i)=>(ce.stream_ops.write(e,t,0,n,r,!1),0)}},pe=i.preloadPlugins||[],ue=(e,t)=>{var r=0;return e&&(r|=365),t&&(r|=146),r},le={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath(e,t={}){if(!(e=J.resolve(e)))return{path:"",node:null};if((t=Object.assign({follow_mount:!0,recurse_count:0},t)).recurse_count>8)throw new le.ErrnoError(32);for(var r=e.split("/").filter((e=>!!e)),n=le.root,i="/",o=0;o<r.length;o++){var s=o===r.length-1;if(s&&t.parent)break;if(n=le.lookupNode(n,r[o]),i=Z.join2(i,r[o]),le.isMountpoint(n)&&(!s||s&&t.follow_mount)&&(n=n.mounted.root),!s||t.follow)for(var a=0;le.isLink(n.mode);){var c=le.readlink(i);if(i=J.resolve(Z.dirname(i),c),n=le.lookupPath(i,{recurse_count:t.recurse_count+1}).node,a++>40)throw new le.ErrnoError(32)}}return{path:i,node:n}},getPath(e){for(var t;;){if(le.isRoot(e)){var r=e.mount.mountpoint;return t?"/"!==r[r.length-1]?`${r}/${t}`:r+t:r}t=t?`${e.name}/${t}`:e.name,e=e.parent}},hashName(e,t){for(var r=0,n=0;n<t.length;n++)r=(r<<5)-r+t.charCodeAt(n)|0;return(e+r>>>0)%le.nameTable.length},hashAddNode(e){var t=le.hashName(e.parent.id,e.name);e.name_next=le.nameTable[t],le.nameTable[t]=e},hashRemoveNode(e){var t=le.hashName(e.parent.id,e.name);if(le.nameTable[t]===e)le.nameTable[t]=e.name_next;else for(var r=le.nameTable[t];r;){if(r.name_next===e){r.name_next=e.name_next;break}r=r.name_next}},lookupNode(e,t){var r=le.mayLookup(e);if(r)throw new le.ErrnoError(r,e);for(var n=le.hashName(e.id,t),i=le.nameTable[n];i;i=i.name_next){var o=i.name;if(i.parent.id===e.id&&o===t)return i}return le.lookup(e,t)},createNode(e,t,r,n){var i=new le.FSNode(e,t,r,n);return le.hashAddNode(i),i},destroyNode(e){le.hashRemoveNode(e)},isRoot:e=>e===e.parent,isMountpoint:e=>!!e.mounted,isFile:e=>32768==(61440&e),isDir:e=>16384==(61440&e),isLink:e=>40960==(61440&e),isChrdev:e=>8192==(61440&e),isBlkdev:e=>24576==(61440&e),isFIFO:e=>4096==(61440&e),isSocket:e=>49152==(49152&e),flagsToPermissionString(e){var t=["r","w","rw"][3&e];return 512&e&&(t+="w"),t},nodePermissions:(e,t)=>le.ignorePermissions||(!t.includes("r")||292&e.mode)&&(!t.includes("w")||146&e.mode)&&(!t.includes("x")||73&e.mode)?0:2,mayLookup:e=>le.nodePermissions(e,"x")||(e.node_ops.lookup?0:2),mayCreate(e,t){try{return le.lookupNode(e,t),20}catch(e){}return le.nodePermissions(e,"wx")},mayDelete(e,t,r){var n;try{n=le.lookupNode(e,t)}catch(e){return e.errno}var i=le.nodePermissions(e,"wx");if(i)return i;if(r){if(!le.isDir(n.mode))return 54;if(le.isRoot(n)||le.getPath(n)===le.cwd())return 10}else if(le.isDir(n.mode))return 31;return 0},mayOpen:(e,t)=>e?le.isLink(e.mode)?32:le.isDir(e.mode)&&("r"!==le.flagsToPermissionString(t)||512&t)?31:le.nodePermissions(e,le.flagsToPermissionString(t)):44,MAX_OPEN_FDS:4096,nextfd(){for(var e=0;e<=le.MAX_OPEN_FDS;e++)if(!le.streams[e])return e;throw new le.ErrnoError(33)},getStreamChecked(e){var t=le.getStream(e);if(!t)throw new le.ErrnoError(8);return t},getStream:e=>le.streams[e],createStream:(e,t=-1)=>(le.FSStream||(le.FSStream=function(){this.shared={}},le.FSStream.prototype={},Object.defineProperties(le.FSStream.prototype,{object:{get(){return this.node},set(e){this.node=e}},isRead:{get(){return 1!=(2097155&this.flags)}},isWrite:{get(){return 0!=(2097155&this.flags)}},isAppend:{get(){return 1024&this.flags}},flags:{get(){return this.shared.flags},set(e){this.shared.flags=e}},position:{get(){return this.shared.position},set(e){this.shared.position=e}}})),e=Object.assign(new le.FSStream,e),-1==t&&(t=le.nextfd()),e.fd=t,le.streams[t]=e,e),closeStream(e){le.streams[e]=null},chrdev_stream_ops:{open(e){var t=le.getDevice(e.node.rdev);e.stream_ops=t.stream_ops,e.stream_ops.open&&e.stream_ops.open(e)},llseek(){throw new le.ErrnoError(70)}},major:e=>e>>8,minor:e=>255&e,makedev:(e,t)=>e<<8|t,registerDevice(e,t){le.devices[e]={stream_ops:t}},getDevice:e=>le.devices[e],getMounts(e){for(var t=[],r=[e];r.length;){var n=r.pop();t.push(n),r.push.apply(r,n.mounts)}return t},syncfs(e,t){"function"==typeof e&&(t=e,e=!1),le.syncFSRequests++,le.syncFSRequests>1&&f(`warning: ${le.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var r=le.getMounts(le.root.mount),n=0;function i(e){return le.syncFSRequests--,t(e)}function o(e){if(e)return o.errored?void 0:(o.errored=!0,i(e));++n>=r.length&&i(null)}r.forEach((t=>{if(!t.type.syncfs)return o(null);t.type.syncfs(t,e,o)}))},mount(e,t,r){var n,i="/"===r,o=!r;if(i&&le.root)throw new le.ErrnoError(10);if(!i&&!o){var s=le.lookupPath(r,{follow_mount:!1});if(r=s.path,n=s.node,le.isMountpoint(n))throw new le.ErrnoError(10);if(!le.isDir(n.mode))throw new le.ErrnoError(54)}var a={type:e,opts:t,mountpoint:r,mounts:[]},c=e.mount(a);return c.mount=a,a.root=c,i?le.root=c:n&&(n.mounted=a,n.mount&&n.mount.mounts.push(a)),c},unmount(e){var t=le.lookupPath(e,{follow_mount:!1});if(!le.isMountpoint(t.node))throw new le.ErrnoError(28);var r=t.node,n=r.mounted,i=le.getMounts(n);Object.keys(le.nameTable).forEach((e=>{for(var t=le.nameTable[e];t;){var r=t.name_next;i.includes(t.mount)&&le.destroyNode(t),t=r}})),r.mounted=null;var o=r.mount.mounts.indexOf(n);r.mount.mounts.splice(o,1)},lookup:(e,t)=>e.node_ops.lookup(e,t),mknod(e,t,r){var n=le.lookupPath(e,{parent:!0}).node,i=Z.basename(e);if(!i||"."===i||".."===i)throw new le.ErrnoError(28);var o=le.mayCreate(n,i);if(o)throw new le.ErrnoError(o);if(!n.node_ops.mknod)throw new le.ErrnoError(63);return n.node_ops.mknod(n,i,t,r)},create:(e,t)=>(t=void 0!==t?t:438,t&=4095,t|=32768,le.mknod(e,t,0)),mkdir:(e,t)=>(t=void 0!==t?t:511,t&=1023,t|=16384,le.mknod(e,t,0)),mkdirTree(e,t){for(var r=e.split("/"),n="",i=0;i<r.length;++i)if(r[i]){n+="/"+r[i];try{le.mkdir(n,t)}catch(e){if(20!=e.errno)throw e}}},mkdev:(e,t,r)=>(void 0===r&&(r=t,t=438),t|=8192,le.mknod(e,t,r)),symlink(e,t){if(!J.resolve(e))throw new le.ErrnoError(44);var r=le.lookupPath(t,{parent:!0}).node;if(!r)throw new le.ErrnoError(44);var n=Z.basename(t),i=le.mayCreate(r,n);if(i)throw new le.ErrnoError(i);if(!r.node_ops.symlink)throw new le.ErrnoError(63);return r.node_ops.symlink(r,n,e)},rename(e,t){var r,n,i=Z.dirname(e),o=Z.dirname(t),s=Z.basename(e),a=Z.basename(t);if(r=le.lookupPath(e,{parent:!0}).node,n=le.lookupPath(t,{parent:!0}).node,!r||!n)throw new le.ErrnoError(44);if(r.mount!==n.mount)throw new le.ErrnoError(75);var c,p=le.lookupNode(r,s),u=J.relative(e,o);if("."!==u.charAt(0))throw new le.ErrnoError(28);if("."!==(u=J.relative(t,i)).charAt(0))throw new le.ErrnoError(55);try{c=le.lookupNode(n,a)}catch(e){}if(p!==c){var l=le.isDir(p.mode),d=le.mayDelete(r,s,l);if(d)throw new le.ErrnoError(d);if(d=c?le.mayDelete(n,a,l):le.mayCreate(n,a))throw new le.ErrnoError(d);if(!r.node_ops.rename)throw new le.ErrnoError(63);if(le.isMountpoint(p)||c&&le.isMountpoint(c))throw new le.ErrnoError(10);if(n!==r&&(d=le.nodePermissions(r,"w")))throw new le.ErrnoError(d);le.hashRemoveNode(p);try{r.node_ops.rename(p,n,a)}catch(e){throw e}finally{le.hashAddNode(p)}}},rmdir(e){var t=le.lookupPath(e,{parent:!0}).node,r=Z.basename(e),n=le.lookupNode(t,r),i=le.mayDelete(t,r,!0);if(i)throw new le.ErrnoError(i);if(!t.node_ops.rmdir)throw new le.ErrnoError(63);if(le.isMountpoint(n))throw new le.ErrnoError(10);t.node_ops.rmdir(t,r),le.destroyNode(n)},readdir(e){var t=le.lookupPath(e,{follow:!0}).node;if(!t.node_ops.readdir)throw new le.ErrnoError(54);return t.node_ops.readdir(t)},unlink(e){var t=le.lookupPath(e,{parent:!0}).node;if(!t)throw new le.ErrnoError(44);var r=Z.basename(e),n=le.lookupNode(t,r),i=le.mayDelete(t,r,!1);if(i)throw new le.ErrnoError(i);if(!t.node_ops.unlink)throw new le.ErrnoError(63);if(le.isMountpoint(n))throw new le.ErrnoError(10);t.node_ops.unlink(t,r),le.destroyNode(n)},readlink(e){var t=le.lookupPath(e).node;if(!t)throw new le.ErrnoError(44);if(!t.node_ops.readlink)throw new le.ErrnoError(28);return J.resolve(le.getPath(t.parent),t.node_ops.readlink(t))},stat(e,t){var r=le.lookupPath(e,{follow:!t}).node;if(!r)throw new le.ErrnoError(44);if(!r.node_ops.getattr)throw new le.ErrnoError(63);return r.node_ops.getattr(r)},lstat:e=>le.stat(e,!0),chmod(e,t,r){var n;if(!(n="string"==typeof e?le.lookupPath(e,{follow:!r}).node:e).node_ops.setattr)throw new le.ErrnoError(63);n.node_ops.setattr(n,{mode:4095&t|-4096&n.mode,timestamp:Date.now()})},lchmod(e,t){le.chmod(e,t,!0)},fchmod(e,t){var r=le.getStreamChecked(e);le.chmod(r.node,t)},chown(e,t,r,n){var i;if(!(i="string"==typeof e?le.lookupPath(e,{follow:!n}).node:e).node_ops.setattr)throw new le.ErrnoError(63);i.node_ops.setattr(i,{timestamp:Date.now()})},lchown(e,t,r){le.chown(e,t,r,!0)},fchown(e,t,r){var n=le.getStreamChecked(e);le.chown(n.node,t,r)},truncate(e,t){if(t<0)throw new le.ErrnoError(28);var r;if(!(r="string"==typeof e?le.lookupPath(e,{follow:!0}).node:e).node_ops.setattr)throw new le.ErrnoError(63);if(le.isDir(r.mode))throw new le.ErrnoError(31);if(!le.isFile(r.mode))throw new le.ErrnoError(28);var n=le.nodePermissions(r,"w");if(n)throw new le.ErrnoError(n);r.node_ops.setattr(r,{size:t,timestamp:Date.now()})},ftruncate(e,t){var r=le.getStreamChecked(e);if(0==(2097155&r.flags))throw new le.ErrnoError(28);le.truncate(r.node,t)},utime(e,t,r){var n=le.lookupPath(e,{follow:!0}).node;n.node_ops.setattr(n,{timestamp:Math.max(t,r)})},open(e,t,r){if(""===e)throw new le.ErrnoError(44);var n;if(r=void 0===r?438:r,r=64&(t="string"==typeof t?(e=>{var t={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[e];if(void 0===t)throw new Error(`Unknown file open mode: ${e}`);return t})(t):t)?4095&r|32768:0,"object"==typeof e)n=e;else{e=Z.normalize(e);try{n=le.lookupPath(e,{follow:!(131072&t)}).node}catch(e){}}var o=!1;if(64&t)if(n){if(128&t)throw new le.ErrnoError(20)}else n=le.mknod(e,r,0),o=!0;if(!n)throw new le.ErrnoError(44);if(le.isChrdev(n.mode)&&(t&=-513),65536&t&&!le.isDir(n.mode))throw new le.ErrnoError(54);if(!o){var s=le.mayOpen(n,t);if(s)throw new le.ErrnoError(s)}512&t&&!o&&le.truncate(n,0),t&=-131713;var a=le.createStream({node:n,path:le.getPath(n),flags:t,seekable:!0,position:0,stream_ops:n.stream_ops,ungotten:[],error:!1});return a.stream_ops.open&&a.stream_ops.open(a),!i.logReadFiles||1&t||(le.readFiles||(le.readFiles={}),e in le.readFiles||(le.readFiles[e]=1)),a},close(e){if(le.isClosed(e))throw new le.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(e){throw e}finally{le.closeStream(e.fd)}e.fd=null},isClosed:e=>null===e.fd,llseek(e,t,r){if(le.isClosed(e))throw new le.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new le.ErrnoError(70);if(0!=r&&1!=r&&2!=r)throw new le.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,r),e.ungotten=[],e.position},read(e,t,r,n,i){if(n<0||i<0)throw new le.ErrnoError(28);if(le.isClosed(e))throw new le.ErrnoError(8);if(1==(2097155&e.flags))throw new le.ErrnoError(8);if(le.isDir(e.node.mode))throw new le.ErrnoError(31);if(!e.stream_ops.read)throw new le.ErrnoError(28);var o=void 0!==i;if(o){if(!e.seekable)throw new le.ErrnoError(70)}else i=e.position;var s=e.stream_ops.read(e,t,r,n,i);return o||(e.position+=s),s},write(e,t,r,n,i,o){if(n<0||i<0)throw new le.ErrnoError(28);if(le.isClosed(e))throw new le.ErrnoError(8);if(0==(2097155&e.flags))throw new le.ErrnoError(8);if(le.isDir(e.node.mode))throw new le.ErrnoError(31);if(!e.stream_ops.write)throw new le.ErrnoError(28);e.seekable&&1024&e.flags&&le.llseek(e,0,2);var s=void 0!==i;if(s){if(!e.seekable)throw new le.ErrnoError(70)}else i=e.position;var a=e.stream_ops.write(e,t,r,n,i,o);return s||(e.position+=a),a},allocate(e,t,r){if(le.isClosed(e))throw new le.ErrnoError(8);if(t<0||r<=0)throw new le.ErrnoError(28);if(0==(2097155&e.flags))throw new le.ErrnoError(8);if(!le.isFile(e.node.mode)&&!le.isDir(e.node.mode))throw new le.ErrnoError(43);if(!e.stream_ops.allocate)throw new le.ErrnoError(138);e.stream_ops.allocate(e,t,r)},mmap(e,t,r,n,i){if(0!=(2&n)&&0==(2&i)&&2!=(2097155&e.flags))throw new le.ErrnoError(2);if(1==(2097155&e.flags))throw new le.ErrnoError(2);if(!e.stream_ops.mmap)throw new le.ErrnoError(43);return e.stream_ops.mmap(e,t,r,n,i)},msync:(e,t,r,n,i)=>e.stream_ops.msync?e.stream_ops.msync(e,t,r,n,i):0,munmap:e=>0,ioctl(e,t,r){if(!e.stream_ops.ioctl)throw new le.ErrnoError(59);return e.stream_ops.ioctl(e,t,r)},readFile(e,t={}){if(t.flags=t.flags||0,t.encoding=t.encoding||"binary","utf8"!==t.encoding&&"binary"!==t.encoding)throw new Error(`Invalid encoding type "${t.encoding}"`);var r,n=le.open(e,t.flags),i=le.stat(e).size,o=new Uint8Array(i);return le.read(n,o,0,i,0),"utf8"===t.encoding?r=Q(o,0):"binary"===t.encoding&&(r=o),le.close(n),r},writeFile(e,t,r={}){r.flags=r.flags||577;var n=le.open(e,r.flags,r.mode);if("string"==typeof t){var i=new Uint8Array(te(t)+1),o=re(t,i,0,i.length);le.write(n,i,0,o,void 0,r.canOwn)}else{if(!ArrayBuffer.isView(t))throw new Error("Unsupported data type");le.write(n,t,0,t.byteLength,void 0,r.canOwn)}le.close(n)},cwd:()=>le.currentPath,chdir(e){var t=le.lookupPath(e,{follow:!0});if(null===t.node)throw new le.ErrnoError(44);if(!le.isDir(t.node.mode))throw new le.ErrnoError(54);var r=le.nodePermissions(t.node,"x");if(r)throw new le.ErrnoError(r);le.currentPath=t.path},createDefaultDirectories(){le.mkdir("/tmp"),le.mkdir("/home"),le.mkdir("/home/web_user")},createDefaultDevices(){le.mkdir("/dev"),le.registerDevice(le.makedev(1,3),{read:()=>0,write:(e,t,r,n,i)=>n}),le.mkdev("/dev/null",le.makedev(1,3)),se.register(le.makedev(5,0),se.default_tty_ops),se.register(le.makedev(6,0),se.default_tty1_ops),le.mkdev("/dev/tty",le.makedev(5,0)),le.mkdev("/dev/tty1",le.makedev(6,0));var e=new Uint8Array(1024),t=0,r=()=>(0===t&&(t=X(e).byteLength),e[--t]);le.createDevice("/dev","random",r),le.createDevice("/dev","urandom",r),le.mkdir("/dev/shm"),le.mkdir("/dev/shm/tmp")},createSpecialDirectories(){le.mkdir("/proc");var e=le.mkdir("/proc/self");le.mkdir("/proc/self/fd"),le.mount({mount(){var t=le.createNode(e,"fd",16895,73);return t.node_ops={lookup(e,t){var r=+t,n=le.getStreamChecked(r),i={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>n.path}};return i.parent=i,i}},t}},{},"/proc/self/fd")},createStandardStreams(){i.stdin?le.createDevice("/dev","stdin",i.stdin):le.symlink("/dev/tty","/dev/stdin"),i.stdout?le.createDevice("/dev","stdout",null,i.stdout):le.symlink("/dev/tty","/dev/stdout"),i.stderr?le.createDevice("/dev","stderr",null,i.stderr):le.symlink("/dev/tty1","/dev/stderr"),le.open("/dev/stdin",0),le.open("/dev/stdout",1),le.open("/dev/stderr",1)},ensureErrnoError(){le.ErrnoError||(le.ErrnoError=function(e,t){this.name="ErrnoError",this.node=t,this.setErrno=function(e){this.errno=e},this.setErrno(e),this.message="FS error"},le.ErrnoError.prototype=new Error,le.ErrnoError.prototype.constructor=le.ErrnoError,[44].forEach((e=>{le.genericErrors[e]=new le.ErrnoError(e),le.genericErrors[e].stack="<generic error, no stack>"})))},staticInit(){le.ensureErrnoError(),le.nameTable=new Array(4096),le.mount(ce,{},"/"),le.createDefaultDirectories(),le.createDefaultDevices(),le.createSpecialDirectories(),le.filesystems={MEMFS:ce}},init(e,t,r){le.init.initialized=!0,le.ensureErrnoError(),i.stdin=e||i.stdin,i.stdout=t||i.stdout,i.stderr=r||i.stderr,le.createStandardStreams()},quit(){le.init.initialized=!1;for(var e=0;e<le.streams.length;e++){var t=le.streams[e];t&&le.close(t)}},findObject(e,t){var r=le.analyzePath(e,t);return r.exists?r.object:null},analyzePath(e,t){try{e=(n=le.lookupPath(e,{follow:!t})).path}catch(e){}var r={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var n=le.lookupPath(e,{parent:!0});r.parentExists=!0,r.parentPath=n.path,r.parentObject=n.node,r.name=Z.basename(e),n=le.lookupPath(e,{follow:!t}),r.exists=!0,r.path=n.path,r.object=n.node,r.name=n.node.name,r.isRoot="/"===n.path}catch(e){r.error=e.errno}return r},createPath(e,t,r,n){e="string"==typeof e?e:le.getPath(e);for(var i=t.split("/").reverse();i.length;){var o=i.pop();if(o){var s=Z.join2(e,o);try{le.mkdir(s)}catch(e){}e=s}}return s},createFile(e,t,r,n,i){var o=Z.join2("string"==typeof e?e:le.getPath(e),t),s=ue(n,i);return le.create(o,s)},createDataFile(e,t,r,n,i,o){var s=t;e&&(e="string"==typeof e?e:le.getPath(e),s=t?Z.join2(e,t):e);var a=ue(n,i),c=le.create(s,a);if(r){if("string"==typeof r){for(var p=new Array(r.length),u=0,l=r.length;u<l;++u)p[u]=r.charCodeAt(u);r=p}le.chmod(c,146|a);var d=le.open(c,577);le.write(d,r,0,r.length,0,o),le.close(d),le.chmod(c,a)}return c},createDevice(e,t,r,n){var i=Z.join2("string"==typeof e?e:le.getPath(e),t),o=ue(!!r,!!n);le.createDevice.major||(le.createDevice.major=64);var s=le.makedev(le.createDevice.major++,0);return le.registerDevice(s,{open(e){e.seekable=!1},close(e){n&&n.buffer&&n.buffer.length&&n(10)},read(e,t,n,i,o){for(var s=0,a=0;a<i;a++){var c;try{c=r()}catch(e){throw new le.ErrnoError(29)}if(void 0===c&&0===s)throw new le.ErrnoError(6);if(null==c)break;s++,t[n+a]=c}return s&&(e.node.timestamp=Date.now()),s},write(e,t,r,i,o){for(var s=0;s<i;s++)try{n(t[r+s])}catch(e){throw new le.ErrnoError(29)}return i&&(e.node.timestamp=Date.now()),s}}),le.mkdev(i,o,s)},forceLoadFile(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;if("undefined"!=typeof XMLHttpRequest)throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(!o)throw new Error("Cannot load without read() or XMLHttpRequest.");try{e.contents=ne(o(e.url),!0),e.usedBytes=e.contents.length}catch(e){throw new le.ErrnoError(29)}},createLazyFile(e,t,r,n,i){function o(){this.lengthKnown=!1,this.chunks=[]}if(o.prototype.get=function(e){if(!(e>this.length-1||e<0)){var t=e%this.chunkSize,r=e/this.chunkSize|0;return this.getter(r)[t]}},o.prototype.setDataGetter=function(e){this.getter=e},o.prototype.cacheLength=function(){var e=new XMLHttpRequest;if(e.open("HEAD",r,!1),e.send(null),!(e.status>=200&&e.status<300||304===e.status))throw new Error("Couldn't load "+r+". Status: "+e.status);var t,n=Number(e.getResponseHeader("Content-length")),i=(t=e.getResponseHeader("Accept-Ranges"))&&"bytes"===t,o=(t=e.getResponseHeader("Content-Encoding"))&&"gzip"===t,s=1048576;i||(s=n);var a=this;a.setDataGetter((e=>{var t=e*s,i=(e+1)*s-1;if(i=Math.min(i,n-1),void 0===a.chunks[e]&&(a.chunks[e]=((e,t)=>{if(e>t)throw new Error("invalid range ("+e+", "+t+") or no bytes requested!");if(t>n-1)throw new Error("only "+n+" bytes available! programmer error!");var i=new XMLHttpRequest;if(i.open("GET",r,!1),n!==s&&i.setRequestHeader("Range","bytes="+e+"-"+t),i.responseType="arraybuffer",i.overrideMimeType&&i.overrideMimeType("text/plain; charset=x-user-defined"),i.send(null),!(i.status>=200&&i.status<300||304===i.status))throw new Error("Couldn't load "+r+". Status: "+i.status);return void 0!==i.response?new Uint8Array(i.response||[]):ne(i.responseText||"",!0)})(t,i)),void 0===a.chunks[e])throw new Error("doXHR failed!");return a.chunks[e]})),!o&&n||(s=n=1,n=this.getter(0).length,s=n,_("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=n,this._chunkSize=s,this.lengthKnown=!0},"undefined"!=typeof XMLHttpRequest){if(!d)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var s=new o;Object.defineProperties(s,{length:{get:function(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});var a={isDevice:!1,contents:s}}else a={isDevice:!1,url:r};var c=le.createFile(e,t,a,n,i);a.contents?c.contents=a.contents:a.url&&(c.contents=null,c.url=a.url),Object.defineProperties(c,{usedBytes:{get:function(){return this.contents.length}}});var p={};function u(e,t,r,n,i){var o=e.node.contents;if(i>=o.length)return 0;var s=Math.min(o.length-i,n);if(o.slice)for(var a=0;a<s;a++)t[r+a]=o[i+a];else for(a=0;a<s;a++)t[r+a]=o.get(i+a);return s}return Object.keys(c.stream_ops).forEach((e=>{var t=c.stream_ops[e];p[e]=function(){return le.forceLoadFile(c),t.apply(null,arguments)}})),p.read=(e,t,r,n,i)=>(le.forceLoadFile(c),u(e,t,r,n,i)),p.mmap=(e,t,r,n,i)=>{le.forceLoadFile(c);var o=ae();if(!o)throw new le.ErrnoError(48);return u(e,b,o,t,r),{ptr:o,allocated:!0}},c.stream_ops=p,c}},de={DEFAULT_POLLMASK:5,calculateAt(e,t,r){if(Z.isAbs(t))return t;var n;if(n=-100===e?le.cwd():de.getStreamFromFD(e).path,0==t.length){if(!r)throw new le.ErrnoError(44);return n}return Z.join2(n,t)},doStat(e,t,r){try{var n=e(t)}catch(e){if(e&&e.node&&Z.normalize(t)!==Z.normalize(le.getPath(e.node)))return-54;throw e}S[r>>2]=n.dev,S[r+4>>2]=n.mode,C[r+8>>2]=n.nlink,S[r+12>>2]=n.uid,S[r+16>>2]=n.gid,S[r+20>>2]=n.rdev,U=[n.size>>>0,(B=n.size,+Math.abs(B)>=1?B>0?+Math.floor(B/4294967296)>>>0:~~+Math.ceil((B-+(~~B>>>0))/4294967296)>>>0:0)],S[r+24>>2]=U[0],S[r+28>>2]=U[1],S[r+32>>2]=4096,S[r+36>>2]=n.blocks;var i=n.atime.getTime(),o=n.mtime.getTime(),s=n.ctime.getTime();return U=[Math.floor(i/1e3)>>>0,(B=Math.floor(i/1e3),+Math.abs(B)>=1?B>0?+Math.floor(B/4294967296)>>>0:~~+Math.ceil((B-+(~~B>>>0))/4294967296)>>>0:0)],S[r+40>>2]=U[0],S[r+44>>2]=U[1],C[r+48>>2]=i%1e3*1e3,U=[Math.floor(o/1e3)>>>0,(B=Math.floor(o/1e3),+Math.abs(B)>=1?B>0?+Math.floor(B/4294967296)>>>0:~~+Math.ceil((B-+(~~B>>>0))/4294967296)>>>0:0)],S[r+56>>2]=U[0],S[r+60>>2]=U[1],C[r+64>>2]=o%1e3*1e3,U=[Math.floor(s/1e3)>>>0,(B=Math.floor(s/1e3),+Math.abs(B)>=1?B>0?+Math.floor(B/4294967296)>>>0:~~+Math.ceil((B-+(~~B>>>0))/4294967296)>>>0:0)],S[r+72>>2]=U[0],S[r+76>>2]=U[1],C[r+80>>2]=s%1e3*1e3,U=[n.ino>>>0,(B=n.ino,+Math.abs(B)>=1?B>0?+Math.floor(B/4294967296)>>>0:~~+Math.ceil((B-+(~~B>>>0))/4294967296)>>>0:0)],S[r+88>>2]=U[0],S[r+92>>2]=U[1],0},doMsync(e,t,r,n,i){if(!le.isFile(t.node.mode))throw new le.ErrnoError(43);if(2&n)return 0;var o=w.slice(e,e+r);le.msync(t,o,i,r,n)},varargs:void 0,get(){var e=S[+de.varargs>>2];return de.varargs+=4,e},getp:()=>de.get(),getStr:e=>$(e),getStreamFromFD:e=>le.getStreamChecked(e)},he=(e,t)=>t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,me=e=>e%4==0&&(e%100!=0||e%400==0),_e=[0,31,60,91,121,152,182,213,244,274,305,335],fe=[0,31,59,90,120,151,181,212,243,273,304,334],ye=e=>(me(e.getFullYear())?_e:fe)[e.getMonth()]+e.getDate()-1,ve=e=>{var t=te(e)+1,r=Fe(t);return r&&((e,t,r)=>{re(e,w,t,r)})(e,r,t),r},ge=[],be=e=>{var t=(e-y.buffer.byteLength+65535)/65536;try{return y.grow(t),k(),1}catch(e){}},we={},Se=()=>{if(!Se.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:p||"./this.program"};for(var t in we)void 0===we[t]?delete e[t]:e[t]=we[t];var r=[];for(var t in e)r.push(`${t}=${e[t]}`);Se.strings=r}return Se.strings},Ce=[31,29,31,30,31,30,31,31,30,31,30,31],Ee=[31,28,31,30,31,30,31,31,30,31,30,31],Ie=(e,t)=>{var r;g=e,g=r=e,v||(i.onExit&&i.onExit(r),I=!0),u(r,new q(r))},De=(e,t)=>{e<128?t.push(e):t.push(e%128|128,e>>7)},ke=[],Ge=[],Me=(e,t)=>{ie.set(e,t),ke[e]=ie.get(e)},Pe=function(e,t,r,n){e||(e=this),this.parent=e,this.mount=e.mount,this.mounted=null,this.id=le.nextInode++,this.name=t,this.mode=r,this.node_ops={},this.stream_ops={},this.rdev=n};Object.defineProperties(Pe.prototype,{read:{get:function(){return 365==(365&this.mode)},set:function(e){e?this.mode|=365:this.mode&=-366}},write:{get:function(){return 146==(146&this.mode)},set:function(e){e?this.mode|=146:this.mode&=-147}},isFolder:{get:function(){return le.isDir(this.mode)}},isDevice:{get:function(){return le.isChrdev(this.mode)}}}),le.FSNode=Pe,le.createPreloadedFile=(e,t,r,n,i,o,a,c,p,u)=>{var l=t?J.resolve(Z.join2(e,t)):e;function d(r){function s(r){u&&u(),c||((e,t,r,n,i,o)=>{le.createDataFile(e,t,r,n,i,o)})(e,t,r,n,i,p),o&&o(),N()}((e,t,r,n)=>{"undefined"!=typeof Browser&&Browser.init();var i=!1;return pe.forEach((o=>{i||o.canHandle(t)&&(o.handle(e,t,r,n),i=!0)})),i})(r,l,s,(()=>{a&&a(),N()}))||s(r)}A(),"string"==typeof r?((e,t,r,n)=>{var i=`al ${e}`;s(e,(t=>{D(t,`Loading data file "${e}" failed (no arrayBuffer).`),d(new Uint8Array(t)),i&&N()}),(t=>{if(!r)throw`Loading data file "${e}" failed.`;r()})),i&&A()})(r,0,a):d(r)},le.staticInit();var xe,Re={b:(e,t,r,n)=>{H(`Assertion failed: ${$(e)}, at: `+[t?$(t):"unknown filename",r,n?$(n):"unknown function"])},i:function(e){const t=new Error($(e));throw t.isAssert=!0,t},m:function(e,t,r){var n=he(t,r);try{return isNaN(n)?61:(le.ftruncate(e,n),0)}catch(e){if(void 0===le||"ErrnoError"!==e.name)throw e;return-e.errno}},h:()=>!0,j:function(e,t,r){var n=he(e,t),i=new Date(1e3*n);S[r>>2]=i.getSeconds(),S[r+4>>2]=i.getMinutes(),S[r+8>>2]=i.getHours(),S[r+12>>2]=i.getDate(),S[r+16>>2]=i.getMonth(),S[r+20>>2]=i.getFullYear()-1900,S[r+24>>2]=i.getDay();var o=0|ye(i);S[r+28>>2]=o,S[r+36>>2]=-60*i.getTimezoneOffset();var s=new Date(i.getFullYear(),0,1),a=new Date(i.getFullYear(),6,1).getTimezoneOffset(),c=s.getTimezoneOffset(),p=0|(a!=c&&i.getTimezoneOffset()==Math.min(c,a));S[r+32>>2]=p},k:function(e){var t=(()=>{var t=new Date(S[e+20>>2]+1900,S[e+16>>2],S[e+12>>2],S[e+8>>2],S[e+4>>2],S[e>>2],0),r=S[e+32>>2],n=t.getTimezoneOffset(),i=new Date(t.getFullYear(),0,1),o=new Date(t.getFullYear(),6,1).getTimezoneOffset(),s=i.getTimezoneOffset(),a=Math.min(s,o);if(r<0)S[e+32>>2]=Number(o!=s&&a==n);else if(r>0!=(a==n)){var c=Math.max(s,o),p=r>0?a:c;t.setTime(t.getTime()+6e4*(p-n))}S[e+24>>2]=t.getDay();var u=0|ye(t);return S[e+28>>2]=u,S[e>>2]=t.getSeconds(),S[e+4>>2]=t.getMinutes(),S[e+8>>2]=t.getHours(),S[e+12>>2]=t.getDate(),S[e+16>>2]=t.getMonth(),S[e+20>>2]=t.getYear(),t.getTime()/1e3})();return zn((B=t,+Math.abs(B)>=1?B>0?+Math.floor(B/4294967296)>>>0:~~+Math.ceil((B-+(~~B>>>0))/4294967296)>>>0:0)),t>>>0},r:(e,t,r)=>{var n=(new Date).getFullYear(),i=new Date(n,0,1),o=new Date(n,6,1),s=i.getTimezoneOffset(),a=o.getTimezoneOffset(),c=Math.max(s,a);function p(e){var t=e.toTimeString().match(/\(([A-Za-z ]+)\)$/);return t?t[1]:"GMT"}C[e>>2]=60*c,S[t>>2]=Number(s!=a);var u=p(i),l=p(o),d=ve(u),h=ve(l);a<s?(C[r>>2]=d,C[r+4>>2]=h):(C[r>>2]=h,C[r+4>>2]=d)},a:()=>{H("")},s:(e,t,r)=>((e,t,r)=>{var n=((e,t)=>{var r;for(ge.length=0;r=w[e++];){var n=105!=r;t+=(n&=112!=r)&&t%8?4:0,ge.push(112==r?C[t>>2]:105==r?S[t>>2]:E[t>>3]),t+=n?8:4}return ge})(t,r);return V[e].apply(null,n)})(e,t,r),c:()=>Date.now(),d:(e,t,r)=>w.copyWithin(e,t,t+r),q:e=>{var t=w.length,r=2147483648;if((e>>>=0)>r)return!1;for(var n,i=1;i<=4;i*=2){var o=t*(1+.2/i);o=Math.min(o,e+100663296);var s=Math.min(r,(n=Math.max(e,o))+(65536-n%65536)%65536);if(be(s))return!0}return!1},o:(e,t)=>{var r=0;return Se().forEach(((n,i)=>{var o=t+r;C[e+4*i>>2]=o,((e,t)=>{for(var r=0;r<e.length;++r)b[t++>>0]=e.charCodeAt(r);b[t>>0]=0})(n,o),r+=n.length+1})),0},p:(e,t)=>{var r=Se();C[e>>2]=r.length;var n=0;return r.forEach((e=>n+=e.length+1)),C[t>>2]=n,0},e:function(e){try{var t=de.getStreamFromFD(e);return le.close(t),0}catch(e){if(void 0===le||"ErrnoError"!==e.name)throw e;return e.errno}},g:function(e,t,r,n){try{var i=((e,t,r,n)=>{for(var i=0,o=0;o<r;o++){var s=C[t>>2],a=C[t+4>>2];t+=8;var c=le.read(e,b,s,a,n);if(c<0)return-1;if(i+=c,c<a)break;void 0!==n&&(n+=c)}return i})(de.getStreamFromFD(e),t,r);return C[n>>2]=i,0}catch(e){if(void 0===le||"ErrnoError"!==e.name)throw e;return e.errno}},l:function(e,t,r,n,i){var o=he(t,r);try{if(isNaN(o))return 61;var s=de.getStreamFromFD(e);return le.llseek(s,o,n),U=[s.position>>>0,(B=s.position,+Math.abs(B)>=1?B>0?+Math.floor(B/4294967296)>>>0:~~+Math.ceil((B-+(~~B>>>0))/4294967296)>>>0:0)],S[i>>2]=U[0],S[i+4>>2]=U[1],s.getdents&&0===o&&0===n&&(s.getdents=null),0}catch(e){if(void 0===le||"ErrnoError"!==e.name)throw e;return e.errno}},f:function(e,t,r,n){try{var i=((e,t,r,n)=>{for(var i=0,o=0;o<r;o++){var s=C[t>>2],a=C[t+4>>2];t+=8;var c=le.write(e,b,s,a,n);if(c<0)return-1;i+=c,void 0!==n&&(n+=c)}return i})(de.getStreamFromFD(e),t,r);return C[n>>2]=i,0}catch(e){if(void 0===le||"ErrnoError"!==e.name)throw e;return e.errno}},n:(e,t,r,n,i)=>((e,t,r,n)=>{var i=C[n+40>>2],o={tm_sec:S[n>>2],tm_min:S[n+4>>2],tm_hour:S[n+8>>2],tm_mday:S[n+12>>2],tm_mon:S[n+16>>2],tm_year:S[n+20>>2],tm_wday:S[n+24>>2],tm_yday:S[n+28>>2],tm_isdst:S[n+32>>2],tm_gmtoff:S[n+36>>2],tm_zone:i?$(i):""},s=$(r),a={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var c in a)s=s.replace(new RegExp(c,"g"),a[c]);var p=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],u=["January","February","March","April","May","June","July","August","September","October","November","December"];function l(e,t,r){for(var n="number"==typeof e?e.toString():e||"";n.length<t;)n=r[0]+n;return n}function d(e,t){return l(e,t,"0")}function h(e,t){function r(e){return e<0?-1:e>0?1:0}var n;return 0===(n=r(e.getFullYear()-t.getFullYear()))&&0===(n=r(e.getMonth()-t.getMonth()))&&(n=r(e.getDate()-t.getDate())),n}function m(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function _(e){var t=((e,t)=>{for(var r=new Date(e.getTime());t>0;){var n=me(r.getFullYear()),i=r.getMonth(),o=(n?Ce:Ee)[i];if(!(t>o-r.getDate()))return r.setDate(r.getDate()+t),r;t-=o-r.getDate()+1,r.setDate(1),i<11?r.setMonth(i+1):(r.setMonth(0),r.setFullYear(r.getFullYear()+1))}return r})(new Date(e.tm_year+1900,0,1),e.tm_yday),r=new Date(t.getFullYear(),0,4),n=new Date(t.getFullYear()+1,0,4),i=m(r),o=m(n);return h(i,t)<=0?h(o,t)<=0?t.getFullYear()+1:t.getFullYear():t.getFullYear()-1}var f={"%a":e=>p[e.tm_wday].substring(0,3),"%A":e=>p[e.tm_wday],"%b":e=>u[e.tm_mon].substring(0,3),"%B":e=>u[e.tm_mon],"%C":e=>d((e.tm_year+1900)/100|0,2),"%d":e=>d(e.tm_mday,2),"%e":e=>l(e.tm_mday,2," "),"%g":e=>_(e).toString().substring(2),"%G":e=>_(e),"%H":e=>d(e.tm_hour,2),"%I":e=>{var t=e.tm_hour;return 0==t?t=12:t>12&&(t-=12),d(t,2)},"%j":e=>d(e.tm_mday+((e,t)=>{for(var r=0,n=0;n<=t;r+=e[n++]);return r})(me(e.tm_year+1900)?Ce:Ee,e.tm_mon-1),3),"%m":e=>d(e.tm_mon+1,2),"%M":e=>d(e.tm_min,2),"%n":()=>"\n","%p":e=>e.tm_hour>=0&&e.tm_hour<12?"AM":"PM","%S":e=>d(e.tm_sec,2),"%t":()=>"\t","%u":e=>e.tm_wday||7,"%U":e=>{var t=e.tm_yday+7-e.tm_wday;return d(Math.floor(t/7),2)},"%V":e=>{var t=Math.floor((e.tm_yday+7-(e.tm_wday+6)%7)/7);if((e.tm_wday+371-e.tm_yday-2)%7<=2&&t++,t){if(53==t){var r=(e.tm_wday+371-e.tm_yday)%7;4==r||3==r&&me(e.tm_year)||(t=1)}}else{t=52;var n=(e.tm_wday+7-e.tm_yday-1)%7;(4==n||5==n&&me(e.tm_year%400-1))&&t++}return d(t,2)},"%w":e=>e.tm_wday,"%W":e=>{var t=e.tm_yday+7-(e.tm_wday+6)%7;return d(Math.floor(t/7),2)},"%y":e=>(e.tm_year+1900).toString().substring(2),"%Y":e=>e.tm_year+1900,"%z":e=>{var t=e.tm_gmtoff,r=t>=0;return t=(t=Math.abs(t)/60)/60*100+t%60,(r?"+":"-")+String("0000"+t).slice(-4)},"%Z":e=>e.tm_zone,"%%":()=>"%"};for(var c in s=s.replace(/%%/g,"\0\0"),f)s.includes(c)&&(s=s.replace(new RegExp(c,"g"),f[c](o)));var y,v,g=ne(s=s.replace(/\0\0/g,"%"),!1);return g.length>t?0:(y=g,v=e,b.set(y,v),g.length-1)})(e,t,r,n)},ze=function(){var e,t,r,o,s={a:Re};function a(e,t){var r;return ze=e.exports,y=ze.t,k(),ie=ze.wc,r=ze.u,M.unshift(r),N(),ze}if(A(),i.instantiateWasm)try{return i.instantiateWasm(s,a)}catch(e){f(`Module.instantiateWasm callback failed with error: ${e}`),n(e)}return(e=m,t=T,r=s,o=function(e){a(e.instance)},e||"function"!=typeof WebAssembly.instantiateStreaming||j(t)||"function"!=typeof fetch?W(t,r,o):fetch(t,{credentials:"same-origin"}).then((e=>WebAssembly.instantiateStreaming(e,r).then(o,(function(e){return f(`wasm streaming compile failed: ${e}`),f("falling back to ArrayBuffer instantiation"),W(t,r,o)}))))).catch(n),{}}(),Fe=i._malloc=e=>(Fe=i._malloc=ze.v)(e),Ae=(i._free=e=>(i._free=ze.w)(e),i._main=(e,t)=>(Ae=i._main=ze.x)(e,t)),Ne=(i._webidl_free=e=>(i._webidl_free=ze.y)(e),i._webidl_malloc=e=>(i._webidl_malloc=ze.z)(e),i._emscripten_bind_VoidPtr___destroy___0=e=>(Ne=i._emscripten_bind_VoidPtr___destroy___0=ze.A)(e)),He=i._emscripten_bind_Cloudpilot_Cloudpilot_0=()=>(He=i._emscripten_bind_Cloudpilot_Cloudpilot_0=ze.B)(),Te=i._emscripten_bind_Cloudpilot_Malloc_1=(e,t)=>(Te=i._emscripten_bind_Cloudpilot_Malloc_1=ze.C)(e,t),Le=i._emscripten_bind_Cloudpilot_Free_1=(e,t)=>(Le=i._emscripten_bind_Cloudpilot_Free_1=ze.D)(e,t),Be=i._emscripten_bind_Cloudpilot_Nullptr_0=e=>(Be=i._emscripten_bind_Cloudpilot_Nullptr_0=ze.E)(e),Ue=i._emscripten_bind_Cloudpilot_InitializeSession_3=(e,t,r,n)=>(Ue=i._emscripten_bind_Cloudpilot_InitializeSession_3=ze.F)(e,t,r,n),je=i._emscripten_bind_Cloudpilot_GetCyclesPerSecond_0=e=>(je=i._emscripten_bind_Cloudpilot_GetCyclesPerSecond_0=ze.G)(e),Oe=i._emscripten_bind_Cloudpilot_RunEmulation_1=(e,t)=>(Oe=i._emscripten_bind_Cloudpilot_RunEmulation_1=ze.H)(e,t),We=i._emscripten_bind_Cloudpilot_SetClockFactor_1=(e,t)=>(We=i._emscripten_bind_Cloudpilot_SetClockFactor_1=ze.I)(e,t),Ve=i._emscripten_bind_Cloudpilot_CopyFrame_0=e=>(Ve=i._emscripten_bind_Cloudpilot_CopyFrame_0=ze.J)(e),qe=i._emscripten_bind_Cloudpilot_IsScreenDirty_0=e=>(qe=i._emscripten_bind_Cloudpilot_IsScreenDirty_0=ze.K)(e),Ke=i._emscripten_bind_Cloudpilot_MarkScreenClean_0=e=>(Ke=i._emscripten_bind_Cloudpilot_MarkScreenClean_0=ze.L)(e),Ye=i._emscripten_bind_Cloudpilot_MinMemoryForDevice_1=(e,t)=>(Ye=i._emscripten_bind_Cloudpilot_MinMemoryForDevice_1=ze.M)(e,t),Qe=i._emscripten_bind_Cloudpilot_FramebufferSizeForDevice_1=(e,t)=>(Qe=i._emscripten_bind_Cloudpilot_FramebufferSizeForDevice_1=ze.N)(e,t),$e=i._emscripten_bind_Cloudpilot_TotalMemoryForDevice_1=(e,t)=>($e=i._emscripten_bind_Cloudpilot_TotalMemoryForDevice_1=ze.O)(e,t),Ze=i._emscripten_bind_Cloudpilot_QueuePenMove_2=(e,t,r)=>(Ze=i._emscripten_bind_Cloudpilot_QueuePenMove_2=ze.P)(e,t,r),Xe=i._emscripten_bind_Cloudpilot_QueuePenUp_0=e=>(Xe=i._emscripten_bind_Cloudpilot_QueuePenUp_0=ze.Q)(e),Je=i._emscripten_bind_Cloudpilot_QueueButtonDown_1=(e,t)=>(Je=i._emscripten_bind_Cloudpilot_QueueButtonDown_1=ze.R)(e,t),et=i._emscripten_bind_Cloudpilot_QueueButtonUp_1=(e,t)=>(et=i._emscripten_bind_Cloudpilot_QueueButtonUp_1=ze.S)(e,t),tt=i._emscripten_bind_Cloudpilot_QueueKeyboardEvent_2=(e,t,r)=>(tt=i._emscripten_bind_Cloudpilot_QueueKeyboardEvent_2=ze.T)(e,t,r),rt=i._emscripten_bind_Cloudpilot_IsPowerOff_0=e=>(rt=i._emscripten_bind_Cloudpilot_IsPowerOff_0=ze.U)(e),nt=i._emscripten_bind_Cloudpilot_IsUIInitialized_0=e=>(nt=i._emscripten_bind_Cloudpilot_IsUIInitialized_0=ze.V)(e),it=i._emscripten_bind_Cloudpilot_GetOSVersion_0=e=>(it=i._emscripten_bind_Cloudpilot_GetOSVersion_0=ze.W)(e),ot=i._emscripten_bind_Cloudpilot_IsSetupComplete_0=e=>(ot=i._emscripten_bind_Cloudpilot_IsSetupComplete_0=ze.X)(e),st=i._emscripten_bind_Cloudpilot_Reset_0=e=>(st=i._emscripten_bind_Cloudpilot_Reset_0=ze.Y)(e),at=i._emscripten_bind_Cloudpilot_ResetNoExtensions_0=e=>(at=i._emscripten_bind_Cloudpilot_ResetNoExtensions_0=ze.Z)(e),ct=i._emscripten_bind_Cloudpilot_ResetHard_0=e=>(ct=i._emscripten_bind_Cloudpilot_ResetHard_0=ze._)(e),pt=i._emscripten_bind_Cloudpilot_InstallDb_2=(e,t,r)=>(pt=i._emscripten_bind_Cloudpilot_InstallDb_2=ze.$)(e,t,r),ut=i._emscripten_bind_Cloudpilot_GetPalette2bitMapping_0=e=>(ut=i._emscripten_bind_Cloudpilot_GetPalette2bitMapping_0=ze.aa)(e),lt=i._emscripten_bind_Cloudpilot_GetMemoryPtr_0=e=>(lt=i._emscripten_bind_Cloudpilot_GetMemoryPtr_0=ze.ba)(e),dt=i._emscripten_bind_Cloudpilot_GetDirtyPagesPtr_0=e=>(dt=i._emscripten_bind_Cloudpilot_GetDirtyPagesPtr_0=ze.ca)(e),ht=i._emscripten_bind_Cloudpilot_GetMemorySize_0=e=>(ht=i._emscripten_bind_Cloudpilot_GetMemorySize_0=ze.da)(e),mt=i._emscripten_bind_Cloudpilot_ImportMemoryImage_2=(e,t,r)=>(mt=i._emscripten_bind_Cloudpilot_ImportMemoryImage_2=ze.ea)(e,t,r),_t=i._emscripten_bind_Cloudpilot_GetRomPtr_0=e=>(_t=i._emscripten_bind_Cloudpilot_GetRomPtr_0=ze.fa)(e),ft=i._emscripten_bind_Cloudpilot_GetRomSize_0=e=>(ft=i._emscripten_bind_Cloudpilot_GetRomSize_0=ze.ga)(e),yt=i._emscripten_bind_Cloudpilot_GetSavestatePtr_0=e=>(yt=i._emscripten_bind_Cloudpilot_GetSavestatePtr_0=ze.ha)(e),vt=i._emscripten_bind_Cloudpilot_GetSavestateSize_0=e=>(vt=i._emscripten_bind_Cloudpilot_GetSavestateSize_0=ze.ia)(e),gt=i._emscripten_bind_Cloudpilot_SaveState_0=e=>(gt=i._emscripten_bind_Cloudpilot_SaveState_0=ze.ja)(e),bt=i._emscripten_bind_Cloudpilot_LoadState_2=(e,t,r)=>(bt=i._emscripten_bind_Cloudpilot_LoadState_2=ze.ka)(e,t,r),wt=i._emscripten_bind_Cloudpilot_GetHotsyncName_0=e=>(wt=i._emscripten_bind_Cloudpilot_GetHotsyncName_0=ze.la)(e),St=i._emscripten_bind_Cloudpilot_SetHotsyncName_1=(e,t)=>(St=i._emscripten_bind_Cloudpilot_SetHotsyncName_1=ze.ma)(e,t),Ct=i._emscripten_bind_Cloudpilot_RegisterPwmHandler_1=(e,t)=>(Ct=i._emscripten_bind_Cloudpilot_RegisterPwmHandler_1=ze.na)(e,t),Et=i._emscripten_bind_Cloudpilot_StartBackup_0=e=>(Et=i._emscripten_bind_Cloudpilot_StartBackup_0=ze.oa)(e),It=i._emscripten_bind_Cloudpilot_SetClipboardIntegration_1=(e,t)=>(It=i._emscripten_bind_Cloudpilot_SetClipboardIntegration_1=ze.pa)(e,t),Dt=i._emscripten_bind_Cloudpilot_GetClipboardIntegration_0=e=>(Dt=i._emscripten_bind_Cloudpilot_GetClipboardIntegration_0=ze.qa)(e),kt=i._emscripten_bind_Cloudpilot_IsSuspended_0=e=>(kt=i._emscripten_bind_Cloudpilot_IsSuspended_0=ze.ra)(e),Gt=i._emscripten_bind_Cloudpilot_GetSuspendContext_0=e=>(Gt=i._emscripten_bind_Cloudpilot_GetSuspendContext_0=ze.sa)(e),Mt=i._emscripten_bind_Cloudpilot_SetNetworkRedirection_1=(e,t)=>(Mt=i._emscripten_bind_Cloudpilot_SetNetworkRedirection_1=ze.ta)(e,t),Pt=i._emscripten_bind_Cloudpilot_GetNetworkRedirection_0=e=>(Pt=i._emscripten_bind_Cloudpilot_GetNetworkRedirection_0=ze.ua)(e),xt=i._emscripten_bind_Cloudpilot_RegisterProxyDisconnectHandler_1=(e,t)=>(xt=i._emscripten_bind_Cloudpilot_RegisterProxyDisconnectHandler_1=ze.va)(e,t),Rt=i._emscripten_bind_Cloudpilot_SetHotsyncNameManagement_1=(e,t)=>(Rt=i._emscripten_bind_Cloudpilot_SetHotsyncNameManagement_1=ze.wa)(e,t),zt=i._emscripten_bind_Cloudpilot_LaunchAppByName_1=(e,t)=>(zt=i._emscripten_bind_Cloudpilot_LaunchAppByName_1=ze.xa)(e,t),Ft=i._emscripten_bind_Cloudpilot_LaunchAppByDbHeader_2=(e,t,r)=>(Ft=i._emscripten_bind_Cloudpilot_LaunchAppByDbHeader_2=ze.ya)(e,t,r),At=i._emscripten_bind_Cloudpilot_DeviceSupportsCardSize_1=(e,t)=>(At=i._emscripten_bind_Cloudpilot_DeviceSupportsCardSize_1=ze.za)(e,t),Nt=i._emscripten_bind_Cloudpilot_ClearExternalStorage_0=e=>(Nt=i._emscripten_bind_Cloudpilot_ClearExternalStorage_0=ze.Aa)(e),Ht=i._emscripten_bind_Cloudpilot_AllocateCard_2=(e,t,r)=>(Ht=i._emscripten_bind_Cloudpilot_AllocateCard_2=ze.Ba)(e,t,r),Tt=i._emscripten_bind_Cloudpilot_AdoptCard_3=(e,t,r,n)=>(Tt=i._emscripten_bind_Cloudpilot_AdoptCard_3=ze.Ca)(e,t,r,n),Lt=i._emscripten_bind_Cloudpilot_MountCard_1=(e,t)=>(Lt=i._emscripten_bind_Cloudpilot_MountCard_1=ze.Da)(e,t),Bt=i._emscripten_bind_Cloudpilot_RemoveCard_1=(e,t)=>(Bt=i._emscripten_bind_Cloudpilot_RemoveCard_1=ze.Ea)(e,t),Ut=i._emscripten_bind_Cloudpilot_GetCardData_1=(e,t)=>(Ut=i._emscripten_bind_Cloudpilot_GetCardData_1=ze.Fa)(e,t),jt=i._emscripten_bind_Cloudpilot_GetCardDirtyPages_1=(e,t)=>(jt=i._emscripten_bind_Cloudpilot_GetCardDirtyPages_1=ze.Ga)(e,t),Ot=i._emscripten_bind_Cloudpilot_GetCardSize_1=(e,t)=>(Ot=i._emscripten_bind_Cloudpilot_GetCardSize_1=ze.Ha)(e,t),Wt=i._emscripten_bind_Cloudpilot_RemountCards_0=e=>(Wt=i._emscripten_bind_Cloudpilot_RemountCards_0=ze.Ia)(e),Vt=i._emscripten_bind_Cloudpilot_GetSupportLevel_1=(e,t)=>(Vt=i._emscripten_bind_Cloudpilot_GetSupportLevel_1=ze.Ja)(e,t),qt=i._emscripten_bind_Cloudpilot_GetMountedKey_0=e=>(qt=i._emscripten_bind_Cloudpilot_GetMountedKey_0=ze.Ka)(e),Kt=i._emscripten_bind_Cloudpilot___destroy___0=e=>(Kt=i._emscripten_bind_Cloudpilot___destroy___0=ze.La)(e),Yt=i._emscripten_bind_RomInfo_RomInfo_2=(e,t)=>(Yt=i._emscripten_bind_RomInfo_RomInfo_2=ze.Ma)(e,t),Qt=i._emscripten_bind_RomInfo_IsValid_0=e=>(Qt=i._emscripten_bind_RomInfo_IsValid_0=ze.Na)(e),$t=i._emscripten_bind_RomInfo_CardVersion_0=e=>($t=i._emscripten_bind_RomInfo_CardVersion_0=ze.Oa)(e),Zt=i._emscripten_bind_RomInfo_CardName_0=e=>(Zt=i._emscripten_bind_RomInfo_CardName_0=ze.Pa)(e),Xt=i._emscripten_bind_RomInfo_RomVersion_0=e=>(Xt=i._emscripten_bind_RomInfo_RomVersion_0=ze.Qa)(e),Jt=i._emscripten_bind_RomInfo_RomVersionString_0=e=>(Jt=i._emscripten_bind_RomInfo_RomVersionString_0=ze.Ra)(e),er=i._emscripten_bind_RomInfo_Supports_1=(e,t)=>(er=i._emscripten_bind_RomInfo_Supports_1=ze.Sa)(e,t),tr=i._emscripten_bind_RomInfo___destroy___0=e=>(tr=i._emscripten_bind_RomInfo___destroy___0=ze.Ta)(e),rr=i._emscripten_bind_Frame_GetLineWidth_0=e=>(rr=i._emscripten_bind_Frame_GetLineWidth_0=ze.Ua)(e),nr=i._emscripten_bind_Frame_GetBpp_0=e=>(nr=i._emscripten_bind_Frame_GetBpp_0=ze.Va)(e),ir=i._emscripten_bind_Frame_GetLines_0=e=>(ir=i._emscripten_bind_Frame_GetLines_0=ze.Wa)(e),or=i._emscripten_bind_Frame_GetMargin_0=e=>(or=i._emscripten_bind_Frame_GetMargin_0=ze.Xa)(e),sr=i._emscripten_bind_Frame_GetBytesPerLine_0=e=>(sr=i._emscripten_bind_Frame_GetBytesPerLine_0=ze.Ya)(e),ar=i._emscripten_bind_Frame_GetFirstDirtyLine_0=e=>(ar=i._emscripten_bind_Frame_GetFirstDirtyLine_0=ze.Za)(e),cr=i._emscripten_bind_Frame_GetLastDirtyLine_0=e=>(cr=i._emscripten_bind_Frame_GetLastDirtyLine_0=ze._a)(e),pr=i._emscripten_bind_Frame_GetHasChanges_0=e=>(pr=i._emscripten_bind_Frame_GetHasChanges_0=ze.$a)(e),ur=i._emscripten_bind_Frame_GetBuffer_0=e=>(ur=i._emscripten_bind_Frame_GetBuffer_0=ze.ab)(e),lr=i._emscripten_bind_Frame_GetBufferSize_0=e=>(lr=i._emscripten_bind_Frame_GetBufferSize_0=ze.bb)(e),dr=i._emscripten_bind_Frame_GetScaleX_0=e=>(dr=i._emscripten_bind_Frame_GetScaleX_0=ze.cb)(e),hr=i._emscripten_bind_Frame_GetScaleY_0=e=>(hr=i._emscripten_bind_Frame_GetScaleY_0=ze.db)(e),mr=i._emscripten_bind_Frame___destroy___0=e=>(mr=i._emscripten_bind_Frame___destroy___0=ze.eb)(e),_r=i._emscripten_bind_DbBackup_Init_1=(e,t)=>(_r=i._emscripten_bind_DbBackup_Init_1=ze.fb)(e,t),fr=i._emscripten_bind_DbBackup_IsInProgress_0=e=>(fr=i._emscripten_bind_DbBackup_IsInProgress_0=ze.gb)(e),yr=i._emscripten_bind_DbBackup_IsDone_0=e=>(yr=i._emscripten_bind_DbBackup_IsDone_0=ze.hb)(e),vr=i._emscripten_bind_DbBackup_GetCurrentDatabase_0=e=>(vr=i._emscripten_bind_DbBackup_GetCurrentDatabase_0=ze.ib)(e),gr=i._emscripten_bind_DbBackup_Save_0=e=>(gr=i._emscripten_bind_DbBackup_Save_0=ze.jb)(e),br=i._emscripten_bind_DbBackup_Skip_0=e=>(br=i._emscripten_bind_DbBackup_Skip_0=ze.kb)(e),wr=i._emscripten_bind_DbBackup_GetArchivePtr_0=e=>(wr=i._emscripten_bind_DbBackup_GetArchivePtr_0=ze.lb)(e),Sr=i._emscripten_bind_DbBackup_GetArchiveSize_0=e=>(Sr=i._emscripten_bind_DbBackup_GetArchiveSize_0=ze.mb)(e),Cr=i._emscripten_bind_DbBackup___destroy___0=e=>(Cr=i._emscripten_bind_DbBackup___destroy___0=ze.nb)(e),Er=i._emscripten_bind_SuspendContextClipboardCopy_Cancel_0=e=>(Er=i._emscripten_bind_SuspendContextClipboardCopy_Cancel_0=ze.ob)(e),Ir=i._emscripten_bind_SuspendContextClipboardCopy_Resume_0=e=>(Ir=i._emscripten_bind_SuspendContextClipboardCopy_Resume_0=ze.pb)(e),Dr=i._emscripten_bind_SuspendContextClipboardCopy_GetClipboardContent_0=e=>(Dr=i._emscripten_bind_SuspendContextClipboardCopy_GetClipboardContent_0=ze.qb)(e),kr=i._emscripten_bind_SuspendContextClipboardCopy___destroy___0=e=>(kr=i._emscripten_bind_SuspendContextClipboardCopy___destroy___0=ze.rb)(e),Gr=i._emscripten_bind_SuspendContextClipboardPaste_Cancel_0=e=>(Gr=i._emscripten_bind_SuspendContextClipboardPaste_Cancel_0=ze.sb)(e),Mr=i._emscripten_bind_SuspendContextClipboardPaste_Resume_1=(e,t)=>(Mr=i._emscripten_bind_SuspendContextClipboardPaste_Resume_1=ze.tb)(e,t),Pr=i._emscripten_bind_SuspendContextClipboardPaste___destroy___0=e=>(Pr=i._emscripten_bind_SuspendContextClipboardPaste___destroy___0=ze.ub)(e),xr=i._emscripten_bind_SuspendContextNetworkConnect_Cancel_0=e=>(xr=i._emscripten_bind_SuspendContextNetworkConnect_Cancel_0=ze.vb)(e),Rr=i._emscripten_bind_SuspendContextNetworkConnect_Resume_1=(e,t)=>(Rr=i._emscripten_bind_SuspendContextNetworkConnect_Resume_1=ze.wb)(e,t),zr=i._emscripten_bind_SuspendContextNetworkConnect___destroy___0=e=>(zr=i._emscripten_bind_SuspendContextNetworkConnect___destroy___0=ze.xb)(e),Fr=i._emscripten_bind_SuspendContextNetworkRpc_Cancel_0=e=>(Fr=i._emscripten_bind_SuspendContextNetworkRpc_Cancel_0=ze.yb)(e),Ar=i._emscripten_bind_SuspendContextNetworkRpc_GetRequestSize_0=e=>(Ar=i._emscripten_bind_SuspendContextNetworkRpc_GetRequestSize_0=ze.zb)(e),Nr=i._emscripten_bind_SuspendContextNetworkRpc_GetRequestData_0=e=>(Nr=i._emscripten_bind_SuspendContextNetworkRpc_GetRequestData_0=ze.Ab)(e),Hr=i._emscripten_bind_SuspendContextNetworkRpc_ReceiveResponse_2=(e,t,r)=>(Hr=i._emscripten_bind_SuspendContextNetworkRpc_ReceiveResponse_2=ze.Bb)(e,t,r),Tr=i._emscripten_bind_SuspendContextNetworkRpc___destroy___0=e=>(Tr=i._emscripten_bind_SuspendContextNetworkRpc___destroy___0=ze.Cb)(e),Lr=i._emscripten_bind_SuspendContext_GetKind_0=e=>(Lr=i._emscripten_bind_SuspendContext_GetKind_0=ze.Db)(e),Br=i._emscripten_bind_SuspendContext_Cancel_0=e=>(Br=i._emscripten_bind_SuspendContext_Cancel_0=ze.Eb)(e),Ur=i._emscripten_bind_SuspendContext_AsContextClipboardCopy_0=e=>(Ur=i._emscripten_bind_SuspendContext_AsContextClipboardCopy_0=ze.Fb)(e),jr=i._emscripten_bind_SuspendContext_AsContextClipboardPaste_0=e=>(jr=i._emscripten_bind_SuspendContext_AsContextClipboardPaste_0=ze.Gb)(e),Or=i._emscripten_bind_SuspendContext_AsContextNetworkConnect_0=e=>(Or=i._emscripten_bind_SuspendContext_AsContextNetworkConnect_0=ze.Hb)(e),Wr=i._emscripten_bind_SuspendContext_AsContextNetworkRpc_0=e=>(Wr=i._emscripten_bind_SuspendContext_AsContextNetworkRpc_0=ze.Ib)(e),Vr=i._emscripten_bind_SuspendContext___destroy___0=e=>(Vr=i._emscripten_bind_SuspendContext___destroy___0=ze.Jb)(e),qr=i._emscripten_bind_ZipfileWalker_ZipfileWalker_2=(e,t)=>(qr=i._emscripten_bind_ZipfileWalker_ZipfileWalker_2=ze.Kb)(e,t),Kr=i._emscripten_bind_ZipfileWalker_GetState_0=e=>(Kr=i._emscripten_bind_ZipfileWalker_GetState_0=ze.Lb)(e),Yr=i._emscripten_bind_ZipfileWalker_Next_0=e=>(Yr=i._emscripten_bind_ZipfileWalker_Next_0=ze.Mb)(e),Qr=i._emscripten_bind_ZipfileWalker_GetCurrentEntrySize_0=e=>(Qr=i._emscripten_bind_ZipfileWalker_GetCurrentEntrySize_0=ze.Nb)(e),$r=i._emscripten_bind_ZipfileWalker_GetCurrentEntryName_0=e=>($r=i._emscripten_bind_ZipfileWalker_GetCurrentEntryName_0=ze.Ob)(e),Zr=i._emscripten_bind_ZipfileWalker_GetCurrentEntryContent_0=e=>(Zr=i._emscripten_bind_ZipfileWalker_GetCurrentEntryContent_0=ze.Pb)(e),Xr=i._emscripten_bind_ZipfileWalker___destroy___0=e=>(Xr=i._emscripten_bind_ZipfileWalker___destroy___0=ze.Qb)(e),Jr=i._emscripten_bind_SessionImage_SessionImage_0=()=>(Jr=i._emscripten_bind_SessionImage_SessionImage_0=ze.Rb)(),en=i._emscripten_bind_SessionImage_GetDeviceId_0=e=>(en=i._emscripten_bind_SessionImage_GetDeviceId_0=ze.Sb)(e),tn=i._emscripten_bind_SessionImage_SetDeviceId_1=(e,t)=>(tn=i._emscripten_bind_SessionImage_SetDeviceId_1=ze.Tb)(e,t),rn=i._emscripten_bind_SessionImage_GetRomImage_0=e=>(rn=i._emscripten_bind_SessionImage_GetRomImage_0=ze.Ub)(e),nn=i._emscripten_bind_SessionImage_GetRomImageSize_0=e=>(nn=i._emscripten_bind_SessionImage_GetRomImageSize_0=ze.Vb)(e),on=i._emscripten_bind_SessionImage_SetRomImage_2=(e,t,r)=>(on=i._emscripten_bind_SessionImage_SetRomImage_2=ze.Wb)(e,t,r),sn=i._emscripten_bind_SessionImage_GetMemoryImage_0=e=>(sn=i._emscripten_bind_SessionImage_GetMemoryImage_0=ze.Xb)(e),an=i._emscripten_bind_SessionImage_GetMemoryImageSize_0=e=>(an=i._emscripten_bind_SessionImage_GetMemoryImageSize_0=ze.Yb)(e),cn=i._emscripten_bind_SessionImage_SetMemoryImage_2=(e,t,r)=>(cn=i._emscripten_bind_SessionImage_SetMemoryImage_2=ze.Zb)(e,t,r),pn=i._emscripten_bind_SessionImage_GetMetadata_0=e=>(pn=i._emscripten_bind_SessionImage_GetMetadata_0=ze._b)(e),un=i._emscripten_bind_SessionImage_GetMetadataSize_0=e=>(un=i._emscripten_bind_SessionImage_GetMetadataSize_0=ze.$b)(e),ln=i._emscripten_bind_SessionImage_SetMetadata_2=(e,t,r)=>(ln=i._emscripten_bind_SessionImage_SetMetadata_2=ze.ac)(e,t,r),dn=i._emscripten_bind_SessionImage_GetSavestate_0=e=>(dn=i._emscripten_bind_SessionImage_GetSavestate_0=ze.bc)(e),hn=i._emscripten_bind_SessionImage_GetSavestateSize_0=e=>(hn=i._emscripten_bind_SessionImage_GetSavestateSize_0=ze.cc)(e),mn=i._emscripten_bind_SessionImage_SetSavestate_2=(e,t,r)=>(mn=i._emscripten_bind_SessionImage_SetSavestate_2=ze.dc)(e,t,r),_n=i._emscripten_bind_SessionImage_GetVersion_0=e=>(_n=i._emscripten_bind_SessionImage_GetVersion_0=ze.ec)(e),fn=i._emscripten_bind_SessionImage_Serialize_0=e=>(fn=i._emscripten_bind_SessionImage_Serialize_0=ze.fc)(e),yn=i._emscripten_bind_SessionImage_GetSerializedImage_0=e=>(yn=i._emscripten_bind_SessionImage_GetSerializedImage_0=ze.gc)(e),vn=i._emscripten_bind_SessionImage_GetSerializedImageSize_0=e=>(vn=i._emscripten_bind_SessionImage_GetSerializedImageSize_0=ze.hc)(e),gn=i._emscripten_bind_SessionImage_Deserialize_2=(e,t,r)=>(gn=i._emscripten_bind_SessionImage_Deserialize_2=ze.ic)(e,t,r),bn=i._emscripten_bind_SessionImage___destroy___0=e=>(bn=i._emscripten_bind_SessionImage___destroy___0=ze.jc)(e),wn=i._emscripten_bind_SkinLoader_SkinLoader_1=e=>(wn=i._emscripten_bind_SkinLoader_SkinLoader_1=ze.kc)(e),Sn=i._emscripten_bind_SkinLoader_GetData_0=e=>(Sn=i._emscripten_bind_SkinLoader_GetData_0=ze.lc)(e),Cn=i._emscripten_bind_SkinLoader_GetSize_0=e=>(Cn=i._emscripten_bind_SkinLoader_GetSize_0=ze.mc)(e),En=i._emscripten_bind_SkinLoader___destroy___0=e=>(En=i._emscripten_bind_SkinLoader___destroy___0=ze.nc)(e),In=i._emscripten_bind_GunzipContext_GunzipContext_3=(e,t,r)=>(In=i._emscripten_bind_GunzipContext_GunzipContext_3=ze.oc)(e,t,r),Dn=i._emscripten_bind_GunzipContext_GetState_0=e=>(Dn=i._emscripten_bind_GunzipContext_GetState_0=ze.pc)(e),kn=i._emscripten_bind_GunzipContext_Continue_0=e=>(kn=i._emscripten_bind_GunzipContext_Continue_0=ze.qc)(e),Gn=i._emscripten_bind_GunzipContext_GetUncompressedData_0=e=>(Gn=i._emscripten_bind_GunzipContext_GetUncompressedData_0=ze.rc)(e),Mn=i._emscripten_bind_GunzipContext_ReleaseUncompressedData_0=e=>(Mn=i._emscripten_bind_GunzipContext_ReleaseUncompressedData_0=ze.sc)(e),Pn=i._emscripten_bind_GunzipContext_GetUncompressedSize_0=e=>(Pn=i._emscripten_bind_GunzipContext_GetUncompressedSize_0=ze.tc)(e),xn=i._emscripten_bind_GunzipContext_GetError_0=e=>(xn=i._emscripten_bind_GunzipContext_GetError_0=ze.uc)(e),Rn=i._emscripten_bind_GunzipContext___destroy___0=e=>(Rn=i._emscripten_bind_GunzipContext___destroy___0=ze.vc)(e),zn=e=>(zn=ze.xc)(e);function Fn(){function e(){xe||(xe=!0,i.calledRun=!0,I||(i.noFSInit||le.init.initialized||le.init(),le.ignorePermissions=!1,se.init(),K(M),K(P),r(i),i.onRuntimeInitialized&&i.onRuntimeInitialized(),An&&function(){var e=Ae;try{var t=e(0,0);return Ie(t),t}catch(e){return(e=>{if(e instanceof q||"unwind"==e)return g;u(1,e)})(e)}}(),function(){if(i.postRun)for("function"==typeof i.postRun&&(i.postRun=[i.postRun]);i.postRun.length;)e=i.postRun.shift(),x.unshift(e);var e;K(x)}()))}R>0||(function(){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;)e=i.preRun.shift(),G.unshift(e);var e;K(G)}(),R>0||(i.setStatus?(i.setStatus("Running..."),setTimeout((function(){setTimeout((function(){i.setStatus("")}),1),e()}),1)):e()))}if(i.___original_main=()=>(i.___original_main=ze.yc)(),i.___start_em_js=1472759,i.___stop_em_js=1472956,i.addFunction=(e,t)=>{var r=(e=>(oe||(oe=new WeakMap,((e,t)=>{if(oe)for(var r=0;r<0+t;r++){var n=(o=void 0,(o=ke[i=r])||(i>=ke.length&&(ke.length=i+1),ke[i]=o=ie.get(i)),o);n&&oe.set(n,r)}var i,o})(0,ie.length)),oe.get(e)||0))(e);if(r)return r;var n=(()=>{if(Ge.length)return Ge.pop();try{ie.grow(1)}catch(e){if(!(e instanceof RangeError))throw e;throw"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH."}return ie.length-1})();try{Me(n,e)}catch(r){if(!(r instanceof TypeError))throw r;var i=((e,t)=>{if("function"==typeof WebAssembly.Function)return new WebAssembly.Function((e=>{for(var t={i:"i32",j:"i64",f:"f32",d:"f64",p:"i32"},r={parameters:[],results:"v"==e[0]?[]:[t[e[0]]]},n=1;n<e.length;++n)r.parameters.push(t[e[n]]);return r})(t),e);var r=[1];((e,t)=>{var r=e.slice(0,1),n=e.slice(1),i={i:127,p:127,j:126,f:125,d:124};t.push(96),De(n.length,t);for(var o=0;o<n.length;++o)t.push(i[n[o]]);"v"==r?t.push(0):t.push(1,i[r])})(t,r);var n=[0,97,115,109,1,0,0,0,1];De(r.length,n),n.push.apply(n,r),n.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);var i=new WebAssembly.Module(new Uint8Array(n));return new WebAssembly.Instance(i,{e:{f:e}}).exports.f})(e,t);Me(n,i)}return oe.set(e,n),n},i.UTF8ToString=$,F=function e(){xe||Fn(),xe||(F=e)},i.preInit)for("function"==typeof i.preInit&&(i.preInit=[i.preInit]);i.preInit.length>0;)i.preInit.pop()();var An=!0;function Nn(){}function Hn(e){return(e||Nn).__cache__}function Tn(e,t){var r=Hn(t),n=r[e];return n||((n=Object.create((t||Nn).prototype)).ptr=e,r[e]=n)}i.noInitialRun&&(An=!1),Fn(),Nn.prototype=Object.create(Nn.prototype),Nn.prototype.constructor=Nn,Nn.prototype.__class__=Nn,Nn.__cache__={},i.WrapperObject=Nn,i.getCache=Hn,i.wrapPointer=Tn,i.castObject=function(e,t){return Tn(e.ptr,t)},i.NULL=Tn(0),i.destroy=function(e){if(!e.__destroy__)throw"Error: Cannot destroy object. (Did you create it yourself?)";e.__destroy__(),delete Hn(e.__class__)[e.ptr]},i.compare=function(e,t){return e.ptr===t.ptr},i.getPointer=function(e){return e.ptr},i.getClass=function(e){return e.__class__};var Ln={buffer:0,size:0,pos:0,temps:[],needed:0,prepare(){if(Ln.needed){for(var e=0;e<Ln.temps.length;e++)i._webidl_free(Ln.temps[e]);Ln.temps.length=0,i._webidl_free(Ln.buffer),Ln.buffer=0,Ln.size+=Ln.needed,Ln.needed=0}Ln.buffer||(Ln.size+=128,Ln.buffer=i._webidl_malloc(Ln.size),D(Ln.buffer)),Ln.pos=0},alloc(e,t){D(Ln.buffer);var r,n=t.BYTES_PER_ELEMENT,o=e.length*n;return o=o+7&-8,Ln.pos+o>=Ln.size?(D(o>0),Ln.needed+=o,r=i._webidl_malloc(o),Ln.temps.push(r)):(r=Ln.buffer+Ln.pos,Ln.pos+=o),r},copy(e,t,r){switch(r>>>=0,t.BYTES_PER_ELEMENT){case 2:r>>>=1;break;case 4:r>>>=2;break;case 8:r>>>=3}for(var n=0;n<e.length;n++)t[r+n]=e[n]}};function Bn(e){if("string"==typeof e){var t=ne(e),r=Ln.alloc(t,b);return Ln.copy(t,b,r),r}return e}function Un(){throw"cannot construct a VoidPtr, no constructor in IDL"}function jn(){this.ptr=He(),Hn(jn)[this.ptr]=this}function On(e,t){e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),this.ptr=Yt(e,t),Hn(On)[this.ptr]=this}function Wn(){throw"cannot construct a Frame, no constructor in IDL"}function Vn(){throw"cannot construct a DbBackup, no constructor in IDL"}function qn(){throw"cannot construct a SuspendContextClipboardCopy, no constructor in IDL"}function Kn(){throw"cannot construct a SuspendContextClipboardPaste, no constructor in IDL"}function Yn(){throw"cannot construct a SuspendContextNetworkConnect, no constructor in IDL"}function Qn(){throw"cannot construct a SuspendContextNetworkRpc, no constructor in IDL"}function $n(){throw"cannot construct a SuspendContext, no constructor in IDL"}function Zn(e,t){e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),this.ptr=qr(e,t),Hn(Zn)[this.ptr]=this}function Xn(){this.ptr=Jr(),Hn(Xn)[this.ptr]=this}function Jn(e){Ln.prepare(),e=e&&"object"==typeof e?e.ptr:Bn(e),this.ptr=wn(e),Hn(Jn)[this.ptr]=this}function ei(e,t,r){e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),this.ptr=In(e,t,r),Hn(ei)[this.ptr]=this}return Un.prototype=Object.create(Nn.prototype),Un.prototype.constructor=Un,Un.prototype.__class__=Un,Un.__cache__={},i.VoidPtr=Un,Un.prototype.__destroy__=Un.prototype.__destroy__=function(){var e=this.ptr;Ne(e)},jn.prototype=Object.create(Nn.prototype),jn.prototype.constructor=jn,jn.prototype.__class__=jn,jn.__cache__={},i.Cloudpilot=jn,jn.prototype.Malloc=jn.prototype.Malloc=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),Tn(Te(t,e),Un)},jn.prototype.Free=jn.prototype.Free=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),Le(t,e)},jn.prototype.Nullptr=jn.prototype.Nullptr=function(){var e=this.ptr;return Tn(Be(e),Un)},jn.prototype.InitializeSession=jn.prototype.InitializeSession=function(e,t,r){var n=this.ptr;return Ln.prepare(),e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r=r&&"object"==typeof r?r.ptr:Bn(r),!!Ue(n,e,t,r)},jn.prototype.GetCyclesPerSecond=jn.prototype.GetCyclesPerSecond=function(){var e=this.ptr;return je(e)},jn.prototype.RunEmulation=jn.prototype.RunEmulation=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),Oe(t,e)},jn.prototype.SetClockFactor=jn.prototype.SetClockFactor=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),We(t,e)},jn.prototype.CopyFrame=jn.prototype.CopyFrame=function(){var e=this.ptr;return Tn(Ve(e),Wn)},jn.prototype.IsScreenDirty=jn.prototype.IsScreenDirty=function(){var e=this.ptr;return!!qe(e)},jn.prototype.MarkScreenClean=jn.prototype.MarkScreenClean=function(){var e=this.ptr;Ke(e)},jn.prototype.MinMemoryForDevice=jn.prototype.MinMemoryForDevice=function(e){var t=this.ptr;return Ln.prepare(),e=e&&"object"==typeof e?e.ptr:Bn(e),Ye(t,e)},jn.prototype.FramebufferSizeForDevice=jn.prototype.FramebufferSizeForDevice=function(e){var t=this.ptr;return Ln.prepare(),e=e&&"object"==typeof e?e.ptr:Bn(e),Qe(t,e)},jn.prototype.TotalMemoryForDevice=jn.prototype.TotalMemoryForDevice=function(e){var t=this.ptr;return Ln.prepare(),e=e&&"object"==typeof e?e.ptr:Bn(e),$e(t,e)},jn.prototype.QueuePenMove=jn.prototype.QueuePenMove=function(e,t){var r=this.ptr;e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),Ze(r,e,t)},jn.prototype.QueuePenUp=jn.prototype.QueuePenUp=function(){var e=this.ptr;Xe(e)},jn.prototype.QueueButtonDown=jn.prototype.QueueButtonDown=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),Je(t,e)},jn.prototype.QueueButtonUp=jn.prototype.QueueButtonUp=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),et(t,e)},jn.prototype.QueueKeyboardEvent=jn.prototype.QueueKeyboardEvent=function(e,t){var r=this.ptr;e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),tt(r,e,t)},jn.prototype.IsPowerOff=jn.prototype.IsPowerOff=function(){var e=this.ptr;return!!rt(e)},jn.prototype.IsUIInitialized=jn.prototype.IsUIInitialized=function(){var e=this.ptr;return!!nt(e)},jn.prototype.GetOSVersion=jn.prototype.GetOSVersion=function(){var e=this.ptr;return it(e)},jn.prototype.IsSetupComplete=jn.prototype.IsSetupComplete=function(){var e=this.ptr;return!!ot(e)},jn.prototype.Reset=jn.prototype.Reset=function(){var e=this.ptr;st(e)},jn.prototype.ResetNoExtensions=jn.prototype.ResetNoExtensions=function(){var e=this.ptr;at(e)},jn.prototype.ResetHard=jn.prototype.ResetHard=function(){var e=this.ptr;ct(e)},jn.prototype.InstallDb=jn.prototype.InstallDb=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),pt(r,e,t)},jn.prototype.GetPalette2bitMapping=jn.prototype.GetPalette2bitMapping=function(){var e=this.ptr;return ut(e)},jn.prototype.GetMemoryPtr=jn.prototype.GetMemoryPtr=function(){var e=this.ptr;return Tn(lt(e),Un)},jn.prototype.GetDirtyPagesPtr=jn.prototype.GetDirtyPagesPtr=function(){var e=this.ptr;return Tn(dt(e),Un)},jn.prototype.GetMemorySize=jn.prototype.GetMemorySize=function(){var e=this.ptr;return ht(e)},jn.prototype.ImportMemoryImage=jn.prototype.ImportMemoryImage=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),!!mt(r,e,t)},jn.prototype.GetRomPtr=jn.prototype.GetRomPtr=function(){var e=this.ptr;return Tn(_t(e),Un)},jn.prototype.GetRomSize=jn.prototype.GetRomSize=function(){var e=this.ptr;return ft(e)},jn.prototype.GetSavestatePtr=jn.prototype.GetSavestatePtr=function(){var e=this.ptr;return Tn(yt(e),Un)},jn.prototype.GetSavestateSize=jn.prototype.GetSavestateSize=function(){var e=this.ptr;return vt(e)},jn.prototype.SaveState=jn.prototype.SaveState=function(){var e=this.ptr;return!!gt(e)},jn.prototype.LoadState=jn.prototype.LoadState=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),!!bt(r,e,t)},jn.prototype.GetHotsyncName=jn.prototype.GetHotsyncName=function(){var e=this.ptr;return $(wt(e))},jn.prototype.SetHotsyncName=jn.prototype.SetHotsyncName=function(e){var t=this.ptr;Ln.prepare(),e=e&&"object"==typeof e?e.ptr:Bn(e),St(t,e)},jn.prototype.RegisterPwmHandler=jn.prototype.RegisterPwmHandler=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),Ct(t,e)},jn.prototype.StartBackup=jn.prototype.StartBackup=function(){var e=this.ptr;return Tn(Et(e),Vn)},jn.prototype.SetClipboardIntegration=jn.prototype.SetClipboardIntegration=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),It(t,e)},jn.prototype.GetClipboardIntegration=jn.prototype.GetClipboardIntegration=function(){var e=this.ptr;return!!Dt(e)},jn.prototype.IsSuspended=jn.prototype.IsSuspended=function(){var e=this.ptr;return!!kt(e)},jn.prototype.GetSuspendContext=jn.prototype.GetSuspendContext=function(){var e=this.ptr;return Tn(Gt(e),$n)},jn.prototype.SetNetworkRedirection=jn.prototype.SetNetworkRedirection=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),Mt(t,e)},jn.prototype.GetNetworkRedirection=jn.prototype.GetNetworkRedirection=function(){var e=this.ptr;return!!Pt(e)},jn.prototype.RegisterProxyDisconnectHandler=jn.prototype.RegisterProxyDisconnectHandler=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),xt(t,e)},jn.prototype.SetHotsyncNameManagement=jn.prototype.SetHotsyncNameManagement=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),Rt(t,e)},jn.prototype.LaunchAppByName=jn.prototype.LaunchAppByName=function(e){var t=this.ptr;return Ln.prepare(),e=e&&"object"==typeof e?e.ptr:Bn(e),!!zt(t,e)},jn.prototype.LaunchAppByDbHeader=jn.prototype.LaunchAppByDbHeader=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),!!Ft(r,e,t)},jn.prototype.DeviceSupportsCardSize=jn.prototype.DeviceSupportsCardSize=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),!!At(t,e)},jn.prototype.ClearExternalStorage=jn.prototype.ClearExternalStorage=function(){var e=this.ptr;Nt(e)},jn.prototype.AllocateCard=jn.prototype.AllocateCard=function(e,t){var r=this.ptr;return Ln.prepare(),e=e&&"object"==typeof e?e.ptr:Bn(e),t&&"object"==typeof t&&(t=t.ptr),!!Ht(r,e,t)},jn.prototype.AdoptCard=jn.prototype.AdoptCard=function(e,t,r){var n=this.ptr;return Ln.prepare(),e=e&&"object"==typeof e?e.ptr:Bn(e),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!Tt(n,e,t,r)},jn.prototype.MountCard=jn.prototype.MountCard=function(e){var t=this.ptr;return Ln.prepare(),e=e&&"object"==typeof e?e.ptr:Bn(e),!!Lt(t,e)},jn.prototype.RemoveCard=jn.prototype.RemoveCard=function(e){var t=this.ptr;return Ln.prepare(),e=e&&"object"==typeof e?e.ptr:Bn(e),!!Bt(t,e)},jn.prototype.GetCardData=jn.prototype.GetCardData=function(e){var t=this.ptr;return Ln.prepare(),e=e&&"object"==typeof e?e.ptr:Bn(e),Tn(Ut(t,e),Un)},jn.prototype.GetCardDirtyPages=jn.prototype.GetCardDirtyPages=function(e){var t=this.ptr;return Ln.prepare(),e=e&&"object"==typeof e?e.ptr:Bn(e),Tn(jt(t,e),Un)},jn.prototype.GetCardSize=jn.prototype.GetCardSize=function(e){var t=this.ptr;return Ln.prepare(),e=e&&"object"==typeof e?e.ptr:Bn(e),Ot(t,e)},jn.prototype.RemountCards=jn.prototype.RemountCards=function(){var e=this.ptr;Wt(e)},jn.prototype.GetSupportLevel=jn.prototype.GetSupportLevel=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),Vt(t,e)},jn.prototype.GetMountedKey=jn.prototype.GetMountedKey=function(){var e=this.ptr;return $(qt(e))},jn.prototype.__destroy__=jn.prototype.__destroy__=function(){var e=this.ptr;Kt(e)},On.prototype=Object.create(Nn.prototype),On.prototype.constructor=On,On.prototype.__class__=On,On.__cache__={},i.RomInfo=On,On.prototype.IsValid=On.prototype.IsValid=function(){var e=this.ptr;return!!Qt(e)},On.prototype.CardVersion=On.prototype.CardVersion=function(){var e=this.ptr;return $t(e)},On.prototype.CardName=On.prototype.CardName=function(){var e=this.ptr;return $(Zt(e))},On.prototype.RomVersion=On.prototype.RomVersion=function(){var e=this.ptr;return Xt(e)},On.prototype.RomVersionString=On.prototype.RomVersionString=function(){var e=this.ptr;return $(Jt(e))},On.prototype.Supports=On.prototype.Supports=function(e){var t=this.ptr;return Ln.prepare(),e=e&&"object"==typeof e?e.ptr:Bn(e),!!er(t,e)},On.prototype.__destroy__=On.prototype.__destroy__=function(){var e=this.ptr;tr(e)},Wn.prototype=Object.create(Nn.prototype),Wn.prototype.constructor=Wn,Wn.prototype.__class__=Wn,Wn.__cache__={},i.Frame=Wn,Wn.prototype.GetLineWidth=Wn.prototype.GetLineWidth=function(){var e=this.ptr;return rr(e)},Wn.prototype.GetBpp=Wn.prototype.GetBpp=function(){var e=this.ptr;return nr(e)},Wn.prototype.GetLines=Wn.prototype.GetLines=function(){var e=this.ptr;return ir(e)},Wn.prototype.GetMargin=Wn.prototype.GetMargin=function(){var e=this.ptr;return or(e)},Wn.prototype.GetBytesPerLine=Wn.prototype.GetBytesPerLine=function(){var e=this.ptr;return sr(e)},Wn.prototype.GetFirstDirtyLine=Wn.prototype.GetFirstDirtyLine=function(){var e=this.ptr;return ar(e)},Wn.prototype.GetLastDirtyLine=Wn.prototype.GetLastDirtyLine=function(){var e=this.ptr;return cr(e)},Wn.prototype.GetHasChanges=Wn.prototype.GetHasChanges=function(){var e=this.ptr;return!!pr(e)},Wn.prototype.GetBuffer=Wn.prototype.GetBuffer=function(){var e=this.ptr;return Tn(ur(e),Un)},Wn.prototype.GetBufferSize=Wn.prototype.GetBufferSize=function(){var e=this.ptr;return lr(e)},Wn.prototype.GetScaleX=Wn.prototype.GetScaleX=function(){var e=this.ptr;return dr(e)},Wn.prototype.GetScaleY=Wn.prototype.GetScaleY=function(){var e=this.ptr;return hr(e)},Wn.prototype.__destroy__=Wn.prototype.__destroy__=function(){var e=this.ptr;mr(e)},Vn.prototype=Object.create(Nn.prototype),Vn.prototype.constructor=Vn,Vn.prototype.__class__=Vn,Vn.__cache__={},i.DbBackup=Vn,Vn.prototype.Init=Vn.prototype.Init=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),!!_r(t,e)},Vn.prototype.IsInProgress=Vn.prototype.IsInProgress=function(){var e=this.ptr;return!!fr(e)},Vn.prototype.IsDone=Vn.prototype.IsDone=function(){var e=this.ptr;return!!yr(e)},Vn.prototype.GetCurrentDatabase=Vn.prototype.GetCurrentDatabase=function(){var e=this.ptr;return $(vr(e))},Vn.prototype.Save=Vn.prototype.Save=function(){var e=this.ptr;return!!gr(e)},Vn.prototype.Skip=Vn.prototype.Skip=function(){var e=this.ptr;br(e)},Vn.prototype.GetArchivePtr=Vn.prototype.GetArchivePtr=function(){var e=this.ptr;return Tn(wr(e),Un)},Vn.prototype.GetArchiveSize=Vn.prototype.GetArchiveSize=function(){var e=this.ptr;return Sr(e)},Vn.prototype.__destroy__=Vn.prototype.__destroy__=function(){var e=this.ptr;Cr(e)},qn.prototype=Object.create(Nn.prototype),qn.prototype.constructor=qn,qn.prototype.__class__=qn,qn.__cache__={},i.SuspendContextClipboardCopy=qn,qn.prototype.Cancel=qn.prototype.Cancel=function(){var e=this.ptr;Er(e)},qn.prototype.Resume=qn.prototype.Resume=function(){var e=this.ptr;Ir(e)},qn.prototype.GetClipboardContent=qn.prototype.GetClipboardContent=function(){var e=this.ptr;return $(Dr(e))},qn.prototype.__destroy__=qn.prototype.__destroy__=function(){var e=this.ptr;kr(e)},Kn.prototype=Object.create(Nn.prototype),Kn.prototype.constructor=Kn,Kn.prototype.__class__=Kn,Kn.__cache__={},i.SuspendContextClipboardPaste=Kn,Kn.prototype.Cancel=Kn.prototype.Cancel=function(){var e=this.ptr;Gr(e)},Kn.prototype.Resume=Kn.prototype.Resume=function(e){var t=this.ptr;Ln.prepare(),e=e&&"object"==typeof e?e.ptr:Bn(e),Mr(t,e)},Kn.prototype.__destroy__=Kn.prototype.__destroy__=function(){var e=this.ptr;Pr(e)},Yn.prototype=Object.create(Nn.prototype),Yn.prototype.constructor=Yn,Yn.prototype.__class__=Yn,Yn.__cache__={},i.SuspendContextNetworkConnect=Yn,Yn.prototype.Cancel=Yn.prototype.Cancel=function(){var e=this.ptr;xr(e)},Yn.prototype.Resume=Yn.prototype.Resume=function(e){var t=this.ptr;Ln.prepare(),e=e&&"object"==typeof e?e.ptr:Bn(e),Rr(t,e)},Yn.prototype.__destroy__=Yn.prototype.__destroy__=function(){var e=this.ptr;zr(e)},Qn.prototype=Object.create(Nn.prototype),Qn.prototype.constructor=Qn,Qn.prototype.__class__=Qn,Qn.__cache__={},i.SuspendContextNetworkRpc=Qn,Qn.prototype.Cancel=Qn.prototype.Cancel=function(){var e=this.ptr;Fr(e)},Qn.prototype.GetRequestSize=Qn.prototype.GetRequestSize=function(){var e=this.ptr;return Ar(e)},Qn.prototype.GetRequestData=Qn.prototype.GetRequestData=function(){var e=this.ptr;return Tn(Nr(e),Un)},Qn.prototype.ReceiveResponse=Qn.prototype.ReceiveResponse=function(e,t){var r=this.ptr;e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),Hr(r,e,t)},Qn.prototype.__destroy__=Qn.prototype.__destroy__=function(){var e=this.ptr;Tr(e)},$n.prototype=Object.create(Nn.prototype),$n.prototype.constructor=$n,$n.prototype.__class__=$n,$n.__cache__={},i.SuspendContext=$n,$n.prototype.GetKind=$n.prototype.GetKind=function(){var e=this.ptr;return Lr(e)},$n.prototype.Cancel=$n.prototype.Cancel=function(){var e=this.ptr;Br(e)},$n.prototype.AsContextClipboardCopy=$n.prototype.AsContextClipboardCopy=function(){var e=this.ptr;return Tn(Ur(e),qn)},$n.prototype.AsContextClipboardPaste=$n.prototype.AsContextClipboardPaste=function(){var e=this.ptr;return Tn(jr(e),Kn)},$n.prototype.AsContextNetworkConnect=$n.prototype.AsContextNetworkConnect=function(){var e=this.ptr;return Tn(Or(e),Yn)},$n.prototype.AsContextNetworkRpc=$n.prototype.AsContextNetworkRpc=function(){var e=this.ptr;return Tn(Wr(e),Qn)},$n.prototype.__destroy__=$n.prototype.__destroy__=function(){var e=this.ptr;Vr(e)},Zn.prototype=Object.create(Nn.prototype),Zn.prototype.constructor=Zn,Zn.prototype.__class__=Zn,Zn.__cache__={},i.ZipfileWalker=Zn,Zn.prototype.GetState=Zn.prototype.GetState=function(){var e=this.ptr;return Kr(e)},Zn.prototype.Next=Zn.prototype.Next=function(){var e=this.ptr;return Yr(e)},Zn.prototype.GetCurrentEntrySize=Zn.prototype.GetCurrentEntrySize=function(){var e=this.ptr;return Qr(e)},Zn.prototype.GetCurrentEntryName=Zn.prototype.GetCurrentEntryName=function(){var e=this.ptr;return $($r(e))},Zn.prototype.GetCurrentEntryContent=Zn.prototype.GetCurrentEntryContent=function(){var e=this.ptr;return Tn(Zr(e),Un)},Zn.prototype.__destroy__=Zn.prototype.__destroy__=function(){var e=this.ptr;Xr(e)},Xn.prototype=Object.create(Nn.prototype),Xn.prototype.constructor=Xn,Xn.prototype.__class__=Xn,Xn.__cache__={},i.SessionImage=Xn,Xn.prototype.GetDeviceId=Xn.prototype.GetDeviceId=function(){var e=this.ptr;return $(en(e))},Xn.prototype.SetDeviceId=Xn.prototype.SetDeviceId=function(e){var t=this.ptr;return Ln.prepare(),e=e&&"object"==typeof e?e.ptr:Bn(e),Tn(tn(t,e),Xn)},Xn.prototype.GetRomImage=Xn.prototype.GetRomImage=function(){var e=this.ptr;return Tn(rn(e),Un)},Xn.prototype.GetRomImageSize=Xn.prototype.GetRomImageSize=function(){var e=this.ptr;return nn(e)},Xn.prototype.SetRomImage=Xn.prototype.SetRomImage=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),Tn(on(r,e,t),Xn)},Xn.prototype.GetMemoryImage=Xn.prototype.GetMemoryImage=function(){var e=this.ptr;return Tn(sn(e),Un)},Xn.prototype.GetMemoryImageSize=Xn.prototype.GetMemoryImageSize=function(){var e=this.ptr;return an(e)},Xn.prototype.SetMemoryImage=Xn.prototype.SetMemoryImage=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),Tn(cn(r,e,t),Xn)},Xn.prototype.GetMetadata=Xn.prototype.GetMetadata=function(){var e=this.ptr;return Tn(pn(e),Un)},Xn.prototype.GetMetadataSize=Xn.prototype.GetMetadataSize=function(){var e=this.ptr;return un(e)},Xn.prototype.SetMetadata=Xn.prototype.SetMetadata=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),Tn(ln(r,e,t),Xn)},Xn.prototype.GetSavestate=Xn.prototype.GetSavestate=function(){var e=this.ptr;return Tn(dn(e),Un)},Xn.prototype.GetSavestateSize=Xn.prototype.GetSavestateSize=function(){var e=this.ptr;return hn(e)},Xn.prototype.SetSavestate=Xn.prototype.SetSavestate=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),Tn(mn(r,e,t),Xn)},Xn.prototype.GetVersion=Xn.prototype.GetVersion=function(){var e=this.ptr;return _n(e)},Xn.prototype.Serialize=Xn.prototype.Serialize=function(){var e=this.ptr;return!!fn(e)},Xn.prototype.GetSerializedImage=Xn.prototype.GetSerializedImage=function(){var e=this.ptr;return Tn(yn(e),Un)},Xn.prototype.GetSerializedImageSize=Xn.prototype.GetSerializedImageSize=function(){var e=this.ptr;return vn(e)},Xn.prototype.Deserialize=Xn.prototype.Deserialize=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),!!gn(r,e,t)},Xn.prototype.__destroy__=Xn.prototype.__destroy__=function(){var e=this.ptr;bn(e)},Jn.prototype=Object.create(Nn.prototype),Jn.prototype.constructor=Jn,Jn.prototype.__class__=Jn,Jn.__cache__={},i.SkinLoader=Jn,Jn.prototype.GetData=Jn.prototype.GetData=function(){var e=this.ptr;return Tn(Sn(e),Un)},Jn.prototype.GetSize=Jn.prototype.GetSize=function(){var e=this.ptr;return Cn(e)},Jn.prototype.__destroy__=Jn.prototype.__destroy__=function(){var e=this.ptr;En(e)},ei.prototype=Object.create(Nn.prototype),ei.prototype.constructor=ei,ei.prototype.__class__=ei,ei.__cache__={},i.GunzipContext=ei,ei.prototype.GetState=ei.prototype.GetState=function(){var e=this.ptr;return Dn(e)},ei.prototype.Continue=ei.prototype.Continue=function(){var e=this.ptr;return kn(e)},ei.prototype.GetUncompressedData=ei.prototype.GetUncompressedData=function(){var e=this.ptr;return Tn(Gn(e),Un)},ei.prototype.ReleaseUncompressedData=ei.prototype.ReleaseUncompressedData=function(){var e=this.ptr;return Tn(Mn(e),Un)},ei.prototype.GetUncompressedSize=ei.prototype.GetUncompressedSize=function(){var e=this.ptr;return Pn(e)},ei.prototype.GetError=ei.prototype.GetError=function(){var e=this.ptr;return $(xn(e))},ei.prototype.__destroy__=ei.prototype.__destroy__=function(){var e=this.ptr;Rn(e)},e.ready});e.exports=r},650:function(e,t){!function(e){"use strict";var t,r=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,n=536870912,i=1073741824,o=new WeakMap,s=function(e,t){return function(o){var s=t.get(o),a=void 0===s?o.size:s<i?s+1:0;if(!o.has(a))return e(o,a);if(o.size<n){for(;o.has(a);)a=Math.floor(Math.random()*i);return e(o,a)}if(o.size>r)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;o.has(a);)a=Math.floor(Math.random()*r);return e(o,a)}}((t=o,function(e,r){return t.set(e,r),r}),o),a=function(e){return function(t){var r=e(t);return t.add(r),r}}(s);e.addUniqueNumber=a,e.generateUniqueNumber=s}(t)},37:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=[];r[0]=function(){return function(){}},r[1]=function(e,t){return void 0===t?e:function(r){e(r,t)}};var n=function(){function e(){this.hasHandlers=!1,this._handlers=[],this._contexts=[],this._createDispatcher()}return e.prototype.addHandler=function(e,t){return this.isHandlerAttached(e,t)||(this._handlers.push(e),this._contexts.push(t),this._createDispatcher(),this._updateHasHandlers()),this},e.prototype.removeHandler=function(e,t){var r=this._getHandlerIndex(e,t);return void 0!==r&&(this._handlers.splice(r,1),this._contexts.splice(r,1),this._createDispatcher(),this._updateHasHandlers()),this},e.prototype.isHandlerAttached=function(e,t){return void 0!==this._getHandlerIndex(e,t)},e.prototype._updateHasHandlers=function(){this.hasHandlers=!!this._handlers.length},e.prototype._getHandlerIndex=function(e,t){var r,n=this._handlers.length;for(r=0;r<n&&(this._handlers[r]!==e||this._contexts[r]!==t);r++);return r<n?r:void 0},e.prototype._createDispatcher=function(){var e;this.dispatch=(e=this._handlers.length,r[e]||(r[e]=function(e){for(var t="return function dispatcher"+e+"(payload) {\n",r=[],n=[],i=0;i<e;i++)r.push("cb"+i),n.push("ctx"+i),t+="    cb"+i+"(payload, ctx"+i+");\n";return t+="};",new(Function.bind.apply(Function,[void 0].concat(r.concat(n),[t])))}(e)),r[e]).apply(this,this._handlers.concat(this._contexts))},e}();t.default=n},819:(e,t,r)=>{"use strict";var n=r(37);t.j=n.default}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return(()=>{"use strict";function e(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s}function t(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}var i,o,s;r.r(n),r.d(n,{Button:()=>ie,DeviceId:()=>i,DeviceOrientation:()=>o,VERSION:()=>oe,createEmulator:()=>se,createEmulatorFactory:()=>ae}),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError,(s=i||(i={})).palmPilot="PalmPilot",s.pilot="Pilot",s.iii="PalmIII",s.palmVx="PalmVx",s.palmV="PalmV",s.palmVII="PalmVII",s.palmVIIEZ="PalmVIIEZ",s.palmVIIx="PalmVIIx",s.iiic="PalmIIIc",s.iiix="PalmIIIx",s.iiixe="PalmIIIxe",s.iiie="PalmIIIe",s.m500="PalmM500",s.m505="PalmM505",s.m515="PalmM515",s.m520="PalmM520",s.m100="PalmM100",s.m105="PalmM105",s.m125="PalmM125",s.m130="PalmM130",s.i705="Palmi705",s.i710="PalmI710",s.handera330="HandEra330",s.handera330c="HandEra330c",s.pegS300="PEG-S300",s.pegS320="PEG-S320",s.pegS500c="PEG-S500C",s.pegT400="PEG-T400",s.pegN600c="PEG-N600C/N610C",s.pegT600c="PEG-T600",s.pegN700c="PEG-N700C/N710C",s.pegT650c="YSX1230",s.pegNR70="NR70",s.acerS11="Acer-S11",s.lp168="Legend-P168",function(e){e.portrait="portrait",e.landscape90="landscape90",e.landscape270="landscape270",e.portrait180="portrait180"}(o||(o={})),new Error("timeout while waiting for mutex to become available"),new Error("mutex already locked");const a=new Error("request for lock canceled");class c{constructor(e,t=a){this._value=e,this._cancelError=t,this._weightedQueues=[],this._weightedWaiters=[]}acquire(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise(((t,r)=>{this._weightedQueues[e-1]||(this._weightedQueues[e-1]=[]),this._weightedQueues[e-1].push({resolve:t,reject:r}),this._dispatch()}))}runExclusive(e,t=1){return r=this,n=void 0,o=function*(){const[r,n]=yield this.acquire(t);try{return yield e(r)}finally{n()}},new((i=void 0)||(i=Promise))((function(e,t){function s(e){try{c(o.next(e))}catch(e){t(e)}}function a(e){try{c(o.throw(e))}catch(e){t(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof i?r:new i((function(e){e(r)}))).then(s,a)}c((o=o.apply(r,n||[])).next())}));var r,n,i,o}waitForUnlock(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise((t=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),this._weightedWaiters[e-1].push(t),this._dispatch()}))}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatch()}release(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatch()}cancel(){this._weightedQueues.forEach((e=>e.forEach((e=>e.reject(this._cancelError))))),this._weightedQueues=[]}_dispatch(){var e;for(let t=this._value;t>0;t--){const r=null===(e=this._weightedQueues[t-1])||void 0===e?void 0:e.shift();if(!r)continue;const n=this._value,i=t;this._value-=t,t=this._value+1,r.resolve([n,this._newReleaser(i)])}this._drainUnlockWaiters()}_newReleaser(e){let t=!1;return()=>{t||(t=!0,this.release(e))}}_drainUnlockWaiters(){for(let e=this._value;e>0;e--)this._weightedWaiters[e-1]&&(this._weightedWaiters[e-1].forEach((e=>e())),this._weightedWaiters[e-1]=[])}}class p{constructor(e){this._semaphore=new c(1,e)}acquire(){return e=this,t=void 0,n=function*(){const[,e]=yield this._semaphore.acquire();return e},new((r=void 0)||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}));var e,t,r,n}runExclusive(e){return this._semaphore.runExclusive((()=>e()))}isLocked(){return this._semaphore.isLocked()}waitForUnlock(){return this._semaphore.waitForUnlock()}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}}const u="safari"in window,l=(navigator.userAgent.match(/(crios)|(fxios)/i),!!navigator.platform.match(/iPhone|iPad|iPod/)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1),d=(navigator.userAgent.match(/android/i),navigator.userAgent.toLowerCase().indexOf("firefox"),window.AudioContext||window.webkitAudioContext);function h(e,t=100){return new Promise(((r,n)=>{setTimeout((()=>n(new Error("timeout"))),t),e.then(r,n)}))}class m{constructor(e){this.emulationService=e,this.initialize=()=>this.mutex.runExclusive((()=>t(this,void 0,void 0,(function*(){if(!this.initialized){try{this.context=new d}catch(e){return console.error(e),void console.error("web audio not available")}try{this.context.destination.channelCount=1}catch(e){console.warn("audio driver: failed to set channel count")}try{yield this.start()}catch(e){return console.error(e),void console.error("failed to initialize audio context")}this.context.addEventListener("statechange",(()=>{var e;"interrupted"===(null===(e=this.context)||void 0===e?void 0:e.state)&&this.updateState()})),this.gainNode=this.context.createGain(),this.gainNode.channelCount=1,this.gainNode.channelInterpretation="speakers",this.gainNode.gain.value=this.gain(),this.gainNode.connect(this.context.destination),this.applyPwmUpdate(),this.initialized=!0}})))),this.updateState=(e=!1)=>this.mutex.runExclusive((()=>t(this,void 0,void 0,(function*(){if(!this.context)return;if(this.isRunning()===this.shouldRun())return;e||this.isRunning()||!this.shouldRun()||this.applyPwmUpdate();const t=this.context.state;if(this.shouldRun())try{this.updateGain(),yield h(this.context.resume()),console.log("resume audio context")}catch(e){console.error(`failed to resume audio from state ${t}`)}else try{yield h(this.context.suspend()),console.log("suspend audio context")}catch(e){console.error(`failed to suspend audio from state ${t}`)}console.log(`audio context state change ${t} -> ${this.context.state}`)})))),this.onPwmUpdate=e=>t(this,void 0,void 0,(function*(){this.pendingPwmUpdate=e,this.initialized&&(this.shouldRun()!==this.isRunning()&&this.updateState(!0),this.shouldRun()&&this.applyPwmUpdate())})),this.mutex=new p,this.initialized=!1,this.muted=!1,this.emulationService.pwmUpdateEvent.addHandler(this.onPwmUpdate),this.emulationService.emulationStateChangeEvent.addHandler((()=>this.updateState())),this.emulationService.powerOffChangeEvent.addHandler((()=>this.updateState())),l||document.addEventListener("visibilitychange",(()=>this.updateState()))}isInitialized(){return this.initialized}mute(e){this.muted=e,this.updateState()}isMuted(){return this.muted}shouldRun(){return this.emulationService.isRunning()&&!this.emulationService.isPowerOff()&&!this.muted&&this.gain()>0&&("hidden"!==document.visibilityState||l||this.runHidden())}updateGain(){this.gainNode&&(this.gainNode.gain.value=this.gain())}start(){return t(this,void 0,void 0,(function*(){this.context&&(yield h(this.context.resume()),this.updateState(),console.log("audio context initialized"))}))}isRunning(){var e;return"running"===(null===(e=this.context)||void 0===e?void 0:e.state)}applyPwmUpdate(){if(!this.context||!this.pendingPwmUpdate)return;const{frequency:e,dutyCycle:t}=this.pendingPwmUpdate,r=this.context.sampleRate;if(this.pendingPwmUpdate=void 0,e<=0||t<=0||e>=r)return void this.disconnectSource();const n=this.context.createBuffer(1,Math.round(r/e),r),i=n.getChannelData(0);for(let e=0;e<i.length;e++)i[e]=e/i.length<t?1:0;const o=this.context.createBufferSource();o.channelCount=1,o.channelInterpretation="speakers",o.loop=!0,o.buffer=n,this.disconnectSource(),o.connect(this.gainNode),o.start(),this.bufferSourceNode=o,this.pendingPwmUpdate=void 0}disconnectSource(){this.bufferSourceNode&&(this.bufferSourceNode.stop(),this.bufferSourceNode.disconnect(),this.bufferSourceNode=void 0)}gain(){return this.getVolume()/2}}class _ extends m{constructor(){super(...arguments),this.volume=.5}setVolume(e){this.volume=Math.max(Math.min(e,1),0),this.updateGain()}getVolume(){return this.volume}runHidden(){return!1}}function f(e,r){let n,i;const o=document.createElement("canvas");return(s,a)=>t(this,void 0,void 0,(function*(){if(n===s&&i===a)return o;o.width=s,o.height=a;const t=o.getContext("2d");if(!t)throw new Error("get a new browser");return t.drawImage(yield e,0,0,o.width,o.height),(u||l)&&(yield r).indexOf("data:image")>=0&&(yield new Promise((e=>setTimeout(e,0))),t.drawImage(yield e,0,0,o.width,o.height)),n=s,i=a,o}))}function y(e){return new Promise(((t,r)=>{const n=new Image;n.onload=()=>t(n),n.onerror=()=>r(),n.src=e}))}const v=e=>`data:image/svg+xml;base64,${btoa(e)}`;var g,b;function w(e){switch(e){case i.i710:case i.m520:return{screenSize:1,width:320,height:320,silkscreenHeight:120};case i.handera330:case i.handera330c:case i.lp168:return{screenSize:2,width:240,height:320,silkscreenHeight:0};case i.pegS300:case i.pegS320:case i.pegS500c:return{screenSize:0,width:160,height:160,silkscreenHeight:76};case i.pegT600c:case i.pegT400:case i.pegT650c:return{screenSize:1,width:320,height:320,silkscreenHeight:140,silkscreenOvershoot:10};case i.pegN600c:case i.pegN700c:return{screenSize:1,width:320,height:320,silkscreenHeight:120};case i.pegNR70:return{screenSize:3,width:320,height:480,silkscreenHeight:0};case i.acerS11:return{screenSize:0,width:160,height:160,silkscreenHeight:60,siklscreenShift:8};default:return{screenSize:0,width:160,height:160,silkscreenHeight:60}}}function S(e){switch(e){case i.pilot:case i.palmPilot:case i.iii:case i.palmV:case i.palmVx:case i.iiix:case i.iiixe:case i.iiie:case i.m100:case i.m105:case i.m125:case i.m500:case i.palmVII:case i.palmVIIEZ:case i.palmVIIx:case i.i705:case i.handera330:case i.pegS300:case i.pegS320:case i.pegT400:case i.acerS11:return!1;default:return!0}}(b=g||(g={})).sdcard="sdcard",b.memorystick="memorystick",b.none="none";var C=r(819);const E=[135,135,105],I=[0,0,0],D=new Array(16).fill(0).map(((e,t)=>I.map(((e,r)=>Math.floor((t*e+(15-t)*E[r])/15))))).map((([e,t,r])=>4278190080|r<<16|t<<8|e)),k=D.map((e=>{var t;return"#"+(null===(t=(16777215&e).toString(16).padStart(6,"0").match(/(..?)/g))||void 0===t?void 0:t.reverse().join(""))})),G=i.m515,M=k[2],P=k[0],x="rgba(0,0,0,0.2)";function R(e){const t=w(e),r=(0===t.screenSize?3:2)*devicePixelRatio,n={frameDevice:1,frameCanvas:r},i=e=>({frameDevice:e,frameCanvas:e*r}),o=e=>({frameDevice:e,frameCanvas:n.frameCanvas+e*r}),s=t.silkscreenHeight>0?i(1):i(0),a=i(function(e){switch(e){case 3:case 1:return 60;case 2:return 45;default:return 30}}(t.screenSize));return{scale:r,borderWidth:n,height:i(2*n.frameDevice+t.height+s.frameDevice+t.silkscreenHeight+a.frameDevice),width:i(2*n.frameDevice+t.width),screenHeight:i(t.height),screenWidth:i(t.width),screenLeft:o(0),screenTop:o(0),screenBottom:o(t.height),separatorHeight:s,silkscreenHeight:i(t.silkscreenHeight),silkscreenTop:o(t.height+s.frameDevice),silkscreenBottom:o(t.height+s.frameDevice+t.silkscreenHeight),softSilkscreenHeight:i(t.silkscreenHeight>0?0:t.height-t.width),buttonHeight:a,buttonWidth:a,buttonTop:o(t.height+s.frameDevice+t.silkscreenHeight),buttonBottom:o(t.height+s.frameDevice+t.silkscreenHeight+a.frameDevice)}}class z{constructor(e){this.skinLoader=e,this.layout=R(G),this.onResize=new C.j}get width(){switch(this.getOrientation()){case o.portrait:case o.portrait180:case void 0:return this.layout.width.frameCanvas;default:return this.layout.height.frameCanvas}}get height(){switch(this.getOrientation()){case o.portrait:case o.portrait180:case void 0:return this.layout.height.frameCanvas;default:return this.layout.width.frameCanvas}}updateEmulationCanvas(e){this.drawEmulationCanvas(e),this.onAfterUpdateCanvas()}eventToPalmCoordinates(e,t=!1){if(!this.ctx)return;const r=this.ctx.canvas.getBoundingClientRect();let n,i,s,a;r.width/r.height>this.width/this.height?(a=r.height,s=this.width/this.height*r.height,i=r.top,n=r.left+(r.width-s)/2):(s=r.width,a=this.height/this.width*r.width,n=r.left,i=r.top+(r.height-a)/2);let c=(e.clientX-n)/s*this.width/this.layout.scale,p=(e.clientY-i)/a*this.height/this.layout.scale;switch(this.getOrientation()){case o.landscape90:{const e=p;p=this.layout.height.frameDevice-c,c=e;break}case o.landscape270:{const e=p;p=c,c=this.layout.width.frameDevice-e;break}case o.portrait180:c=this.layout.width.frameDevice-c,p=this.layout.height.frameDevice-p}c-=this.layout.borderWidth.frameDevice,p-=this.layout.borderWidth.frameDevice,p>=this.layout.screenHeight.frameDevice&&(p<=this.layout.screenHeight.frameDevice+this.layout.separatorHeight.frameDevice?p=this.layout.screenHeight.frameDevice:p-=this.layout.separatorHeight.frameDevice);const u=this.layout.screenHeight.frameDevice+this.layout.silkscreenHeight.frameDevice+this.layout.buttonHeight.frameDevice;if(t)c<0&&(c=0),c>=this.layout.screenWidth.frameDevice&&(c=this.layout.screenWidth.frameDevice-1),p<0&&(p=0),p>=u&&(p=u-1);else if(c<0||c>=this.layout.screenWidth.frameDevice||p<0||p>=u)return;return[c,p]}isSilkscreen(e){const[,t]=e;return!this.isButtons(e)&&t>=this.layout.screenHeight.frameDevice}isButtons([,e]){return e>=this.layout.screenHeight.frameDevice+this.layout.silkscreenHeight.frameDevice}determineButton([e,t]){return e>=this.layout.screenWidth.frameDevice-this.layout.buttonWidth.frameDevice?3:e>=this.layout.screenWidth.frameDevice-2*this.layout.buttonWidth.frameDevice?2:e>=2*this.layout.buttonWidth.frameDevice?t>=this.layout.screenHeight.frameDevice+this.layout.silkscreenHeight.frameDevice+this.layout.buttonHeight.frameDevice/2?5:4:e>=this.layout.buttonWidth.frameDevice?1:0}initWithCanvas(e){var r;return void 0===e&&(e=null===(r=this.ctx)||void 0===r?void 0:r.canvas),t(this,void 0,void 0,(function*(){if(!e)return;this.layout=R(this.getDeviceId()),this.onResize.dispatch(),e.width=this.width,e.height=this.height;const t=e.getContext("2d");if(!t)throw new Error("canvas not supported - get a new browser");this.ctx=t,this.setupTransformation(),this.fillCanvasRect(0,0,this.layout.width.frameCanvas,this.layout.height.frameCanvas,this.frameColor()),this.fillRect(0,0,this.layout.screenWidth.frameDevice,this.layout.screenHeight.frameDevice+this.layout.silkscreenHeight.frameDevice+this.layout.separatorHeight.frameDevice+this.layout.buttonHeight.frameDevice,this.backgroundColor()),this.drawEmulationCanvas(),yield Promise.all([this.drawSilkscreen(),this.drawButtons()])}))}drawButtons(e=[]){return t(this,void 0,void 0,(function*(){this.ctx&&(this.setupTransformation(),this.ctx.imageSmoothingEnabled=!0,this.ctx.imageSmoothingQuality="high",this.ctx.drawImage(yield this.buttonsImage()(this.layout.screenWidth.frameCanvas,this.layout.buttonHeight.frameCanvas),this.layout.screenLeft.frameCanvas,this.layout.buttonTop.frameCanvas,this.layout.screenWidth.frameCanvas,this.layout.buttonHeight.frameCanvas),e.includes(0)&&this.fillRect(0,this.layout.buttonTop.frameDevice,this.layout.buttonWidth.frameDevice,this.layout.buttonHeight.frameDevice,x),e.includes(1)&&this.fillRect(this.layout.buttonWidth.frameDevice,this.layout.buttonTop.frameDevice,this.layout.buttonWidth.frameDevice,this.layout.buttonHeight.frameDevice,x),e.includes(2)&&this.fillRect(this.layout.screenWidth.frameDevice-2*this.layout.buttonWidth.frameDevice,this.layout.buttonTop.frameDevice,this.layout.buttonWidth.frameDevice,this.layout.buttonHeight.frameDevice,x),e.includes(3)&&this.fillRect(this.layout.screenWidth.frameDevice-this.layout.buttonWidth.frameDevice,this.layout.buttonTop.frameDevice,this.layout.buttonWidth.frameDevice,this.layout.buttonHeight.frameDevice,x),e.includes(4)&&this.fillRect(2*this.layout.buttonWidth.frameDevice,this.layout.buttonTop.frameDevice,this.layout.screenWidth.frameDevice-4*this.layout.buttonWidth.frameDevice,this.layout.buttonHeight.frameDevice/2,x),e.includes(5)&&this.fillRect(2*this.layout.buttonWidth.frameDevice,this.layout.buttonTop.frameDevice+this.layout.buttonHeight.frameDevice/2,this.layout.screenWidth.frameDevice-4*this.layout.buttonWidth.frameDevice,this.layout.buttonHeight.frameDevice/2,x))}))}onAfterUpdateCanvas(){}setupTransformation(){var e;if(this.ctx)switch(null===(e=this.ctx)||void 0===e||e.resetTransform(),this.getOrientation()){case o.portrait:case void 0:break;case o.landscape90:this.ctx.translate(this.layout.height.frameCanvas,0),this.ctx.rotate(Math.PI/2);break;case o.landscape270:this.ctx.translate(0,this.layout.width.frameCanvas),this.ctx.rotate(3*Math.PI/2);break;case o.portrait180:this.ctx.translate(this.layout.width.frameCanvas,this.layout.height.frameCanvas),this.ctx.rotate(Math.PI)}}drawSilkscreen(){return t(this,void 0,void 0,(function*(){0!==this.layout.silkscreenHeight.frameCanvas&&this.ctx&&(this.setupTransformation(),this.fillRect(this.layout.screenLeft.frameDevice,this.layout.silkscreenTop.frameDevice,this.layout.screenWidth.frameDevice,this.layout.silkscreenHeight.frameDevice,M),this.ctx.imageSmoothingEnabled=!0,this.ctx.imageSmoothingQuality="high",this.ctx.drawImage(yield this.silkscreenImage()(this.layout.screenWidth.frameCanvas,this.layout.silkscreenHeight.frameCanvas),this.layout.borderWidth.frameCanvas,this.layout.silkscreenTop.frameCanvas,this.layout.screenWidth.frameCanvas,this.layout.silkscreenHeight.frameCanvas))}))}drawEmulationCanvas(e=this.lastEmulationCanvas){e&&this.ctx&&(this.lastEmulationCanvas=e,this.ctx.imageSmoothingEnabled=!1,this.ctx.drawImage(e,this.layout.screenLeft.frameCanvas,this.layout.screenTop.frameCanvas,this.layout.screenWidth.frameCanvas,this.layout.screenHeight.frameCanvas))}fillRect(e,t,r,n,i){this.ctx&&(this.ctx.beginPath(),this.ctx.rect(this.layout.borderWidth.frameCanvas+this.layout.scale*e,this.layout.borderWidth.frameCanvas+this.layout.scale*t,this.layout.scale*r,this.layout.scale*n),this.ctx.fillStyle=i,this.ctx.fill())}fillCanvasRect(e,t,r,n,i){this.ctx&&(this.ctx.beginPath(),this.ctx.rect(e,t,r,n),this.ctx.fillStyle=i,this.ctx.fill())}silkscreenImage(){return this.skinLoader.loadSkinElement(this.silkscreenSkinElement())}silkscreenSkinElement(){switch(this.getDeviceId()){case i.pegT600c:case i.pegT650c:return"silkscreen/clie-t600.svg";case i.pegN700c:case i.pegN600c:return"silkscreen/clie-n610.svg";case i.pegS320:case i.pegS300:return"silkscreen/clie-s300.svg";case i.pegS500c:return"silkscreen/clie-s500.svg";case i.pegT400:return"silkscreen/clie-t415.svg";case i.acerS11:return"silkscreen/acer-s10.svg";case i.palmPilot:case i.pilot:case i.iii:case i.palmVII:return"silkscreen/pilot.svg";case i.m500:return"silkscreen/m500.svg";case i.m505:case i.m515:case i.m520:return"silkscreen/m515.svg";case i.iiic:return"silkscreen/iiic.svg";case i.m100:case i.m105:case i.m125:return"silkscreen/m100.svg";case i.m130:return"silkscreen/m130.svg";case i.i710:return"silkscreen/tungstenw.svg";case i.i705:return"silkscreen/i705.svg";case i.iiic:case i.iiix:case i.iiixe:case i.palmVx:case i.palmV:case i.palmVIIEZ:case i.palmVIIx:default:return"silkscreen/v.svg"}}buttonsImage(){return this.skinLoader.loadSkinElement(this.buttonsSkinElement())}buttonsSkinElement(){switch(this.getDeviceId()){case i.acerS11:return"hard-buttons/acer-s10.svg";case i.pegNR70:return"hard-buttons/clie-nr70.svg";case i.pegN700c:return"hard-buttons/clie-n700.svg";case i.pegN600c:return"hard-buttons/clie-n610.svg";case i.pegS300:return"hard-buttons/clie-s300.svg";case i.pegS500c:return"hard-buttons/clie-s500.svg";case i.pegS320:return"hard-buttons/clie-s320.svg";case i.pegT400:case i.pegT600c:case i.pegT650c:return"hard-buttons/clie-t415.svg";case i.pilot:case i.palmPilot:return"hard-buttons/pilot.svg";case i.m500:return"hard-buttons/m500.svg";case i.m505:case i.m515:case i.m520:return"hard-buttons/m515.svg";case i.iiic:return"hard-buttons/iiic.svg";case i.m100:case i.m105:return"hard-buttons/m100.svg";case i.m125:return"hard-buttons/m125.svg";case i.m130:return"hard-buttons/m130.svg";case i.i710:return"hard-buttons/tungstenw.svg";case i.iii:case i.iiix:case i.iiixe:case i.palmVII:case i.palmVIIEZ:case i.palmVIIx:return"hard-buttons/iiix.svg";case i.iiie:return"hard-buttons/iiie.svg";case i.i705:return"hard-buttons/i705.svg";case i.handera330:return"hard-buttons/handera330.svg";case i.handera330c:return"hard-buttons/handera330c.svg";case i.lp168:return"hard-buttons/lp168.svg";case i.palmVx:case i.palmV:default:return"hard-buttons/v.svg"}}backgroundColor(){return S(this.getDeviceId())?"white":P}frameColor(){return S(this.getDeviceId())?"white":"#ccc"}}const F='<svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><title>Game Controller</title><path d="M467.51 248.83c-18.4-83.18-45.69-136.24-89.43-149.17A91.5 91.5 0 00352 96c-26.89 0-48.11 16-96 16s-69.15-16-96-16a99.09 99.09 0 00-27.2 3.66C89 112.59 61.94 165.7 43.33 248.83c-19 84.91-15.56 152 21.58 164.88 26 9 49.25-9.61 71.27-37 25-31.2 55.79-40.8 119.82-40.8s93.62 9.6 118.66 40.8c22 27.41 46.11 45.79 71.42 37.16 41.02-14.01 40.44-79.13 21.43-165.04z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"/><circle cx="292" cy="224" r="20"/><path d="M336 288a20 20 0 1120-19.95A20 20 0 01336 288z"/><circle cx="336" cy="180" r="20"/><circle cx="380" cy="224" r="20"/><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M160 176v96M208 224h-96"/></svg>',A=f(y(v(F)),F);class N extends z{constructor(){super(...arguments),this.deviceId=i.m515,this.orientation=o.portrait,this.gameModeIndicatorEnabled=!0,this.gameModeActive=!1,this.lastActiveButtons=void 0}initialize(e,r=this.deviceId,n=this.orientation){var i;return t(this,void 0,void 0,(function*(){this.deviceId=r,this.orientation=n;const t=e||(null===(i=this.ctx)||void 0===i?void 0:i.canvas);t&&(t.width=this.width,t.height=this.height,t.style.objectFit="contain"),yield this.initWithCanvas(e)}))}updateOrientation(e){this.orientation=e,this.initialize()}toggleGameModeIndicator(e){this.gameModeActive=e,this.drawButtons(this.lastActiveButtons)}setGameModeIndicatorEnabled(e){this.gameModeIndicatorEnabled=e,this.drawButtons(this.lastActiveButtons)}isGameModeIndicatorEnabled(){return this.gameModeIndicatorEnabled}getCanvas(){var e;return null===(e=this.ctx)||void 0===e?void 0:e.canvas}drawButtons(e=[]){const r=Object.create(null,{drawButtons:{get:()=>super.drawButtons}});return t(this,void 0,void 0,(function*(){this.lastActiveButtons=e,yield r.drawButtons.call(this,e),this.gameModeActive&&this.gameModeIndicatorEnabled&&(yield this.drawGameModeIndicator())}))}getDeviceId(){return this.deviceId}getOrientation(){return this.orientation}drawGameModeIndicator(){return t(this,void 0,void 0,(function*(){if(!this.ctx)return;const e=Math.floor(.1*this.layout.screenWidth.frameCanvas),t=Math.floor(.8*e),r=Math.floor(.1*e),n=Math.floor(.11*e);this.fillCanvasRect(this.layout.screenLeft.frameCanvas-r+this.layout.screenWidth.frameCanvas-e,this.layout.buttonTop.frameCanvas+this.layout.buttonHeight.frameCanvas-e-r,e,e,"rgba(200, 200, 200, 0.7)"),this.ctx.drawImage(yield A(e,e),this.layout.screenLeft.frameCanvas+this.layout.screenWidth.frameCanvas-r-e+n,this.layout.buttonTop.frameCanvas+this.layout.buttonHeight.frameCanvas-e-r+n,t,t)}))}}var H=r(650);const T=((e,t)=>{let r=null;return()=>{if(null!==r)return r;const e=new Blob(['(()=>{"use strict";const e=new Map,t=new Map,r=(e,t)=>{let r,o;const i=performance.now();r=i,o=e-Math.max(0,i-t);return{expected:r+o,remainingDelay:o}},o=(e,t,r,i)=>{const s=performance.now();s>r?postMessage({id:null,method:"call",params:{timerId:t,timerType:i}}):e.set(t,setTimeout(o,r-s,e,t,r,i))};addEventListener("message",(i=>{let{data:s}=i;try{if("clear"===s.method){const{id:r,params:{timerId:o,timerType:i}}=s;if("interval"===i)(t=>{const r=e.get(t);if(void 0===r)throw new Error(\'There is no interval scheduled with the given id "\'.concat(t,\'".\'));clearTimeout(r),e.delete(t)})(o),postMessage({error:null,id:r});else{if("timeout"!==i)throw new Error(\'The given type "\'.concat(i,\'" is not supported\'));(e=>{const r=t.get(e);if(void 0===r)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(r),t.delete(e)})(o),postMessage({error:null,id:r})}}else{if("set"!==s.method)throw new Error(\'The given method "\'.concat(s.method,\'" is not supported\'));{const{params:{delay:i,now:n,timerId:a,timerType:d}}=s;if("interval"===d)((t,i,s)=>{const{expected:n,remainingDelay:a}=r(t,s);e.set(i,setTimeout(o,a,e,i,n,"interval"))})(i,a,n);else{if("timeout"!==d)throw new Error(\'The given type "\'.concat(d,\'" is not supported\'));((e,i,s)=>{const{expected:n,remainingDelay:a}=r(e,s);t.set(i,setTimeout(o,a,t,i,n,"timeout"))})(i,a,n)}}}}catch(e){postMessage({error:{message:e.message},id:s.id,result:null})}}))})();'],{type:"application/javascript; charset=utf-8"}),t=URL.createObjectURL(e);return r=(e=>{const t=new Map([[0,()=>{}]]),r=new Map([[0,()=>{}]]),n=new Map,i=new Worker(e);return i.addEventListener("message",(({data:e})=>{if(void 0!==(i=e).method&&"call"===i.method){const{params:{timerId:i,timerType:o}}=e;if("interval"===o){const e=t.get(i);if("number"==typeof e){const t=n.get(e);if(void 0===t||t.timerId!==i||t.timerType!==o)throw new Error("The timer is in an undefined state.")}else{if(void 0===e)throw new Error("The timer is in an undefined state.");e()}}else if("timeout"===o){const e=r.get(i);if("number"==typeof e){const t=n.get(e);if(void 0===t||t.timerId!==i||t.timerType!==o)throw new Error("The timer is in an undefined state.")}else{if(void 0===e)throw new Error("The timer is in an undefined state.");e(),r.delete(i)}}}else{if(!(e=>null===e.error&&"number"==typeof e.id)(e)){const{error:{message:t}}=e;throw new Error(t)}{const{id:i}=e,o=n.get(i);if(void 0===o)throw new Error("The timer is in an undefined state.");const{timerId:s,timerType:a}=o;n.delete(i),"interval"===a?t.delete(s):r.delete(s)}}var i})),{clearInterval:e=>{const r=(0,H.generateUniqueNumber)(n);n.set(r,{timerId:e,timerType:"interval"}),t.set(e,r),i.postMessage({id:r,method:"clear",params:{timerId:e,timerType:"interval"}})},clearTimeout:e=>{const t=(0,H.generateUniqueNumber)(n);n.set(t,{timerId:e,timerType:"timeout"}),r.set(e,t),i.postMessage({id:t,method:"clear",params:{timerId:e,timerType:"timeout"}})},setInterval:(e,r)=>{const n=(0,H.generateUniqueNumber)(t);return t.set(n,(()=>{e(),"function"==typeof t.get(n)&&i.postMessage({id:null,method:"set",params:{delay:r,now:performance.now(),timerId:n,timerType:"interval"}})})),i.postMessage({id:null,method:"set",params:{delay:r,now:performance.now(),timerId:n,timerType:"interval"}}),n},setTimeout:(e,t)=>{const n=(0,H.generateUniqueNumber)(r);return r.set(n,e),i.postMessage({id:null,method:"set",params:{delay:t,now:performance.now(),timerId:n,timerType:"timeout"}}),n}}})(t),setTimeout((()=>URL.revokeObjectURL(t))),r}})();var L;!function(e){e[e.animationFrame=0]="animationFrame",e[e.timeout=1]="timeout"}(L||(L={}));class B{constructor(e){this.callback=e}schedule(){void 0===this.handle&&(this.handle=requestAnimationFrame((e=>{this.handle=void 0,this.callback(e)})))}cancel(){void 0!==this.handle&&(cancelAnimationFrame(this.handle),this.handle=void 0)}isScheduled(){return void 0!==this.handle}getKind(){return L.animationFrame}}class U{constructor(e,t=60){this.callback=e,this.fps=t}schedule(){if(void 0!==this.handle)return;const e=performance.now(),t=1e3*Math.ceil(e/1e3*this.fps)/this.fps;var r,n;this.handle=(r=()=>{this.handle=void 0,this.callback(performance.now())},n=Math.max(t-e,0),T().setTimeout(r,n))}cancel(){var e;void 0!==this.handle&&(e=this.handle,T().clearTimeout(e),this.handle=void 0)}isScheduled(){return void 0!==this.handle}getKind(){return L.timeout}}class j{constructor(e,t){this.queue=new Array(e).fill(0),this.reset(t)}reset(e=0){this.next=1,this.size=1,this.queue[0]=e}push(e){return this.queue[this.next]=e,this.next=(this.next+1)%this.queue.length,this.size<this.queue.length&&this.size++,this}calculateAverage(){let e=0;for(let t=0;t<this.size;t++)e+=this.queue[t];return e/this.size}}class O{constructor(e){this.start=0,this.size=0,this.buffer=new Array(e)}push(e){return this.size<this.buffer.length?this.buffer[(this.start+this.size++)%this.buffer.length]=e:(this.start=(this.start+1)%this.buffer.length,this.buffer[(this.start+this.size-1)%this.buffer.length]=e),this}pop(){if(0===this.size)return;const e=this.buffer[this.start];return this.start=(this.start+1)%this.buffer.length,this.size--,e}peekLast(){if(0!==this.size)return this.buffer[(this.start+this.size-1)%this.buffer.length]}replaceLast(e){return this.size>0&&(this.buffer[(this.start+this.size-1)%this.buffer.length]=e),this}count(){return this.size}flush(){return this.start=0,this.size=0,this}}class W{constructor(){this.onPwmUpdate=e=>{this.pendingPwmUpdates.count()>0&&this.pendingPwmUpdates.peekLast().frequency<0?this.pendingPwmUpdates.replaceLast(e):this.pendingPwmUpdates.push(e)},this.advanceEmulation=e=>{if(this.isDirty=!1,!this.cloudpilotInstance||this.hasFatalError()||e<this.clockEmulator)return;const t=this.cloudpilotInstance.isSuspended();let r=!1;this.cloudpilotInstance.setClockFactor(this.emulationSpeed*this.getConfiguredSpeed()),e-this.clockEmulator>1e3/30&&(this.clockEmulator=e-1e3/30);const n=(e-this.clockEmulator)/1e3*this.cloudpilotInstance.cyclesPerSecond(),i=performance.now();let o=0;for(;o<n;)if(o+=this.cloudpilotInstance.runEmulation(Math.ceil(n-o)),this.cloudpilotInstance.isSuspended()){r=!0;break}const s=o/this.cloudpilotInstance.cyclesPerSecond()*1e3,a=performance.now()-i;if(this.clockEmulator+=Math.max(s,a),this.speedAverage.push(s/(a>0?a:s/1e3)*this.emulationSpeed),this.updateEmulationSpeed(this.speedAverage.calculateAverage()),r&&!t)return void this.handleSuspend();const c=this.cloudpilotInstance.isPowerOff(),p=this.cloudpilotInstance.isUiInitialized();if(c!==this.powerOff||p!==this.uiInitialized){const e=this.powerOff;this.powerOff=c,this.uiInitialized=p,e!==this.powerOff&&this.powerOffChangeEvent.dispatch(this.powerOff),this.isDirty=!0}p&&!c&&this.manageHotsyncName()&&this.checkAndUpdateHotsyncName(),this.onAfterAdvanceEmulation(e,o)},this.newFrameEvent=new C.j,this.pwmUpdateEvent=new C.j,this.emulationStateChangeEvent=new C.j,this.powerOffChangeEvent=new C.j,this.deviceId=i.m515,this.clockEmulator=0,this.scheduler=new B((e=>this.onSchedule(e))),this.canvas=document.createElement("canvas"),this.canvasTmp=document.createElement("canvas"),this.lastPenUpdate=0,this.penDown=!1,this.running=!1,this.powerOff=!1,this.uiInitialized=!1,this.pendingPwmUpdates=new O(10),this.lastPwmUpdateEvent=0,this.emulationSpeed=1,this.speedAverage=new j(20),this.timePerFrameAverage=new j(60),this.timestampLastFrame=0,this.frameCounter=0,this.isDirty=!1}handlePointerMove(e,t,r){if(!this.handleInput())return;const n=performance.now();if(this.penDown=!0,!(n-this.lastPenUpdate<25)&&this.cloudpilotInstance){if(r){const r=w(this.deviceId);e=this.transformSilkscreenX(e,r),t=this.transformSilkscreenY(t,r)}this.cloudpilotInstance.queuePenMove(Math.floor(e),Math.floor(t)),this.lastPenUpdate=n}}handlePointerUp(){this.handleInput()&&(this.cloudpilotInstance&&this.penDown&&this.cloudpilotInstance.queuePenUp(),this.lastPenUpdate=0,this.penDown=!1)}handleButtonDown(e){this.handleInput()&&this.cloudpilotInstance&&this.cloudpilotInstance.queueButtonDown(e)}handleButtonUp(e){this.handleInput()&&this.cloudpilotInstance&&this.cloudpilotInstance.queueButtonUp(e)}handleKeyDown(e,t=!1){this.handleInput()&&this.cloudpilotInstance&&this.cloudpilotInstance.queueKeyboardEvent(e,t)}reset(){this.cloudpilotInstance&&this.cloudpilotInstance.reset()}resetNoExtensions(){this.cloudpilotInstance&&this.cloudpilotInstance.resetNoExtensions()}resetHard(){this.cloudpilotInstance&&this.cloudpilotInstance.resetHard()}isRunning(){return this.running}isPowerOff(){return this.powerOff}isUiInitialized(){return this.uiInitialized}getCanvas(){return this.canvas}getStatistics(){return{hostSpeed:this.speedAverage.calculateAverage(),emulationSpeed:this.emulationSpeed,averageFps:this.calculateFPS()}}getEmulationSpeed(){return this.emulationSpeed}isSuspended(){return!!this.cloudpilotInstance&&this.cloudpilotInstance.isSuspended()}onAfterAdvanceEmulation(e,t){}handleSuspend(){}callScheduler(){this.scheduler.schedule()}handleInput(){return!0}openSession(e,t,r,n,i){let o=!1;return!!e.initializeSession(t,r)&&(n&&(n.length%4!=0?console.warn("memory size is not a multiple of 4; ignoring image"):(o=e.loadMemory(new Uint32Array(n.buffer,n.byteOffset,n.length>>>2)),o||console.warn("failed to load memory"))),o&&i&&e.loadState(i),e.remountCards(),this.cloudpilotInstance&&this.cloudpilotInstance.pwmUpdateEvent.removeHandler(this.onPwmUpdate),e.pwmUpdateEvent.addHandler(this.onPwmUpdate),this.cloudpilotInstance=e,this.deviceId=r,this.resetCanvas(),this.pendingPwmUpdates.flush(),this.lastPwmUpdateEvent=0,this.deviceHotsyncName=void 0,this.emulationSpeed=1,this.frameCounter=0,this.speedAverage.reset(1),this.powerOff=e.isPowerOff(),this.uiInitialized=e.isUiInitialized(),this.frameCounter=0,!0)}resetCanvas(){const e=w(this.deviceId);this.canvas.width=this.canvasTmp.width=e.width,this.canvas.height=this.canvasTmp.height=e.height;const t=this.canvas.getContext("2d");if(!t)throw new Error("get a new browser");this.context=t;const r=this.canvasTmp.getContext("2d");if(!r)throw new Error("get a new browser");this.contextTmp=r,this.clearCanvas(),this.imageData=void 0}doResume(){this.cloudpilotInstance&&(this.clockEmulator=performance.now(),this.schedule(),this.setRunning(!0),this.resetFPS())}doPause(){this.stopLoop()}doStop(){this.stopLoop()}stopLoop(){this.running&&(this.scheduler.cancel(),void 0!==this.advanceEmulationHandle&&(window.clearTimeout(this.advanceEmulationHandle),this.advanceEmulationHandle=void 0),this.setRunning(!1))}resetFPS(){this.timePerFrameAverage.reset(),this.timestampLastFrame=performance.now()}calculateFPS(){const e=this.timePerFrameAverage.calculateAverage();return e&&1e3/e}transformSilkscreenX(e,t){if(void 0===t.silkscreenOvershoot)return e;const r=t.width/(t.width+2*t.silkscreenOvershoot);return(e-t.width/2)/r+t.width/2}transformSilkscreenY(e,t){return void 0===t.siklscreenShift?e:e+t.siklscreenShift}setRunning(e){e!==this.running&&(this.running=e,this.emulationStateChangeEvent.dispatch(e))}updateEmulationSpeed(e){if(e>=1&&this.emulationSpeed>=1)return;const t=Math.min(Math.max(Math.floor(10*e)/10,.1),1);t<=this.emulationSpeed?this.emulationSpeed=t:this.emulationSpeed=e-t>=.05?t:this.emulationSpeed}performScreenUpdate(){var e;(null===(e=this.cloudpilotInstance)||void 0===e?void 0:e.isScreenDirty())&&(this.updateScreen(),this.cloudpilotInstance.markScreenClean(),this.frameCounter++)}onSchedule(e){this.hasFatalError()||(this.skipEmulationUpdate()||(this.performScreenUpdate(),this.pendingPwmUpdates.count()>0&&e-this.lastPwmUpdateEvent>10&&(this.pwmUpdateEvent.dispatch(this.pendingPwmUpdates.pop()),this.lastPwmUpdateEvent=e),void 0===this.advanceEmulationHandle&&(this.advanceEmulationHandle=window.setTimeout((()=>{this.advanceEmulationHandle=void 0,this.advanceEmulation(e)}),0)),this.timePerFrameAverage.push(Math.max(0,e-this.timestampLastFrame)),this.timestampLastFrame=e),this.schedule())}schedule(){this.scheduler.cancel(),this.getConfiguredSchdedulerKind()!==this.scheduler.getKind()&&(this.scheduler=this.getConfiguredSchdedulerKind()===L.animationFrame?new B((e=>this.onSchedule(e))):new U((e=>this.onSchedule(e)))),this.callScheduler()}checkAndUpdateHotsyncName(){if(!this.cloudpilotInstance)return;void 0===this.deviceHotsyncName&&(this.deviceHotsyncName=this.cloudpilotInstance.getHotsyncName());const e=this.getConfiguredHotsyncName();void 0===e?this.updateConfiguredHotsyncName(this.deviceHotsyncName):e!==this.deviceHotsyncName&&e.length<=40&&this.cloudpilotInstance.isSetupComplete()&&(this.cloudpilotInstance.setHotsyncName(e),this.deviceHotsyncName=e)}clearCanvas(){const e=this.deviceId,t=w(e);this.context.beginPath(),this.context.rect(0,0,t.width,t.height),this.context.fillStyle=S(e)?"white":k[0],this.context.fill()}updateScreen(){if(!this.cloudpilotInstance)return;const e=this.cloudpilotInstance.getFrame();if(this.cloudpilotInstance.isPowerOff())return this.clearCanvas(),void this.newFrameEvent.dispatch(this.canvas);if(!e.hasChanges)return;if(e.lines*e.scaleY===this.canvas.height&&e.lineWidth*e.scaleX===this.canvas.width){this.imageData&&this.imageData.width===e.lineWidth&&this.imageData.height===e.lines||(this.imageData=new ImageData(e.lineWidth,e.lines));const t=new Uint32Array(this.imageData.data.buffer);switch(e.bpp){case 1:{const r=D[15],n=D[0];let i=0;for(let o=e.firstDirtyLine;o<=e.lastDirtyLine;o++){const s=o*e.bytesPerLine;for(let o=e.margin;o<e.lineWidth+e.margin;o++)t[i++]=e.buffer[s+(o>>>3)]&128>>>(7&o)?r:n}break}case 2:{const r=this.cloudpilotInstance.getPalette2bitMapping(),n=[D[15&r],D[r>>>4&15],D[r>>>8&15],D[r>>>12&15]];let i=0;for(let r=e.firstDirtyLine;r<=e.lastDirtyLine;r++){const o=r*e.bytesPerLine;for(let r=e.margin;r<e.lineWidth+e.margin;r++)t[i++]=n[e.buffer[o+(r>>>2)]>>6-2*(3&r)&3]}break}case 4:{let r=0;for(let n=e.firstDirtyLine;n<=e.lastDirtyLine;n++){const i=n*e.bytesPerLine;for(let n=e.margin;n<e.lineWidth+e.margin;n++)t[r++]=D[e.buffer[i+(n>>>1)]>>>4-4*(1&n)&15]}break}case 24:{const r=new Uint32Array(e.buffer.buffer,e.buffer.byteOffset,e.buffer.byteLength>>>2);if(0===e.margin)t.subarray(0,e.lineWidth*(e.lastDirtyLine-e.firstDirtyLine+1)).set(r.subarray(e.firstDirtyLine*e.lineWidth,e.lineWidth*(e.lastDirtyLine+1)));else{let n=0;for(let i=e.firstDirtyLine;i<=e.lastDirtyLine;i++){let o=i*(e.bytesPerLine>>>2)+e.margin;for(let i=0;i<e.lineWidth;i++)t[n++]=r[o++]}}}}}if(!this.imageData)return;const t=1!==e.scaleX||1!==e.scaleY;(t?this.contextTmp:this.context).putImageData(this.imageData,0,e.firstDirtyLine,0,0,e.lineWidth,e.lastDirtyLine-e.firstDirtyLine+1),t&&(this.context.imageSmoothingEnabled=!1,this.context.drawImage(this.canvasTmp,0,e.firstDirtyLine,e.lineWidth,e.lastDirtyLine-e.firstDirtyLine+1,0,e.firstDirtyLine*e.scaleY,e.lineWidth*e.scaleX,(e.lastDirtyLine-e.firstDirtyLine+1)*e.scaleY)),this.newFrameEvent.dispatch(this.canvas)}}class V extends W{constructor(){super(...arguments),this.timesliceEvent=new C.j}pause(){this.doPause()}resume(){this.doResume()}initWithRom(e,t,r,n){return this.isRunning()&&(this.doStop(),this.session=void 0),e.clearExternalStorage(),!!this.openSession(e,t,r)&&(this.session=n,!0)}initWithSessionImage(e,t,r){return this.isRunning()&&(this.doStop(),this.session=void 0),e.clearExternalStorage(),!!this.openSession(e,t.rom,t.deviceId,t.memory,t.savestate)&&(this.session=r,!0)}getSession(){return this.session}forceUpdateHotsyncName(){this.cloudpilotInstance&&this.cloudpilotInstance.isUiInitialized()&&!this.cloudpilotInstance.isPowerOff()&&this.checkAndUpdateHotsyncName()}getConfiguredSpeed(){var e,t;return null!==(t=null===(e=this.session)||void 0===e?void 0:e.speed)&&void 0!==t?t:1}manageHotsyncName(){return!0}getConfiguredHotsyncName(){var e;return null===(e=this.session)||void 0===e?void 0:e.hotsyncName}updateConfiguredHotsyncName(e){this.session&&(this.session.hotsyncName=e)}getConfiguredSchdedulerKind(){var e;return(null===(e=this.session)||void 0===e?void 0:e.runInBackground)?L.timeout:L.animationFrame}hasFatalError(){var e;return!!(null===(e=this.cloudpilotInstance)||void 0===e?void 0:e.hasFatalError())}skipEmulationUpdate(){return!1}onAfterAdvanceEmulation(e,t){this.timesliceEvent.dispatch()}handleInput(){return this.isRunning()}}class q{constructor(e,t){this.emulationService=e,this.canvasDisplayService=t,this.handleMouseDown=e=>{if(0!==e.button)return;const t=this.canvasDisplayService.eventToPalmCoordinates(e);if(!t)return;const r=this.determineArea(t);if(2===r){const e=this.canvasDisplayService.determineButton(t);this.interactionMouse={area:r,buttonPrimary:e},this.handleButtonDown(e)}else this.interactionMouse={area:r},this.emulationService.handlePointerMove(...t,1===r)},this.handleMouseMove=e=>{var t,r;if(!(1&e.buttons&&this.interactionMouse&&2!==(null===(t=this.interactionMouse)||void 0===t?void 0:t.area)))return;const n=this.canvasDisplayService.eventToPalmCoordinates(e,!0);n&&this.emulationService.handlePointerMove(...n,1===(null===(r=this.interactionMouse)||void 0===r?void 0:r.area))},this.handeMouseUp=e=>{if(0!==e.button)return;const t=this.interactionMouse;switch(this.interactionMouse=void 0,null==t?void 0:t.area){case 2:this.handleButtonUp(t.buttonPrimary);break;case 0:case 1:this.emulationService.handlePointerUp()}},this.handleTouchStart=e=>{let t=!1;for(let r=0;r<e.changedTouches.length;r++){const n=e.changedTouches.item(r);if(!n)continue;const i=this.canvasDisplayService.eventToPalmCoordinates(n);if(!i)continue;t=!0;const o=this.determineArea(i);if(2===o){const e=this.canvasDisplayService.determineButton(i);this.interactionsTouch.set(n.identifier,{area:o,buttonPrimary:e}),this.handleButtonDown(e)}else this.interactionsTouch.set(n.identifier,{area:o}),this.emulationService.handlePointerMove(...i,1===o)}t&&!1!==e.cancelable&&e.preventDefault()},this.handleTouchMove=e=>{let t=!1;for(let r=0;r<e.changedTouches.length;r++){const n=e.changedTouches.item(r);if(!n)continue;const i=this.interactionsTouch.get(n.identifier);if(!i)continue;t=!0;const o=i.area;switch(o){case 2:{const e=this.canvasDisplayService.eventToPalmCoordinates(n);if(!e||2!==this.determineArea(e)){this.handleButtonUp(i.buttonSecondary),i.buttonSecondary=void 0;break}const t=this.canvasDisplayService.determineButton(e);t===i.buttonPrimary?(this.handleButtonUp(i.buttonSecondary),i.buttonSecondary=void 0):t!==i.buttonSecondary&&(this.handleButtonUp(i.buttonSecondary),i.buttonSecondary=t,this.handleButtonDown(t));break}case 0:case 1:{const e=this.canvasDisplayService.eventToPalmCoordinates(n,!0);if(!e)continue;this.emulationService.handlePointerMove(...e,1===o);break}default:continue}}t&&!1!==e.cancelable&&e.preventDefault()},this.handleTouchEnd=e=>{let t=!1;for(let r=0;r<e.changedTouches.length;r++){const n=e.changedTouches.item(r);if(!n)continue;const i=this.interactionsTouch.get(n.identifier);switch(i&&(t=!0),this.interactionsTouch.delete(n.identifier),null==i?void 0:i.area){case 2:this.handleButtonUp(i.buttonPrimary),this.handleButtonUp(i.buttonSecondary);break;case 0:case 1:this.emulationService.handlePointerUp()}}t&&!1!==e.cancelable&&e.preventDefault()},this.handleKeyDown=e=>{if(this.emulationService.isSuspended()||!this.enableKeyboardEvents())return;if(this.isToggleGameMode(e))return e.preventDefault(),this.gameMode=!this.gameMode,void this.onToggleGameMode();const t=this.buttonFromEvent(e);if(void 0!==t)return this.handleButtonDown(t),void e.preventDefault();const r=this.keyCodeFromEvent(e);void 0!==r&&(this.emulationService.handleKeyDown(r),e.preventDefault())},this.handleKeyUp=e=>{if(this.emulationService.isSuspended()||!this.enableKeyboardEvents())return;const t=this.buttonFromEvent(e);if(void 0!==t)return this.handleButtonUp(t),void e.preventDefault();if("Control"===e.key){for(const e of this.activeButtons)this.emulationService.handleButtonUp(e);this.activeButtons.clear(),this.canvasDisplayService.drawButtons([])}},this.keyEventTarget=window,this.interactionsTouch=new Map,this.activeButtons=new Set,this.gameMode=!1,this.enableGamemodeHotkey=!0}bind(e,t=window){this.pointerEventTarget&&this.release(),this.pointerEventTarget=e,this.keyEventTarget=t||window,this.addEventListener(e,"mousedown",this.handleMouseDown),this.addEventListener(window,"mouseup",this.handeMouseUp),this.addEventListener(window,"mousemove",this.handleMouseMove),this.addEventListener(e,"touchstart",this.handleTouchStart),this.addEventListener(e,"touchmove",this.handleTouchMove),this.addEventListener(e,"touchend",this.handleTouchEnd),this.addEventListener(e,"touchcancel",this.handleTouchEnd),this.addEventListener(this.keyEventTarget,"keydown",this.handleKeyDown),this.addEventListener(this.keyEventTarget,"keyup",this.handleKeyUp)}release(){if(this.pointerEventTarget){this.removeEventListener(this.pointerEventTarget,"mousedown",this.handleMouseDown),this.removeEventListener(window,"mouseup",this.handeMouseUp),this.removeEventListener(window,"mousemove",this.handleMouseMove),this.removeEventListener(this.pointerEventTarget,"touchstart",this.handleTouchStart),this.removeEventListener(this.pointerEventTarget,"touchmove",this.handleTouchMove),this.removeEventListener(this.pointerEventTarget,"touchend",this.handleTouchEnd),this.removeEventListener(this.pointerEventTarget,"touchcancel",this.handleTouchEnd),this.removeEventListener(this.keyEventTarget,"keydown",this.handleKeyDown),this.removeEventListener(this.keyEventTarget,"keyup",this.handleKeyUp);for(const e of this.activeButtons)this.handleButtonUp(e);this.activeButtons.clear(),this.interactionsTouch.clear(),this.interactionMouse=void 0,this.pointerEventTarget=void 0}}isGameMode(){return this.gameMode}setGameMode(e){this.gameMode=e,this.onToggleGameMode()}setGameModeHotkeyEnabled(e){this.enableGamemodeHotkey=e}isGameModeHotkeyEnabled(){return this.enableGamemodeHotkey}enableKeyboardEvents(){return!0}onToggleGameMode(){}addEventListener(e,t,r,n){e.addEventListener(t,r,n)}removeEventListener(e,t,r,n){e.removeEventListener(t,r,n)}determineArea(e){return this.canvasDisplayService.isButtons(e)?2:this.canvasDisplayService.isSilkscreen(e)?1:0}handleButtonDown(e){this.activeButtons.has(e)||(this.activeButtons.add(e),this.emulationService.handleButtonDown(e),this.canvasDisplayService.drawButtons(Array.from(this.activeButtons.values())))}handleButtonUp(e){void 0!==e&&this.activeButtons.has(e)&&(this.activeButtons.delete(e),this.emulationService.handleButtonUp(e),this.canvasDisplayService.drawButtons(Array.from(this.activeButtons.values())))}isToggleGameMode(e){return this.isGameModeHotkeyEnabled()&&("Shift"===e.key&&e.ctrlKey||"Control"===e.key&&e.shiftKey)}isGameModeActive(e){return!this.gameMode&&e.ctrlKey||this.gameMode&&!e.ctrlKey}buttonFromEvent(e){switch(e.key){case"PageUp":return 4;case"PageDown":return 5}if(this.isGameModeActive(e))switch(e.key){case"w":case"i":case"ArrowUp":return 4;case"s":case"k":case"ArrowDown":return 5;case"a":case"j":case"y":case"z":case"ArrowLeft":return 0;case"q":case"u":case"x":return 1;case"e":case"o":case"c":return 2;case"d":case"l":case"v":case"ArrowRight":return 3}}keyCodeFromEvent(e){if(!this.isGameModeActive(e)){if(1===e.key.length&&e.key.charCodeAt(0)<=255)return e.key.charCodeAt(0);switch(e.key){case"ArrowLeft":return 28;case"ArrowRight":return 29;case"ArrowUp":return 30;case"ArrowDown":return 31;case"Backspace":return 8;case"Tab":return 9;case"Enter":return 10;default:return}}}}class K extends q{constructor(e,t){super(e,t),this.gameModeChangeEvent=new C.j,this.canvasDisplayService=t}onToggleGameMode(){this.canvasDisplayService.toggleGameModeIndicator(this.isGameMode()),this.gameModeChangeEvent.dispatch(this.isGameMode())}}class Y{constructor(e){this.cloudpilot=e,this.images=new Map}loadSkinElement(e){if(this.images.has(e))return this.images.get(e);const t=this.cloudpilot.then((t=>t.loadSkin(e))).then((t=>t?Promise.all([t,y(v(t))]):Promise.reject(new Error(`failed to load skin ${e}`)))),r=f(t.then((([,e])=>e)),t.then((([e])=>e)));return this.images.set(e,r),r}}class Q{constructor(e){this.query=e,this.changeEvent=new C.j,this.last=e()}update(){const e=this.query();e!==this.last&&(this.changeEvent.dispatch(e),this.last=e)}}const $={hotsyncName:void 0,orientation:o.portrait,runInBackground:!1,speed:1,deviceId:i.m515},Z="MEMORY_CARD";class X{constructor(e){this.cloudpilot=e,this.onTimeslice=()=>{this.powerOffWatcher.update(),this.uiInitializedWatcher.update(),this.hotsyncNameWatcher.update()},this.audioInitializedEvent=new C.j,this.session=Object.assign({},$),this.emulationService=new V,this.canvasDisplayService=new N(new Y(Promise.resolve(e))),this.eventHandlingService=new K(this.emulationService,this.canvasDisplayService),this.audioService=new _(this.emulationService),this.emulationService.newFrameEvent.addHandler((e=>this.canvasDisplayService.updateEmulationCanvas(e))),this.timesliceEvent.addHandler(this.onTimeslice),this.powerOffWatcher=new Q((()=>this.isPowerOff())),this.uiInitializedWatcher=new Q((()=>this.isUiInitialized())),this.hotsyncNameWatcher=new Q((()=>this.getHotsyncName()||""))}getStatistics(){return this.emulationService.getStatistics()}loadRom(e,t){if(void 0===t){const r=this.cloudpilot.getRomInfo(e);if(!r||0===r.supportedDevices.length)throw new Error("unsupported device");t=r.supportedDevices[0]}if(this.session=Object.assign(Object.assign({},$),{deviceId:t}),this.emulationService.initWithRom(this.cloudpilot,e,t,this.session))return this.canvasDisplayService.initialize(void 0,t,this.session.orientation),this;throw new Error("failed to initialize session")}loadSession(e){var t,r,n,i,s;const a=this.cloudpilot.deserializeSessionImage(e);if(!a)throw new Error("bad session image");if(this.session={hotsyncName:null===(t=a.metadata)||void 0===t?void 0:t.hotsyncName,speed:null!==(n=null===(r=a.metadata)||void 0===r?void 0:r.speed)&&void 0!==n?n:1,orientation:null!==(s=null===(i=a.metadata)||void 0===i?void 0:i.deviceOrientation)&&void 0!==s?s:o.portrait,runInBackground:!1,deviceId:a.deviceId},this.emulationService.initWithSessionImage(this.cloudpilot,a,this.session))return this.canvasDisplayService.initialize(void 0,a.deviceId,this.session.orientation),this;throw new Error("failed to initialize session")}insertCompressedCardImage(e){if(!this.cloudpilot.decompressCard(Z,e))throw new Error("failed to decompress and mount card image");if(!this.cloudpilot.mountCard(Z))throw new Error("failed to mount card image");return this}insertCardImage(e){if(e.length%512!=0)throw new Error("card image size must be a multiple of 512");if(!this.cloudpilot.allocateCard(Z,e.length))throw new Error("failed to allocate card image");const t=this.cloudpilot.getCardData(Z);if(!t)throw new Error("failed to allocate card image");if(t.set(new Uint32Array(e.buffer,e.byteOffset,e.byteLength>>>2)),!this.cloudpilot.mountCard(Z))throw new Error("failed to mount card image");return this}ejectCard(){if(!this.isCardMounted())return this;if(!this.cloudpilot.removeCard(Z))throw new Error("failed to eject card");return this}isCardMounted(){return this.cloudpilot.getMountedKey()===Z}setCanvas(e){return this.canvasDisplayService.initialize(e,this.session.deviceId,this.session.orientation),this}bindInput(e){const t=this.canvasDisplayService.getCanvas();if(!t)throw new Error("you must set up the canvas setCanvas before calling bindInput");return this.eventHandlingService.bind(t,e),this}releaseInput(){return this.eventHandlingService.release(),this}installDatabase(e){if(this.cloudpilot.installDb(e)<0)throw new Error("failed to install database");return this}installAndLaunchDatabase(e){return this.installDatabase(e).launchDatabase(e)}installFromZipfile(e){return this.installFromZipfileAndLaunch(e)}installFromZipfileAndLaunch(e,t){let r;if(this.cloudpilot.withZipfileWalkerSync(e,(e=>{for(;0===e.GetState();){const n=e.GetCurrentEntryContent(),i=e.GetCurrentEntryName();if(!n)throw new Error(`unable to read ${i} from zupfile`);this.installDatabase(n),i.toLowerCase()===(null==t?void 0:t.toLowerCase())&&(r=n.subarray(0,32).slice()),e.Next()}if(-1===e.GetState())throw new Error("error reading zipfile")})),void 0!==t&&!r)throw new Error(`database ${t} not found `);return r&&this.launchDatabase(r),this}launchByName(e){if(!this.cloudpilot.launchAppByName(e))throw new Error(`failed to launch ${e}`);return this}launchDatabase(e){if(!this.cloudpilot.launchAppByDbHeader(e))throw new Error("failed to launch database");return this}reset(){return this.emulationService.reset(),this}resetNoExtensions(){return this.emulationService.resetNoExtensions(),this}resetHard(){return this.emulationService.resetHard(),this}isRunning(){return this.emulationService.isRunning()}isPowerOff(){return this.emulationService.isPowerOff()}isUiInitialized(){return this.emulationService.isUiInitialized()}resume(){return this.emulationService.resume(),this}pause(){return this.emulationService.pause(),this}buttonDown(e){return this.emulationService.handleButtonDown(e),this}buttonUp(e){return this.emulationService.handleButtonUp(e),this}setSpeed(e){return this.session.speed=e,this}getSpeed(){return this.session.speed}setVolume(e){return this.audioService.setVolume(e),this}getVolume(){return this.audioService.getVolume()}initializeAudio(){return t(this,void 0,void 0,(function*(){return yield this.audioService.initialize(),this.audioService.isInitialized()}))}isAudioInitialized(){return this.audioService.isInitialized()}setOrientation(e){return this.session.orientation=e,this.canvasDisplayService.updateOrientation(this.session.orientation),this}getOrientation(){return this.session.orientation}setHotsyncName(e){return this.session.hotsyncName=e,this.emulationService.forceUpdateHotsyncName(),this}getHotsyncName(){return this.session.hotsyncName}setRunHidden(e){return this.session.runInBackground=e,this}getRunHidden(){return this.session.runInBackground}isGameMode(){return this.eventHandlingService.isGameMode()}setGameMode(e){return this.eventHandlingService.setGameMode(e),this}isGameModeHotkeyEnabled(){return this.eventHandlingService.isGameModeHotkeyEnabled()}setGameModeHotkeyEnabled(e){return this.eventHandlingService.setGameModeHotkeyEnabled(e),this}isGameModeIndicatorEnabled(){return this.canvasDisplayService.isGameModeIndicatorEnabled()}setGameModeIndicatorEnabled(e){return this.canvasDisplayService.setGameModeIndicatorEnabled(e),this}get powerOffChangeEvent(){return this.powerOffWatcher.changeEvent}get isUiInitializedChangeEvent(){return this.uiInitializedWatcher.changeEvent}get hotsyncNameChangeEvent(){return this.hotsyncNameWatcher.changeEvent}get gameModeChangeEvent(){return this.eventHandlingService.gameModeChangeEvent}get timesliceEvent(){return this.emulationService.timesliceEvent}}var J=r(492),ee=r.n(J);const te=[i.palmPilot,i.pilot,i.iii,i.palmVx,i.palmV,i.palmVII,i.palmVIIEZ,i.palmVIIx,i.iiixe,i.iiix,i.iiie,i.m500,i.m505,i.m515,i.m520,i.iiic,i.m100,i.m105,i.m125,i.m130,i.i705,i.i710,i.handera330,i.handera330c,i.pegS300,i.pegS320,i.pegS500c,i.pegT400,i.pegN600c,i.pegT600c,i.pegN700c,i.pegT650c,i.pegNR70,i.acerS11,i.lp168];function re(){return(e,t,r)=>{const n=r.value;return r.value=function(e,t){return this.guard((()=>n.call(this,e,t)))},r}}class ne{constructor(e){this.module=e,this.fatalErrorEvent=new C.j,this.pwmUpdateEvent=new C.j,this.proxyDisconnectEvent=new C.j,this.amIdead=!1,this.cloudpilot=new e.Cloudpilot,this.cloudpilot.RegisterPwmHandler(e.addFunction(((e,t)=>this.pwmUpdateEvent.dispatch({frequency:e,dutyCycle:t})),"vdd")),this.cloudpilot.RegisterProxyDisconnectHandler(e.addFunction((t=>this.proxyDisconnectEvent.dispatch(e.UTF8ToString(t))),"vi"))}static create(e){return t(this,void 0,void 0,(function*(){return new ne(yield ee()(Object.assign(Object.assign({print:e=>console.log(e),printErr:e=>console.error(e)},"string"==typeof e?{locateFile:()=>e}:{}),"function"==typeof e?{instantiateWasm:e}:{})))}))}destroy(){this.module.destroy(this.cloudpilot)}hasFatalError(){return this.amIdead}getRomInfo(e){const t=this.copyIn(e),r=new this.module.RomInfo(t,e.length);let n;return r.IsValid()&&(n={cardVersion:r.CardVersion(),cardName:r.CardName(),romVersion:r.RomVersion(),romVersionString:r.RomVersionString(),supportedDevices:te.filter(r.Supports.bind(r))}),this.cloudpilot.Free(t),this.module.destroy(r),n}initializeSession(e,t){const r=this.copyIn(e),n=this.cloudpilot.InitializeSession(r,e.length,t);return this.cloudpilot.Free(r),n}cyclesPerSecond(){return this.cloudpilot.GetCyclesPerSecond()}runEmulation(e){return this.cloudpilot.RunEmulation(e)}getFrame(){const e=this.cloudpilot.CopyFrame(),t=this.module.getPointer(e.GetBuffer());return{bpp:e.GetBpp(),bytesPerLine:e.GetBytesPerLine(),lines:e.GetLines(),lineWidth:e.GetLineWidth(),margin:e.GetMargin(),firstDirtyLine:e.GetFirstDirtyLine(),lastDirtyLine:e.GetLastDirtyLine(),hasChanges:e.GetHasChanges(),scaleX:e.GetScaleX(),scaleY:e.GetScaleY(),buffer:this.module.HEAPU8.subarray(t,t+e.GetBufferSize())}}isScreenDirty(){return this.cloudpilot.IsScreenDirty()}markScreenClean(){this.cloudpilot.MarkScreenClean()}minRamForDevice(e){return 1024*this.cloudpilot.MinMemoryForDevice(e)}framebufferSizeForDevice(e){return 1024*this.cloudpilot.FramebufferSizeForDevice(e)}totalMemorySizeForDevice(e){return 1024*this.cloudpilot.TotalMemoryForDevice(e)}queuePenMove(e,t){this.cloudpilot.QueuePenMove(e,t)}queuePenUp(){this.cloudpilot.QueuePenUp()}queueButtonDown(e){this.cloudpilot.QueueButtonDown(e)}queueButtonUp(e){this.cloudpilot.QueueButtonUp(e)}queueKeyboardEvent(e,t){this.cloudpilot.QueueKeyboardEvent(e,t)}isPowerOff(){return!!this.cloudpilot.IsPowerOff()}isUiInitialized(){return!!this.cloudpilot.IsUIInitialized()}isSetupComplete(){return!!this.cloudpilot.IsSetupComplete()}getOSVersion(){return this.cloudpilot.GetOSVersion()}reset(){this.cloudpilot.Reset()}resetNoExtensions(){this.cloudpilot.ResetNoExtensions()}resetHard(){this.cloudpilot.ResetHard()}installDb(e){const t=this.copyIn(e),r=this.cloudpilot.InstallDb(t,e.length);return this.cloudpilot.Free(t),r}getPalette2bitMapping(){return this.cloudpilot.GetPalette2bitMapping()}getMemory(){const e=this.module.getPointer(this.cloudpilot.GetMemoryPtr());return this.module.HEAPU8.subarray(e,e+this.cloudpilot.GetMemorySize())}getMemory32(){let e=this.module.getPointer(this.cloudpilot.GetMemoryPtr());if(3&e)throw new Error("unaligned pointer");return e>>>=2,this.module.HEAPU32.subarray(e,e+(this.cloudpilot.GetMemorySize()>>>2))}getDirtyPages(){const e=this.module.getPointer(this.cloudpilot.GetDirtyPagesPtr()),t=this.cloudpilot.GetMemorySize(),r=(t>>>13)+(t%8192==0?0:1);return this.module.HEAPU8.subarray(e,e+r)}loadMemory(e){const t=this.getMemory32();if((()=>{if(e.length!==t.length||e.length<256)return!1;for(let r=256;r>0;r--){if(e[e.length-r]!==t[t.length-r])return!1;if(4294967295===t[t.length-r])break}return!0})())return t.set(e),!0;{const t=this.copyIn32(e),r=this.cloudpilot.ImportMemoryImage(t,e.length<<2);return this.cloudpilot.Free(t),r}}getRomImage(){const e=this.module.getPointer(this.cloudpilot.GetRomPtr());return this.module.HEAPU8.subarray(e,e+this.cloudpilot.GetRomSize())}getSavestate(){const e=this.module.getPointer(this.cloudpilot.GetSavestatePtr());return this.module.HEAPU8.subarray(e,e+this.cloudpilot.GetSavestateSize())}saveState(){return!!this.cloudpilot.SaveState()}loadState(e){const t=this.copyIn(e),r=this.cloudpilot.LoadState(t,e.length);return this.cloudpilot.Free(t),r}getHotsyncName(){return this.cloudpilot.GetHotsyncName()}setClockFactor(e){this.cloudpilot.SetClockFactor(e)}setHotsyncName(e){this.cloudpilot.SetHotsyncName(e)}backup(e){return t(this,void 0,void 0,(function*(){const t=this.guard((()=>this.cloudpilot.StartBackup()));try{return yield e(this.wrap(t))}finally{this.module.destroy(t)}}))}getArchive(e){const t=e.GetArchiveSize();return this.copyOut(e.GetArchivePtr(),t)}setClipboardIntegration(e){this.cloudpilot.SetClipboardIntegration(e)}getClipboardIntegration(){return this.cloudpilot.GetClipboardIntegration()}isSuspended(){return this.cloudpilot.IsSuspended()}getSuspendKind(){return this.cloudpilot.GetSuspendContext().GetKind()}cancelSuspend(){this.cloudpilot.GetSuspendContext().Cancel()}getSuspendContextClipboardCopy(){return this.wrap(this.cloudpilot.GetSuspendContext().AsContextClipboardCopy())}getSuspendContextClipboardPaste(){return this.wrap(this.cloudpilot.GetSuspendContext().AsContextClipboardPaste())}setNetworkRedirection(e){this.cloudpilot.SetNetworkRedirection(e)}getNetworkRedirection(){return this.cloudpilot.GetNetworkRedirection()}getSuspendContextNetworkConnect(){return this.wrap(this.cloudpilot.GetSuspendContext().AsContextNetworkConnect())}getSuspendContextNetworkRpc(){return this.wrap(this.cloudpilot.GetSuspendContext().AsContextNetworkRpc())}copyBuffer(e){return this.copyIn(e)}freeBuffer(e){this.cloudpilot.Free(e)}setHotsyncNameManagement(e){this.cloudpilot.SetHotsyncNameManagement(e)}resolveBuffer(e,t){const r=this.module.getPointer(e);return this.module.HEAPU8.subarray(r,r+t)}withZipfileWalker(e,r){return t(this,void 0,void 0,(function*(){const t=this.guard((()=>{const t=this.copyIn(e),r=new this.module.ZipfileWalker(e.length,t);return this.cloudpilot.Free(t),r}));try{return yield r(this.wrap(Object.setPrototypeOf({GetCurrentEntryContent:()=>this.copyOut(t.GetCurrentEntryContent(),t.GetCurrentEntrySize())},t)))}finally{this.module.destroy(t)}}))}withZipfileWalkerSync(e,t){const r=this.guard((()=>{const t=this.copyIn(e),r=new this.module.ZipfileWalker(e.length,t);return this.cloudpilot.Free(t),r}));try{return t(this.wrap(Object.setPrototypeOf({GetCurrentEntryContent:()=>this.copyOut(r.GetCurrentEntryContent(),r.GetCurrentEntrySize())},r)))}finally{this.module.destroy(r)}}serializeSessionImage(e){var t,r;const n=new this.module.SessionImage,i=this.cloudpilot.Nullptr(),o=this.copyIn(e.rom),s=e.memory?this.copyIn(e.memory):i,a=void 0!==e.savestate?this.copyIn(e.savestate):i;let c=i,p=0;if(void 0!==e.metadata){const t=(new TextEncoder).encode(JSON.stringify(e.metadata));p=t.length,c=this.copyIn(t)}n.SetRomImage(o,e.rom.length),n.SetMemoryImage(s,(null===(t=e.memory)||void 0===t?void 0:t.length)||0),n.SetDeviceId(e.deviceId),n.SetSavestate(a,(null===(r=e.savestate)||void 0===r?void 0:r.length)||0),n.SetMetadata(c,p);const u=n.Serialize()?this.copyOut(n.GetSerializedImage(),n.GetSerializedImageSize()):void 0;return this.module.destroy(n),[o,s,a,c].forEach((e=>this.cloudpilot.Free(e))),u}deserializeSessionImage(e){const t=new this.module.SessionImage,r=this.copyIn(e),n=(()=>{if(!t.Deserialize(r,e.length))return;const n=this.copyOut(t.GetRomImage(),t.GetRomImageSize()),i=this.copyOut(t.GetMemoryImage(),t.GetMemoryImageSize()),o=this.copyOut(t.GetSavestate(),t.GetSavestateSize()),s=t.GetDeviceId();if(!te.includes(s))return void console.warn(`unsupported device ${s}`);let a;const c=this.copyOut(t.GetMetadata(),t.GetMetadataSize());if(c)try{a=JSON.parse((new TextDecoder).decode(c))}catch(e){console.warn("invalid metadata",e)}return{deviceId:s,rom:n,memory:i,savestate:o,metadata:a,version:t.GetVersion()}})();return this.module.destroy(t),this.cloudpilot.Free(r),n}launchAppByName(e){return this.cloudpilot.LaunchAppByName(e)}launchAppByDbHeader(e){if(e.length<32)return!1;const t=this.copyIn(e.subarray(0,32)),r=this.cloudpilot.LaunchAppByDbHeader(t,32);return this.cloudpilot.Free(t),r}deviceSupportsCardSize(e){return this.cloudpilot.DeviceSupportsCardSize(e)}clearExternalStorage(){this.cloudpilot.ClearExternalStorage()}allocateCard(e,t){return this.cloudpilot.AllocateCard(e,t>>>9)}decompressCard(e,t){const r=this.copyIn(t);let n;try{for(n=new this.module.GunzipContext(r,t.length,524288);0===n.GetState();)n.Continue();return-1===n.GetState()?(console.error(`gunzip failed: ${n.GetError()}`),!1):n.GetUncompressedSize()%512!=0?(console.error("failed to allocate card: invalid size of decompressed image"),!1):this.cloudpilot.AdoptCard(e,n.ReleaseUncompressedData(),n.GetUncompressedSize()>>>9)}finally{this.cloudpilot.Free(r),n&&this.module.destroy(n)}}getCardData(e){const t=this.module.getPointer(this.cloudpilot.GetCardData(e));if(0!==t)return this.module.HEAPU32.subarray(t>>>2,t+this.cloudpilot.GetCardSize(e)>>2)}getCardDirtyPages(e){const t=this.module.getPointer(this.cloudpilot.GetCardDirtyPages(e));if(0===t)return;const r=function(e){const t=(e>>>13)+(e%8192>0?1:0);return(t>>>3)+(t%8>0?1:0)}(this.cloudpilot.GetCardSize(e));return this.module.HEAPU8.subarray(t,t+r)}getMountedKey(){return this.cloudpilot.GetMountedKey()}mountCard(e){return this.cloudpilot.MountCard(e)}removeCard(e){return this.cloudpilot.RemoveCard(e)}remountCards(){this.cloudpilot.RemountCards()}getCardSupportLevel(e){return this.cloudpilot.GetSupportLevel(e)}loadSkin(e){const t=new this.module.SkinLoader(e);try{const e=this.module.getPointer(t.GetData());if(0===e)return;return(new TextDecoder).decode(this.module.HEAPU8.subarray(e,e+t.GetSize()))}finally{this.module.destroy(t)}}guard(e){if(this.amIdead)throw new Error("cloudpilot instance is dead");try{return e()}catch(e){throw this.amIdead=!0,this.cloudpilot=void 0,this.fatalErrorEvent.dispatch(e instanceof Error?e:new Error("unknown error")),e}}copyIn(e){const t=this.cloudpilot.Malloc(e.length),r=this.module.getPointer(t);return this.module.HEAPU8.subarray(r,r+e.length).set(e),t}copyIn32(e){const t=this.cloudpilot.Malloc(e.length<<2),r=this.module.getPointer(t);return this.module.HEAPU32.subarray(r>>>2,(r>>>2)+e.length).set(e),t}copyOut(e,t){const r=this.module.getPointer(e);return r>0&&t>0?this.module.HEAPU8.subarray(r,r+t).slice():void 0}wrap(e){return new Proxy(e,{get:(e,t)=>{const r=e[t];return"function"!=typeof r?r:(...t)=>this.guard((()=>r.apply(e,t)))}})}}var ie;e([re()],ne.prototype,"getRomInfo",null),e([re()],ne.prototype,"initializeSession",null),e([re()],ne.prototype,"cyclesPerSecond",null),e([re()],ne.prototype,"runEmulation",null),e([re()],ne.prototype,"getFrame",null),e([re()],ne.prototype,"isScreenDirty",null),e([re()],ne.prototype,"markScreenClean",null),e([re()],ne.prototype,"minRamForDevice",null),e([re()],ne.prototype,"framebufferSizeForDevice",null),e([re()],ne.prototype,"totalMemorySizeForDevice",null),e([re()],ne.prototype,"queuePenMove",null),e([re()],ne.prototype,"queuePenUp",null),e([re()],ne.prototype,"queueButtonDown",null),e([re()],ne.prototype,"queueButtonUp",null),e([re()],ne.prototype,"queueKeyboardEvent",null),e([re()],ne.prototype,"isPowerOff",null),e([re()],ne.prototype,"isUiInitialized",null),e([re()],ne.prototype,"isSetupComplete",null),e([re()],ne.prototype,"getOSVersion",null),e([re()],ne.prototype,"reset",null),e([re()],ne.prototype,"resetNoExtensions",null),e([re()],ne.prototype,"resetHard",null),e([re()],ne.prototype,"installDb",null),e([re()],ne.prototype,"getPalette2bitMapping",null),e([re()],ne.prototype,"getMemory",null),e([re()],ne.prototype,"getMemory32",null),e([re()],ne.prototype,"getDirtyPages",null),e([re()],ne.prototype,"loadMemory",null),e([re()],ne.prototype,"getRomImage",null),e([re()],ne.prototype,"getSavestate",null),e([re()],ne.prototype,"saveState",null),e([re()],ne.prototype,"loadState",null),e([re()],ne.prototype,"getHotsyncName",null),e([re()],ne.prototype,"setClockFactor",null),e([re()],ne.prototype,"setHotsyncName",null),e([re()],ne.prototype,"setClipboardIntegration",null),e([re()],ne.prototype,"getClipboardIntegration",null),e([re()],ne.prototype,"isSuspended",null),e([re()],ne.prototype,"getSuspendKind",null),e([re()],ne.prototype,"cancelSuspend",null),e([re()],ne.prototype,"getSuspendContextClipboardCopy",null),e([re()],ne.prototype,"getSuspendContextClipboardPaste",null),e([re()],ne.prototype,"setNetworkRedirection",null),e([re()],ne.prototype,"getNetworkRedirection",null),e([re()],ne.prototype,"getSuspendContextNetworkConnect",null),e([re()],ne.prototype,"getSuspendContextNetworkRpc",null),e([re()],ne.prototype,"copyBuffer",null),e([re()],ne.prototype,"freeBuffer",null),e([re()],ne.prototype,"setHotsyncNameManagement",null),e([re()],ne.prototype,"resolveBuffer",null),e([re()],ne.prototype,"serializeSessionImage",null),e([re()],ne.prototype,"deserializeSessionImage",null),e([re()],ne.prototype,"launchAppByName",null),e([re()],ne.prototype,"launchAppByDbHeader",null),e([re()],ne.prototype,"deviceSupportsCardSize",null),e([re()],ne.prototype,"clearExternalStorage",null),e([re()],ne.prototype,"allocateCard",null),e([re()],ne.prototype,"decompressCard",null),e([re()],ne.prototype,"getCardData",null),e([re()],ne.prototype,"getCardDirtyPages",null),e([re()],ne.prototype,"getMountedKey",null),e([re()],ne.prototype,"mountCard",null),e([re()],ne.prototype,"removeCard",null),e([re()],ne.prototype,"remountCards",null),e([re()],ne.prototype,"getCardSupportLevel",null),e([re()],ne.prototype,"loadSkin",null),function(e){e[e.cal=0]="cal",e[e.phone=1]="phone",e[e.todo=2]="todo",e[e.notes=3]="notes",e[e.up=4]="up",e[e.down=5]="down",e[e.power=6]="power",e[e.cradle=7]="cradle"}(ie||(ie={}));const oe="1.8.17";function se(e){return t(this,void 0,void 0,(function*(){return new X(yield ne.create(e))}))}function ae(e){const r=function(e){const r=WebAssembly.compileStreaming?WebAssembly.compileStreaming(fetch(e)):fetch(e).then((e=>e.arrayBuffer())).then((e=>WebAssembly.compile(e)));return(e,n)=>t(this,void 0,void 0,(function*(){return n(yield WebAssembly.instantiate(yield r,e))}))}(null!=e?e:"cloudpilot_web.wasm");return()=>ne.create(r).then((e=>new X(e)))}})(),n})()));
//# sourceMappingURL=cloudpilot-emu.js.map